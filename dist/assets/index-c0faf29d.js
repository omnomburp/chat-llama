var b8=Object.defineProperty;var v8=(n,e,t)=>e in n?b8(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var O=(n,e,t)=>(v8(n,typeof e!="symbol"?e+"":e,t),t),Rg=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var o=(n,e,t)=>(Rg(n,e,"read from private field"),t?t.call(n):e.get(n)),g=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},b=(n,e,t,s)=>(Rg(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t);var Lt=(n,e,t,s)=>({set _(i){b(n,e,i,t)},get _(){return o(n,e,s)}}),A=(n,e,t)=>(Rg(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function Ns(){}function U6(n){return n()}function Y3(){return Object.create(null)}function Rr(n){n.forEach(U6)}function q6(n){return typeof n=="function"}function ug(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function y8(n){return Object.keys(n).length===0}function Wt(n){return n??""}const w8=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function K(n,e){n.appendChild(e)}function Le(n,e,t){n.insertBefore(e,t||null)}function De(n){n.parentNode&&n.parentNode.removeChild(n)}function A8(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function oe(n){return document.createElement(n)}function Xt(n){return document.createTextNode(n)}function ke(){return Xt(" ")}function a4(){return Xt("")}function rt(n,e,t,s){return n.addEventListener(e,t,s),()=>n.removeEventListener(e,t,s)}function hc(n){return function(e){return e.preventDefault(),n.call(this,e)}}function U(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function x8(n){return Array.from(n.childNodes)}function Mr(n,e){e=""+e,n.data!==e&&(n.data=e)}function K3(n,e){n.value=e??""}function S8(n,e,{bubbles:t=!1,cancelable:s=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:s})}let Gc;function Hc(n){Gc=n}function $6(){if(!Gc)throw new Error("Function called outside component initialization");return Gc}function Z3(n){$6().$$.on_mount.push(n)}function G6(){const n=$6();return(e,t,{cancelable:s=!1}={})=>{const i=n.$$.callbacks[e];if(i){const r=S8(e,t,{cancelable:s});return i.slice().forEach(a=>{a.call(n,r)}),!r.defaultPrevented}return!0}}function k8(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(s=>s.call(this,e))}const Ul=[],o4=[];let s0=[];const Q3=[],V6=Promise.resolve();let l4=!1;function j6(){l4||(l4=!0,V6.then(W6))}function Pg(){return j6(),V6}function h4(n){s0.push(n)}const Lg=new Set;let Ol=0;function W6(){if(Ol!==0)return;const n=Gc;do{try{for(;Ol<Ul.length;){const e=Ul[Ol];Ol++,Hc(e),T8(e.$$)}}catch(e){throw Ul.length=0,Ol=0,e}for(Hc(null),Ul.length=0,Ol=0;o4.length;)o4.pop()();for(let e=0;e<s0.length;e+=1){const t=s0[e];Lg.has(t)||(Lg.add(t),t())}s0.length=0}while(Ul.length);for(;Q3.length;)Q3.pop()();l4=!1,Lg.clear(),Hc(n)}function T8(n){if(n.fragment!==null){n.update(),Rr(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(h4)}}function C8(n){const e=[],t=[];s0.forEach(s=>n.indexOf(s)===-1?e.push(s):t.push(s)),t.forEach(s=>s()),s0=e}const d1=new Set;let E8;function Uc(n,e){n&&n.i&&(d1.delete(n),n.i(e))}function Ig(n,e,t,s){if(n&&n.o){if(d1.has(n))return;d1.add(n),E8.c.push(()=>{d1.delete(n),s&&(t&&n.d(1),s())}),n.o(e)}else s&&s()}function Fa(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Z2(n,e){n.d(1),e.delete(n.key)}function Q2(n,e,t,s,i,r,a,l,h,c,u,d){let f=n.length,p=r.length,w=f;const y={};for(;w--;)y[n[w].key]=w;const x=[],S=new Map,E=new Map,T=[];for(w=p;w--;){const L=d(i,r,w),F=t(L);let N=a.get(F);N?s&&T.push(()=>N.p(L,e)):(N=c(F,L),N.c()),S.set(F,x[w]=N),F in y&&E.set(F,Math.abs(w-y[F]))}const _=new Set,M=new Set;function D(L){Uc(L,1),L.m(l,u),a.set(L.key,L),u=L.first,p--}for(;f&&p;){const L=x[p-1],F=n[f-1],N=L.key,W=F.key;L===F?(u=L.first,f--,p--):S.has(W)?!a.has(N)||_.has(N)?D(L):M.has(W)?f--:E.get(N)>E.get(W)?(M.add(N),D(L)):(_.add(W),f--):(h(F,a),f--)}for(;f--;){const L=n[f];S.has(L.key)||h(L,a)}for(;p;)D(x[p-1]);return Rr(T),x}function Bg(n){n&&n.c()}function f1(n,e,t){const{fragment:s,after_update:i}=n.$$;s&&s.m(e,t),h4(()=>{const r=n.$$.on_mount.map(U6).filter(q6);n.$$.on_destroy?n.$$.on_destroy.push(...r):Rr(r),n.$$.on_mount=[]}),i.forEach(h4)}function p1(n,e){const t=n.$$;t.fragment!==null&&(C8(t.after_update),Rr(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function _8(n,e){n.$$.dirty[0]===-1&&(Ul.push(n),j6(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function dg(n,e,t,s,i,r,a=null,l=[-1]){const h=Gc;Hc(n);const c=n.$$={fragment:null,ctx:[],props:r,update:Ns,not_equal:i,bound:Y3(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(h?h.$$.context:[])),callbacks:Y3(),dirty:l,skip_bound:!1,root:e.target||h.$$.root};a&&a(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(d,f,...p)=>{const w=p.length?p[0]:f;return c.ctx&&i(c.ctx[d],c.ctx[d]=w)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](w),u&&_8(n,d)),f}):[],c.update(),u=!0,Rr(c.before_update),c.fragment=s?s(c.ctx):!1,e.target){if(e.hydrate){const d=x8(e.target);c.fragment&&c.fragment.l(d),d.forEach(De)}else c.fragment&&c.fragment.c();e.intro&&Uc(n.$$.fragment),f1(n,e.target,e.anchor),W6()}Hc(h)}class fg{constructor(){O(this,"$$");O(this,"$$set")}$destroy(){p1(this,1),this.$destroy=Ns}$on(e,t){if(!q6(t))return Ns;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const i=s.indexOf(t);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!y8(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const M8="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(M8);function J2(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Il=J2();function X6(n){Il=n}var qc={exec:()=>null};function Ie(n,e=""){let t=typeof n=="string"?n:n.source,s={replace:(i,r)=>{let a=typeof r=="string"?r:r.source;return a=a.replace(As.caret,"$1"),t=t.replace(i,a),s},getRegex:()=>new RegExp(t,e)};return s}var D8=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),As={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},R8=/^(?:[ \t]*(?:\n|$))+/,P8=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,L8=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,If=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,I8=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,e3=/(?:[*+-]|\d{1,9}[.)])/,Y6=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,K6=Ie(Y6).replace(/bull/g,e3).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),B8=Ie(Y6).replace(/bull/g,e3).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),t3=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,N8=/^[^\n]+/,s3=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,F8=Ie(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",s3).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),O8=Ie(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,e3).getRegex(),pg="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",i3=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,z8=Ie("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",i3).replace("tag",pg).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Z6=Ie(t3).replace("hr",If).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pg).getRegex(),H8=Ie(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Z6).getRegex(),r3={blockquote:H8,code:P8,def:F8,fences:L8,heading:I8,hr:If,html:z8,lheading:K6,list:O8,newline:R8,paragraph:Z6,table:qc,text:N8},J3=Ie("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",If).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pg).getRegex(),U8={...r3,lheading:B8,table:J3,paragraph:Ie(t3).replace("hr",If).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",J3).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",pg).getRegex()},q8={...r3,html:Ie(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",i3).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:qc,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ie(t3).replace("hr",If).replace("heading",` *#{1,6} *[^
]`).replace("lheading",K6).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},$8=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,G8=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Q6=/^( {2,}|\\)\n(?!\s*$)/,V8=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,mg=/[\p{P}\p{S}]/u,n3=/[\s\p{P}\p{S}]/u,J6=/[^\s\p{P}\p{S}]/u,j8=Ie(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,n3).getRegex(),eb=/(?!~)[\p{P}\p{S}]/u,W8=/(?!~)[\s\p{P}\p{S}]/u,X8=/(?:[^\s\p{P}\p{S}]|~)/u,Y8=Ie(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",D8?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),tb=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,K8=Ie(tb,"u").replace(/punct/g,mg).getRegex(),Z8=Ie(tb,"u").replace(/punct/g,eb).getRegex(),sb="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Q8=Ie(sb,"gu").replace(/notPunctSpace/g,J6).replace(/punctSpace/g,n3).replace(/punct/g,mg).getRegex(),J8=Ie(sb,"gu").replace(/notPunctSpace/g,X8).replace(/punctSpace/g,W8).replace(/punct/g,eb).getRegex(),ey=Ie("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,J6).replace(/punctSpace/g,n3).replace(/punct/g,mg).getRegex(),ty=Ie(/\\(punct)/,"gu").replace(/punct/g,mg).getRegex(),sy=Ie(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),iy=Ie(i3).replace("(?:-->|$)","-->").getRegex(),ry=Ie("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",iy).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Q1=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,ny=Ie(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Q1).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ib=Ie(/^!?\[(label)\]\[(ref)\]/).replace("label",Q1).replace("ref",s3).getRegex(),rb=Ie(/^!?\[(ref)\](?:\[\])?/).replace("ref",s3).getRegex(),ay=Ie("reflink|nolink(?!\\()","g").replace("reflink",ib).replace("nolink",rb).getRegex(),e5=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,a3={_backpedal:qc,anyPunctuation:ty,autolink:sy,blockSkip:Y8,br:Q6,code:G8,del:qc,emStrongLDelim:K8,emStrongRDelimAst:Q8,emStrongRDelimUnd:ey,escape:$8,link:ny,nolink:rb,punctuation:j8,reflink:ib,reflinkSearch:ay,tag:ry,text:V8,url:qc},oy={...a3,link:Ie(/^!?\[(label)\]\((.*?)\)/).replace("label",Q1).getRegex(),reflink:Ie(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Q1).getRegex()},c4={...a3,emStrongRDelimAst:J8,emStrongLDelim:Z8,url:Ie(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",e5).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Ie(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",e5).getRegex()},ly={...c4,br:Ie(Q6).replace("{2,}","*").getRegex(),text:Ie(c4.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},jf={normal:r3,gfm:U8,pedantic:q8},cc={normal:a3,gfm:c4,breaks:ly,pedantic:oy},hy={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},t5=n=>hy[n];function Fr(n,e){if(e){if(As.escapeTest.test(n))return n.replace(As.escapeReplace,t5)}else if(As.escapeTestNoEncode.test(n))return n.replace(As.escapeReplaceNoEncode,t5);return n}function s5(n){try{n=encodeURI(n).replace(As.percentDecode,"%")}catch{return null}return n}function i5(n,e){var r;let t=n.replace(As.findPipe,(a,l,h)=>{let c=!1,u=l;for(;--u>=0&&h[u]==="\\";)c=!c;return c?"|":" |"}),s=t.split(As.splitPipe),i=0;if(s[0].trim()||s.shift(),s.length>0&&!((r=s.at(-1))!=null&&r.trim())&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;i<s.length;i++)s[i]=s[i].trim().replace(As.slashPipe,"|");return s}function uc(n,e,t){let s=n.length;if(s===0)return"";let i=0;for(;i<s;){let r=n.charAt(s-i-1);if(r===e&&!t)i++;else if(r!==e&&t)i++;else break}return n.slice(0,s-i)}function cy(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let s=0;s<n.length;s++)if(n[s]==="\\")s++;else if(n[s]===e[0])t++;else if(n[s]===e[1]&&(t--,t<0))return s;return t>0?-2:-1}function r5(n,e,t,s,i){let r=e.href,a=e.title||null,l=n[1].replace(i.other.outputLinkReplace,"$1");s.state.inLink=!0;let h={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:r,title:a,text:l,tokens:s.inlineTokens(l)};return s.state.inLink=!1,h}function uy(n,e,t){let s=n.match(t.other.indentCodeCompensation);if(s===null)return e;let i=s[1];return e.split(`
`).map(r=>{let a=r.match(t.other.beginningSpace);if(a===null)return r;let[l]=a;return l.length>=i.length?r.slice(i.length):r}).join(`
`)}var J1=class{constructor(n){O(this,"options");O(this,"rules");O(this,"lexer");this.options=n||Il}space(n){let e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){let e=this.rules.block.code.exec(n);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:uc(t,`
`)}}}fences(n){let e=this.rules.block.fences.exec(n);if(e){let t=e[0],s=uy(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:s}}}heading(n){let e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let s=uc(t,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(t=s.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){let e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:uc(e[0],`
`)}}blockquote(n){let e=this.rules.block.blockquote.exec(n);if(e){let t=uc(e[0],`
`).split(`
`),s="",i="",r=[];for(;t.length>0;){let a=!1,l=[],h;for(h=0;h<t.length;h++)if(this.rules.other.blockquoteStart.test(t[h]))l.push(t[h]),a=!0;else if(!a)l.push(t[h]);else break;t=t.slice(h);let c=l.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${c}`:c,i=i?`${i}
${u}`:u;let d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,r,!0),this.lexer.state.top=d,t.length===0)break;let f=r.at(-1);if((f==null?void 0:f.type)==="code")break;if((f==null?void 0:f.type)==="blockquote"){let p=f,w=p.raw+`
`+t.join(`
`),y=this.blockquote(w);r[r.length-1]=y,s=s.substring(0,s.length-p.raw.length)+y.raw,i=i.substring(0,i.length-p.text.length)+y.text;break}else if((f==null?void 0:f.type)==="list"){let p=f,w=p.raw+`
`+t.join(`
`),y=this.list(w);r[r.length-1]=y,s=s.substring(0,s.length-f.raw.length)+y.raw,i=i.substring(0,i.length-p.raw.length)+y.raw,t=w.substring(r.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:r,text:i}}}list(n){var t,s;let e=this.rules.block.list.exec(n);if(e){let i=e[1].trim(),r=i.length>1,a={type:"list",raw:"",ordered:r,start:r?+i.slice(0,-1):"",loose:!1,items:[]};i=r?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=r?i:"[*+-]");let l=this.rules.other.listItemRegex(i),h=!1;for(;n;){let u=!1,d="",f="";if(!(e=l.exec(n))||this.rules.block.hr.test(n))break;d=e[0],n=n.substring(d.length);let p=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,S=>" ".repeat(3*S.length)),w=n.split(`
`,1)[0],y=!p.trim(),x=0;if(this.options.pedantic?(x=2,f=p.trimStart()):y?x=e[1].length+1:(x=e[2].search(this.rules.other.nonSpaceChar),x=x>4?1:x,f=p.slice(x),x+=e[1].length),y&&this.rules.other.blankLine.test(w)&&(d+=w+`
`,n=n.substring(w.length+1),u=!0),!u){let S=this.rules.other.nextBulletRegex(x),E=this.rules.other.hrRegex(x),T=this.rules.other.fencesBeginRegex(x),_=this.rules.other.headingBeginRegex(x),M=this.rules.other.htmlBeginRegex(x);for(;n;){let D=n.split(`
`,1)[0],L;if(w=D,this.options.pedantic?(w=w.replace(this.rules.other.listReplaceNesting,"  "),L=w):L=w.replace(this.rules.other.tabCharGlobal,"    "),T.test(w)||_.test(w)||M.test(w)||S.test(w)||E.test(w))break;if(L.search(this.rules.other.nonSpaceChar)>=x||!w.trim())f+=`
`+L.slice(x);else{if(y||p.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||T.test(p)||_.test(p)||E.test(p))break;f+=`
`+w}!y&&!w.trim()&&(y=!0),d+=D+`
`,n=n.substring(D.length+1),p=L.slice(x)}}a.loose||(h?a.loose=!0:this.rules.other.doubleBlankLine.test(d)&&(h=!0)),a.items.push({type:"list_item",raw:d,task:!!this.options.gfm&&this.rules.other.listIsTask.test(f),loose:!1,text:f,tokens:[]}),a.raw+=d}let c=a.items.at(-1);if(c)c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd();else return;a.raw=a.raw.trimEnd();for(let u of a.items){if(this.lexer.state.top=!1,u.tokens=this.lexer.blockTokens(u.text,[]),u.task){if(u.text=u.text.replace(this.rules.other.listReplaceTask,""),((t=u.tokens[0])==null?void 0:t.type)==="text"||((s=u.tokens[0])==null?void 0:s.type)==="paragraph"){u.tokens[0].raw=u.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),u.tokens[0].text=u.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let f=this.lexer.inlineQueue.length-1;f>=0;f--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[f].src)){this.lexer.inlineQueue[f].src=this.lexer.inlineQueue[f].src.replace(this.rules.other.listReplaceTask,"");break}}let d=this.rules.other.listTaskCheckbox.exec(u.raw);if(d){let f={type:"checkbox",raw:d[0]+" ",checked:d[0]!=="[ ]"};u.checked=f.checked,a.loose?u.tokens[0]&&["paragraph","text"].includes(u.tokens[0].type)&&"tokens"in u.tokens[0]&&u.tokens[0].tokens?(u.tokens[0].raw=f.raw+u.tokens[0].raw,u.tokens[0].text=f.raw+u.tokens[0].text,u.tokens[0].tokens.unshift(f)):u.tokens.unshift({type:"paragraph",raw:f.raw,text:f.raw,tokens:[f]}):u.tokens.unshift(f)}}if(!a.loose){let d=u.tokens.filter(p=>p.type==="space"),f=d.length>0&&d.some(p=>this.rules.other.anyLine.test(p.raw));a.loose=f}}if(a.loose)for(let u of a.items){u.loose=!0;for(let d of u.tokens)d.type==="text"&&(d.type="paragraph")}return a}}html(n){let e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){let e=this.rules.block.def.exec(n);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:s,title:i}}}table(n){var a;let e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=i5(e[1]),s=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(a=e[3])!=null&&a.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],r={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===s.length){for(let l of s)this.rules.other.tableAlignRight.test(l)?r.align.push("right"):this.rules.other.tableAlignCenter.test(l)?r.align.push("center"):this.rules.other.tableAlignLeft.test(l)?r.align.push("left"):r.align.push(null);for(let l=0;l<t.length;l++)r.header.push({text:t[l],tokens:this.lexer.inline(t[l]),header:!0,align:r.align[l]});for(let l of i)r.rows.push(i5(l,r.header.length).map((h,c)=>({text:h,tokens:this.lexer.inline(h),header:!1,align:r.align[c]})));return r}}lheading(n){let e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){let e=this.rules.block.paragraph.exec(n);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){let e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){let e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){let e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){let e=this.rules.inline.link.exec(n);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let r=uc(t.slice(0,-1),"\\");if((t.length-r.length)%2===0)return}else{let r=cy(e[2],"()");if(r===-2)return;if(r>-1){let a=(e[0].indexOf("!")===0?5:4)+e[1].length+r;e[2]=e[2].substring(0,r),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let s=e[2],i="";if(this.options.pedantic){let r=this.rules.other.pedanticHrefTitle.exec(s);r&&(s=r[1],i=r[3])}else i=e[3]?e[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?s=s.slice(1):s=s.slice(1,-1)),r5(e,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){let s=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[s.toLowerCase()];if(!i){let r=t[0].charAt(0);return{type:"text",raw:r,text:r}}return r5(t,i,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let s=this.rules.inline.emStrongLDelim.exec(n);if(!(!s||s[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(s[1]||s[2])||!t||this.rules.inline.punctuation.exec(t))){let i=[...s[0]].length-1,r,a,l=i,h=0,c=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,e=e.slice(-1*n.length+i);(s=c.exec(e))!=null;){if(r=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!r)continue;if(a=[...r].length,s[3]||s[4]){l+=a;continue}else if((s[5]||s[6])&&i%3&&!((i+a)%3)){h+=a;continue}if(l-=a,l>0)continue;a=Math.min(a,a+l+h);let u=[...s[0]][0].length,d=n.slice(0,i+s.index+u+a);if(Math.min(i,a)%2){let p=d.slice(1,-1);return{type:"em",raw:d,text:p,tokens:this.lexer.inlineTokens(p)}}let f=d.slice(2,-2);return{type:"strong",raw:d,text:f,tokens:this.lexer.inlineTokens(f)}}}}codespan(n){let e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),s=this.rules.other.nonSpaceChar.test(t),i=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return s&&i&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){let e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){let e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){let e=this.rules.inline.autolink.exec(n);if(e){let t,s;return e[2]==="@"?(t=e[1],s="mailto:"+t):(t=e[1],s=t),{type:"link",raw:e[0],text:t,href:s,tokens:[{type:"text",raw:t,text:t}]}}}url(n){var t;let e;if(e=this.rules.inline.url.exec(n)){let s,i;if(e[2]==="@")s=e[0],i="mailto:"+s;else{let r;do r=e[0],e[0]=((t=this.rules.inline._backpedal.exec(e[0]))==null?void 0:t[0])??"";while(r!==e[0]);s=e[0],e[1]==="www."?i="http://"+e[0]:i=e[0]}return{type:"link",raw:e[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(n){let e=this.rules.inline.text.exec(n);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},Ki=class u4{constructor(e){O(this,"tokens");O(this,"options");O(this,"state");O(this,"inlineQueue");O(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Il,this.options.tokenizer=this.options.tokenizer||new J1,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:As,block:jf.normal,inline:cc.normal};this.options.pedantic?(t.block=jf.pedantic,t.inline=cc.pedantic):this.options.gfm&&(t.block=jf.gfm,this.options.breaks?t.inline=cc.breaks:t.inline=cc.gfm),this.tokenizer.rules=t}static get rules(){return{block:jf,inline:cc}}static lex(e,t){return new u4(t).lex(e)}static lexInline(e,t){return new u4(t).inlineTokens(e)}lex(e){e=e.replace(As.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let s=this.inlineQueue[t];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],s=!1){var i,r,a;for(this.options.pedantic&&(e=e.replace(As.tabCharGlobal,"    ").replace(As.spaceLine,""));e;){let l;if((r=(i=this.options.extensions)==null?void 0:i.block)!=null&&r.some(c=>(l=c.call({lexer:this},e,t))?(e=e.substring(l.raw.length),t.push(l),!0):!1))continue;if(l=this.tokenizer.space(e)){e=e.substring(l.raw.length);let c=t.at(-1);l.raw.length===1&&c!==void 0?c.raw+=`
`:t.push(l);continue}if(l=this.tokenizer.code(e)){e=e.substring(l.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+l.raw,c.text+=`
`+l.text,this.inlineQueue.at(-1).src=c.text):t.push(l);continue}if(l=this.tokenizer.fences(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.heading(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.hr(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.blockquote(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.list(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.html(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.def(e)){e=e.substring(l.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+l.raw,c.text+=`
`+l.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[l.tag]||(this.tokens.links[l.tag]={href:l.href,title:l.title},t.push(l));continue}if(l=this.tokenizer.table(e)){e=e.substring(l.raw.length),t.push(l);continue}if(l=this.tokenizer.lheading(e)){e=e.substring(l.raw.length),t.push(l);continue}let h=e;if((a=this.options.extensions)!=null&&a.startBlock){let c=1/0,u=e.slice(1),d;this.options.extensions.startBlock.forEach(f=>{d=f.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(h=e.substring(0,c+1))}if(this.state.top&&(l=this.tokenizer.paragraph(h))){let c=t.at(-1);s&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+l.raw,c.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(l),s=h.length!==e.length,e=e.substring(l.raw.length);continue}if(l=this.tokenizer.text(e)){e=e.substring(l.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=(c.raw.endsWith(`
`)?"":`
`)+l.raw,c.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(l);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var h,c,u,d,f;let s=e,i=null;if(this.tokens.links){let p=Object.keys(this.tokens.links);if(p.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)p.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,i.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let r;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)r=i[2]?i[2].length:0,s=s.slice(0,i.index+r)+"["+"a".repeat(i[0].length-r-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);s=((c=(h=this.options.hooks)==null?void 0:h.emStrongMask)==null?void 0:c.call({lexer:this},s))??s;let a=!1,l="";for(;e;){a||(l=""),a=!1;let p;if((d=(u=this.options.extensions)==null?void 0:u.inline)!=null&&d.some(y=>(p=y.call({lexer:this},e,t))?(e=e.substring(p.raw.length),t.push(p),!0):!1))continue;if(p=this.tokenizer.escape(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.tag(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.link(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(p.raw.length);let y=t.at(-1);p.type==="text"&&(y==null?void 0:y.type)==="text"?(y.raw+=p.raw,y.text+=p.text):t.push(p);continue}if(p=this.tokenizer.emStrong(e,s,l)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.codespan(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.br(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.del(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.autolink(e)){e=e.substring(p.raw.length),t.push(p);continue}if(!this.state.inLink&&(p=this.tokenizer.url(e))){e=e.substring(p.raw.length),t.push(p);continue}let w=e;if((f=this.options.extensions)!=null&&f.startInline){let y=1/0,x=e.slice(1),S;this.options.extensions.startInline.forEach(E=>{S=E.call({lexer:this},x),typeof S=="number"&&S>=0&&(y=Math.min(y,S))}),y<1/0&&y>=0&&(w=e.substring(0,y+1))}if(p=this.tokenizer.inlineText(w)){e=e.substring(p.raw.length),p.raw.slice(-1)!=="_"&&(l=p.raw.slice(-1)),a=!0;let y=t.at(-1);(y==null?void 0:y.type)==="text"?(y.raw+=p.raw,y.text+=p.text):t.push(p);continue}if(e){let y="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(y);break}else throw new Error(y)}}return t}},ep=class{constructor(n){O(this,"options");O(this,"parser");this.options=n||Il}space(n){return""}code({text:n,lang:e,escaped:t}){var r;let s=(r=(e||"").match(As.notSpaceStart))==null?void 0:r[0],i=n.replace(As.endingNewline,"")+`
`;return s?'<pre><code class="language-'+Fr(s)+'">'+(t?i:Fr(i,!0))+`</code></pre>
`:"<pre><code>"+(t?i:Fr(i,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}def(n){return""}heading({tokens:n,depth:e}){return`<h${e}>${this.parser.parseInline(n)}</h${e}>
`}hr(n){return`<hr>
`}list(n){let e=n.ordered,t=n.start,s="";for(let a=0;a<n.items.length;a++){let l=n.items[a];s+=this.listitem(l)}let i=e?"ol":"ul",r=e&&t!==1?' start="'+t+'"':"";return"<"+i+r+`>
`+s+"</"+i+`>
`}listitem(n){return`<li>${this.parser.parse(n.tokens)}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let e="",t="";for(let i=0;i<n.header.length;i++)t+=this.tablecell(n.header[i]);e+=this.tablerow({text:t});let s="";for(let i=0;i<n.rows.length;i++){let r=n.rows[i];t="";for(let a=0;a<r.length;a++)t+=this.tablecell(r[a]);s+=this.tablerow({text:t})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+s+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){let e=this.parser.parseInline(n.tokens),t=n.header?"th":"td";return(n.align?`<${t} align="${n.align}">`:`<${t}>`)+e+`</${t}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${Fr(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:e,tokens:t}){let s=this.parser.parseInline(t),i=s5(n);if(i===null)return s;n=i;let r='<a href="'+n+'"';return e&&(r+=' title="'+Fr(e)+'"'),r+=">"+s+"</a>",r}image({href:n,title:e,text:t,tokens:s}){s&&(t=this.parser.parseInline(s,this.parser.textRenderer));let i=s5(n);if(i===null)return Fr(t);n=i;let r=`<img src="${n}" alt="${t}"`;return e&&(r+=` title="${Fr(e)}"`),r+=">",r}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:Fr(n.text)}},o3=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}checkbox({raw:n}){return n}},Zi=class d4{constructor(e){O(this,"options");O(this,"renderer");O(this,"textRenderer");this.options=e||Il,this.options.renderer=this.options.renderer||new ep,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new o3}static parse(e,t){return new d4(t).parse(e)}static parseInline(e,t){return new d4(t).parseInline(e)}parse(e){var s,i;let t="";for(let r=0;r<e.length;r++){let a=e[r];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[a.type]){let h=a,c=this.options.extensions.renderers[h.type].call({parser:this},h);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(h.type)){t+=c||"";continue}}let l=a;switch(l.type){case"space":{t+=this.renderer.space(l);break}case"hr":{t+=this.renderer.hr(l);break}case"heading":{t+=this.renderer.heading(l);break}case"code":{t+=this.renderer.code(l);break}case"table":{t+=this.renderer.table(l);break}case"blockquote":{t+=this.renderer.blockquote(l);break}case"list":{t+=this.renderer.list(l);break}case"checkbox":{t+=this.renderer.checkbox(l);break}case"html":{t+=this.renderer.html(l);break}case"def":{t+=this.renderer.def(l);break}case"paragraph":{t+=this.renderer.paragraph(l);break}case"text":{t+=this.renderer.text(l);break}default:{let h='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return t}parseInline(e,t=this.renderer){var i,r;let s="";for(let a=0;a<e.length;a++){let l=e[a];if((r=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&r[l.type]){let c=this.options.extensions.renderers[l.type].call({parser:this},l);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){s+=c||"";continue}}let h=l;switch(h.type){case"escape":{s+=t.text(h);break}case"html":{s+=t.html(h);break}case"link":{s+=t.link(h);break}case"image":{s+=t.image(h);break}case"checkbox":{s+=t.checkbox(h);break}case"strong":{s+=t.strong(h);break}case"em":{s+=t.em(h);break}case"codespan":{s+=t.codespan(h);break}case"br":{s+=t.br(h);break}case"del":{s+=t.del(h);break}case"text":{s+=t.text(h);break}default:{let c='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return s}},u1,bc=(u1=class{constructor(e){O(this,"options");O(this,"block");this.options=e||Il}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?Ki.lex:Ki.lexInline}provideParser(){return this.block?Zi.parse:Zi.parseInline}},O(u1,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),O(u1,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),u1),dy=class{constructor(...n){O(this,"defaults",J2());O(this,"options",this.setOptions);O(this,"parse",this.parseMarkdown(!0));O(this,"parseInline",this.parseMarkdown(!1));O(this,"Parser",Zi);O(this,"Renderer",ep);O(this,"TextRenderer",o3);O(this,"Lexer",Ki);O(this,"Tokenizer",J1);O(this,"Hooks",bc);this.use(...n)}walkTokens(n,e){var s,i;let t=[];for(let r of n)switch(t=t.concat(e.call(this,r)),r.type){case"table":{let a=r;for(let l of a.header)t=t.concat(this.walkTokens(l.tokens,e));for(let l of a.rows)for(let h of l)t=t.concat(this.walkTokens(h.tokens,e));break}case"list":{let a=r;t=t.concat(this.walkTokens(a.items,e));break}default:{let a=r;(i=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&i[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{let h=a[l].flat(1/0);t=t.concat(this.walkTokens(h,e))}):a.tokens&&(t=t.concat(this.walkTokens(a.tokens,e)))}}return t}use(...n){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{let s={...t};if(s.async=this.defaults.async||s.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let r=e.renderers[i.name];r?e.renderers[i.name]=function(...a){let l=i.renderer.apply(this,a);return l===!1&&(l=r.apply(this,a)),l}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let r=e[i.level];r?r.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),s.extensions=e),t.renderer){let i=this.defaults.renderer||new ep(this.defaults);for(let r in t.renderer){if(!(r in i))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;let a=r,l=t.renderer[a],h=i[a];i[a]=(...c)=>{let u=l.apply(i,c);return u===!1&&(u=h.apply(i,c)),u||""}}s.renderer=i}if(t.tokenizer){let i=this.defaults.tokenizer||new J1(this.defaults);for(let r in t.tokenizer){if(!(r in i))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;let a=r,l=t.tokenizer[a],h=i[a];i[a]=(...c)=>{let u=l.apply(i,c);return u===!1&&(u=h.apply(i,c)),u}}s.tokenizer=i}if(t.hooks){let i=this.defaults.hooks||new bc;for(let r in t.hooks){if(!(r in i))throw new Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;let a=r,l=t.hooks[a],h=i[a];bc.passThroughHooks.has(r)?i[a]=c=>{if(this.defaults.async&&bc.passThroughHooksRespectAsync.has(r))return(async()=>{let d=await l.call(i,c);return h.call(i,d)})();let u=l.call(i,c);return h.call(i,u)}:i[a]=(...c)=>{if(this.defaults.async)return(async()=>{let d=await l.apply(i,c);return d===!1&&(d=await h.apply(i,c)),d})();let u=l.apply(i,c);return u===!1&&(u=h.apply(i,c)),u}}s.hooks=i}if(t.walkTokens){let i=this.defaults.walkTokens,r=t.walkTokens;s.walkTokens=function(a){let l=[];return l.push(r.call(this,a)),i&&(l=l.concat(i.call(this,a))),l}}this.defaults={...this.defaults,...s}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return Ki.lex(n,e??this.defaults)}parser(n,e){return Zi.parse(n,e??this.defaults)}parseMarkdown(n){return(e,t)=>{let s={...t},i={...this.defaults,...s},r=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return r(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return r(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return r(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=n),i.async)return(async()=>{let a=i.hooks?await i.hooks.preprocess(e):e,l=await(i.hooks?await i.hooks.provideLexer():n?Ki.lex:Ki.lexInline)(a,i),h=i.hooks?await i.hooks.processAllTokens(l):l;i.walkTokens&&await Promise.all(this.walkTokens(h,i.walkTokens));let c=await(i.hooks?await i.hooks.provideParser():n?Zi.parse:Zi.parseInline)(h,i);return i.hooks?await i.hooks.postprocess(c):c})().catch(r);try{i.hooks&&(e=i.hooks.preprocess(e));let a=(i.hooks?i.hooks.provideLexer():n?Ki.lex:Ki.lexInline)(e,i);i.hooks&&(a=i.hooks.processAllTokens(a)),i.walkTokens&&this.walkTokens(a,i.walkTokens);let l=(i.hooks?i.hooks.provideParser():n?Zi.parse:Zi.parseInline)(a,i);return i.hooks&&(l=i.hooks.postprocess(l)),l}catch(a){return r(a)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){let s="<p>An error occurred:</p><pre>"+Fr(t.message+"",!0)+"</pre>";return e?Promise.resolve(s):s}if(e)return Promise.reject(t);throw t}}},Dl=new dy;function Ne(n,e){return Dl.parse(n,e)}Ne.options=Ne.setOptions=function(n){return Dl.setOptions(n),Ne.defaults=Dl.defaults,X6(Ne.defaults),Ne};Ne.getDefaults=J2;Ne.defaults=Il;Ne.use=function(...n){return Dl.use(...n),Ne.defaults=Dl.defaults,X6(Ne.defaults),Ne};Ne.walkTokens=function(n,e){return Dl.walkTokens(n,e)};Ne.parseInline=Dl.parseInline;Ne.Parser=Zi;Ne.parser=Zi.parse;Ne.Renderer=ep;Ne.TextRenderer=o3;Ne.Lexer=Ki;Ne.lexer=Ki.lex;Ne.Tokenizer=J1;Ne.Hooks=bc;Ne.parse=Ne;Ne.options;Ne.setOptions;Ne.use;Ne.walkTokens;Ne.parseInline;Zi.parse;Ki.lex;class Bs{constructor(e,t,s){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=e,this.start=t,this.end=s}static range(e,t){return t?!e||!e.loc||!t.loc||e.loc.lexer!==t.loc.lexer?null:new Bs(e.loc.lexer,e.loc.start,t.loc.end):e&&e.loc}}class hi{constructor(e,t){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=e,this.loc=t}range(e,t){return new hi(t,Bs.range(this,e))}}class X{constructor(e,t){this.name=void 0,this.position=void 0,this.length=void 0,this.rawMessage=void 0;var s="KaTeX parse error: "+e,i,r,a=t&&t.loc;if(a&&a.start<=a.end){var l=a.lexer.input;i=a.start,r=a.end,i===l.length?s+=" at end of input: ":s+=" at position "+(i+1)+": ";var h=l.slice(i,r).replace(/[^]/g,"$&̲"),c;i>15?c="…"+l.slice(i-15,i):c=l.slice(0,i);var u;r+15<l.length?u=l.slice(r,r+15)+"…":u=l.slice(r),s+=c+h+u}var d=new Error(s);return d.name="ParseError",d.__proto__=X.prototype,d.position=i,i!=null&&r!=null&&(d.length=r-i),d.rawMessage=e,d}}X.prototype.__proto__=Error.prototype;var fy=function(e,t){return e===void 0?t:e},py=/([A-Z])/g,my=function(e){return e.replace(py,"-$1").toLowerCase()},gy={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},by=/[&><"']/g;function vy(n){return String(n).replace(by,e=>gy[e])}var nb=function n(e){return e.type==="ordgroup"||e.type==="color"?e.body.length===1?n(e.body[0]):e:e.type==="font"?n(e.body):e},yy=function(e){var t=nb(e);return t.type==="mathord"||t.type==="textord"||t.type==="atom"},wy=function(e){if(!e)throw new Error("Expected non-null, but got "+String(e));return e},Ay=function(e){var t=/^[\x00-\x20]*([^\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(e);return t?t[2]!==":"||!/^[a-zA-Z][a-zA-Z0-9+\-.]*$/.test(t[1])?null:t[1].toLowerCase():"_relative"},Pe={deflt:fy,escape:vy,hyphenate:my,getBaseElem:nb,isCharacterBox:yy,protocolFromUrl:Ay},m1={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:n=>"#"+n},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(n,e)=>(e.push(n),e)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:n=>Math.max(0,n),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:n=>Math.max(0,n),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:n=>Math.max(0,n),cli:"-e, --max-expand <n>",cliProcessor:n=>n==="Infinity"?1/0:parseInt(n)},globalGroup:{type:"boolean",cli:!1}};function xy(n){if(n.default)return n.default;var e=n.type,t=Array.isArray(e)?e[0]:e;if(typeof t!="string")return t.enum[0];switch(t){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class l3{constructor(e){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,e=e||{};for(var t in m1)if(m1.hasOwnProperty(t)){var s=m1[t];this[t]=e[t]!==void 0?s.processor?s.processor(e[t]):e[t]:xy(s)}}reportNonstrict(e,t,s){var i=this.strict;if(typeof i=="function"&&(i=i(e,t,s)),!(!i||i==="ignore")){if(i===!0||i==="error")throw new X("LaTeX-incompatible input and strict mode is set to 'error': "+(t+" ["+e+"]"),s);i==="warn"?typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(t+" ["+e+"]")):typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+i+"': "+t+" ["+e+"]"))}}useStrictBehavior(e,t,s){var i=this.strict;if(typeof i=="function")try{i=i(e,t,s)}catch{i="error"}return!i||i==="ignore"?!1:i===!0||i==="error"?!0:i==="warn"?(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(t+" ["+e+"]")),!1):(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+i+"': "+t+" ["+e+"]")),!1)}isTrusted(e){if(e.url&&!e.protocol){var t=Pe.protocolFromUrl(e.url);if(t==null)return!1;e.protocol=t}var s=typeof this.trust=="function"?this.trust(e):this.trust;return!!s}}class Bn{constructor(e,t,s){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=e,this.size=t,this.cramped=s}sup(){return Cr[Sy[this.id]]}sub(){return Cr[ky[this.id]]}fracNum(){return Cr[Ty[this.id]]}fracDen(){return Cr[Cy[this.id]]}cramp(){return Cr[Ey[this.id]]}text(){return Cr[_y[this.id]]}isTight(){return this.size>=2}}var h3=0,tp=1,i0=2,_n=3,Vc=4,Ei=5,nc=6,xs=7,Cr=[new Bn(h3,0,!1),new Bn(tp,0,!0),new Bn(i0,1,!1),new Bn(_n,1,!0),new Bn(Vc,2,!1),new Bn(Ei,2,!0),new Bn(nc,3,!1),new Bn(xs,3,!0)],Sy=[Vc,Ei,Vc,Ei,nc,xs,nc,xs],ky=[Ei,Ei,Ei,Ei,xs,xs,xs,xs],Ty=[i0,_n,Vc,Ei,nc,xs,nc,xs],Cy=[_n,_n,Ei,Ei,xs,xs,xs,xs],Ey=[tp,tp,_n,_n,Ei,Ei,xs,xs],_y=[h3,tp,i0,_n,i0,_n,i0,_n],ce={DISPLAY:Cr[h3],TEXT:Cr[i0],SCRIPT:Cr[Vc],SCRIPTSCRIPT:Cr[nc]},f4=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];function My(n){for(var e=0;e<f4.length;e++)for(var t=f4[e],s=0;s<t.blocks.length;s++){var i=t.blocks[s];if(n>=i[0]&&n<=i[1])return t.name}return null}var g1=[];f4.forEach(n=>n.blocks.forEach(e=>g1.push(...e)));function ab(n){for(var e=0;e<g1.length;e+=2)if(n>=g1[e]&&n<=g1[e+1])return!0;return!1}var zl=80,Dy=function(e,t){return"M95,"+(622+e+t)+`
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l`+e/2.075+" -"+e+`
c5.3,-9.3,12,-14,20,-14
H400000v`+(40+e)+`H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M`+(834+e)+" "+t+"h400000v"+(40+e)+"h-400000z"},Ry=function(e,t){return"M263,"+(601+e+t)+`c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l`+e/2.084+" -"+e+`
c4.7,-7.3,11,-11,19,-11
H40000v`+(40+e)+`H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M`+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"},Py=function(e,t){return"M983 "+(10+e+t)+`
l`+e/3.13+" -"+e+`
c4,-6.7,10,-10,18,-10 H400000v`+(40+e)+`
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M`+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"},Ly=function(e,t){return"M424,"+(2398+e+t)+`
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l`+e/4.223+" -"+e+`c4,-6.7,10,-10,18,-10 H400000
v`+(40+e)+`H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M`+(1001+e)+" "+t+`
h400000v`+(40+e)+"h-400000z"},Iy=function(e,t){return"M473,"+(2713+e+t)+`
c339.3,-1799.3,509.3,-2700,510,-2702 l`+e/5.298+" -"+e+`
c3.3,-7.3,9.3,-11,18,-11 H400000v`+(40+e)+`H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM`+(1001+e)+" "+t+"h400000v"+(40+e)+"H1017.7z"},By=function(e){var t=e/2;return"M400000 "+e+" H0 L"+t+" 0 l65 45 L145 "+(e-80)+" H400000z"},Ny=function(e,t,s){var i=s-54-t-e;return"M702 "+(e+t)+"H400000"+(40+e)+`
H742v`+i+`l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 `+t+"H400000v"+(40+e)+"H742z"},Fy=function(e,t,s){t=1e3*t;var i="";switch(e){case"sqrtMain":i=Dy(t,zl);break;case"sqrtSize1":i=Ry(t,zl);break;case"sqrtSize2":i=Py(t,zl);break;case"sqrtSize3":i=Ly(t,zl);break;case"sqrtSize4":i=Iy(t,zl);break;case"sqrtTall":i=Ny(t,zl,s)}return i},Oy=function(e,t){switch(e){case"⎜":return"M291 0 H417 V"+t+" H291z M291 0 H417 V"+t+" H291z";case"∣":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145z";case"∥":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145z"+("M367 0 H410 V"+t+" H367z M367 0 H410 V"+t+" H367z");case"⎟":return"M457 0 H583 V"+t+" H457z M457 0 H583 V"+t+" H457z";case"⎢":return"M319 0 H403 V"+t+" H319z M319 0 H403 V"+t+" H319z";case"⎥":return"M263 0 H347 V"+t+" H263z M263 0 H347 V"+t+" H263z";case"⎪":return"M384 0 H504 V"+t+" H384z M384 0 H504 V"+t+" H384z";case"⏐":return"M312 0 H355 V"+t+" H312z M312 0 H355 V"+t+" H312z";case"‖":return"M257 0 H300 V"+t+" H257z M257 0 H300 V"+t+" H257z"+("M478 0 H521 V"+t+" H478z M478 0 H521 V"+t+" H478z");default:return""}},n5={doubleleftarrow:`M262 157
l10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3
 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28
 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5
c2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5
 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87
-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7
-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z
m8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l
-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5
 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88
-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68
-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18
-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782
c-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3
-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,leftgroup:`M400000 80
H435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0
 435 0h399565z`,leftgroupunder:`M400000 262
H435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219
 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3
-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5
-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7
-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5
 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3
-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7
-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z
m0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333
 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5
 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667
-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12
 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7
-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0
v40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5
-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3
-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21
 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z
M40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z
M40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23
-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8
c28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3
 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6
-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z
m368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8
60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8
-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z
m502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2
c0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6
-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z
m525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0
85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8
-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z
m770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1
c0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0
 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18
 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3
-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2
-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58
 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11
-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7
 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z
m0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8
 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5
-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95
-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8
 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3
 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3
-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z
m0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3
 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0
-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21
 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z
M399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23
 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32
-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142
-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40
 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69
-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3
-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19
-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101
 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167
c-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3
 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42
 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333
-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70
 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,tilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z`,tilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418
-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9
 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114
c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751
 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,tilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457
-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0
 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697
 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696
 -338 0-409-156.573-744-156.573z`,tilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345
-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409
 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9
 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409
 -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,
-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202
c4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5
c-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130
s-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47
121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6
s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11
c0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z
M100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32
-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0
13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39
-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5
-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17
c2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21
c-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40
c-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z
M0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,
1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,
-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z
M93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`},zy=function(e,t){switch(e){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+` v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v`+t+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+` v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v`+t+" v1759 h84z";case"vert":return"M145 15 v585 v"+t+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+t+" v585 h43z";case"doublevert":return"M145 15 v585 v"+t+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+t+` v585 h43z
M367 15 v585 v`+t+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v`+t+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+t+` v1715 h263 v84 H319z
MM319 602 V0 H403 V602 v`+t+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+t+` v1799 H0 v-84 H319z
MM319 602 V0 H403 V602 v`+t+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+` v602 h84z
M403 1759 V0 H319 V1759 v`+t+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+` v602 h84z
M347 1759 V0 h-84 V1759 v`+t+" v602 h84z";case"lparen":return`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,`+(t+84)+`c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-`+(t+92)+`c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`;case"rparen":return`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,`+(t+9)+`
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-`+(t+144)+`c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`;default:throw new Error("Unknown stretchy delimiter.")}};class Bf{constructor(e){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=e,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(e){return this.classes.includes(e)}toNode(){for(var e=document.createDocumentFragment(),t=0;t<this.children.length;t++)e.appendChild(this.children[t].toNode());return e}toMarkup(){for(var e="",t=0;t<this.children.length;t++)e+=this.children[t].toMarkup();return e}toText(){var e=t=>t.toText();return this.children.map(e).join("")}}var Er={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},Wf={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},a5={Å:"A",Ð:"D",Þ:"o",å:"a",ð:"d",þ:"o",А:"A",Б:"B",В:"B",Г:"F",Д:"A",Е:"E",Ж:"K",З:"3",И:"N",Й:"N",К:"K",Л:"N",М:"M",Н:"H",О:"O",П:"N",Р:"P",С:"C",Т:"T",У:"y",Ф:"O",Х:"X",Ц:"U",Ч:"h",Ш:"W",Щ:"W",Ъ:"B",Ы:"X",Ь:"B",Э:"3",Ю:"X",Я:"R",а:"a",б:"b",в:"a",г:"r",д:"y",е:"e",ж:"m",з:"e",и:"n",й:"n",к:"n",л:"n",м:"m",н:"n",о:"o",п:"n",р:"p",с:"c",т:"o",у:"y",ф:"b",х:"x",ц:"n",ч:"n",ш:"w",щ:"w",ъ:"a",ы:"m",ь:"a",э:"e",ю:"m",я:"r"};function Hy(n,e){Er[n]=e}function c3(n,e,t){if(!Er[e])throw new Error("Font metrics not found for font: "+e+".");var s=n.charCodeAt(0),i=Er[e][s];if(!i&&n[0]in a5&&(s=a5[n[0]].charCodeAt(0),i=Er[e][s]),!i&&t==="text"&&ab(s)&&(i=Er[e][77]),i)return{depth:i[0],height:i[1],italic:i[2],skew:i[3],width:i[4]}}var Ng={};function Uy(n){var e;if(n>=5?e=0:n>=3?e=1:e=2,!Ng[e]){var t=Ng[e]={cssEmPerMu:Wf.quad[e]/18};for(var s in Wf)Wf.hasOwnProperty(s)&&(t[s]=Wf[s][e])}return Ng[e]}var qy=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],o5=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],l5=function(e,t){return t.size<2?e:qy[e-1][t.size-1]};class $r{constructor(e){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=e.style,this.color=e.color,this.size=e.size||$r.BASESIZE,this.textSize=e.textSize||this.size,this.phantom=!!e.phantom,this.font=e.font||"",this.fontFamily=e.fontFamily||"",this.fontWeight=e.fontWeight||"",this.fontShape=e.fontShape||"",this.sizeMultiplier=o5[this.size-1],this.maxSize=e.maxSize,this.minRuleThickness=e.minRuleThickness,this._fontMetrics=void 0}extend(e){var t={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return new $r(t)}havingStyle(e){return this.style===e?this:this.extend({style:e,size:l5(this.textSize,e)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(e){return this.size===e&&this.textSize===e?this:this.extend({style:this.style.text(),size:e,textSize:e,sizeMultiplier:o5[e-1]})}havingBaseStyle(e){e=e||this.style.text();var t=l5($r.BASESIZE,e);return this.size===t&&this.textSize===$r.BASESIZE&&this.style===e?this:this.extend({style:e,size:t})}havingBaseSizing(){var e;switch(this.style.id){case 4:case 5:e=3;break;case 6:case 7:e=1;break;default:e=6}return this.extend({style:this.style.text(),size:e})}withColor(e){return this.extend({color:e})}withPhantom(){return this.extend({phantom:!0})}withFont(e){return this.extend({font:e})}withTextFontFamily(e){return this.extend({fontFamily:e,font:""})}withTextFontWeight(e){return this.extend({fontWeight:e,font:""})}withTextFontShape(e){return this.extend({fontShape:e,font:""})}sizingClasses(e){return e.size!==this.size?["sizing","reset-size"+e.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==$r.BASESIZE?["sizing","reset-size"+this.size,"size"+$r.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=Uy(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}$r.BASESIZE=6;var p4={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:803/800,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:803/800},$y={ex:!0,em:!0,mu:!0},ob=function(e){return typeof e!="string"&&(e=e.unit),e in p4||e in $y||e==="ex"},mt=function(e,t){var s;if(e.unit in p4)s=p4[e.unit]/t.fontMetrics().ptPerEm/t.sizeMultiplier;else if(e.unit==="mu")s=t.fontMetrics().cssEmPerMu;else{var i;if(t.style.isTight()?i=t.havingStyle(t.style.text()):i=t,e.unit==="ex")s=i.fontMetrics().xHeight;else if(e.unit==="em")s=i.fontMetrics().quad;else throw new X("Invalid unit: '"+e.unit+"'");i!==t&&(s*=i.sizeMultiplier/t.sizeMultiplier)}return Math.min(e.number*s,t.maxSize)},Q=function(e){return+e.toFixed(4)+"em"},Oa=function(e){return e.filter(t=>t).join(" ")},lb=function(e,t,s){if(this.classes=e||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=s||{},t){t.style.isTight()&&this.classes.push("mtight");var i=t.getColor();i&&(this.style.color=i)}},hb=function(e){var t=document.createElement(e);t.className=Oa(this.classes);for(var s in this.style)this.style.hasOwnProperty(s)&&(t.style[s]=this.style[s]);for(var i in this.attributes)this.attributes.hasOwnProperty(i)&&t.setAttribute(i,this.attributes[i]);for(var r=0;r<this.children.length;r++)t.appendChild(this.children[r].toNode());return t},Gy=/[\s"'>/=\x00-\x1f]/,cb=function(e){var t="<"+e;this.classes.length&&(t+=' class="'+Pe.escape(Oa(this.classes))+'"');var s="";for(var i in this.style)this.style.hasOwnProperty(i)&&(s+=Pe.hyphenate(i)+":"+this.style[i]+";");s&&(t+=' style="'+Pe.escape(s)+'"');for(var r in this.attributes)if(this.attributes.hasOwnProperty(r)){if(Gy.test(r))throw new X("Invalid attribute name '"+r+"'");t+=" "+r+'="'+Pe.escape(this.attributes[r])+'"'}t+=">";for(var a=0;a<this.children.length;a++)t+=this.children[a].toMarkup();return t+="</"+e+">",t};class Nf{constructor(e,t,s,i){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,lb.call(this,e,s,i),this.children=t||[]}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return this.classes.includes(e)}toNode(){return hb.call(this,"span")}toMarkup(){return cb.call(this,"span")}}class u3{constructor(e,t,s,i){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,lb.call(this,t,i),this.children=s||[],this.setAttribute("href",e)}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return this.classes.includes(e)}toNode(){return hb.call(this,"a")}toMarkup(){return cb.call(this,"a")}}class Vy{constructor(e,t,s){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=t,this.src=e,this.classes=["mord"],this.style=s}hasClass(e){return this.classes.includes(e)}toNode(){var e=document.createElement("img");e.src=this.src,e.alt=this.alt,e.className="mord";for(var t in this.style)this.style.hasOwnProperty(t)&&(e.style[t]=this.style[t]);return e}toMarkup(){var e='<img src="'+Pe.escape(this.src)+'"'+(' alt="'+Pe.escape(this.alt)+'"'),t="";for(var s in this.style)this.style.hasOwnProperty(s)&&(t+=Pe.hyphenate(s)+":"+this.style[s]+";");return t&&(e+=' style="'+Pe.escape(t)+'"'),e+="'/>",e}}var jy={î:"ı̂",ï:"ı̈",í:"ı́",ì:"ı̀"};class _i{constructor(e,t,s,i,r,a,l,h){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=e,this.height=t||0,this.depth=s||0,this.italic=i||0,this.skew=r||0,this.width=a||0,this.classes=l||[],this.style=h||{},this.maxFontSize=0;var c=My(this.text.charCodeAt(0));c&&this.classes.push(c+"_fallback"),/[îïíì]/.test(this.text)&&(this.text=jy[this.text])}hasClass(e){return this.classes.includes(e)}toNode(){var e=document.createTextNode(this.text),t=null;this.italic>0&&(t=document.createElement("span"),t.style.marginRight=Q(this.italic)),this.classes.length>0&&(t=t||document.createElement("span"),t.className=Oa(this.classes));for(var s in this.style)this.style.hasOwnProperty(s)&&(t=t||document.createElement("span"),t.style[s]=this.style[s]);return t?(t.appendChild(e),t):e}toMarkup(){var e=!1,t="<span";this.classes.length&&(e=!0,t+=' class="',t+=Pe.escape(Oa(this.classes)),t+='"');var s="";this.italic>0&&(s+="margin-right:"+this.italic+"em;");for(var i in this.style)this.style.hasOwnProperty(i)&&(s+=Pe.hyphenate(i)+":"+this.style[i]+";");s&&(e=!0,t+=' style="'+Pe.escape(s)+'"');var r=Pe.escape(this.text);return e?(t+=">",t+=r,t+="</span>",t):r}}class Dn{constructor(e,t){this.children=void 0,this.attributes=void 0,this.children=e||[],this.attributes=t||{}}toNode(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"svg");for(var s in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,s)&&t.setAttribute(s,this.attributes[s]);for(var i=0;i<this.children.length;i++)t.appendChild(this.children[i].toNode());return t}toMarkup(){var e='<svg xmlns="http://www.w3.org/2000/svg"';for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="'+Pe.escape(this.attributes[t])+'"');e+=">";for(var s=0;s<this.children.length;s++)e+=this.children[s].toMarkup();return e+="</svg>",e}}class za{constructor(e,t){this.pathName=void 0,this.alternate=void 0,this.pathName=e,this.alternate=t}toNode(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"path");return this.alternate?t.setAttribute("d",this.alternate):t.setAttribute("d",n5[this.pathName]),t}toMarkup(){return this.alternate?'<path d="'+Pe.escape(this.alternate)+'"/>':'<path d="'+Pe.escape(n5[this.pathName])+'"/>'}}class m4{constructor(e){this.attributes=void 0,this.attributes=e||{}}toNode(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"line");for(var s in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,s)&&t.setAttribute(s,this.attributes[s]);return t}toMarkup(){var e="<line";for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="'+Pe.escape(this.attributes[t])+'"');return e+="/>",e}}function h5(n){if(n instanceof _i)return n;throw new Error("Expected symbolNode but got "+String(n)+".")}function Wy(n){if(n instanceof Nf)return n;throw new Error("Expected span<HtmlDomNode> but got "+String(n)+".")}var Xy={bin:1,close:1,inner:1,open:1,punct:1,rel:1},Yy={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},tt={math:{},text:{}};function m(n,e,t,s,i,r){tt[n][i]={font:e,group:t,replace:s},r&&s&&(tt[n][s]=tt[n][i])}var v="math",G="text",k="main",R="ams",lt="accent-token",re="bin",Ss="close",ac="inner",he="mathord",Rt="op-token",ci="open",gg="punct",P="rel",Ln="spacing",I="textord";m(v,k,P,"≡","\\equiv",!0);m(v,k,P,"≺","\\prec",!0);m(v,k,P,"≻","\\succ",!0);m(v,k,P,"∼","\\sim",!0);m(v,k,P,"⊥","\\perp");m(v,k,P,"⪯","\\preceq",!0);m(v,k,P,"⪰","\\succeq",!0);m(v,k,P,"≃","\\simeq",!0);m(v,k,P,"∣","\\mid",!0);m(v,k,P,"≪","\\ll",!0);m(v,k,P,"≫","\\gg",!0);m(v,k,P,"≍","\\asymp",!0);m(v,k,P,"∥","\\parallel");m(v,k,P,"⋈","\\bowtie",!0);m(v,k,P,"⌣","\\smile",!0);m(v,k,P,"⊑","\\sqsubseteq",!0);m(v,k,P,"⊒","\\sqsupseteq",!0);m(v,k,P,"≐","\\doteq",!0);m(v,k,P,"⌢","\\frown",!0);m(v,k,P,"∋","\\ni",!0);m(v,k,P,"∝","\\propto",!0);m(v,k,P,"⊢","\\vdash",!0);m(v,k,P,"⊣","\\dashv",!0);m(v,k,P,"∋","\\owns");m(v,k,gg,".","\\ldotp");m(v,k,gg,"⋅","\\cdotp");m(v,k,I,"#","\\#");m(G,k,I,"#","\\#");m(v,k,I,"&","\\&");m(G,k,I,"&","\\&");m(v,k,I,"ℵ","\\aleph",!0);m(v,k,I,"∀","\\forall",!0);m(v,k,I,"ℏ","\\hbar",!0);m(v,k,I,"∃","\\exists",!0);m(v,k,I,"∇","\\nabla",!0);m(v,k,I,"♭","\\flat",!0);m(v,k,I,"ℓ","\\ell",!0);m(v,k,I,"♮","\\natural",!0);m(v,k,I,"♣","\\clubsuit",!0);m(v,k,I,"℘","\\wp",!0);m(v,k,I,"♯","\\sharp",!0);m(v,k,I,"♢","\\diamondsuit",!0);m(v,k,I,"ℜ","\\Re",!0);m(v,k,I,"♡","\\heartsuit",!0);m(v,k,I,"ℑ","\\Im",!0);m(v,k,I,"♠","\\spadesuit",!0);m(v,k,I,"§","\\S",!0);m(G,k,I,"§","\\S");m(v,k,I,"¶","\\P",!0);m(G,k,I,"¶","\\P");m(v,k,I,"†","\\dag");m(G,k,I,"†","\\dag");m(G,k,I,"†","\\textdagger");m(v,k,I,"‡","\\ddag");m(G,k,I,"‡","\\ddag");m(G,k,I,"‡","\\textdaggerdbl");m(v,k,Ss,"⎱","\\rmoustache",!0);m(v,k,ci,"⎰","\\lmoustache",!0);m(v,k,Ss,"⟯","\\rgroup",!0);m(v,k,ci,"⟮","\\lgroup",!0);m(v,k,re,"∓","\\mp",!0);m(v,k,re,"⊖","\\ominus",!0);m(v,k,re,"⊎","\\uplus",!0);m(v,k,re,"⊓","\\sqcap",!0);m(v,k,re,"∗","\\ast");m(v,k,re,"⊔","\\sqcup",!0);m(v,k,re,"◯","\\bigcirc",!0);m(v,k,re,"∙","\\bullet",!0);m(v,k,re,"‡","\\ddagger");m(v,k,re,"≀","\\wr",!0);m(v,k,re,"⨿","\\amalg");m(v,k,re,"&","\\And");m(v,k,P,"⟵","\\longleftarrow",!0);m(v,k,P,"⇐","\\Leftarrow",!0);m(v,k,P,"⟸","\\Longleftarrow",!0);m(v,k,P,"⟶","\\longrightarrow",!0);m(v,k,P,"⇒","\\Rightarrow",!0);m(v,k,P,"⟹","\\Longrightarrow",!0);m(v,k,P,"↔","\\leftrightarrow",!0);m(v,k,P,"⟷","\\longleftrightarrow",!0);m(v,k,P,"⇔","\\Leftrightarrow",!0);m(v,k,P,"⟺","\\Longleftrightarrow",!0);m(v,k,P,"↦","\\mapsto",!0);m(v,k,P,"⟼","\\longmapsto",!0);m(v,k,P,"↗","\\nearrow",!0);m(v,k,P,"↩","\\hookleftarrow",!0);m(v,k,P,"↪","\\hookrightarrow",!0);m(v,k,P,"↘","\\searrow",!0);m(v,k,P,"↼","\\leftharpoonup",!0);m(v,k,P,"⇀","\\rightharpoonup",!0);m(v,k,P,"↙","\\swarrow",!0);m(v,k,P,"↽","\\leftharpoondown",!0);m(v,k,P,"⇁","\\rightharpoondown",!0);m(v,k,P,"↖","\\nwarrow",!0);m(v,k,P,"⇌","\\rightleftharpoons",!0);m(v,R,P,"≮","\\nless",!0);m(v,R,P,"","\\@nleqslant");m(v,R,P,"","\\@nleqq");m(v,R,P,"⪇","\\lneq",!0);m(v,R,P,"≨","\\lneqq",!0);m(v,R,P,"","\\@lvertneqq");m(v,R,P,"⋦","\\lnsim",!0);m(v,R,P,"⪉","\\lnapprox",!0);m(v,R,P,"⊀","\\nprec",!0);m(v,R,P,"⋠","\\npreceq",!0);m(v,R,P,"⋨","\\precnsim",!0);m(v,R,P,"⪹","\\precnapprox",!0);m(v,R,P,"≁","\\nsim",!0);m(v,R,P,"","\\@nshortmid");m(v,R,P,"∤","\\nmid",!0);m(v,R,P,"⊬","\\nvdash",!0);m(v,R,P,"⊭","\\nvDash",!0);m(v,R,P,"⋪","\\ntriangleleft");m(v,R,P,"⋬","\\ntrianglelefteq",!0);m(v,R,P,"⊊","\\subsetneq",!0);m(v,R,P,"","\\@varsubsetneq");m(v,R,P,"⫋","\\subsetneqq",!0);m(v,R,P,"","\\@varsubsetneqq");m(v,R,P,"≯","\\ngtr",!0);m(v,R,P,"","\\@ngeqslant");m(v,R,P,"","\\@ngeqq");m(v,R,P,"⪈","\\gneq",!0);m(v,R,P,"≩","\\gneqq",!0);m(v,R,P,"","\\@gvertneqq");m(v,R,P,"⋧","\\gnsim",!0);m(v,R,P,"⪊","\\gnapprox",!0);m(v,R,P,"⊁","\\nsucc",!0);m(v,R,P,"⋡","\\nsucceq",!0);m(v,R,P,"⋩","\\succnsim",!0);m(v,R,P,"⪺","\\succnapprox",!0);m(v,R,P,"≆","\\ncong",!0);m(v,R,P,"","\\@nshortparallel");m(v,R,P,"∦","\\nparallel",!0);m(v,R,P,"⊯","\\nVDash",!0);m(v,R,P,"⋫","\\ntriangleright");m(v,R,P,"⋭","\\ntrianglerighteq",!0);m(v,R,P,"","\\@nsupseteqq");m(v,R,P,"⊋","\\supsetneq",!0);m(v,R,P,"","\\@varsupsetneq");m(v,R,P,"⫌","\\supsetneqq",!0);m(v,R,P,"","\\@varsupsetneqq");m(v,R,P,"⊮","\\nVdash",!0);m(v,R,P,"⪵","\\precneqq",!0);m(v,R,P,"⪶","\\succneqq",!0);m(v,R,P,"","\\@nsubseteqq");m(v,R,re,"⊴","\\unlhd");m(v,R,re,"⊵","\\unrhd");m(v,R,P,"↚","\\nleftarrow",!0);m(v,R,P,"↛","\\nrightarrow",!0);m(v,R,P,"⇍","\\nLeftarrow",!0);m(v,R,P,"⇏","\\nRightarrow",!0);m(v,R,P,"↮","\\nleftrightarrow",!0);m(v,R,P,"⇎","\\nLeftrightarrow",!0);m(v,R,P,"△","\\vartriangle");m(v,R,I,"ℏ","\\hslash");m(v,R,I,"▽","\\triangledown");m(v,R,I,"◊","\\lozenge");m(v,R,I,"Ⓢ","\\circledS");m(v,R,I,"®","\\circledR");m(G,R,I,"®","\\circledR");m(v,R,I,"∡","\\measuredangle",!0);m(v,R,I,"∄","\\nexists");m(v,R,I,"℧","\\mho");m(v,R,I,"Ⅎ","\\Finv",!0);m(v,R,I,"⅁","\\Game",!0);m(v,R,I,"‵","\\backprime");m(v,R,I,"▲","\\blacktriangle");m(v,R,I,"▼","\\blacktriangledown");m(v,R,I,"■","\\blacksquare");m(v,R,I,"⧫","\\blacklozenge");m(v,R,I,"★","\\bigstar");m(v,R,I,"∢","\\sphericalangle",!0);m(v,R,I,"∁","\\complement",!0);m(v,R,I,"ð","\\eth",!0);m(G,k,I,"ð","ð");m(v,R,I,"╱","\\diagup");m(v,R,I,"╲","\\diagdown");m(v,R,I,"□","\\square");m(v,R,I,"□","\\Box");m(v,R,I,"◊","\\Diamond");m(v,R,I,"¥","\\yen",!0);m(G,R,I,"¥","\\yen",!0);m(v,R,I,"✓","\\checkmark",!0);m(G,R,I,"✓","\\checkmark");m(v,R,I,"ℶ","\\beth",!0);m(v,R,I,"ℸ","\\daleth",!0);m(v,R,I,"ℷ","\\gimel",!0);m(v,R,I,"ϝ","\\digamma",!0);m(v,R,I,"ϰ","\\varkappa");m(v,R,ci,"┌","\\@ulcorner",!0);m(v,R,Ss,"┐","\\@urcorner",!0);m(v,R,ci,"└","\\@llcorner",!0);m(v,R,Ss,"┘","\\@lrcorner",!0);m(v,R,P,"≦","\\leqq",!0);m(v,R,P,"⩽","\\leqslant",!0);m(v,R,P,"⪕","\\eqslantless",!0);m(v,R,P,"≲","\\lesssim",!0);m(v,R,P,"⪅","\\lessapprox",!0);m(v,R,P,"≊","\\approxeq",!0);m(v,R,re,"⋖","\\lessdot");m(v,R,P,"⋘","\\lll",!0);m(v,R,P,"≶","\\lessgtr",!0);m(v,R,P,"⋚","\\lesseqgtr",!0);m(v,R,P,"⪋","\\lesseqqgtr",!0);m(v,R,P,"≑","\\doteqdot");m(v,R,P,"≓","\\risingdotseq",!0);m(v,R,P,"≒","\\fallingdotseq",!0);m(v,R,P,"∽","\\backsim",!0);m(v,R,P,"⋍","\\backsimeq",!0);m(v,R,P,"⫅","\\subseteqq",!0);m(v,R,P,"⋐","\\Subset",!0);m(v,R,P,"⊏","\\sqsubset",!0);m(v,R,P,"≼","\\preccurlyeq",!0);m(v,R,P,"⋞","\\curlyeqprec",!0);m(v,R,P,"≾","\\precsim",!0);m(v,R,P,"⪷","\\precapprox",!0);m(v,R,P,"⊲","\\vartriangleleft");m(v,R,P,"⊴","\\trianglelefteq");m(v,R,P,"⊨","\\vDash",!0);m(v,R,P,"⊪","\\Vvdash",!0);m(v,R,P,"⌣","\\smallsmile");m(v,R,P,"⌢","\\smallfrown");m(v,R,P,"≏","\\bumpeq",!0);m(v,R,P,"≎","\\Bumpeq",!0);m(v,R,P,"≧","\\geqq",!0);m(v,R,P,"⩾","\\geqslant",!0);m(v,R,P,"⪖","\\eqslantgtr",!0);m(v,R,P,"≳","\\gtrsim",!0);m(v,R,P,"⪆","\\gtrapprox",!0);m(v,R,re,"⋗","\\gtrdot");m(v,R,P,"⋙","\\ggg",!0);m(v,R,P,"≷","\\gtrless",!0);m(v,R,P,"⋛","\\gtreqless",!0);m(v,R,P,"⪌","\\gtreqqless",!0);m(v,R,P,"≖","\\eqcirc",!0);m(v,R,P,"≗","\\circeq",!0);m(v,R,P,"≜","\\triangleq",!0);m(v,R,P,"∼","\\thicksim");m(v,R,P,"≈","\\thickapprox");m(v,R,P,"⫆","\\supseteqq",!0);m(v,R,P,"⋑","\\Supset",!0);m(v,R,P,"⊐","\\sqsupset",!0);m(v,R,P,"≽","\\succcurlyeq",!0);m(v,R,P,"⋟","\\curlyeqsucc",!0);m(v,R,P,"≿","\\succsim",!0);m(v,R,P,"⪸","\\succapprox",!0);m(v,R,P,"⊳","\\vartriangleright");m(v,R,P,"⊵","\\trianglerighteq");m(v,R,P,"⊩","\\Vdash",!0);m(v,R,P,"∣","\\shortmid");m(v,R,P,"∥","\\shortparallel");m(v,R,P,"≬","\\between",!0);m(v,R,P,"⋔","\\pitchfork",!0);m(v,R,P,"∝","\\varpropto");m(v,R,P,"◀","\\blacktriangleleft");m(v,R,P,"∴","\\therefore",!0);m(v,R,P,"∍","\\backepsilon");m(v,R,P,"▶","\\blacktriangleright");m(v,R,P,"∵","\\because",!0);m(v,R,P,"⋘","\\llless");m(v,R,P,"⋙","\\gggtr");m(v,R,re,"⊲","\\lhd");m(v,R,re,"⊳","\\rhd");m(v,R,P,"≂","\\eqsim",!0);m(v,k,P,"⋈","\\Join");m(v,R,P,"≑","\\Doteq",!0);m(v,R,re,"∔","\\dotplus",!0);m(v,R,re,"∖","\\smallsetminus");m(v,R,re,"⋒","\\Cap",!0);m(v,R,re,"⋓","\\Cup",!0);m(v,R,re,"⩞","\\doublebarwedge",!0);m(v,R,re,"⊟","\\boxminus",!0);m(v,R,re,"⊞","\\boxplus",!0);m(v,R,re,"⋇","\\divideontimes",!0);m(v,R,re,"⋉","\\ltimes",!0);m(v,R,re,"⋊","\\rtimes",!0);m(v,R,re,"⋋","\\leftthreetimes",!0);m(v,R,re,"⋌","\\rightthreetimes",!0);m(v,R,re,"⋏","\\curlywedge",!0);m(v,R,re,"⋎","\\curlyvee",!0);m(v,R,re,"⊝","\\circleddash",!0);m(v,R,re,"⊛","\\circledast",!0);m(v,R,re,"⋅","\\centerdot");m(v,R,re,"⊺","\\intercal",!0);m(v,R,re,"⋒","\\doublecap");m(v,R,re,"⋓","\\doublecup");m(v,R,re,"⊠","\\boxtimes",!0);m(v,R,P,"⇢","\\dashrightarrow",!0);m(v,R,P,"⇠","\\dashleftarrow",!0);m(v,R,P,"⇇","\\leftleftarrows",!0);m(v,R,P,"⇆","\\leftrightarrows",!0);m(v,R,P,"⇚","\\Lleftarrow",!0);m(v,R,P,"↞","\\twoheadleftarrow",!0);m(v,R,P,"↢","\\leftarrowtail",!0);m(v,R,P,"↫","\\looparrowleft",!0);m(v,R,P,"⇋","\\leftrightharpoons",!0);m(v,R,P,"↶","\\curvearrowleft",!0);m(v,R,P,"↺","\\circlearrowleft",!0);m(v,R,P,"↰","\\Lsh",!0);m(v,R,P,"⇈","\\upuparrows",!0);m(v,R,P,"↿","\\upharpoonleft",!0);m(v,R,P,"⇃","\\downharpoonleft",!0);m(v,k,P,"⊶","\\origof",!0);m(v,k,P,"⊷","\\imageof",!0);m(v,R,P,"⊸","\\multimap",!0);m(v,R,P,"↭","\\leftrightsquigarrow",!0);m(v,R,P,"⇉","\\rightrightarrows",!0);m(v,R,P,"⇄","\\rightleftarrows",!0);m(v,R,P,"↠","\\twoheadrightarrow",!0);m(v,R,P,"↣","\\rightarrowtail",!0);m(v,R,P,"↬","\\looparrowright",!0);m(v,R,P,"↷","\\curvearrowright",!0);m(v,R,P,"↻","\\circlearrowright",!0);m(v,R,P,"↱","\\Rsh",!0);m(v,R,P,"⇊","\\downdownarrows",!0);m(v,R,P,"↾","\\upharpoonright",!0);m(v,R,P,"⇂","\\downharpoonright",!0);m(v,R,P,"⇝","\\rightsquigarrow",!0);m(v,R,P,"⇝","\\leadsto");m(v,R,P,"⇛","\\Rrightarrow",!0);m(v,R,P,"↾","\\restriction");m(v,k,I,"‘","`");m(v,k,I,"$","\\$");m(G,k,I,"$","\\$");m(G,k,I,"$","\\textdollar");m(v,k,I,"%","\\%");m(G,k,I,"%","\\%");m(v,k,I,"_","\\_");m(G,k,I,"_","\\_");m(G,k,I,"_","\\textunderscore");m(v,k,I,"∠","\\angle",!0);m(v,k,I,"∞","\\infty",!0);m(v,k,I,"′","\\prime");m(v,k,I,"△","\\triangle");m(v,k,I,"Γ","\\Gamma",!0);m(v,k,I,"Δ","\\Delta",!0);m(v,k,I,"Θ","\\Theta",!0);m(v,k,I,"Λ","\\Lambda",!0);m(v,k,I,"Ξ","\\Xi",!0);m(v,k,I,"Π","\\Pi",!0);m(v,k,I,"Σ","\\Sigma",!0);m(v,k,I,"Υ","\\Upsilon",!0);m(v,k,I,"Φ","\\Phi",!0);m(v,k,I,"Ψ","\\Psi",!0);m(v,k,I,"Ω","\\Omega",!0);m(v,k,I,"A","Α");m(v,k,I,"B","Β");m(v,k,I,"E","Ε");m(v,k,I,"Z","Ζ");m(v,k,I,"H","Η");m(v,k,I,"I","Ι");m(v,k,I,"K","Κ");m(v,k,I,"M","Μ");m(v,k,I,"N","Ν");m(v,k,I,"O","Ο");m(v,k,I,"P","Ρ");m(v,k,I,"T","Τ");m(v,k,I,"X","Χ");m(v,k,I,"¬","\\neg",!0);m(v,k,I,"¬","\\lnot");m(v,k,I,"⊤","\\top");m(v,k,I,"⊥","\\bot");m(v,k,I,"∅","\\emptyset");m(v,R,I,"∅","\\varnothing");m(v,k,he,"α","\\alpha",!0);m(v,k,he,"β","\\beta",!0);m(v,k,he,"γ","\\gamma",!0);m(v,k,he,"δ","\\delta",!0);m(v,k,he,"ϵ","\\epsilon",!0);m(v,k,he,"ζ","\\zeta",!0);m(v,k,he,"η","\\eta",!0);m(v,k,he,"θ","\\theta",!0);m(v,k,he,"ι","\\iota",!0);m(v,k,he,"κ","\\kappa",!0);m(v,k,he,"λ","\\lambda",!0);m(v,k,he,"μ","\\mu",!0);m(v,k,he,"ν","\\nu",!0);m(v,k,he,"ξ","\\xi",!0);m(v,k,he,"ο","\\omicron",!0);m(v,k,he,"π","\\pi",!0);m(v,k,he,"ρ","\\rho",!0);m(v,k,he,"σ","\\sigma",!0);m(v,k,he,"τ","\\tau",!0);m(v,k,he,"υ","\\upsilon",!0);m(v,k,he,"ϕ","\\phi",!0);m(v,k,he,"χ","\\chi",!0);m(v,k,he,"ψ","\\psi",!0);m(v,k,he,"ω","\\omega",!0);m(v,k,he,"ε","\\varepsilon",!0);m(v,k,he,"ϑ","\\vartheta",!0);m(v,k,he,"ϖ","\\varpi",!0);m(v,k,he,"ϱ","\\varrho",!0);m(v,k,he,"ς","\\varsigma",!0);m(v,k,he,"φ","\\varphi",!0);m(v,k,re,"∗","*",!0);m(v,k,re,"+","+");m(v,k,re,"−","-",!0);m(v,k,re,"⋅","\\cdot",!0);m(v,k,re,"∘","\\circ",!0);m(v,k,re,"÷","\\div",!0);m(v,k,re,"±","\\pm",!0);m(v,k,re,"×","\\times",!0);m(v,k,re,"∩","\\cap",!0);m(v,k,re,"∪","\\cup",!0);m(v,k,re,"∖","\\setminus",!0);m(v,k,re,"∧","\\land");m(v,k,re,"∨","\\lor");m(v,k,re,"∧","\\wedge",!0);m(v,k,re,"∨","\\vee",!0);m(v,k,I,"√","\\surd");m(v,k,ci,"⟨","\\langle",!0);m(v,k,ci,"∣","\\lvert");m(v,k,ci,"∥","\\lVert");m(v,k,Ss,"?","?");m(v,k,Ss,"!","!");m(v,k,Ss,"⟩","\\rangle",!0);m(v,k,Ss,"∣","\\rvert");m(v,k,Ss,"∥","\\rVert");m(v,k,P,"=","=");m(v,k,P,":",":");m(v,k,P,"≈","\\approx",!0);m(v,k,P,"≅","\\cong",!0);m(v,k,P,"≥","\\ge");m(v,k,P,"≥","\\geq",!0);m(v,k,P,"←","\\gets");m(v,k,P,">","\\gt",!0);m(v,k,P,"∈","\\in",!0);m(v,k,P,"","\\@not");m(v,k,P,"⊂","\\subset",!0);m(v,k,P,"⊃","\\supset",!0);m(v,k,P,"⊆","\\subseteq",!0);m(v,k,P,"⊇","\\supseteq",!0);m(v,R,P,"⊈","\\nsubseteq",!0);m(v,R,P,"⊉","\\nsupseteq",!0);m(v,k,P,"⊨","\\models");m(v,k,P,"←","\\leftarrow",!0);m(v,k,P,"≤","\\le");m(v,k,P,"≤","\\leq",!0);m(v,k,P,"<","\\lt",!0);m(v,k,P,"→","\\rightarrow",!0);m(v,k,P,"→","\\to");m(v,R,P,"≱","\\ngeq",!0);m(v,R,P,"≰","\\nleq",!0);m(v,k,Ln," ","\\ ");m(v,k,Ln," ","\\space");m(v,k,Ln," ","\\nobreakspace");m(G,k,Ln," ","\\ ");m(G,k,Ln," "," ");m(G,k,Ln," ","\\space");m(G,k,Ln," ","\\nobreakspace");m(v,k,Ln,null,"\\nobreak");m(v,k,Ln,null,"\\allowbreak");m(v,k,gg,",",",");m(v,k,gg,";",";");m(v,R,re,"⊼","\\barwedge",!0);m(v,R,re,"⊻","\\veebar",!0);m(v,k,re,"⊙","\\odot",!0);m(v,k,re,"⊕","\\oplus",!0);m(v,k,re,"⊗","\\otimes",!0);m(v,k,I,"∂","\\partial",!0);m(v,k,re,"⊘","\\oslash",!0);m(v,R,re,"⊚","\\circledcirc",!0);m(v,R,re,"⊡","\\boxdot",!0);m(v,k,re,"△","\\bigtriangleup");m(v,k,re,"▽","\\bigtriangledown");m(v,k,re,"†","\\dagger");m(v,k,re,"⋄","\\diamond");m(v,k,re,"⋆","\\star");m(v,k,re,"◃","\\triangleleft");m(v,k,re,"▹","\\triangleright");m(v,k,ci,"{","\\{");m(G,k,I,"{","\\{");m(G,k,I,"{","\\textbraceleft");m(v,k,Ss,"}","\\}");m(G,k,I,"}","\\}");m(G,k,I,"}","\\textbraceright");m(v,k,ci,"{","\\lbrace");m(v,k,Ss,"}","\\rbrace");m(v,k,ci,"[","\\lbrack",!0);m(G,k,I,"[","\\lbrack",!0);m(v,k,Ss,"]","\\rbrack",!0);m(G,k,I,"]","\\rbrack",!0);m(v,k,ci,"(","\\lparen",!0);m(v,k,Ss,")","\\rparen",!0);m(G,k,I,"<","\\textless",!0);m(G,k,I,">","\\textgreater",!0);m(v,k,ci,"⌊","\\lfloor",!0);m(v,k,Ss,"⌋","\\rfloor",!0);m(v,k,ci,"⌈","\\lceil",!0);m(v,k,Ss,"⌉","\\rceil",!0);m(v,k,I,"\\","\\backslash");m(v,k,I,"∣","|");m(v,k,I,"∣","\\vert");m(G,k,I,"|","\\textbar",!0);m(v,k,I,"∥","\\|");m(v,k,I,"∥","\\Vert");m(G,k,I,"∥","\\textbardbl");m(G,k,I,"~","\\textasciitilde");m(G,k,I,"\\","\\textbackslash");m(G,k,I,"^","\\textasciicircum");m(v,k,P,"↑","\\uparrow",!0);m(v,k,P,"⇑","\\Uparrow",!0);m(v,k,P,"↓","\\downarrow",!0);m(v,k,P,"⇓","\\Downarrow",!0);m(v,k,P,"↕","\\updownarrow",!0);m(v,k,P,"⇕","\\Updownarrow",!0);m(v,k,Rt,"∐","\\coprod");m(v,k,Rt,"⋁","\\bigvee");m(v,k,Rt,"⋀","\\bigwedge");m(v,k,Rt,"⨄","\\biguplus");m(v,k,Rt,"⋂","\\bigcap");m(v,k,Rt,"⋃","\\bigcup");m(v,k,Rt,"∫","\\int");m(v,k,Rt,"∫","\\intop");m(v,k,Rt,"∬","\\iint");m(v,k,Rt,"∭","\\iiint");m(v,k,Rt,"∏","\\prod");m(v,k,Rt,"∑","\\sum");m(v,k,Rt,"⨂","\\bigotimes");m(v,k,Rt,"⨁","\\bigoplus");m(v,k,Rt,"⨀","\\bigodot");m(v,k,Rt,"∮","\\oint");m(v,k,Rt,"∯","\\oiint");m(v,k,Rt,"∰","\\oiiint");m(v,k,Rt,"⨆","\\bigsqcup");m(v,k,Rt,"∫","\\smallint");m(G,k,ac,"…","\\textellipsis");m(v,k,ac,"…","\\mathellipsis");m(G,k,ac,"…","\\ldots",!0);m(v,k,ac,"…","\\ldots",!0);m(v,k,ac,"⋯","\\@cdots",!0);m(v,k,ac,"⋱","\\ddots",!0);m(v,k,I,"⋮","\\varvdots");m(G,k,I,"⋮","\\varvdots");m(v,k,lt,"ˊ","\\acute");m(v,k,lt,"ˋ","\\grave");m(v,k,lt,"¨","\\ddot");m(v,k,lt,"~","\\tilde");m(v,k,lt,"ˉ","\\bar");m(v,k,lt,"˘","\\breve");m(v,k,lt,"ˇ","\\check");m(v,k,lt,"^","\\hat");m(v,k,lt,"⃗","\\vec");m(v,k,lt,"˙","\\dot");m(v,k,lt,"˚","\\mathring");m(v,k,he,"","\\@imath");m(v,k,he,"","\\@jmath");m(v,k,I,"ı","ı");m(v,k,I,"ȷ","ȷ");m(G,k,I,"ı","\\i",!0);m(G,k,I,"ȷ","\\j",!0);m(G,k,I,"ß","\\ss",!0);m(G,k,I,"æ","\\ae",!0);m(G,k,I,"œ","\\oe",!0);m(G,k,I,"ø","\\o",!0);m(G,k,I,"Æ","\\AE",!0);m(G,k,I,"Œ","\\OE",!0);m(G,k,I,"Ø","\\O",!0);m(G,k,lt,"ˊ","\\'");m(G,k,lt,"ˋ","\\`");m(G,k,lt,"ˆ","\\^");m(G,k,lt,"˜","\\~");m(G,k,lt,"ˉ","\\=");m(G,k,lt,"˘","\\u");m(G,k,lt,"˙","\\.");m(G,k,lt,"¸","\\c");m(G,k,lt,"˚","\\r");m(G,k,lt,"ˇ","\\v");m(G,k,lt,"¨",'\\"');m(G,k,lt,"˝","\\H");m(G,k,lt,"◯","\\textcircled");var ub={"--":!0,"---":!0,"``":!0,"''":!0};m(G,k,I,"–","--",!0);m(G,k,I,"–","\\textendash");m(G,k,I,"—","---",!0);m(G,k,I,"—","\\textemdash");m(G,k,I,"‘","`",!0);m(G,k,I,"‘","\\textquoteleft");m(G,k,I,"’","'",!0);m(G,k,I,"’","\\textquoteright");m(G,k,I,"“","``",!0);m(G,k,I,"“","\\textquotedblleft");m(G,k,I,"”","''",!0);m(G,k,I,"”","\\textquotedblright");m(v,k,I,"°","\\degree",!0);m(G,k,I,"°","\\degree");m(G,k,I,"°","\\textdegree",!0);m(v,k,I,"£","\\pounds");m(v,k,I,"£","\\mathsterling",!0);m(G,k,I,"£","\\pounds");m(G,k,I,"£","\\textsterling",!0);m(v,R,I,"✠","\\maltese");m(G,R,I,"✠","\\maltese");var c5='0123456789/@."';for(var Fg=0;Fg<c5.length;Fg++){var u5=c5.charAt(Fg);m(v,k,I,u5,u5)}var d5='0123456789!@*()-=+";:?/.,';for(var Og=0;Og<d5.length;Og++){var f5=d5.charAt(Og);m(G,k,I,f5,f5)}var sp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var zg=0;zg<sp.length;zg++){var Xf=sp.charAt(zg);m(v,k,he,Xf,Xf),m(G,k,I,Xf,Xf)}m(v,R,I,"C","ℂ");m(G,R,I,"C","ℂ");m(v,R,I,"H","ℍ");m(G,R,I,"H","ℍ");m(v,R,I,"N","ℕ");m(G,R,I,"N","ℕ");m(v,R,I,"P","ℙ");m(G,R,I,"P","ℙ");m(v,R,I,"Q","ℚ");m(G,R,I,"Q","ℚ");m(v,R,I,"R","ℝ");m(G,R,I,"R","ℝ");m(v,R,I,"Z","ℤ");m(G,R,I,"Z","ℤ");m(v,k,he,"h","ℎ");m(G,k,he,"h","ℎ");var de="";for(var fs=0;fs<sp.length;fs++){var bt=sp.charAt(fs);de=String.fromCharCode(55349,56320+fs),m(v,k,he,bt,de),m(G,k,I,bt,de),de=String.fromCharCode(55349,56372+fs),m(v,k,he,bt,de),m(G,k,I,bt,de),de=String.fromCharCode(55349,56424+fs),m(v,k,he,bt,de),m(G,k,I,bt,de),de=String.fromCharCode(55349,56580+fs),m(v,k,he,bt,de),m(G,k,I,bt,de),de=String.fromCharCode(55349,56684+fs),m(v,k,he,bt,de),m(G,k,I,bt,de),de=String.fromCharCode(55349,56736+fs),m(v,k,he,bt,de),m(G,k,I,bt,de),de=String.fromCharCode(55349,56788+fs),m(v,k,he,bt,de),m(G,k,I,bt,de),de=String.fromCharCode(55349,56840+fs),m(v,k,he,bt,de),m(G,k,I,bt,de),de=String.fromCharCode(55349,56944+fs),m(v,k,he,bt,de),m(G,k,I,bt,de),fs<26&&(de=String.fromCharCode(55349,56632+fs),m(v,k,he,bt,de),m(G,k,I,bt,de),de=String.fromCharCode(55349,56476+fs),m(v,k,he,bt,de),m(G,k,I,bt,de))}de=String.fromCharCode(55349,56668);m(v,k,he,"k",de);m(G,k,I,"k",de);for(var Ga=0;Ga<10;Ga++){var Nn=Ga.toString();de=String.fromCharCode(55349,57294+Ga),m(v,k,he,Nn,de),m(G,k,I,Nn,de),de=String.fromCharCode(55349,57314+Ga),m(v,k,he,Nn,de),m(G,k,I,Nn,de),de=String.fromCharCode(55349,57324+Ga),m(v,k,he,Nn,de),m(G,k,I,Nn,de),de=String.fromCharCode(55349,57334+Ga),m(v,k,he,Nn,de),m(G,k,I,Nn,de)}var g4="ÐÞþ";for(var Hg=0;Hg<g4.length;Hg++){var Yf=g4.charAt(Hg);m(v,k,he,Yf,Yf),m(G,k,I,Yf,Yf)}var Kf=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],p5=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],Ky=function(e,t){var s=e.charCodeAt(0),i=e.charCodeAt(1),r=(s-55296)*1024+(i-56320)+65536,a=t==="math"?0:1;if(119808<=r&&r<120484){var l=Math.floor((r-119808)/26);return[Kf[l][2],Kf[l][a]]}else if(120782<=r&&r<=120831){var h=Math.floor((r-120782)/10);return[p5[h][2],p5[h][a]]}else{if(r===120485||r===120486)return[Kf[0][2],Kf[0][a]];if(120486<r&&r<120782)return["",""];throw new X("Unsupported character: "+e)}},bg=function(e,t,s){return tt[s][e]&&tt[s][e].replace&&(e=tt[s][e].replace),{value:e,metrics:c3(e,t,s)}},Yi=function(e,t,s,i,r){var a=bg(e,t,s),l=a.metrics;e=a.value;var h;if(l){var c=l.italic;(s==="text"||i&&i.font==="mathit")&&(c=0),h=new _i(e,l.height,l.depth,c,l.skew,l.width,r)}else typeof console<"u"&&console.warn("No character metrics "+("for '"+e+"' in style '"+t+"' and mode '"+s+"'")),h=new _i(e,0,0,0,0,0,r);if(i){h.maxFontSize=i.sizeMultiplier,i.style.isTight()&&h.classes.push("mtight");var u=i.getColor();u&&(h.style.color=u)}return h},Zy=function(e,t,s,i){return i===void 0&&(i=[]),s.font==="boldsymbol"&&bg(e,"Main-Bold",t).metrics?Yi(e,"Main-Bold",t,s,i.concat(["mathbf"])):e==="\\"||tt[t][e].font==="main"?Yi(e,"Main-Regular",t,s,i):Yi(e,"AMS-Regular",t,s,i.concat(["amsrm"]))},Qy=function(e,t,s,i,r){return r!=="textord"&&bg(e,"Math-BoldItalic",t).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}},Jy=function(e,t,s){var i=e.mode,r=e.text,a=["mord"],l=i==="math"||i==="text"&&t.font,h=l?t.font:t.fontFamily,c="",u="";if(r.charCodeAt(0)===55349&&([c,u]=Ky(r,i)),c.length>0)return Yi(r,c,i,t,a.concat(u));if(h){var d,f;if(h==="boldsymbol"){var p=Qy(r,i,t,a,s);d=p.fontName,f=[p.fontClass]}else l?(d=pb[h].fontName,f=[h]):(d=Zf(h,t.fontWeight,t.fontShape),f=[h,t.fontWeight,t.fontShape]);if(bg(r,d,i).metrics)return Yi(r,d,i,t,a.concat(f));if(ub.hasOwnProperty(r)&&d.slice(0,10)==="Typewriter"){for(var w=[],y=0;y<r.length;y++)w.push(Yi(r[y],d,i,t,a.concat(f)));return fb(w)}}if(s==="mathord")return Yi(r,"Math-Italic",i,t,a.concat(["mathnormal"]));if(s==="textord"){var x=tt[i][r]&&tt[i][r].font;if(x==="ams"){var S=Zf("amsrm",t.fontWeight,t.fontShape);return Yi(r,S,i,t,a.concat("amsrm",t.fontWeight,t.fontShape))}else if(x==="main"||!x){var E=Zf("textrm",t.fontWeight,t.fontShape);return Yi(r,E,i,t,a.concat(t.fontWeight,t.fontShape))}else{var T=Zf(x,t.fontWeight,t.fontShape);return Yi(r,T,i,t,a.concat(T,t.fontWeight,t.fontShape))}}else throw new Error("unexpected type: "+s+" in makeOrd")},ew=(n,e)=>{if(Oa(n.classes)!==Oa(e.classes)||n.skew!==e.skew||n.maxFontSize!==e.maxFontSize)return!1;if(n.classes.length===1){var t=n.classes[0];if(t==="mbin"||t==="mord")return!1}for(var s in n.style)if(n.style.hasOwnProperty(s)&&n.style[s]!==e.style[s])return!1;for(var i in e.style)if(e.style.hasOwnProperty(i)&&n.style[i]!==e.style[i])return!1;return!0},tw=n=>{for(var e=0;e<n.length-1;e++){var t=n[e],s=n[e+1];t instanceof _i&&s instanceof _i&&ew(t,s)&&(t.text+=s.text,t.height=Math.max(t.height,s.height),t.depth=Math.max(t.depth,s.depth),t.italic=s.italic,n.splice(e+1,1),e--)}return n},d3=function(e){for(var t=0,s=0,i=0,r=0;r<e.children.length;r++){var a=e.children[r];a.height>t&&(t=a.height),a.depth>s&&(s=a.depth),a.maxFontSize>i&&(i=a.maxFontSize)}e.height=t,e.depth=s,e.maxFontSize=i},Ls=function(e,t,s,i){var r=new Nf(e,t,s,i);return d3(r),r},db=(n,e,t,s)=>new Nf(n,e,t,s),sw=function(e,t,s){var i=Ls([e],[],t);return i.height=Math.max(s||t.fontMetrics().defaultRuleThickness,t.minRuleThickness),i.style.borderBottomWidth=Q(i.height),i.maxFontSize=1,i},iw=function(e,t,s,i){var r=new u3(e,t,s,i);return d3(r),r},fb=function(e){var t=new Bf(e);return d3(t),t},rw=function(e,t){return e instanceof Bf?Ls([],[e],t):e},nw=function(e){if(e.positionType==="individualShift"){for(var t=e.children,s=[t[0]],i=-t[0].shift-t[0].elem.depth,r=i,a=1;a<t.length;a++){var l=-t[a].shift-r-t[a].elem.depth,h=l-(t[a-1].elem.height+t[a-1].elem.depth);r=r+l,s.push({type:"kern",size:h}),s.push(t[a])}return{children:s,depth:i}}var c;if(e.positionType==="top"){for(var u=e.positionData,d=0;d<e.children.length;d++){var f=e.children[d];u-=f.type==="kern"?f.size:f.elem.height+f.elem.depth}c=u}else if(e.positionType==="bottom")c=-e.positionData;else{var p=e.children[0];if(p.type!=="elem")throw new Error('First child must have type "elem".');if(e.positionType==="shift")c=-p.elem.depth-e.positionData;else if(e.positionType==="firstBaseline")c=-p.elem.depth;else throw new Error("Invalid positionType "+e.positionType+".")}return{children:e.children,depth:c}},aw=function(e,t){for(var{children:s,depth:i}=nw(e),r=0,a=0;a<s.length;a++){var l=s[a];if(l.type==="elem"){var h=l.elem;r=Math.max(r,h.maxFontSize,h.height)}}r+=2;var c=Ls(["pstrut"],[]);c.style.height=Q(r);for(var u=[],d=i,f=i,p=i,w=0;w<s.length;w++){var y=s[w];if(y.type==="kern")p+=y.size;else{var x=y.elem,S=y.wrapperClasses||[],E=y.wrapperStyle||{},T=Ls(S,[c,x],void 0,E);T.style.top=Q(-r-p-x.depth),y.marginLeft&&(T.style.marginLeft=y.marginLeft),y.marginRight&&(T.style.marginRight=y.marginRight),u.push(T),p+=x.height+x.depth}d=Math.min(d,p),f=Math.max(f,p)}var _=Ls(["vlist"],u);_.style.height=Q(f);var M;if(d<0){var D=Ls([],[]),L=Ls(["vlist"],[D]);L.style.height=Q(-d);var F=Ls(["vlist-s"],[new _i("​")]);M=[Ls(["vlist-r"],[_,F]),Ls(["vlist-r"],[L])]}else M=[Ls(["vlist-r"],[_])];var N=Ls(["vlist-t"],M);return M.length===2&&N.classes.push("vlist-t2"),N.height=f,N.depth=-d,N},ow=(n,e)=>{var t=Ls(["mspace"],[],e),s=mt(n,e);return t.style.marginRight=Q(s),t},Zf=function(e,t,s){var i="";switch(e){case"amsrm":i="AMS";break;case"textrm":i="Main";break;case"textsf":i="SansSerif";break;case"texttt":i="Typewriter";break;default:i=e}var r;return t==="textbf"&&s==="textit"?r="BoldItalic":t==="textbf"?r="Bold":t==="textit"?r="Italic":r="Regular",i+"-"+r},pb={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathsfit:{variant:"sans-serif-italic",fontName:"SansSerif-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},mb={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},lw=function(e,t){var[s,i,r]=mb[e],a=new za(s),l=new Dn([a],{width:Q(i),height:Q(r),style:"width:"+Q(i),viewBox:"0 0 "+1e3*i+" "+1e3*r,preserveAspectRatio:"xMinYMin"}),h=db(["overlay"],[l],t);return h.height=r,h.style.height=Q(r),h.style.width=Q(i),h},B={fontMap:pb,makeSymbol:Yi,mathsym:Zy,makeSpan:Ls,makeSvgSpan:db,makeLineSpan:sw,makeAnchor:iw,makeFragment:fb,wrapFragment:rw,makeVList:aw,makeOrd:Jy,makeGlue:ow,staticSvg:lw,svgData:mb,tryCombineChars:tw},ft={number:3,unit:"mu"},Va={number:4,unit:"mu"},Nr={number:5,unit:"mu"},hw={mord:{mop:ft,mbin:Va,mrel:Nr,minner:ft},mop:{mord:ft,mop:ft,mrel:Nr,minner:ft},mbin:{mord:Va,mop:Va,mopen:Va,minner:Va},mrel:{mord:Nr,mop:Nr,mopen:Nr,minner:Nr},mopen:{},mclose:{mop:ft,mbin:Va,mrel:Nr,minner:ft},mpunct:{mord:ft,mop:ft,mrel:Nr,mopen:ft,mclose:ft,mpunct:ft,minner:ft},minner:{mord:ft,mop:ft,mbin:Va,mrel:Nr,mopen:ft,mpunct:ft,minner:ft}},cw={mord:{mop:ft},mop:{mord:ft,mop:ft},mbin:{},mrel:{},mopen:{},mclose:{mop:ft},mpunct:{},minner:{mop:ft}},gb={},ip={},rp={};function ie(n){for(var{type:e,names:t,props:s,handler:i,htmlBuilder:r,mathmlBuilder:a}=n,l={type:e,numArgs:s.numArgs,argTypes:s.argTypes,allowedInArgument:!!s.allowedInArgument,allowedInText:!!s.allowedInText,allowedInMath:s.allowedInMath===void 0?!0:s.allowedInMath,numOptionalArgs:s.numOptionalArgs||0,infix:!!s.infix,primitive:!!s.primitive,handler:i},h=0;h<t.length;++h)gb[t[h]]=l;e&&(r&&(ip[e]=r),a&&(rp[e]=a))}function Bl(n){var{type:e,htmlBuilder:t,mathmlBuilder:s}=n;ie({type:e,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:t,mathmlBuilder:s})}var np=function(e){return e.type==="ordgroup"&&e.body.length===1?e.body[0]:e},Et=function(e){return e.type==="ordgroup"?e.body:[e]},Rn=B.makeSpan,uw=["leftmost","mbin","mopen","mrel","mop","mpunct"],dw=["rightmost","mrel","mclose","mpunct"],fw={display:ce.DISPLAY,text:ce.TEXT,script:ce.SCRIPT,scriptscript:ce.SCRIPTSCRIPT},pw={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},Ot=function(e,t,s,i){i===void 0&&(i=[null,null]);for(var r=[],a=0;a<e.length;a++){var l=Re(e[a],t);if(l instanceof Bf){var h=l.children;r.push(...h)}else r.push(l)}if(B.tryCombineChars(r),!s)return r;var c=t;if(e.length===1){var u=e[0];u.type==="sizing"?c=t.havingSize(u.size):u.type==="styling"&&(c=t.havingStyle(fw[u.style]))}var d=Rn([i[0]||"leftmost"],[],t),f=Rn([i[1]||"rightmost"],[],t),p=s==="root";return m5(r,(w,y)=>{var x=y.classes[0],S=w.classes[0];x==="mbin"&&dw.includes(S)?y.classes[0]="mord":S==="mbin"&&uw.includes(x)&&(w.classes[0]="mord")},{node:d},f,p),m5(r,(w,y)=>{var x=b4(y),S=b4(w),E=x&&S?w.hasClass("mtight")?cw[x][S]:hw[x][S]:null;if(E)return B.makeGlue(E,c)},{node:d},f,p),r},m5=function n(e,t,s,i,r){i&&e.push(i);for(var a=0;a<e.length;a++){var l=e[a],h=bb(l);if(h){n(h.children,t,s,null,r);continue}var c=!l.hasClass("mspace");if(c){var u=t(l,s.node);u&&(s.insertAfter?s.insertAfter(u):(e.unshift(u),a++))}c?s.node=l:r&&l.hasClass("newline")&&(s.node=Rn(["leftmost"])),s.insertAfter=(d=>f=>{e.splice(d+1,0,f),a++})(a)}i&&e.pop()},bb=function(e){return e instanceof Bf||e instanceof u3||e instanceof Nf&&e.hasClass("enclosing")?e:null},mw=function n(e,t){var s=bb(e);if(s){var i=s.children;if(i.length){if(t==="right")return n(i[i.length-1],"right");if(t==="left")return n(i[0],"left")}}return e},b4=function(e,t){return e?(t&&(e=mw(e,t)),pw[e.classes[0]]||null):null},jc=function(e,t){var s=["nulldelimiter"].concat(e.baseSizingClasses());return Rn(t.concat(s))},Re=function(e,t,s){if(!e)return Rn();if(ip[e.type]){var i=ip[e.type](e,t);if(s&&t.size!==s.size){i=Rn(t.sizingClasses(s),[i],t);var r=t.sizeMultiplier/s.sizeMultiplier;i.height*=r,i.depth*=r}return i}else throw new X("Got group of unknown type: '"+e.type+"'")};function Qf(n,e){var t=Rn(["base"],n,e),s=Rn(["strut"]);return s.style.height=Q(t.height+t.depth),t.depth&&(s.style.verticalAlign=Q(-t.depth)),t.children.unshift(s),t}function v4(n,e){var t=null;n.length===1&&n[0].type==="tag"&&(t=n[0].tag,n=n[0].body);var s=Ot(n,e,"root"),i;s.length===2&&s[1].hasClass("tag")&&(i=s.pop());for(var r=[],a=[],l=0;l<s.length;l++)if(a.push(s[l]),s[l].hasClass("mbin")||s[l].hasClass("mrel")||s[l].hasClass("allowbreak")){for(var h=!1;l<s.length-1&&s[l+1].hasClass("mspace")&&!s[l+1].hasClass("newline");)l++,a.push(s[l]),s[l].hasClass("nobreak")&&(h=!0);h||(r.push(Qf(a,e)),a=[])}else s[l].hasClass("newline")&&(a.pop(),a.length>0&&(r.push(Qf(a,e)),a=[]),r.push(s[l]));a.length>0&&r.push(Qf(a,e));var c;t?(c=Qf(Ot(t,e,!0)),c.classes=["tag"],r.push(c)):i&&r.push(i);var u=Rn(["katex-html"],r);if(u.setAttribute("aria-hidden","true"),c){var d=c.children[0];d.style.height=Q(u.height+u.depth),u.depth&&(d.style.verticalAlign=Q(-u.depth))}return u}function vb(n){return new Bf(n)}class li{constructor(e,t,s){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=e,this.attributes={},this.children=t||[],this.classes=s||[]}setAttribute(e,t){this.attributes[e]=t}getAttribute(e){return this.attributes[e]}toNode(){var e=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);this.classes.length>0&&(e.className=Oa(this.classes));for(var s=0;s<this.children.length;s++)if(this.children[s]instanceof _r&&this.children[s+1]instanceof _r){for(var i=this.children[s].toText()+this.children[++s].toText();this.children[s+1]instanceof _r;)i+=this.children[++s].toText();e.appendChild(new _r(i).toNode())}else e.appendChild(this.children[s].toNode());return e}toMarkup(){var e="<"+this.type;for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="',e+=Pe.escape(this.attributes[t]),e+='"');this.classes.length>0&&(e+=' class ="'+Pe.escape(Oa(this.classes))+'"'),e+=">";for(var s=0;s<this.children.length;s++)e+=this.children[s].toMarkup();return e+="</"+this.type+">",e}toText(){return this.children.map(e=>e.toText()).join("")}}class _r{constructor(e){this.text=void 0,this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return Pe.escape(this.toText())}toText(){return this.text}}class gw{constructor(e){this.width=void 0,this.character=void 0,this.width=e,e>=.05555&&e<=.05556?this.character=" ":e>=.1666&&e<=.1667?this.character=" ":e>=.2222&&e<=.2223?this.character=" ":e>=.2777&&e<=.2778?this.character="  ":e>=-.05556&&e<=-.05555?this.character=" ⁣":e>=-.1667&&e<=-.1666?this.character=" ⁣":e>=-.2223&&e<=-.2222?this.character=" ⁣":e>=-.2778&&e<=-.2777?this.character=" ⁣":this.character=null}toNode(){if(this.character)return document.createTextNode(this.character);var e=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return e.setAttribute("width",Q(this.width)),e}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+Q(this.width)+'"/>'}toText(){return this.character?this.character:" "}}var j={MathNode:li,TextNode:_r,SpaceNode:gw,newDocumentFragment:vb},Mi=function(e,t,s){return tt[t][e]&&tt[t][e].replace&&e.charCodeAt(0)!==55349&&!(ub.hasOwnProperty(e)&&s&&(s.fontFamily&&s.fontFamily.slice(4,6)==="tt"||s.font&&s.font.slice(4,6)==="tt"))&&(e=tt[t][e].replace),new j.TextNode(e)},f3=function(e){return e.length===1?e[0]:new j.MathNode("mrow",e)},p3=function(e,t){if(t.fontFamily==="texttt")return"monospace";if(t.fontFamily==="textsf")return t.fontShape==="textit"&&t.fontWeight==="textbf"?"sans-serif-bold-italic":t.fontShape==="textit"?"sans-serif-italic":t.fontWeight==="textbf"?"bold-sans-serif":"sans-serif";if(t.fontShape==="textit"&&t.fontWeight==="textbf")return"bold-italic";if(t.fontShape==="textit")return"italic";if(t.fontWeight==="textbf")return"bold";var s=t.font;if(!s||s==="mathnormal")return null;var i=e.mode;if(s==="mathit")return"italic";if(s==="boldsymbol")return e.type==="textord"?"bold":"bold-italic";if(s==="mathbf")return"bold";if(s==="mathbb")return"double-struck";if(s==="mathsfit")return"sans-serif-italic";if(s==="mathfrak")return"fraktur";if(s==="mathscr"||s==="mathcal")return"script";if(s==="mathsf")return"sans-serif";if(s==="mathtt")return"monospace";var r=e.text;if(["\\imath","\\jmath"].includes(r))return null;tt[i][r]&&tt[i][r].replace&&(r=tt[i][r].replace);var a=B.fontMap[s].fontName;return c3(r,a,i)?B.fontMap[s].variant:null};function Ug(n){if(!n)return!1;if(n.type==="mi"&&n.children.length===1){var e=n.children[0];return e instanceof _r&&e.text==="."}else if(n.type==="mo"&&n.children.length===1&&n.getAttribute("separator")==="true"&&n.getAttribute("lspace")==="0em"&&n.getAttribute("rspace")==="0em"){var t=n.children[0];return t instanceof _r&&t.text===","}else return!1}var Fs=function(e,t,s){if(e.length===1){var i=Ye(e[0],t);return s&&i instanceof li&&i.type==="mo"&&(i.setAttribute("lspace","0em"),i.setAttribute("rspace","0em")),[i]}for(var r=[],a,l=0;l<e.length;l++){var h=Ye(e[l],t);if(h instanceof li&&a instanceof li){if(h.type==="mtext"&&a.type==="mtext"&&h.getAttribute("mathvariant")===a.getAttribute("mathvariant")){a.children.push(...h.children);continue}else if(h.type==="mn"&&a.type==="mn"){a.children.push(...h.children);continue}else if(Ug(h)&&a.type==="mn"){a.children.push(...h.children);continue}else if(h.type==="mn"&&Ug(a))h.children=[...a.children,...h.children],r.pop();else if((h.type==="msup"||h.type==="msub")&&h.children.length>=1&&(a.type==="mn"||Ug(a))){var c=h.children[0];c instanceof li&&c.type==="mn"&&(c.children=[...a.children,...c.children],r.pop())}else if(a.type==="mi"&&a.children.length===1){var u=a.children[0];if(u instanceof _r&&u.text==="̸"&&(h.type==="mo"||h.type==="mi"||h.type==="mn")){var d=h.children[0];d instanceof _r&&d.text.length>0&&(d.text=d.text.slice(0,1)+"̸"+d.text.slice(1),r.pop())}}}r.push(h),a=h}return r},Ha=function(e,t,s){return f3(Fs(e,t,s))},Ye=function(e,t){if(!e)return new j.MathNode("mrow");if(rp[e.type]){var s=rp[e.type](e,t);return s}else throw new X("Got group of unknown type: '"+e.type+"'")};function g5(n,e,t,s,i){var r=Fs(n,t),a;r.length===1&&r[0]instanceof li&&["mrow","mtable"].includes(r[0].type)?a=r[0]:a=new j.MathNode("mrow",r);var l=new j.MathNode("annotation",[new j.TextNode(e)]);l.setAttribute("encoding","application/x-tex");var h=new j.MathNode("semantics",[a,l]),c=new j.MathNode("math",[h]);c.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),s&&c.setAttribute("display","block");var u=i?"katex":"katex-mathml";return B.makeSpan([u],[c])}var yb=function(e){return new $r({style:e.displayMode?ce.DISPLAY:ce.TEXT,maxSize:e.maxSize,minRuleThickness:e.minRuleThickness})},wb=function(e,t){if(t.displayMode){var s=["katex-display"];t.leqno&&s.push("leqno"),t.fleqn&&s.push("fleqn"),e=B.makeSpan(s,[e])}return e},bw=function(e,t,s){var i=yb(s),r;if(s.output==="mathml")return g5(e,t,i,s.displayMode,!0);if(s.output==="html"){var a=v4(e,i);r=B.makeSpan(["katex"],[a])}else{var l=g5(e,t,i,s.displayMode,!1),h=v4(e,i);r=B.makeSpan(["katex"],[l,h])}return wb(r,s)},vw=function(e,t,s){var i=yb(s),r=v4(e,i),a=B.makeSpan(["katex"],[r]);return wb(a,s)},yw={widehat:"^",widecheck:"ˇ",widetilde:"~",utilde:"~",overleftarrow:"←",underleftarrow:"←",xleftarrow:"←",overrightarrow:"→",underrightarrow:"→",xrightarrow:"→",underbrace:"⏟",overbrace:"⏞",overgroup:"⏠",undergroup:"⏡",overleftrightarrow:"↔",underleftrightarrow:"↔",xleftrightarrow:"↔",Overrightarrow:"⇒",xRightarrow:"⇒",overleftharpoon:"↼",xleftharpoonup:"↼",overrightharpoon:"⇀",xrightharpoonup:"⇀",xLeftarrow:"⇐",xLeftrightarrow:"⇔",xhookleftarrow:"↩",xhookrightarrow:"↪",xmapsto:"↦",xrightharpoondown:"⇁",xleftharpoondown:"↽",xrightleftharpoons:"⇌",xleftrightharpoons:"⇋",xtwoheadleftarrow:"↞",xtwoheadrightarrow:"↠",xlongequal:"=",xtofrom:"⇄",xrightleftarrows:"⇄",xrightequilibrium:"⇌",xleftequilibrium:"⇋","\\cdrightarrow":"→","\\cdleftarrow":"←","\\cdlongequal":"="},ww=function(e){var t=new j.MathNode("mo",[new j.TextNode(yw[e.replace(/^\\/,"")])]);return t.setAttribute("stretchy","true"),t},Aw={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},xw=function(e){return e.type==="ordgroup"?e.body.length:1},Sw=function(e,t){function s(){var l=4e5,h=e.label.slice(1);if(["widehat","widecheck","widetilde","utilde"].includes(h)){var c=e,u=xw(c.base),d,f,p;if(u>5)h==="widehat"||h==="widecheck"?(d=420,l=2364,p=.42,f=h+"4"):(d=312,l=2340,p=.34,f="tilde4");else{var w=[1,1,2,2,3,3][u];h==="widehat"||h==="widecheck"?(l=[0,1062,2364,2364,2364][w],d=[0,239,300,360,420][w],p=[0,.24,.3,.3,.36,.42][w],f=h+w):(l=[0,600,1033,2339,2340][w],d=[0,260,286,306,312][w],p=[0,.26,.286,.3,.306,.34][w],f="tilde"+w)}var y=new za(f),x=new Dn([y],{width:"100%",height:Q(p),viewBox:"0 0 "+l+" "+d,preserveAspectRatio:"none"});return{span:B.makeSvgSpan([],[x],t),minWidth:0,height:p}}else{var S=[],E=Aw[h],[T,_,M]=E,D=M/1e3,L=T.length,F,N;if(L===1){var W=E[3];F=["hide-tail"],N=[W]}else if(L===2)F=["halfarrow-left","halfarrow-right"],N=["xMinYMin","xMaxYMin"];else if(L===3)F=["brace-left","brace-center","brace-right"],N=["xMinYMin","xMidYMin","xMaxYMin"];else throw new Error(`Correct katexImagesData or update code here to support
                    `+L+" children.");for(var $=0;$<L;$++){var q=new za(T[$]),se=new Dn([q],{width:"400em",height:Q(D),viewBox:"0 0 "+l+" "+M,preserveAspectRatio:N[$]+" slice"}),z=B.makeSvgSpan([F[$]],[se],t);if(L===1)return{span:z,minWidth:_,height:D};z.style.height=Q(D),S.push(z)}return{span:B.makeSpan(["stretchy"],S,t),minWidth:_,height:D}}}var{span:i,minWidth:r,height:a}=s();return i.height=a,i.style.height=Q(a),r>0&&(i.style.minWidth=Q(r)),i},kw=function(e,t,s,i,r){var a,l=e.height+e.depth+s+i;if(/fbox|color|angl/.test(t)){if(a=B.makeSpan(["stretchy",t],[],r),t==="fbox"){var h=r.color&&r.getColor();h&&(a.style.borderColor=h)}}else{var c=[];/^[bx]cancel$/.test(t)&&c.push(new m4({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(t)&&c.push(new m4({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var u=new Dn(c,{width:"100%",height:Q(l)});a=B.makeSvgSpan([],[u],r)}return a.height=l,a.style.height=Q(l),a},Pn={encloseSpan:kw,mathMLnode:ww,svgSpan:Sw};function ye(n,e){if(!n||n.type!==e)throw new Error("Expected node of type "+e+", but got "+(n?"node of type "+n.type:String(n)));return n}function m3(n){var e=vg(n);if(!e)throw new Error("Expected node of symbol group type, but got "+(n?"node of type "+n.type:String(n)));return e}function vg(n){return n&&(n.type==="atom"||Yy.hasOwnProperty(n.type))?n:null}var g3=(n,e)=>{var t,s,i;n&&n.type==="supsub"?(s=ye(n.base,"accent"),t=s.base,n.base=t,i=Wy(Re(n,e)),n.base=s):(s=ye(n,"accent"),t=s.base);var r=Re(t,e.havingCrampedStyle()),a=s.isShifty&&Pe.isCharacterBox(t),l=0;if(a){var h=Pe.getBaseElem(t),c=Re(h,e.havingCrampedStyle());l=h5(c).skew}var u=s.label==="\\c",d=u?r.height+r.depth:Math.min(r.height,e.fontMetrics().xHeight),f;if(s.isStretchy)f=Pn.svgSpan(s,e),f=B.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r},{type:"elem",elem:f,wrapperClasses:["svg-align"],wrapperStyle:l>0?{width:"calc(100% - "+Q(2*l)+")",marginLeft:Q(2*l)}:void 0}]},e);else{var p,w;s.label==="\\vec"?(p=B.staticSvg("vec",e),w=B.svgData.vec[1]):(p=B.makeOrd({mode:s.mode,text:s.label},e,"textord"),p=h5(p),p.italic=0,w=p.width,u&&(d+=p.depth)),f=B.makeSpan(["accent-body"],[p]);var y=s.label==="\\textcircled";y&&(f.classes.push("accent-full"),d=r.height);var x=l;y||(x-=w/2),f.style.left=Q(x),s.label==="\\textcircled"&&(f.style.top=".2em"),f=B.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r},{type:"kern",size:-d},{type:"elem",elem:f}]},e)}var S=B.makeSpan(["mord","accent"],[f],e);return i?(i.children[0]=S,i.height=Math.max(S.height,i.height),i.classes[0]="mord",i):S},Ab=(n,e)=>{var t=n.isStretchy?Pn.mathMLnode(n.label):new j.MathNode("mo",[Mi(n.label,n.mode)]),s=new j.MathNode("mover",[Ye(n.base,e),t]);return s.setAttribute("accent","true"),s},Tw=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map(n=>"\\"+n).join("|"));ie({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(n,e)=>{var t=np(e[0]),s=!Tw.test(n.funcName),i=!s||n.funcName==="\\widehat"||n.funcName==="\\widetilde"||n.funcName==="\\widecheck";return{type:"accent",mode:n.parser.mode,label:n.funcName,isStretchy:s,isShifty:i,base:t}},htmlBuilder:g3,mathmlBuilder:Ab});ie({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(n,e)=>{var t=e[0],s=n.parser.mode;return s==="math"&&(n.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+n.funcName+" works only in text mode"),s="text"),{type:"accent",mode:s,label:n.funcName,isStretchy:!1,isShifty:!0,base:t}},htmlBuilder:g3,mathmlBuilder:Ab});ie({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(n,e)=>{var{parser:t,funcName:s}=n,i=e[0];return{type:"accentUnder",mode:t.mode,label:s,base:i}},htmlBuilder:(n,e)=>{var t=Re(n.base,e),s=Pn.svgSpan(n,e),i=n.label==="\\utilde"?.12:0,r=B.makeVList({positionType:"top",positionData:t.height,children:[{type:"elem",elem:s,wrapperClasses:["svg-align"]},{type:"kern",size:i},{type:"elem",elem:t}]},e);return B.makeSpan(["mord","accentunder"],[r],e)},mathmlBuilder:(n,e)=>{var t=Pn.mathMLnode(n.label),s=new j.MathNode("munder",[Ye(n.base,e),t]);return s.setAttribute("accentunder","true"),s}});var Jf=n=>{var e=new j.MathNode("mpadded",n?[n]:[]);return e.setAttribute("width","+0.6em"),e.setAttribute("lspace","0.3em"),e};ie({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(n,e,t){var{parser:s,funcName:i}=n;return{type:"xArrow",mode:s.mode,label:i,body:e[0],below:t[0]}},htmlBuilder(n,e){var t=e.style,s=e.havingStyle(t.sup()),i=B.wrapFragment(Re(n.body,s,e),e),r=n.label.slice(0,2)==="\\x"?"x":"cd";i.classes.push(r+"-arrow-pad");var a;n.below&&(s=e.havingStyle(t.sub()),a=B.wrapFragment(Re(n.below,s,e),e),a.classes.push(r+"-arrow-pad"));var l=Pn.svgSpan(n,e),h=-e.fontMetrics().axisHeight+.5*l.height,c=-e.fontMetrics().axisHeight-.5*l.height-.111;(i.depth>.25||n.label==="\\xleftequilibrium")&&(c-=i.depth);var u;if(a){var d=-e.fontMetrics().axisHeight+a.height+.5*l.height+.111;u=B.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:c},{type:"elem",elem:l,shift:h},{type:"elem",elem:a,shift:d}]},e)}else u=B.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:c},{type:"elem",elem:l,shift:h}]},e);return u.children[0].children[0].children[1].classes.push("svg-align"),B.makeSpan(["mrel","x-arrow"],[u],e)},mathmlBuilder(n,e){var t=Pn.mathMLnode(n.label);t.setAttribute("minsize",n.label.charAt(0)==="x"?"1.75em":"3.0em");var s;if(n.body){var i=Jf(Ye(n.body,e));if(n.below){var r=Jf(Ye(n.below,e));s=new j.MathNode("munderover",[t,r,i])}else s=new j.MathNode("mover",[t,i])}else if(n.below){var a=Jf(Ye(n.below,e));s=new j.MathNode("munder",[t,a])}else s=Jf(),s=new j.MathNode("mover",[t,s]);return s}});var Cw=B.makeSpan;function xb(n,e){var t=Ot(n.body,e,!0);return Cw([n.mclass],t,e)}function Sb(n,e){var t,s=Fs(n.body,e);return n.mclass==="minner"?t=new j.MathNode("mpadded",s):n.mclass==="mord"?n.isCharacterBox?(t=s[0],t.type="mi"):t=new j.MathNode("mi",s):(n.isCharacterBox?(t=s[0],t.type="mo"):t=new j.MathNode("mo",s),n.mclass==="mbin"?(t.attributes.lspace="0.22em",t.attributes.rspace="0.22em"):n.mclass==="mpunct"?(t.attributes.lspace="0em",t.attributes.rspace="0.17em"):n.mclass==="mopen"||n.mclass==="mclose"?(t.attributes.lspace="0em",t.attributes.rspace="0em"):n.mclass==="minner"&&(t.attributes.lspace="0.0556em",t.attributes.width="+0.1111em")),t}ie({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(n,e){var{parser:t,funcName:s}=n,i=e[0];return{type:"mclass",mode:t.mode,mclass:"m"+s.slice(5),body:Et(i),isCharacterBox:Pe.isCharacterBox(i)}},htmlBuilder:xb,mathmlBuilder:Sb});var yg=n=>{var e=n.type==="ordgroup"&&n.body.length?n.body[0]:n;return e.type==="atom"&&(e.family==="bin"||e.family==="rel")?"m"+e.family:"mord"};ie({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(n,e){var{parser:t}=n;return{type:"mclass",mode:t.mode,mclass:yg(e[0]),body:Et(e[1]),isCharacterBox:Pe.isCharacterBox(e[1])}}});ie({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(n,e){var{parser:t,funcName:s}=n,i=e[1],r=e[0],a;s!=="\\stackrel"?a=yg(i):a="mrel";var l={type:"op",mode:i.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:s!=="\\stackrel",body:Et(i)},h={type:"supsub",mode:r.mode,base:l,sup:s==="\\underset"?null:r,sub:s==="\\underset"?r:null};return{type:"mclass",mode:t.mode,mclass:a,body:[h],isCharacterBox:Pe.isCharacterBox(h)}},htmlBuilder:xb,mathmlBuilder:Sb});ie({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(n,e){var{parser:t}=n;return{type:"pmb",mode:t.mode,mclass:yg(e[0]),body:Et(e[0])}},htmlBuilder(n,e){var t=Ot(n.body,e,!0),s=B.makeSpan([n.mclass],t,e);return s.style.textShadow="0.02em 0.01em 0.04px",s},mathmlBuilder(n,e){var t=Fs(n.body,e),s=new j.MathNode("mstyle",t);return s.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),s}});var Ew={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},b5=()=>({type:"styling",body:[],mode:"math",style:"display"}),v5=n=>n.type==="textord"&&n.text==="@",_w=(n,e)=>(n.type==="mathord"||n.type==="atom")&&n.text===e;function Mw(n,e,t){var s=Ew[n];switch(s){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return t.callFunction(s,[e[0]],[e[1]]);case"\\uparrow":case"\\downarrow":{var i=t.callFunction("\\\\cdleft",[e[0]],[]),r={type:"atom",text:s,mode:"math",family:"rel"},a=t.callFunction("\\Big",[r],[]),l=t.callFunction("\\\\cdright",[e[1]],[]),h={type:"ordgroup",mode:"math",body:[i,a,l]};return t.callFunction("\\\\cdparent",[h],[])}case"\\\\cdlongequal":return t.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{var c={type:"textord",text:"\\Vert",mode:"math"};return t.callFunction("\\Big",[c],[])}default:return{type:"textord",text:" ",mode:"math"}}}function Dw(n){var e=[];for(n.gullet.beginGroup(),n.gullet.macros.set("\\cr","\\\\\\relax"),n.gullet.beginGroup();;){e.push(n.parseExpression(!1,"\\\\")),n.gullet.endGroup(),n.gullet.beginGroup();var t=n.fetch().text;if(t==="&"||t==="\\\\")n.consume();else if(t==="\\end"){e[e.length-1].length===0&&e.pop();break}else throw new X("Expected \\\\ or \\cr or \\end",n.nextToken)}for(var s=[],i=[s],r=0;r<e.length;r++){for(var a=e[r],l=b5(),h=0;h<a.length;h++)if(!v5(a[h]))l.body.push(a[h]);else{s.push(l),h+=1;var c=m3(a[h]).text,u=new Array(2);if(u[0]={type:"ordgroup",mode:"math",body:[]},u[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(c)>-1))if("<>AV".indexOf(c)>-1)for(var d=0;d<2;d++){for(var f=!0,p=h+1;p<a.length;p++){if(_w(a[p],c)){f=!1,h=p;break}if(v5(a[p]))throw new X("Missing a "+c+" character to complete a CD arrow.",a[p]);u[d].body.push(a[p])}if(f)throw new X("Missing a "+c+" character to complete a CD arrow.",a[h])}else throw new X('Expected one of "<>AV=|." after @',a[h]);var w=Mw(c,u,n),y={type:"styling",body:[w],mode:"math",style:"display"};s.push(y),l=b5()}r%2===0?s.push(l):s.shift(),s=[],i.push(s)}n.gullet.endGroup(),n.gullet.endGroup();var x=new Array(i[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25});return{type:"array",mode:"math",body:i,arraystretch:1,addJot:!0,rowGaps:[null],cols:x,colSeparationType:"CD",hLinesBeforeRow:new Array(i.length+1).fill([])}}ie({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(n,e){var{parser:t,funcName:s}=n;return{type:"cdlabel",mode:t.mode,side:s.slice(4),label:e[0]}},htmlBuilder(n,e){var t=e.havingStyle(e.style.sup()),s=B.wrapFragment(Re(n.label,t,e),e);return s.classes.push("cd-label-"+n.side),s.style.bottom=Q(.8-s.depth),s.height=0,s.depth=0,s},mathmlBuilder(n,e){var t=new j.MathNode("mrow",[Ye(n.label,e)]);return t=new j.MathNode("mpadded",[t]),t.setAttribute("width","0"),n.side==="left"&&t.setAttribute("lspace","-1width"),t.setAttribute("voffset","0.7em"),t=new j.MathNode("mstyle",[t]),t.setAttribute("displaystyle","false"),t.setAttribute("scriptlevel","1"),t}});ie({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(n,e){var{parser:t}=n;return{type:"cdlabelparent",mode:t.mode,fragment:e[0]}},htmlBuilder(n,e){var t=B.wrapFragment(Re(n.fragment,e),e);return t.classes.push("cd-vert-arrow"),t},mathmlBuilder(n,e){return new j.MathNode("mrow",[Ye(n.fragment,e)])}});ie({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(n,e){for(var{parser:t}=n,s=ye(e[0],"ordgroup"),i=s.body,r="",a=0;a<i.length;a++){var l=ye(i[a],"textord");r+=l.text}var h=parseInt(r),c;if(isNaN(h))throw new X("\\@char has non-numeric argument "+r);if(h<0||h>=1114111)throw new X("\\@char with invalid code point "+r);return h<=65535?c=String.fromCharCode(h):(h-=65536,c=String.fromCharCode((h>>10)+55296,(h&1023)+56320)),{type:"textord",mode:t.mode,text:c}}});var kb=(n,e)=>{var t=Ot(n.body,e.withColor(n.color),!1);return B.makeFragment(t)},Tb=(n,e)=>{var t=Fs(n.body,e.withColor(n.color)),s=new j.MathNode("mstyle",t);return s.setAttribute("mathcolor",n.color),s};ie({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(n,e){var{parser:t}=n,s=ye(e[0],"color-token").color,i=e[1];return{type:"color",mode:t.mode,color:s,body:Et(i)}},htmlBuilder:kb,mathmlBuilder:Tb});ie({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(n,e){var{parser:t,breakOnTokenText:s}=n,i=ye(e[0],"color-token").color;t.gullet.macros.set("\\current@color",i);var r=t.parseExpression(!0,s);return{type:"color",mode:t.mode,color:i,body:r}},htmlBuilder:kb,mathmlBuilder:Tb});ie({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(n,e,t){var{parser:s}=n,i=s.gullet.future().text==="["?s.parseSizeGroup(!0):null,r=!s.settings.displayMode||!s.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:s.mode,newLine:r,size:i&&ye(i,"size").value}},htmlBuilder(n,e){var t=B.makeSpan(["mspace"],[],e);return n.newLine&&(t.classes.push("newline"),n.size&&(t.style.marginTop=Q(mt(n.size,e)))),t},mathmlBuilder(n,e){var t=new j.MathNode("mspace");return n.newLine&&(t.setAttribute("linebreak","newline"),n.size&&t.setAttribute("height",Q(mt(n.size,e)))),t}});var y4={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},Cb=n=>{var e=n.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(e))throw new X("Expected a control sequence",n);return e},Rw=n=>{var e=n.gullet.popToken();return e.text==="="&&(e=n.gullet.popToken(),e.text===" "&&(e=n.gullet.popToken())),e},Eb=(n,e,t,s)=>{var i=n.gullet.macros.get(t.text);i==null&&(t.noexpand=!0,i={tokens:[t],numArgs:0,unexpandable:!n.gullet.isExpandable(t.text)}),n.gullet.macros.set(e,i,s)};ie({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(n){var{parser:e,funcName:t}=n;e.consumeSpaces();var s=e.fetch();if(y4[s.text])return(t==="\\global"||t==="\\\\globallong")&&(s.text=y4[s.text]),ye(e.parseFunction(),"internal");throw new X("Invalid token after macro prefix",s)}});ie({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(n){var{parser:e,funcName:t}=n,s=e.gullet.popToken(),i=s.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(i))throw new X("Expected a control sequence",s);for(var r=0,a,l=[[]];e.gullet.future().text!=="{";)if(s=e.gullet.popToken(),s.text==="#"){if(e.gullet.future().text==="{"){a=e.gullet.future(),l[r].push("{");break}if(s=e.gullet.popToken(),!/^[1-9]$/.test(s.text))throw new X('Invalid argument number "'+s.text+'"');if(parseInt(s.text)!==r+1)throw new X('Argument number "'+s.text+'" out of order');r++,l.push([])}else{if(s.text==="EOF")throw new X("Expected a macro definition");l[r].push(s.text)}var{tokens:h}=e.gullet.consumeArg();return a&&h.unshift(a),(t==="\\edef"||t==="\\xdef")&&(h=e.gullet.expandTokens(h),h.reverse()),e.gullet.macros.set(i,{tokens:h,numArgs:r,delimiters:l},t===y4[t]),{type:"internal",mode:e.mode}}});ie({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(n){var{parser:e,funcName:t}=n,s=Cb(e.gullet.popToken());e.gullet.consumeSpaces();var i=Rw(e);return Eb(e,s,i,t==="\\\\globallet"),{type:"internal",mode:e.mode}}});ie({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(n){var{parser:e,funcName:t}=n,s=Cb(e.gullet.popToken()),i=e.gullet.popToken(),r=e.gullet.popToken();return Eb(e,s,r,t==="\\\\globalfuture"),e.gullet.pushToken(r),e.gullet.pushToken(i),{type:"internal",mode:e.mode}}});var vc=function(e,t,s){var i=tt.math[e]&&tt.math[e].replace,r=c3(i||e,t,s);if(!r)throw new Error("Unsupported symbol "+e+" and font size "+t+".");return r},b3=function(e,t,s,i){var r=s.havingBaseStyle(t),a=B.makeSpan(i.concat(r.sizingClasses(s)),[e],s),l=r.sizeMultiplier/s.sizeMultiplier;return a.height*=l,a.depth*=l,a.maxFontSize=r.sizeMultiplier,a},_b=function(e,t,s){var i=t.havingBaseStyle(s),r=(1-t.sizeMultiplier/i.sizeMultiplier)*t.fontMetrics().axisHeight;e.classes.push("delimcenter"),e.style.top=Q(r),e.height-=r,e.depth+=r},Pw=function(e,t,s,i,r,a){var l=B.makeSymbol(e,"Main-Regular",r,i),h=b3(l,t,i,a);return s&&_b(h,i,t),h},Lw=function(e,t,s,i){return B.makeSymbol(e,"Size"+t+"-Regular",s,i)},Mb=function(e,t,s,i,r,a){var l=Lw(e,t,r,i),h=b3(B.makeSpan(["delimsizing","size"+t],[l],i),ce.TEXT,i,a);return s&&_b(h,i,ce.TEXT),h},qg=function(e,t,s){var i;t==="Size1-Regular"?i="delim-size1":i="delim-size4";var r=B.makeSpan(["delimsizinginner",i],[B.makeSpan([],[B.makeSymbol(e,t,s)])]);return{type:"elem",elem:r}},$g=function(e,t,s){var i=Er["Size4-Regular"][e.charCodeAt(0)]?Er["Size4-Regular"][e.charCodeAt(0)][4]:Er["Size1-Regular"][e.charCodeAt(0)][4],r=new za("inner",Oy(e,Math.round(1e3*t))),a=new Dn([r],{width:Q(i),height:Q(t),style:"width:"+Q(i),viewBox:"0 0 "+1e3*i+" "+Math.round(1e3*t),preserveAspectRatio:"xMinYMin"}),l=B.makeSvgSpan([],[a],s);return l.height=t,l.style.height=Q(t),l.style.width=Q(i),{type:"elem",elem:l}},w4=.008,e1={type:"kern",size:-1*w4},Iw=["|","\\lvert","\\rvert","\\vert"],Bw=["\\|","\\lVert","\\rVert","\\Vert"],Db=function(e,t,s,i,r,a){var l,h,c,u,d="",f=0;l=c=u=e,h=null;var p="Size1-Regular";e==="\\uparrow"?c=u="⏐":e==="\\Uparrow"?c=u="‖":e==="\\downarrow"?l=c="⏐":e==="\\Downarrow"?l=c="‖":e==="\\updownarrow"?(l="\\uparrow",c="⏐",u="\\downarrow"):e==="\\Updownarrow"?(l="\\Uparrow",c="‖",u="\\Downarrow"):Iw.includes(e)?(c="∣",d="vert",f=333):Bw.includes(e)?(c="∥",d="doublevert",f=556):e==="["||e==="\\lbrack"?(l="⎡",c="⎢",u="⎣",p="Size4-Regular",d="lbrack",f=667):e==="]"||e==="\\rbrack"?(l="⎤",c="⎥",u="⎦",p="Size4-Regular",d="rbrack",f=667):e==="\\lfloor"||e==="⌊"?(c=l="⎢",u="⎣",p="Size4-Regular",d="lfloor",f=667):e==="\\lceil"||e==="⌈"?(l="⎡",c=u="⎢",p="Size4-Regular",d="lceil",f=667):e==="\\rfloor"||e==="⌋"?(c=l="⎥",u="⎦",p="Size4-Regular",d="rfloor",f=667):e==="\\rceil"||e==="⌉"?(l="⎤",c=u="⎥",p="Size4-Regular",d="rceil",f=667):e==="("||e==="\\lparen"?(l="⎛",c="⎜",u="⎝",p="Size4-Regular",d="lparen",f=875):e===")"||e==="\\rparen"?(l="⎞",c="⎟",u="⎠",p="Size4-Regular",d="rparen",f=875):e==="\\{"||e==="\\lbrace"?(l="⎧",h="⎨",u="⎩",c="⎪",p="Size4-Regular"):e==="\\}"||e==="\\rbrace"?(l="⎫",h="⎬",u="⎭",c="⎪",p="Size4-Regular"):e==="\\lgroup"||e==="⟮"?(l="⎧",u="⎩",c="⎪",p="Size4-Regular"):e==="\\rgroup"||e==="⟯"?(l="⎫",u="⎭",c="⎪",p="Size4-Regular"):e==="\\lmoustache"||e==="⎰"?(l="⎧",u="⎭",c="⎪",p="Size4-Regular"):(e==="\\rmoustache"||e==="⎱")&&(l="⎫",u="⎩",c="⎪",p="Size4-Regular");var w=vc(l,p,r),y=w.height+w.depth,x=vc(c,p,r),S=x.height+x.depth,E=vc(u,p,r),T=E.height+E.depth,_=0,M=1;if(h!==null){var D=vc(h,p,r);_=D.height+D.depth,M=2}var L=y+T+_,F=Math.max(0,Math.ceil((t-L)/(M*S))),N=L+F*M*S,W=i.fontMetrics().axisHeight;s&&(W*=i.sizeMultiplier);var $=N/2-W,q=[];if(d.length>0){var se=N-y-T,z=Math.round(N*1e3),ee=zy(d,Math.round(se*1e3)),Y=new za(d,ee),Z=(f/1e3).toFixed(3)+"em",V=(z/1e3).toFixed(3)+"em",we=new Dn([Y],{width:Z,height:V,viewBox:"0 0 "+f+" "+z}),Fe=B.makeSvgSpan([],[we],i);Fe.height=z/1e3,Fe.style.width=Z,Fe.style.height=V,q.push({type:"elem",elem:Fe})}else{if(q.push(qg(u,p,r)),q.push(e1),h===null){var st=N-y-T+2*w4;q.push($g(c,st,i))}else{var ue=(N-y-T-_)/2+2*w4;q.push($g(c,ue,i)),q.push(e1),q.push(qg(h,p,r)),q.push(e1),q.push($g(c,ue,i))}q.push(e1),q.push(qg(l,p,r))}var Ae=i.havingBaseStyle(ce.TEXT),Be=B.makeVList({positionType:"bottom",positionData:$,children:q},Ae);return b3(B.makeSpan(["delimsizing","mult"],[Be],Ae),ce.TEXT,i,a)},Gg=80,Vg=.08,jg=function(e,t,s,i,r){var a=Fy(e,i,s),l=new za(e,a),h=new Dn([l],{width:"400em",height:Q(t),viewBox:"0 0 400000 "+s,preserveAspectRatio:"xMinYMin slice"});return B.makeSvgSpan(["hide-tail"],[h],r)},Nw=function(e,t){var s=t.havingBaseSizing(),i=Ib("\\surd",e*s.sizeMultiplier,Lb,s),r=s.sizeMultiplier,a=Math.max(0,t.minRuleThickness-t.fontMetrics().sqrtRuleThickness),l,h=0,c=0,u=0,d;return i.type==="small"?(u=1e3+1e3*a+Gg,e<1?r=1:e<1.4&&(r=.7),h=(1+a+Vg)/r,c=(1+a)/r,l=jg("sqrtMain",h,u,a,t),l.style.minWidth="0.853em",d=.833/r):i.type==="large"?(u=(1e3+Gg)*$c[i.size],c=($c[i.size]+a)/r,h=($c[i.size]+a+Vg)/r,l=jg("sqrtSize"+i.size,h,u,a,t),l.style.minWidth="1.02em",d=1/r):(h=e+a+Vg,c=e+a,u=Math.floor(1e3*e+a)+Gg,l=jg("sqrtTall",h,u,a,t),l.style.minWidth="0.742em",d=1.056),l.height=c,l.style.height=Q(h),{span:l,advanceWidth:d,ruleWidth:(t.fontMetrics().sqrtRuleThickness+a)*r}},Rb=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","\\surd"],Fw=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱"],Pb=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],$c=[0,1.2,1.8,2.4,3],Ow=function(e,t,s,i,r){if(e==="<"||e==="\\lt"||e==="⟨"?e="\\langle":(e===">"||e==="\\gt"||e==="⟩")&&(e="\\rangle"),Rb.includes(e)||Pb.includes(e))return Mb(e,t,!1,s,i,r);if(Fw.includes(e))return Db(e,$c[t],!1,s,i,r);throw new X("Illegal delimiter: '"+e+"'")},zw=[{type:"small",style:ce.SCRIPTSCRIPT},{type:"small",style:ce.SCRIPT},{type:"small",style:ce.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],Hw=[{type:"small",style:ce.SCRIPTSCRIPT},{type:"small",style:ce.SCRIPT},{type:"small",style:ce.TEXT},{type:"stack"}],Lb=[{type:"small",style:ce.SCRIPTSCRIPT},{type:"small",style:ce.SCRIPT},{type:"small",style:ce.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],Uw=function(e){if(e.type==="small")return"Main-Regular";if(e.type==="large")return"Size"+e.size+"-Regular";if(e.type==="stack")return"Size4-Regular";throw new Error("Add support for delim type '"+e.type+"' here.")},Ib=function(e,t,s,i){for(var r=Math.min(2,3-i.style.size),a=r;a<s.length&&s[a].type!=="stack";a++){var l=vc(e,Uw(s[a]),"math"),h=l.height+l.depth;if(s[a].type==="small"){var c=i.havingBaseStyle(s[a].style);h*=c.sizeMultiplier}if(h>t)return s[a]}return s[s.length-1]},Bb=function(e,t,s,i,r,a){e==="<"||e==="\\lt"||e==="⟨"?e="\\langle":(e===">"||e==="\\gt"||e==="⟩")&&(e="\\rangle");var l;Pb.includes(e)?l=zw:Rb.includes(e)?l=Lb:l=Hw;var h=Ib(e,t,l,i);return h.type==="small"?Pw(e,h.style,s,i,r,a):h.type==="large"?Mb(e,h.size,s,i,r,a):Db(e,t,s,i,r,a)},qw=function(e,t,s,i,r,a){var l=i.fontMetrics().axisHeight*i.sizeMultiplier,h=901,c=5/i.fontMetrics().ptPerEm,u=Math.max(t-l,s+l),d=Math.max(u/500*h,2*u-c);return Bb(e,d,!0,i,r,a)},Mn={sqrtImage:Nw,sizedDelim:Ow,sizeToMaxHeight:$c,customSizedDelim:Bb,leftRightDelim:qw},y5={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},$w=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","<",">","\\langle","⟨","\\rangle","⟩","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function wg(n,e){var t=vg(n);if(t&&$w.includes(t.text))return t;throw t?new X("Invalid delimiter '"+t.text+"' after '"+e.funcName+"'",n):new X("Invalid delimiter type '"+n.type+"'",n)}ie({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(n,e)=>{var t=wg(e[0],n);return{type:"delimsizing",mode:n.parser.mode,size:y5[n.funcName].size,mclass:y5[n.funcName].mclass,delim:t.text}},htmlBuilder:(n,e)=>n.delim==="."?B.makeSpan([n.mclass]):Mn.sizedDelim(n.delim,n.size,e,n.mode,[n.mclass]),mathmlBuilder:n=>{var e=[];n.delim!=="."&&e.push(Mi(n.delim,n.mode));var t=new j.MathNode("mo",e);n.mclass==="mopen"||n.mclass==="mclose"?t.setAttribute("fence","true"):t.setAttribute("fence","false"),t.setAttribute("stretchy","true");var s=Q(Mn.sizeToMaxHeight[n.size]);return t.setAttribute("minsize",s),t.setAttribute("maxsize",s),t}});function w5(n){if(!n.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}ie({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(n,e)=>{var t=n.parser.gullet.macros.get("\\current@color");if(t&&typeof t!="string")throw new X("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:n.parser.mode,delim:wg(e[0],n).text,color:t}}});ie({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(n,e)=>{var t=wg(e[0],n),s=n.parser;++s.leftrightDepth;var i=s.parseExpression(!1);--s.leftrightDepth,s.expect("\\right",!1);var r=ye(s.parseFunction(),"leftright-right");return{type:"leftright",mode:s.mode,body:i,left:t.text,right:r.delim,rightColor:r.color}},htmlBuilder:(n,e)=>{w5(n);for(var t=Ot(n.body,e,!0,["mopen","mclose"]),s=0,i=0,r=!1,a=0;a<t.length;a++)t[a].isMiddle?r=!0:(s=Math.max(t[a].height,s),i=Math.max(t[a].depth,i));s*=e.sizeMultiplier,i*=e.sizeMultiplier;var l;if(n.left==="."?l=jc(e,["mopen"]):l=Mn.leftRightDelim(n.left,s,i,e,n.mode,["mopen"]),t.unshift(l),r)for(var h=1;h<t.length;h++){var c=t[h],u=c.isMiddle;u&&(t[h]=Mn.leftRightDelim(u.delim,s,i,u.options,n.mode,[]))}var d;if(n.right===".")d=jc(e,["mclose"]);else{var f=n.rightColor?e.withColor(n.rightColor):e;d=Mn.leftRightDelim(n.right,s,i,f,n.mode,["mclose"])}return t.push(d),B.makeSpan(["minner"],t,e)},mathmlBuilder:(n,e)=>{w5(n);var t=Fs(n.body,e);if(n.left!=="."){var s=new j.MathNode("mo",[Mi(n.left,n.mode)]);s.setAttribute("fence","true"),t.unshift(s)}if(n.right!=="."){var i=new j.MathNode("mo",[Mi(n.right,n.mode)]);i.setAttribute("fence","true"),n.rightColor&&i.setAttribute("mathcolor",n.rightColor),t.push(i)}return f3(t)}});ie({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(n,e)=>{var t=wg(e[0],n);if(!n.parser.leftrightDepth)throw new X("\\middle without preceding \\left",t);return{type:"middle",mode:n.parser.mode,delim:t.text}},htmlBuilder:(n,e)=>{var t;if(n.delim===".")t=jc(e,[]);else{t=Mn.sizedDelim(n.delim,1,e,n.mode,[]);var s={delim:n.delim,options:e};t.isMiddle=s}return t},mathmlBuilder:(n,e)=>{var t=n.delim==="\\vert"||n.delim==="|"?Mi("|","text"):Mi(n.delim,n.mode),s=new j.MathNode("mo",[t]);return s.setAttribute("fence","true"),s.setAttribute("lspace","0.05em"),s.setAttribute("rspace","0.05em"),s}});var v3=(n,e)=>{var t=B.wrapFragment(Re(n.body,e),e),s=n.label.slice(1),i=e.sizeMultiplier,r,a=0,l=Pe.isCharacterBox(n.body);if(s==="sout")r=B.makeSpan(["stretchy","sout"]),r.height=e.fontMetrics().defaultRuleThickness/i,a=-.5*e.fontMetrics().xHeight;else if(s==="phase"){var h=mt({number:.6,unit:"pt"},e),c=mt({number:.35,unit:"ex"},e),u=e.havingBaseSizing();i=i/u.sizeMultiplier;var d=t.height+t.depth+h+c;t.style.paddingLeft=Q(d/2+h);var f=Math.floor(1e3*d*i),p=By(f),w=new Dn([new za("phase",p)],{width:"400em",height:Q(f/1e3),viewBox:"0 0 400000 "+f,preserveAspectRatio:"xMinYMin slice"});r=B.makeSvgSpan(["hide-tail"],[w],e),r.style.height=Q(d),a=t.depth+h+c}else{/cancel/.test(s)?l||t.classes.push("cancel-pad"):s==="angl"?t.classes.push("anglpad"):t.classes.push("boxpad");var y=0,x=0,S=0;/box/.test(s)?(S=Math.max(e.fontMetrics().fboxrule,e.minRuleThickness),y=e.fontMetrics().fboxsep+(s==="colorbox"?0:S),x=y):s==="angl"?(S=Math.max(e.fontMetrics().defaultRuleThickness,e.minRuleThickness),y=4*S,x=Math.max(0,.25-t.depth)):(y=l?.2:0,x=y),r=Pn.encloseSpan(t,s,y,x,e),/fbox|boxed|fcolorbox/.test(s)?(r.style.borderStyle="solid",r.style.borderWidth=Q(S)):s==="angl"&&S!==.049&&(r.style.borderTopWidth=Q(S),r.style.borderRightWidth=Q(S)),a=t.depth+x,n.backgroundColor&&(r.style.backgroundColor=n.backgroundColor,n.borderColor&&(r.style.borderColor=n.borderColor))}var E;if(n.backgroundColor)E=B.makeVList({positionType:"individualShift",children:[{type:"elem",elem:r,shift:a},{type:"elem",elem:t,shift:0}]},e);else{var T=/cancel|phase/.test(s)?["svg-align"]:[];E=B.makeVList({positionType:"individualShift",children:[{type:"elem",elem:t,shift:0},{type:"elem",elem:r,shift:a,wrapperClasses:T}]},e)}return/cancel/.test(s)&&(E.height=t.height,E.depth=t.depth),/cancel/.test(s)&&!l?B.makeSpan(["mord","cancel-lap"],[E],e):B.makeSpan(["mord"],[E],e)},y3=(n,e)=>{var t=0,s=new j.MathNode(n.label.indexOf("colorbox")>-1?"mpadded":"menclose",[Ye(n.body,e)]);switch(n.label){case"\\cancel":s.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":s.setAttribute("notation","downdiagonalstrike");break;case"\\phase":s.setAttribute("notation","phasorangle");break;case"\\sout":s.setAttribute("notation","horizontalstrike");break;case"\\fbox":s.setAttribute("notation","box");break;case"\\angl":s.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(t=e.fontMetrics().fboxsep*e.fontMetrics().ptPerEm,s.setAttribute("width","+"+2*t+"pt"),s.setAttribute("height","+"+2*t+"pt"),s.setAttribute("lspace",t+"pt"),s.setAttribute("voffset",t+"pt"),n.label==="\\fcolorbox"){var i=Math.max(e.fontMetrics().fboxrule,e.minRuleThickness);s.setAttribute("style","border: "+i+"em solid "+String(n.borderColor))}break;case"\\xcancel":s.setAttribute("notation","updiagonalstrike downdiagonalstrike");break}return n.backgroundColor&&s.setAttribute("mathbackground",n.backgroundColor),s};ie({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(n,e,t){var{parser:s,funcName:i}=n,r=ye(e[0],"color-token").color,a=e[1];return{type:"enclose",mode:s.mode,label:i,backgroundColor:r,body:a}},htmlBuilder:v3,mathmlBuilder:y3});ie({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(n,e,t){var{parser:s,funcName:i}=n,r=ye(e[0],"color-token").color,a=ye(e[1],"color-token").color,l=e[2];return{type:"enclose",mode:s.mode,label:i,backgroundColor:a,borderColor:r,body:l}},htmlBuilder:v3,mathmlBuilder:y3});ie({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(n,e){var{parser:t}=n;return{type:"enclose",mode:t.mode,label:"\\fbox",body:e[0]}}});ie({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(n,e){var{parser:t,funcName:s}=n,i=e[0];return{type:"enclose",mode:t.mode,label:s,body:i}},htmlBuilder:v3,mathmlBuilder:y3});ie({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(n,e){var{parser:t}=n;return{type:"enclose",mode:t.mode,label:"\\angl",body:e[0]}}});var Nb={};function Pr(n){for(var{type:e,names:t,props:s,handler:i,htmlBuilder:r,mathmlBuilder:a}=n,l={type:e,numArgs:s.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:i},h=0;h<t.length;++h)Nb[t[h]]=l;r&&(ip[e]=r),a&&(rp[e]=a)}var Fb={};function C(n,e){Fb[n]=e}function A5(n){var e=[];n.consumeSpaces();var t=n.fetch().text;for(t==="\\relax"&&(n.consume(),n.consumeSpaces(),t=n.fetch().text);t==="\\hline"||t==="\\hdashline";)n.consume(),e.push(t==="\\hdashline"),n.consumeSpaces(),t=n.fetch().text;return e}var Ag=n=>{var e=n.parser.settings;if(!e.displayMode)throw new X("{"+n.envName+"} can be used only in display mode.")};function w3(n){if(n.indexOf("ed")===-1)return n.indexOf("*")===-1}function $a(n,e,t){var{hskipBeforeAndAfter:s,addJot:i,cols:r,arraystretch:a,colSeparationType:l,autoTag:h,singleRow:c,emptySingleRow:u,maxNumCols:d,leqno:f}=e;if(n.gullet.beginGroup(),c||n.gullet.macros.set("\\cr","\\\\\\relax"),!a){var p=n.gullet.expandMacroAsText("\\arraystretch");if(p==null)a=1;else if(a=parseFloat(p),!a||a<0)throw new X("Invalid \\arraystretch: "+p)}n.gullet.beginGroup();var w=[],y=[w],x=[],S=[],E=h!=null?[]:void 0;function T(){h&&n.gullet.macros.set("\\@eqnsw","1",!0)}function _(){E&&(n.gullet.macros.get("\\df@tag")?(E.push(n.subparse([new hi("\\df@tag")])),n.gullet.macros.set("\\df@tag",void 0,!0)):E.push(!!h&&n.gullet.macros.get("\\@eqnsw")==="1"))}for(T(),S.push(A5(n));;){var M=n.parseExpression(!1,c?"\\end":"\\\\");n.gullet.endGroup(),n.gullet.beginGroup(),M={type:"ordgroup",mode:n.mode,body:M},t&&(M={type:"styling",mode:n.mode,style:t,body:[M]}),w.push(M);var D=n.fetch().text;if(D==="&"){if(d&&w.length===d){if(c||l)throw new X("Too many tab characters: &",n.nextToken);n.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}n.consume()}else if(D==="\\end"){_(),w.length===1&&M.type==="styling"&&M.body[0].body.length===0&&(y.length>1||!u)&&y.pop(),S.length<y.length+1&&S.push([]);break}else if(D==="\\\\"){n.consume();var L=void 0;n.gullet.future().text!==" "&&(L=n.parseSizeGroup(!0)),x.push(L?L.value:null),_(),S.push(A5(n)),w=[],y.push(w),T()}else throw new X("Expected & or \\\\ or \\cr or \\end",n.nextToken)}return n.gullet.endGroup(),n.gullet.endGroup(),{type:"array",mode:n.mode,addJot:i,arraystretch:a,body:y,cols:r,rowGaps:x,hskipBeforeAndAfter:s,hLinesBeforeRow:S,colSeparationType:l,tags:E,leqno:f}}function A3(n){return n.slice(0,1)==="d"?"display":"text"}var Lr=function(e,t){var s,i,r=e.body.length,a=e.hLinesBeforeRow,l=0,h=new Array(r),c=[],u=Math.max(t.fontMetrics().arrayRuleWidth,t.minRuleThickness),d=1/t.fontMetrics().ptPerEm,f=5*d;if(e.colSeparationType&&e.colSeparationType==="small"){var p=t.havingStyle(ce.SCRIPT).sizeMultiplier;f=.2778*(p/t.sizeMultiplier)}var w=e.colSeparationType==="CD"?mt({number:3,unit:"ex"},t):12*d,y=3*d,x=e.arraystretch*w,S=.7*x,E=.3*x,T=0;function _(H){for(var te=0;te<H.length;++te)te>0&&(T+=.25),c.push({pos:T,isDashed:H[te]})}for(_(a[0]),s=0;s<e.body.length;++s){var M=e.body[s],D=S,L=E;l<M.length&&(l=M.length);var F=new Array(M.length);for(i=0;i<M.length;++i){var N=Re(M[i],t);L<N.depth&&(L=N.depth),D<N.height&&(D=N.height),F[i]=N}var W=e.rowGaps[s],$=0;W&&($=mt(W,t),$>0&&($+=E,L<$&&(L=$),$=0)),e.addJot&&(L+=y),F.height=D,F.depth=L,T+=D,F.pos=T,T+=L+$,h[s]=F,_(a[s+1])}var q=T/2+t.fontMetrics().axisHeight,se=e.cols||[],z=[],ee,Y,Z=[];if(e.tags&&e.tags.some(H=>H))for(s=0;s<r;++s){var V=h[s],we=V.pos-q,Fe=e.tags[s],st=void 0;Fe===!0?st=B.makeSpan(["eqn-num"],[],t):Fe===!1?st=B.makeSpan([],[],t):st=B.makeSpan([],Ot(Fe,t,!0),t),st.depth=V.depth,st.height=V.height,Z.push({type:"elem",elem:st,shift:we})}for(i=0,Y=0;i<l||Y<se.length;++i,++Y){for(var ue=se[Y]||{},Ae=!0;ue.type==="separator";){if(Ae||(ee=B.makeSpan(["arraycolsep"],[]),ee.style.width=Q(t.fontMetrics().doubleRuleSep),z.push(ee)),ue.separator==="|"||ue.separator===":"){var Be=ue.separator==="|"?"solid":"dashed",Ee=B.makeSpan(["vertical-separator"],[],t);Ee.style.height=Q(T),Ee.style.borderRightWidth=Q(u),Ee.style.borderRightStyle=Be,Ee.style.margin="0 "+Q(-u/2);var Yt=T-q;Yt&&(Ee.style.verticalAlign=Q(-Yt)),z.push(Ee)}else throw new X("Invalid separator type: "+ue.separator);Y++,ue=se[Y]||{},Ae=!1}if(!(i>=l)){var _e=void 0;(i>0||e.hskipBeforeAndAfter)&&(_e=Pe.deflt(ue.pregap,f),_e!==0&&(ee=B.makeSpan(["arraycolsep"],[]),ee.style.width=Q(_e),z.push(ee)));var ht=[];for(s=0;s<r;++s){var it=h[s],Ve=it[i];if(Ve){var Ke=it.pos-q;Ve.depth=it.depth,Ve.height=it.height,ht.push({type:"elem",elem:Ve,shift:Ke})}}ht=B.makeVList({positionType:"individualShift",children:ht},t),ht=B.makeSpan(["col-align-"+(ue.align||"c")],[ht]),z.push(ht),(i<l-1||e.hskipBeforeAndAfter)&&(_e=Pe.deflt(ue.postgap,f),_e!==0&&(ee=B.makeSpan(["arraycolsep"],[]),ee.style.width=Q(_e),z.push(ee)))}}if(h=B.makeSpan(["mtable"],z),c.length>0){for(var Ji=B.makeLineSpan("hline",t,u),Ri=B.makeLineSpan("hdashline",t,u),ns=[{type:"elem",elem:h,shift:0}];c.length>0;){var fe=c.pop(),ct=fe.pos-q;fe.isDashed?ns.push({type:"elem",elem:Ri,shift:ct}):ns.push({type:"elem",elem:Ji,shift:ct})}h=B.makeVList({positionType:"individualShift",children:ns},t)}if(Z.length===0)return B.makeSpan(["mord"],[h],t);var lc=B.makeVList({positionType:"individualShift",children:Z},t);return lc=B.makeSpan(["tag"],[lc],t),B.makeFragment([h,lc])},Gw={c:"center ",l:"left ",r:"right "},Ir=function(e,t){for(var s=[],i=new j.MathNode("mtd",[],["mtr-glue"]),r=new j.MathNode("mtd",[],["mml-eqn-num"]),a=0;a<e.body.length;a++){for(var l=e.body[a],h=[],c=0;c<l.length;c++)h.push(new j.MathNode("mtd",[Ye(l[c],t)]));e.tags&&e.tags[a]&&(h.unshift(i),h.push(i),e.leqno?h.unshift(r):h.push(r)),s.push(new j.MathNode("mtr",h))}var u=new j.MathNode("mtable",s),d=e.arraystretch===.5?.1:.16+e.arraystretch-1+(e.addJot?.09:0);u.setAttribute("rowspacing",Q(d));var f="",p="";if(e.cols&&e.cols.length>0){var w=e.cols,y="",x=!1,S=0,E=w.length;w[0].type==="separator"&&(f+="top ",S=1),w[w.length-1].type==="separator"&&(f+="bottom ",E-=1);for(var T=S;T<E;T++)w[T].type==="align"?(p+=Gw[w[T].align],x&&(y+="none "),x=!0):w[T].type==="separator"&&x&&(y+=w[T].separator==="|"?"solid ":"dashed ",x=!1);u.setAttribute("columnalign",p.trim()),/[sd]/.test(y)&&u.setAttribute("columnlines",y.trim())}if(e.colSeparationType==="align"){for(var _=e.cols||[],M="",D=1;D<_.length;D++)M+=D%2?"0em ":"1em ";u.setAttribute("columnspacing",M.trim())}else e.colSeparationType==="alignat"||e.colSeparationType==="gather"?u.setAttribute("columnspacing","0em"):e.colSeparationType==="small"?u.setAttribute("columnspacing","0.2778em"):e.colSeparationType==="CD"?u.setAttribute("columnspacing","0.5em"):u.setAttribute("columnspacing","1em");var L="",F=e.hLinesBeforeRow;f+=F[0].length>0?"left ":"",f+=F[F.length-1].length>0?"right ":"";for(var N=1;N<F.length-1;N++)L+=F[N].length===0?"none ":F[N][0]?"dashed ":"solid ";return/[sd]/.test(L)&&u.setAttribute("rowlines",L.trim()),f!==""&&(u=new j.MathNode("menclose",[u]),u.setAttribute("notation",f.trim())),e.arraystretch&&e.arraystretch<1&&(u=new j.MathNode("mstyle",[u]),u.setAttribute("scriptlevel","1")),u},Ob=function(e,t){e.envName.indexOf("ed")===-1&&Ag(e);var s=[],i=e.envName.indexOf("at")>-1?"alignat":"align",r=e.envName==="split",a=$a(e.parser,{cols:s,addJot:!0,autoTag:r?void 0:w3(e.envName),emptySingleRow:!0,colSeparationType:i,maxNumCols:r?2:void 0,leqno:e.parser.settings.leqno},"display"),l,h=0,c={type:"ordgroup",mode:e.mode,body:[]};if(t[0]&&t[0].type==="ordgroup"){for(var u="",d=0;d<t[0].body.length;d++){var f=ye(t[0].body[d],"textord");u+=f.text}l=Number(u),h=l*2}var p=!h;a.body.forEach(function(S){for(var E=1;E<S.length;E+=2){var T=ye(S[E],"styling"),_=ye(T.body[0],"ordgroup");_.body.unshift(c)}if(p)h<S.length&&(h=S.length);else{var M=S.length/2;if(l<M)throw new X("Too many math in a row: "+("expected "+l+", but got "+M),S[0])}});for(var w=0;w<h;++w){var y="r",x=0;w%2===1?y="l":w>0&&p&&(x=1),s[w]={type:"align",align:y,pregap:x,postgap:0}}return a.colSeparationType=p?"align":"alignat",a};Pr({type:"array",names:["array","darray"],props:{numArgs:1},handler(n,e){var t=vg(e[0]),s=t?[e[0]]:ye(e[0],"ordgroup").body,i=s.map(function(a){var l=m3(a),h=l.text;if("lcr".indexOf(h)!==-1)return{type:"align",align:h};if(h==="|")return{type:"separator",separator:"|"};if(h===":")return{type:"separator",separator:":"};throw new X("Unknown column alignment: "+h,a)}),r={cols:i,hskipBeforeAndAfter:!0,maxNumCols:i.length};return $a(n.parser,r,A3(n.envName))},htmlBuilder:Lr,mathmlBuilder:Ir});Pr({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(n){var e={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[n.envName.replace("*","")],t="c",s={hskipBeforeAndAfter:!1,cols:[{type:"align",align:t}]};if(n.envName.charAt(n.envName.length-1)==="*"){var i=n.parser;if(i.consumeSpaces(),i.fetch().text==="["){if(i.consume(),i.consumeSpaces(),t=i.fetch().text,"lcr".indexOf(t)===-1)throw new X("Expected l or c or r",i.nextToken);i.consume(),i.consumeSpaces(),i.expect("]"),i.consume(),s.cols=[{type:"align",align:t}]}}var r=$a(n.parser,s,A3(n.envName)),a=Math.max(0,...r.body.map(l=>l.length));return r.cols=new Array(a).fill({type:"align",align:t}),e?{type:"leftright",mode:n.mode,body:[r],left:e[0],right:e[1],rightColor:void 0}:r},htmlBuilder:Lr,mathmlBuilder:Ir});Pr({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(n){var e={arraystretch:.5},t=$a(n.parser,e,"script");return t.colSeparationType="small",t},htmlBuilder:Lr,mathmlBuilder:Ir});Pr({type:"array",names:["subarray"],props:{numArgs:1},handler(n,e){var t=vg(e[0]),s=t?[e[0]]:ye(e[0],"ordgroup").body,i=s.map(function(a){var l=m3(a),h=l.text;if("lc".indexOf(h)!==-1)return{type:"align",align:h};throw new X("Unknown column alignment: "+h,a)});if(i.length>1)throw new X("{subarray} can contain only one column");var r={cols:i,hskipBeforeAndAfter:!1,arraystretch:.5};if(r=$a(n.parser,r,"script"),r.body.length>0&&r.body[0].length>1)throw new X("{subarray} can contain only one column");return r},htmlBuilder:Lr,mathmlBuilder:Ir});Pr({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(n){var e={arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},t=$a(n.parser,e,A3(n.envName));return{type:"leftright",mode:n.mode,body:[t],left:n.envName.indexOf("r")>-1?".":"\\{",right:n.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:Lr,mathmlBuilder:Ir});Pr({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:Ob,htmlBuilder:Lr,mathmlBuilder:Ir});Pr({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(n){["gather","gather*"].includes(n.envName)&&Ag(n);var e={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:w3(n.envName),emptySingleRow:!0,leqno:n.parser.settings.leqno};return $a(n.parser,e,"display")},htmlBuilder:Lr,mathmlBuilder:Ir});Pr({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:Ob,htmlBuilder:Lr,mathmlBuilder:Ir});Pr({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(n){Ag(n);var e={autoTag:w3(n.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:n.parser.settings.leqno};return $a(n.parser,e,"display")},htmlBuilder:Lr,mathmlBuilder:Ir});Pr({type:"array",names:["CD"],props:{numArgs:0},handler(n){return Ag(n),Dw(n.parser)},htmlBuilder:Lr,mathmlBuilder:Ir});C("\\nonumber","\\gdef\\@eqnsw{0}");C("\\notag","\\nonumber");ie({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(n,e){throw new X(n.funcName+" valid only within array environment")}});var x5=Nb;ie({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(n,e){var{parser:t,funcName:s}=n,i=e[0];if(i.type!=="ordgroup")throw new X("Invalid environment name",i);for(var r="",a=0;a<i.body.length;++a)r+=ye(i.body[a],"textord").text;if(s==="\\begin"){if(!x5.hasOwnProperty(r))throw new X("No such environment: "+r,i);var l=x5[r],{args:h,optArgs:c}=t.parseArguments("\\begin{"+r+"}",l),u={mode:t.mode,envName:r,parser:t},d=l.handler(u,h,c);t.expect("\\end",!1);var f=t.nextToken,p=ye(t.parseFunction(),"environment");if(p.name!==r)throw new X("Mismatch: \\begin{"+r+"} matched by \\end{"+p.name+"}",f);return d}return{type:"environment",mode:t.mode,name:r,nameGroup:i}}});var zb=(n,e)=>{var t=n.font,s=e.withFont(t);return Re(n.body,s)},Hb=(n,e)=>{var t=n.font,s=e.withFont(t);return Ye(n.body,s)},S5={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};ie({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathsfit","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(n,e)=>{var{parser:t,funcName:s}=n,i=np(e[0]),r=s;return r in S5&&(r=S5[r]),{type:"font",mode:t.mode,font:r.slice(1),body:i}},htmlBuilder:zb,mathmlBuilder:Hb});ie({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(n,e)=>{var{parser:t}=n,s=e[0],i=Pe.isCharacterBox(s);return{type:"mclass",mode:t.mode,mclass:yg(s),body:[{type:"font",mode:t.mode,font:"boldsymbol",body:s}],isCharacterBox:i}}});ie({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(n,e)=>{var{parser:t,funcName:s,breakOnTokenText:i}=n,{mode:r}=t,a=t.parseExpression(!0,i),l="math"+s.slice(1);return{type:"font",mode:r,font:l,body:{type:"ordgroup",mode:t.mode,body:a}}},htmlBuilder:zb,mathmlBuilder:Hb});var Ub=(n,e)=>{var t=e;return n==="display"?t=t.id>=ce.SCRIPT.id?t.text():ce.DISPLAY:n==="text"&&t.size===ce.DISPLAY.size?t=ce.TEXT:n==="script"?t=ce.SCRIPT:n==="scriptscript"&&(t=ce.SCRIPTSCRIPT),t},x3=(n,e)=>{var t=Ub(n.size,e.style),s=t.fracNum(),i=t.fracDen(),r;r=e.havingStyle(s);var a=Re(n.numer,r,e);if(n.continued){var l=8.5/e.fontMetrics().ptPerEm,h=3.5/e.fontMetrics().ptPerEm;a.height=a.height<l?l:a.height,a.depth=a.depth<h?h:a.depth}r=e.havingStyle(i);var c=Re(n.denom,r,e),u,d,f;n.hasBarLine?(n.barSize?(d=mt(n.barSize,e),u=B.makeLineSpan("frac-line",e,d)):u=B.makeLineSpan("frac-line",e),d=u.height,f=u.height):(u=null,d=0,f=e.fontMetrics().defaultRuleThickness);var p,w,y;t.size===ce.DISPLAY.size||n.size==="display"?(p=e.fontMetrics().num1,d>0?w=3*f:w=7*f,y=e.fontMetrics().denom1):(d>0?(p=e.fontMetrics().num2,w=f):(p=e.fontMetrics().num3,w=3*f),y=e.fontMetrics().denom2);var x;if(u){var E=e.fontMetrics().axisHeight;p-a.depth-(E+.5*d)<w&&(p+=w-(p-a.depth-(E+.5*d))),E-.5*d-(c.height-y)<w&&(y+=w-(E-.5*d-(c.height-y)));var T=-(E-.5*d);x=B.makeVList({positionType:"individualShift",children:[{type:"elem",elem:c,shift:y},{type:"elem",elem:u,shift:T},{type:"elem",elem:a,shift:-p}]},e)}else{var S=p-a.depth-(c.height-y);S<w&&(p+=.5*(w-S),y+=.5*(w-S)),x=B.makeVList({positionType:"individualShift",children:[{type:"elem",elem:c,shift:y},{type:"elem",elem:a,shift:-p}]},e)}r=e.havingStyle(t),x.height*=r.sizeMultiplier/e.sizeMultiplier,x.depth*=r.sizeMultiplier/e.sizeMultiplier;var _;t.size===ce.DISPLAY.size?_=e.fontMetrics().delim1:t.size===ce.SCRIPTSCRIPT.size?_=e.havingStyle(ce.SCRIPT).fontMetrics().delim2:_=e.fontMetrics().delim2;var M,D;return n.leftDelim==null?M=jc(e,["mopen"]):M=Mn.customSizedDelim(n.leftDelim,_,!0,e.havingStyle(t),n.mode,["mopen"]),n.continued?D=B.makeSpan([]):n.rightDelim==null?D=jc(e,["mclose"]):D=Mn.customSizedDelim(n.rightDelim,_,!0,e.havingStyle(t),n.mode,["mclose"]),B.makeSpan(["mord"].concat(r.sizingClasses(e)),[M,B.makeSpan(["mfrac"],[x]),D],e)},S3=(n,e)=>{var t=new j.MathNode("mfrac",[Ye(n.numer,e),Ye(n.denom,e)]);if(!n.hasBarLine)t.setAttribute("linethickness","0px");else if(n.barSize){var s=mt(n.barSize,e);t.setAttribute("linethickness",Q(s))}var i=Ub(n.size,e.style);if(i.size!==e.style.size){t=new j.MathNode("mstyle",[t]);var r=i.size===ce.DISPLAY.size?"true":"false";t.setAttribute("displaystyle",r),t.setAttribute("scriptlevel","0")}if(n.leftDelim!=null||n.rightDelim!=null){var a=[];if(n.leftDelim!=null){var l=new j.MathNode("mo",[new j.TextNode(n.leftDelim.replace("\\",""))]);l.setAttribute("fence","true"),a.push(l)}if(a.push(t),n.rightDelim!=null){var h=new j.MathNode("mo",[new j.TextNode(n.rightDelim.replace("\\",""))]);h.setAttribute("fence","true"),a.push(h)}return f3(a)}return t};ie({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(n,e)=>{var{parser:t,funcName:s}=n,i=e[0],r=e[1],a,l=null,h=null,c="auto";switch(s){case"\\dfrac":case"\\frac":case"\\tfrac":a=!0;break;case"\\\\atopfrac":a=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":a=!1,l="(",h=")";break;case"\\\\bracefrac":a=!1,l="\\{",h="\\}";break;case"\\\\brackfrac":a=!1,l="[",h="]";break;default:throw new Error("Unrecognized genfrac command")}switch(s){case"\\dfrac":case"\\dbinom":c="display";break;case"\\tfrac":case"\\tbinom":c="text";break}return{type:"genfrac",mode:t.mode,continued:!1,numer:i,denom:r,hasBarLine:a,leftDelim:l,rightDelim:h,size:c,barSize:null}},htmlBuilder:x3,mathmlBuilder:S3});ie({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(n,e)=>{var{parser:t,funcName:s}=n,i=e[0],r=e[1];return{type:"genfrac",mode:t.mode,continued:!0,numer:i,denom:r,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}});ie({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(n){var{parser:e,funcName:t,token:s}=n,i;switch(t){case"\\over":i="\\frac";break;case"\\choose":i="\\binom";break;case"\\atop":i="\\\\atopfrac";break;case"\\brace":i="\\\\bracefrac";break;case"\\brack":i="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:e.mode,replaceWith:i,token:s}}});var k5=["display","text","script","scriptscript"],T5=function(e){var t=null;return e.length>0&&(t=e,t=t==="."?null:t),t};ie({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(n,e){var{parser:t}=n,s=e[4],i=e[5],r=np(e[0]),a=r.type==="atom"&&r.family==="open"?T5(r.text):null,l=np(e[1]),h=l.type==="atom"&&l.family==="close"?T5(l.text):null,c=ye(e[2],"size"),u,d=null;c.isBlank?u=!0:(d=c.value,u=d.number>0);var f="auto",p=e[3];if(p.type==="ordgroup"){if(p.body.length>0){var w=ye(p.body[0],"textord");f=k5[Number(w.text)]}}else p=ye(p,"textord"),f=k5[Number(p.text)];return{type:"genfrac",mode:t.mode,numer:s,denom:i,continued:!1,hasBarLine:u,barSize:d,leftDelim:a,rightDelim:h,size:f}},htmlBuilder:x3,mathmlBuilder:S3});ie({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(n,e){var{parser:t,funcName:s,token:i}=n;return{type:"infix",mode:t.mode,replaceWith:"\\\\abovefrac",size:ye(e[0],"size").value,token:i}}});ie({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(n,e)=>{var{parser:t,funcName:s}=n,i=e[0],r=wy(ye(e[1],"infix").size),a=e[2],l=r.number>0;return{type:"genfrac",mode:t.mode,numer:i,denom:a,continued:!1,hasBarLine:l,barSize:r,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:x3,mathmlBuilder:S3});var qb=(n,e)=>{var t=e.style,s,i;n.type==="supsub"?(s=n.sup?Re(n.sup,e.havingStyle(t.sup()),e):Re(n.sub,e.havingStyle(t.sub()),e),i=ye(n.base,"horizBrace")):i=ye(n,"horizBrace");var r=Re(i.base,e.havingBaseStyle(ce.DISPLAY)),a=Pn.svgSpan(i,e),l;if(i.isOver?(l=B.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r},{type:"kern",size:.1},{type:"elem",elem:a}]},e),l.children[0].children[0].children[1].classes.push("svg-align")):(l=B.makeVList({positionType:"bottom",positionData:r.depth+.1+a.height,children:[{type:"elem",elem:a},{type:"kern",size:.1},{type:"elem",elem:r}]},e),l.children[0].children[0].children[0].classes.push("svg-align")),s){var h=B.makeSpan(["mord",i.isOver?"mover":"munder"],[l],e);i.isOver?l=B.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:h},{type:"kern",size:.2},{type:"elem",elem:s}]},e):l=B.makeVList({positionType:"bottom",positionData:h.depth+.2+s.height+s.depth,children:[{type:"elem",elem:s},{type:"kern",size:.2},{type:"elem",elem:h}]},e)}return B.makeSpan(["mord",i.isOver?"mover":"munder"],[l],e)},Vw=(n,e)=>{var t=Pn.mathMLnode(n.label);return new j.MathNode(n.isOver?"mover":"munder",[Ye(n.base,e),t])};ie({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(n,e){var{parser:t,funcName:s}=n;return{type:"horizBrace",mode:t.mode,label:s,isOver:/^\\over/.test(s),base:e[0]}},htmlBuilder:qb,mathmlBuilder:Vw});ie({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(n,e)=>{var{parser:t}=n,s=e[1],i=ye(e[0],"url").url;return t.settings.isTrusted({command:"\\href",url:i})?{type:"href",mode:t.mode,href:i,body:Et(s)}:t.formatUnsupportedCmd("\\href")},htmlBuilder:(n,e)=>{var t=Ot(n.body,e,!1);return B.makeAnchor(n.href,[],t,e)},mathmlBuilder:(n,e)=>{var t=Ha(n.body,e);return t instanceof li||(t=new li("mrow",[t])),t.setAttribute("href",n.href),t}});ie({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(n,e)=>{var{parser:t}=n,s=ye(e[0],"url").url;if(!t.settings.isTrusted({command:"\\url",url:s}))return t.formatUnsupportedCmd("\\url");for(var i=[],r=0;r<s.length;r++){var a=s[r];a==="~"&&(a="\\textasciitilde"),i.push({type:"textord",mode:"text",text:a})}var l={type:"text",mode:t.mode,font:"\\texttt",body:i};return{type:"href",mode:t.mode,href:s,body:Et(l)}}});ie({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(n,e){var{parser:t}=n;return{type:"hbox",mode:t.mode,body:Et(e[0])}},htmlBuilder(n,e){var t=Ot(n.body,e,!1);return B.makeFragment(t)},mathmlBuilder(n,e){return new j.MathNode("mrow",Fs(n.body,e))}});ie({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(n,e)=>{var{parser:t,funcName:s,token:i}=n,r=ye(e[0],"raw").string,a=e[1];t.settings.strict&&t.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var l,h={};switch(s){case"\\htmlClass":h.class=r,l={command:"\\htmlClass",class:r};break;case"\\htmlId":h.id=r,l={command:"\\htmlId",id:r};break;case"\\htmlStyle":h.style=r,l={command:"\\htmlStyle",style:r};break;case"\\htmlData":{for(var c=r.split(","),u=0;u<c.length;u++){var d=c[u].split("=");if(d.length!==2)throw new X("Error parsing key-value for \\htmlData");h["data-"+d[0].trim()]=d[1].trim()}l={command:"\\htmlData",attributes:h};break}default:throw new Error("Unrecognized html command")}return t.settings.isTrusted(l)?{type:"html",mode:t.mode,attributes:h,body:Et(a)}:t.formatUnsupportedCmd(s)},htmlBuilder:(n,e)=>{var t=Ot(n.body,e,!1),s=["enclosing"];n.attributes.class&&s.push(...n.attributes.class.trim().split(/\s+/));var i=B.makeSpan(s,t,e);for(var r in n.attributes)r!=="class"&&n.attributes.hasOwnProperty(r)&&i.setAttribute(r,n.attributes[r]);return i},mathmlBuilder:(n,e)=>Ha(n.body,e)});ie({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(n,e)=>{var{parser:t}=n;return{type:"htmlmathml",mode:t.mode,html:Et(e[0]),mathml:Et(e[1])}},htmlBuilder:(n,e)=>{var t=Ot(n.html,e,!1);return B.makeFragment(t)},mathmlBuilder:(n,e)=>Ha(n.mathml,e)});var Wg=function(e){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(e))return{number:+e,unit:"bp"};var t=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(e);if(!t)throw new X("Invalid size: '"+e+"' in \\includegraphics");var s={number:+(t[1]+t[2]),unit:t[3]};if(!ob(s))throw new X("Invalid unit: '"+s.unit+"' in \\includegraphics.");return s};ie({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(n,e,t)=>{var{parser:s}=n,i={number:0,unit:"em"},r={number:.9,unit:"em"},a={number:0,unit:"em"},l="";if(t[0])for(var h=ye(t[0],"raw").string,c=h.split(","),u=0;u<c.length;u++){var d=c[u].split("=");if(d.length===2){var f=d[1].trim();switch(d[0].trim()){case"alt":l=f;break;case"width":i=Wg(f);break;case"height":r=Wg(f);break;case"totalheight":a=Wg(f);break;default:throw new X("Invalid key: '"+d[0]+"' in \\includegraphics.")}}}var p=ye(e[0],"url").url;return l===""&&(l=p,l=l.replace(/^.*[\\/]/,""),l=l.substring(0,l.lastIndexOf("."))),s.settings.isTrusted({command:"\\includegraphics",url:p})?{type:"includegraphics",mode:s.mode,alt:l,width:i,height:r,totalheight:a,src:p}:s.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(n,e)=>{var t=mt(n.height,e),s=0;n.totalheight.number>0&&(s=mt(n.totalheight,e)-t);var i=0;n.width.number>0&&(i=mt(n.width,e));var r={height:Q(t+s)};i>0&&(r.width=Q(i)),s>0&&(r.verticalAlign=Q(-s));var a=new Vy(n.src,n.alt,r);return a.height=t,a.depth=s,a},mathmlBuilder:(n,e)=>{var t=new j.MathNode("mglyph",[]);t.setAttribute("alt",n.alt);var s=mt(n.height,e),i=0;if(n.totalheight.number>0&&(i=mt(n.totalheight,e)-s,t.setAttribute("valign",Q(-i))),t.setAttribute("height",Q(s+i)),n.width.number>0){var r=mt(n.width,e);t.setAttribute("width",Q(r))}return t.setAttribute("src",n.src),t}});ie({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(n,e){var{parser:t,funcName:s}=n,i=ye(e[0],"size");if(t.settings.strict){var r=s[1]==="m",a=i.value.unit==="mu";r?(a||t.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+s+" supports only mu units, "+("not "+i.value.unit+" units")),t.mode!=="math"&&t.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+s+" works only in math mode")):a&&t.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+s+" doesn't support mu units")}return{type:"kern",mode:t.mode,dimension:i.value}},htmlBuilder(n,e){return B.makeGlue(n.dimension,e)},mathmlBuilder(n,e){var t=mt(n.dimension,e);return new j.SpaceNode(t)}});ie({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(n,e)=>{var{parser:t,funcName:s}=n,i=e[0];return{type:"lap",mode:t.mode,alignment:s.slice(5),body:i}},htmlBuilder:(n,e)=>{var t;n.alignment==="clap"?(t=B.makeSpan([],[Re(n.body,e)]),t=B.makeSpan(["inner"],[t],e)):t=B.makeSpan(["inner"],[Re(n.body,e)]);var s=B.makeSpan(["fix"],[]),i=B.makeSpan([n.alignment],[t,s],e),r=B.makeSpan(["strut"]);return r.style.height=Q(i.height+i.depth),i.depth&&(r.style.verticalAlign=Q(-i.depth)),i.children.unshift(r),i=B.makeSpan(["thinbox"],[i],e),B.makeSpan(["mord","vbox"],[i],e)},mathmlBuilder:(n,e)=>{var t=new j.MathNode("mpadded",[Ye(n.body,e)]);if(n.alignment!=="rlap"){var s=n.alignment==="llap"?"-1":"-0.5";t.setAttribute("lspace",s+"width")}return t.setAttribute("width","0px"),t}});ie({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(n,e){var{funcName:t,parser:s}=n,i=s.mode;s.switchMode("math");var r=t==="\\("?"\\)":"$",a=s.parseExpression(!1,r);return s.expect(r),s.switchMode(i),{type:"styling",mode:s.mode,style:"text",body:a}}});ie({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(n,e){throw new X("Mismatched "+n.funcName)}});var C5=(n,e)=>{switch(e.style.size){case ce.DISPLAY.size:return n.display;case ce.TEXT.size:return n.text;case ce.SCRIPT.size:return n.script;case ce.SCRIPTSCRIPT.size:return n.scriptscript;default:return n.text}};ie({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(n,e)=>{var{parser:t}=n;return{type:"mathchoice",mode:t.mode,display:Et(e[0]),text:Et(e[1]),script:Et(e[2]),scriptscript:Et(e[3])}},htmlBuilder:(n,e)=>{var t=C5(n,e),s=Ot(t,e,!1);return B.makeFragment(s)},mathmlBuilder:(n,e)=>{var t=C5(n,e);return Ha(t,e)}});var $b=(n,e,t,s,i,r,a)=>{n=B.makeSpan([],[n]);var l=t&&Pe.isCharacterBox(t),h,c;if(e){var u=Re(e,s.havingStyle(i.sup()),s);c={elem:u,kern:Math.max(s.fontMetrics().bigOpSpacing1,s.fontMetrics().bigOpSpacing3-u.depth)}}if(t){var d=Re(t,s.havingStyle(i.sub()),s);h={elem:d,kern:Math.max(s.fontMetrics().bigOpSpacing2,s.fontMetrics().bigOpSpacing4-d.height)}}var f;if(c&&h){var p=s.fontMetrics().bigOpSpacing5+h.elem.height+h.elem.depth+h.kern+n.depth+a;f=B.makeVList({positionType:"bottom",positionData:p,children:[{type:"kern",size:s.fontMetrics().bigOpSpacing5},{type:"elem",elem:h.elem,marginLeft:Q(-r)},{type:"kern",size:h.kern},{type:"elem",elem:n},{type:"kern",size:c.kern},{type:"elem",elem:c.elem,marginLeft:Q(r)},{type:"kern",size:s.fontMetrics().bigOpSpacing5}]},s)}else if(h){var w=n.height-a;f=B.makeVList({positionType:"top",positionData:w,children:[{type:"kern",size:s.fontMetrics().bigOpSpacing5},{type:"elem",elem:h.elem,marginLeft:Q(-r)},{type:"kern",size:h.kern},{type:"elem",elem:n}]},s)}else if(c){var y=n.depth+a;f=B.makeVList({positionType:"bottom",positionData:y,children:[{type:"elem",elem:n},{type:"kern",size:c.kern},{type:"elem",elem:c.elem,marginLeft:Q(r)},{type:"kern",size:s.fontMetrics().bigOpSpacing5}]},s)}else return n;var x=[f];if(h&&r!==0&&!l){var S=B.makeSpan(["mspace"],[],s);S.style.marginRight=Q(r),x.unshift(S)}return B.makeSpan(["mop","op-limits"],x,s)},Gb=["\\smallint"],oc=(n,e)=>{var t,s,i=!1,r;n.type==="supsub"?(t=n.sup,s=n.sub,r=ye(n.base,"op"),i=!0):r=ye(n,"op");var a=e.style,l=!1;a.size===ce.DISPLAY.size&&r.symbol&&!Gb.includes(r.name)&&(l=!0);var h;if(r.symbol){var c=l?"Size2-Regular":"Size1-Regular",u="";if((r.name==="\\oiint"||r.name==="\\oiiint")&&(u=r.name.slice(1),r.name=u==="oiint"?"\\iint":"\\iiint"),h=B.makeSymbol(r.name,c,"math",e,["mop","op-symbol",l?"large-op":"small-op"]),u.length>0){var d=h.italic,f=B.staticSvg(u+"Size"+(l?"2":"1"),e);h=B.makeVList({positionType:"individualShift",children:[{type:"elem",elem:h,shift:0},{type:"elem",elem:f,shift:l?.08:0}]},e),r.name="\\"+u,h.classes.unshift("mop"),h.italic=d}}else if(r.body){var p=Ot(r.body,e,!0);p.length===1&&p[0]instanceof _i?(h=p[0],h.classes[0]="mop"):h=B.makeSpan(["mop"],p,e)}else{for(var w=[],y=1;y<r.name.length;y++)w.push(B.mathsym(r.name[y],r.mode,e));h=B.makeSpan(["mop"],w,e)}var x=0,S=0;return(h instanceof _i||r.name==="\\oiint"||r.name==="\\oiiint")&&!r.suppressBaseShift&&(x=(h.height-h.depth)/2-e.fontMetrics().axisHeight,S=h.italic),i?$b(h,t,s,e,a,S,x):(x&&(h.style.position="relative",h.style.top=Q(x)),h)},Ff=(n,e)=>{var t;if(n.symbol)t=new li("mo",[Mi(n.name,n.mode)]),Gb.includes(n.name)&&t.setAttribute("largeop","false");else if(n.body)t=new li("mo",Fs(n.body,e));else{t=new li("mi",[new _r(n.name.slice(1))]);var s=new li("mo",[Mi("⁡","text")]);n.parentIsSupSub?t=new li("mrow",[t,s]):t=vb([t,s])}return t},jw={"∏":"\\prod","∐":"\\coprod","∑":"\\sum","⋀":"\\bigwedge","⋁":"\\bigvee","⋂":"\\bigcap","⋃":"\\bigcup","⨀":"\\bigodot","⨁":"\\bigoplus","⨂":"\\bigotimes","⨄":"\\biguplus","⨆":"\\bigsqcup"};ie({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨄","⨆"],props:{numArgs:0},handler:(n,e)=>{var{parser:t,funcName:s}=n,i=s;return i.length===1&&(i=jw[i]),{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:i}},htmlBuilder:oc,mathmlBuilder:Ff});ie({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(n,e)=>{var{parser:t}=n,s=e[0];return{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:Et(s)}},htmlBuilder:oc,mathmlBuilder:Ff});var Ww={"∫":"\\int","∬":"\\iint","∭":"\\iiint","∮":"\\oint","∯":"\\oiint","∰":"\\oiiint"};ie({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(n){var{parser:e,funcName:t}=n;return{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:t}},htmlBuilder:oc,mathmlBuilder:Ff});ie({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(n){var{parser:e,funcName:t}=n;return{type:"op",mode:e.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:t}},htmlBuilder:oc,mathmlBuilder:Ff});ie({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","∫","∬","∭","∮","∯","∰"],props:{numArgs:0},handler(n){var{parser:e,funcName:t}=n,s=t;return s.length===1&&(s=Ww[s]),{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:s}},htmlBuilder:oc,mathmlBuilder:Ff});var Vb=(n,e)=>{var t,s,i=!1,r;n.type==="supsub"?(t=n.sup,s=n.sub,r=ye(n.base,"operatorname"),i=!0):r=ye(n,"operatorname");var a;if(r.body.length>0){for(var l=r.body.map(d=>{var f=d.text;return typeof f=="string"?{type:"textord",mode:d.mode,text:f}:d}),h=Ot(l,e.withFont("mathrm"),!0),c=0;c<h.length;c++){var u=h[c];u instanceof _i&&(u.text=u.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}a=B.makeSpan(["mop"],h,e)}else a=B.makeSpan(["mop"],[],e);return i?$b(a,t,s,e,e.style,0,0):a},Xw=(n,e)=>{for(var t=Fs(n.body,e.withFont("mathrm")),s=!0,i=0;i<t.length;i++){var r=t[i];if(!(r instanceof j.SpaceNode))if(r instanceof j.MathNode)switch(r.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":{var a=r.children[0];r.children.length===1&&a instanceof j.TextNode?a.text=a.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):s=!1;break}default:s=!1}else s=!1}if(s){var l=t.map(u=>u.toText()).join("");t=[new j.TextNode(l)]}var h=new j.MathNode("mi",t);h.setAttribute("mathvariant","normal");var c=new j.MathNode("mo",[Mi("⁡","text")]);return n.parentIsSupSub?new j.MathNode("mrow",[h,c]):j.newDocumentFragment([h,c])};ie({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(n,e)=>{var{parser:t,funcName:s}=n,i=e[0];return{type:"operatorname",mode:t.mode,body:Et(i),alwaysHandleSupSub:s==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1}},htmlBuilder:Vb,mathmlBuilder:Xw});C("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@");Bl({type:"ordgroup",htmlBuilder(n,e){return n.semisimple?B.makeFragment(Ot(n.body,e,!1)):B.makeSpan(["mord"],Ot(n.body,e,!0),e)},mathmlBuilder(n,e){return Ha(n.body,e,!0)}});ie({type:"overline",names:["\\overline"],props:{numArgs:1},handler(n,e){var{parser:t}=n,s=e[0];return{type:"overline",mode:t.mode,body:s}},htmlBuilder(n,e){var t=Re(n.body,e.havingCrampedStyle()),s=B.makeLineSpan("overline-line",e),i=e.fontMetrics().defaultRuleThickness,r=B.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t},{type:"kern",size:3*i},{type:"elem",elem:s},{type:"kern",size:i}]},e);return B.makeSpan(["mord","overline"],[r],e)},mathmlBuilder(n,e){var t=new j.MathNode("mo",[new j.TextNode("‾")]);t.setAttribute("stretchy","true");var s=new j.MathNode("mover",[Ye(n.body,e),t]);return s.setAttribute("accent","true"),s}});ie({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(n,e)=>{var{parser:t}=n,s=e[0];return{type:"phantom",mode:t.mode,body:Et(s)}},htmlBuilder:(n,e)=>{var t=Ot(n.body,e.withPhantom(),!1);return B.makeFragment(t)},mathmlBuilder:(n,e)=>{var t=Fs(n.body,e);return new j.MathNode("mphantom",t)}});ie({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(n,e)=>{var{parser:t}=n,s=e[0];return{type:"hphantom",mode:t.mode,body:s}},htmlBuilder:(n,e)=>{var t=B.makeSpan([],[Re(n.body,e.withPhantom())]);if(t.height=0,t.depth=0,t.children)for(var s=0;s<t.children.length;s++)t.children[s].height=0,t.children[s].depth=0;return t=B.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t}]},e),B.makeSpan(["mord"],[t],e)},mathmlBuilder:(n,e)=>{var t=Fs(Et(n.body),e),s=new j.MathNode("mphantom",t),i=new j.MathNode("mpadded",[s]);return i.setAttribute("height","0px"),i.setAttribute("depth","0px"),i}});ie({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(n,e)=>{var{parser:t}=n,s=e[0];return{type:"vphantom",mode:t.mode,body:s}},htmlBuilder:(n,e)=>{var t=B.makeSpan(["inner"],[Re(n.body,e.withPhantom())]),s=B.makeSpan(["fix"],[]);return B.makeSpan(["mord","rlap"],[t,s],e)},mathmlBuilder:(n,e)=>{var t=Fs(Et(n.body),e),s=new j.MathNode("mphantom",t),i=new j.MathNode("mpadded",[s]);return i.setAttribute("width","0px"),i}});ie({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(n,e){var{parser:t}=n,s=ye(e[0],"size").value,i=e[1];return{type:"raisebox",mode:t.mode,dy:s,body:i}},htmlBuilder(n,e){var t=Re(n.body,e),s=mt(n.dy,e);return B.makeVList({positionType:"shift",positionData:-s,children:[{type:"elem",elem:t}]},e)},mathmlBuilder(n,e){var t=new j.MathNode("mpadded",[Ye(n.body,e)]),s=n.dy.number+n.dy.unit;return t.setAttribute("voffset",s),t}});ie({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0,allowedInArgument:!0},handler(n){var{parser:e}=n;return{type:"internal",mode:e.mode}}});ie({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["size","size","size"]},handler(n,e,t){var{parser:s}=n,i=t[0],r=ye(e[0],"size"),a=ye(e[1],"size");return{type:"rule",mode:s.mode,shift:i&&ye(i,"size").value,width:r.value,height:a.value}},htmlBuilder(n,e){var t=B.makeSpan(["mord","rule"],[],e),s=mt(n.width,e),i=mt(n.height,e),r=n.shift?mt(n.shift,e):0;return t.style.borderRightWidth=Q(s),t.style.borderTopWidth=Q(i),t.style.bottom=Q(r),t.width=s,t.height=i+r,t.depth=-r,t.maxFontSize=i*1.125*e.sizeMultiplier,t},mathmlBuilder(n,e){var t=mt(n.width,e),s=mt(n.height,e),i=n.shift?mt(n.shift,e):0,r=e.color&&e.getColor()||"black",a=new j.MathNode("mspace");a.setAttribute("mathbackground",r),a.setAttribute("width",Q(t)),a.setAttribute("height",Q(s));var l=new j.MathNode("mpadded",[a]);return i>=0?l.setAttribute("height",Q(i)):(l.setAttribute("height",Q(i)),l.setAttribute("depth",Q(-i))),l.setAttribute("voffset",Q(i)),l}});function jb(n,e,t){for(var s=Ot(n,e,!1),i=e.sizeMultiplier/t.sizeMultiplier,r=0;r<s.length;r++){var a=s[r].classes.indexOf("sizing");a<0?Array.prototype.push.apply(s[r].classes,e.sizingClasses(t)):s[r].classes[a+1]==="reset-size"+e.size&&(s[r].classes[a+1]="reset-size"+t.size),s[r].height*=i,s[r].depth*=i}return B.makeFragment(s)}var E5=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],Yw=(n,e)=>{var t=e.havingSize(n.size);return jb(n.body,t,e)};ie({type:"sizing",names:E5,props:{numArgs:0,allowedInText:!0},handler:(n,e)=>{var{breakOnTokenText:t,funcName:s,parser:i}=n,r=i.parseExpression(!1,t);return{type:"sizing",mode:i.mode,size:E5.indexOf(s)+1,body:r}},htmlBuilder:Yw,mathmlBuilder:(n,e)=>{var t=e.havingSize(n.size),s=Fs(n.body,t),i=new j.MathNode("mstyle",s);return i.setAttribute("mathsize",Q(t.sizeMultiplier)),i}});ie({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(n,e,t)=>{var{parser:s}=n,i=!1,r=!1,a=t[0]&&ye(t[0],"ordgroup");if(a)for(var l="",h=0;h<a.body.length;++h){var c=a.body[h];if(l=c.text,l==="t")i=!0;else if(l==="b")r=!0;else{i=!1,r=!1;break}}else i=!0,r=!0;var u=e[0];return{type:"smash",mode:s.mode,body:u,smashHeight:i,smashDepth:r}},htmlBuilder:(n,e)=>{var t=B.makeSpan([],[Re(n.body,e)]);if(!n.smashHeight&&!n.smashDepth)return t;if(n.smashHeight&&(t.height=0,t.children))for(var s=0;s<t.children.length;s++)t.children[s].height=0;if(n.smashDepth&&(t.depth=0,t.children))for(var i=0;i<t.children.length;i++)t.children[i].depth=0;var r=B.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t}]},e);return B.makeSpan(["mord"],[r],e)},mathmlBuilder:(n,e)=>{var t=new j.MathNode("mpadded",[Ye(n.body,e)]);return n.smashHeight&&t.setAttribute("height","0px"),n.smashDepth&&t.setAttribute("depth","0px"),t}});ie({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(n,e,t){var{parser:s}=n,i=t[0],r=e[0];return{type:"sqrt",mode:s.mode,body:r,index:i}},htmlBuilder(n,e){var t=Re(n.body,e.havingCrampedStyle());t.height===0&&(t.height=e.fontMetrics().xHeight),t=B.wrapFragment(t,e);var s=e.fontMetrics(),i=s.defaultRuleThickness,r=i;e.style.id<ce.TEXT.id&&(r=e.fontMetrics().xHeight);var a=i+r/4,l=t.height+t.depth+a+i,{span:h,ruleWidth:c,advanceWidth:u}=Mn.sqrtImage(l,e),d=h.height-c;d>t.height+t.depth+a&&(a=(a+d-t.height-t.depth)/2);var f=h.height-t.height-a-c;t.style.paddingLeft=Q(u);var p=B.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t,wrapperClasses:["svg-align"]},{type:"kern",size:-(t.height+f)},{type:"elem",elem:h},{type:"kern",size:c}]},e);if(n.index){var w=e.havingStyle(ce.SCRIPTSCRIPT),y=Re(n.index,w,e),x=.6*(p.height-p.depth),S=B.makeVList({positionType:"shift",positionData:-x,children:[{type:"elem",elem:y}]},e),E=B.makeSpan(["root"],[S]);return B.makeSpan(["mord","sqrt"],[E,p],e)}else return B.makeSpan(["mord","sqrt"],[p],e)},mathmlBuilder(n,e){var{body:t,index:s}=n;return s?new j.MathNode("mroot",[Ye(t,e),Ye(s,e)]):new j.MathNode("msqrt",[Ye(t,e)])}});var _5={display:ce.DISPLAY,text:ce.TEXT,script:ce.SCRIPT,scriptscript:ce.SCRIPTSCRIPT};ie({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(n,e){var{breakOnTokenText:t,funcName:s,parser:i}=n,r=i.parseExpression(!0,t),a=s.slice(1,s.length-5);return{type:"styling",mode:i.mode,style:a,body:r}},htmlBuilder(n,e){var t=_5[n.style],s=e.havingStyle(t).withFont("");return jb(n.body,s,e)},mathmlBuilder(n,e){var t=_5[n.style],s=e.havingStyle(t),i=Fs(n.body,s),r=new j.MathNode("mstyle",i),a={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]},l=a[n.style];return r.setAttribute("scriptlevel",l[0]),r.setAttribute("displaystyle",l[1]),r}});var Kw=function(e,t){var s=e.base;if(s)if(s.type==="op"){var i=s.limits&&(t.style.size===ce.DISPLAY.size||s.alwaysHandleSupSub);return i?oc:null}else if(s.type==="operatorname"){var r=s.alwaysHandleSupSub&&(t.style.size===ce.DISPLAY.size||s.limits);return r?Vb:null}else{if(s.type==="accent")return Pe.isCharacterBox(s.base)?g3:null;if(s.type==="horizBrace"){var a=!e.sub;return a===s.isOver?qb:null}else return null}else return null};Bl({type:"supsub",htmlBuilder(n,e){var t=Kw(n,e);if(t)return t(n,e);var{base:s,sup:i,sub:r}=n,a=Re(s,e),l,h,c=e.fontMetrics(),u=0,d=0,f=s&&Pe.isCharacterBox(s);if(i){var p=e.havingStyle(e.style.sup());l=Re(i,p,e),f||(u=a.height-p.fontMetrics().supDrop*p.sizeMultiplier/e.sizeMultiplier)}if(r){var w=e.havingStyle(e.style.sub());h=Re(r,w,e),f||(d=a.depth+w.fontMetrics().subDrop*w.sizeMultiplier/e.sizeMultiplier)}var y;e.style===ce.DISPLAY?y=c.sup1:e.style.cramped?y=c.sup3:y=c.sup2;var x=e.sizeMultiplier,S=Q(.5/c.ptPerEm/x),E=null;if(h){var T=n.base&&n.base.type==="op"&&n.base.name&&(n.base.name==="\\oiint"||n.base.name==="\\oiiint");(a instanceof _i||T)&&(E=Q(-a.italic))}var _;if(l&&h){u=Math.max(u,y,l.depth+.25*c.xHeight),d=Math.max(d,c.sub2);var M=c.defaultRuleThickness,D=4*M;if(u-l.depth-(h.height-d)<D){d=D-(u-l.depth)+h.height;var L=.8*c.xHeight-(u-l.depth);L>0&&(u+=L,d-=L)}var F=[{type:"elem",elem:h,shift:d,marginRight:S,marginLeft:E},{type:"elem",elem:l,shift:-u,marginRight:S}];_=B.makeVList({positionType:"individualShift",children:F},e)}else if(h){d=Math.max(d,c.sub1,h.height-.8*c.xHeight);var N=[{type:"elem",elem:h,marginLeft:E,marginRight:S}];_=B.makeVList({positionType:"shift",positionData:d,children:N},e)}else if(l)u=Math.max(u,y,l.depth+.25*c.xHeight),_=B.makeVList({positionType:"shift",positionData:-u,children:[{type:"elem",elem:l,marginRight:S}]},e);else throw new Error("supsub must have either sup or sub.");var W=b4(a,"right")||"mord";return B.makeSpan([W],[a,B.makeSpan(["msupsub"],[_])],e)},mathmlBuilder(n,e){var t=!1,s,i;n.base&&n.base.type==="horizBrace"&&(i=!!n.sup,i===n.base.isOver&&(t=!0,s=n.base.isOver)),n.base&&(n.base.type==="op"||n.base.type==="operatorname")&&(n.base.parentIsSupSub=!0);var r=[Ye(n.base,e)];n.sub&&r.push(Ye(n.sub,e)),n.sup&&r.push(Ye(n.sup,e));var a;if(t)a=s?"mover":"munder";else if(n.sub)if(n.sup){var c=n.base;c&&c.type==="op"&&c.limits&&e.style===ce.DISPLAY||c&&c.type==="operatorname"&&c.alwaysHandleSupSub&&(e.style===ce.DISPLAY||c.limits)?a="munderover":a="msubsup"}else{var h=n.base;h&&h.type==="op"&&h.limits&&(e.style===ce.DISPLAY||h.alwaysHandleSupSub)||h&&h.type==="operatorname"&&h.alwaysHandleSupSub&&(h.limits||e.style===ce.DISPLAY)?a="munder":a="msub"}else{var l=n.base;l&&l.type==="op"&&l.limits&&(e.style===ce.DISPLAY||l.alwaysHandleSupSub)||l&&l.type==="operatorname"&&l.alwaysHandleSupSub&&(l.limits||e.style===ce.DISPLAY)?a="mover":a="msup"}return new j.MathNode(a,r)}});Bl({type:"atom",htmlBuilder(n,e){return B.mathsym(n.text,n.mode,e,["m"+n.family])},mathmlBuilder(n,e){var t=new j.MathNode("mo",[Mi(n.text,n.mode)]);if(n.family==="bin"){var s=p3(n,e);s==="bold-italic"&&t.setAttribute("mathvariant",s)}else n.family==="punct"?t.setAttribute("separator","true"):(n.family==="open"||n.family==="close")&&t.setAttribute("stretchy","false");return t}});var Wb={mi:"italic",mn:"normal",mtext:"normal"};Bl({type:"mathord",htmlBuilder(n,e){return B.makeOrd(n,e,"mathord")},mathmlBuilder(n,e){var t=new j.MathNode("mi",[Mi(n.text,n.mode,e)]),s=p3(n,e)||"italic";return s!==Wb[t.type]&&t.setAttribute("mathvariant",s),t}});Bl({type:"textord",htmlBuilder(n,e){return B.makeOrd(n,e,"textord")},mathmlBuilder(n,e){var t=Mi(n.text,n.mode,e),s=p3(n,e)||"normal",i;return n.mode==="text"?i=new j.MathNode("mtext",[t]):/[0-9]/.test(n.text)?i=new j.MathNode("mn",[t]):n.text==="\\prime"?i=new j.MathNode("mo",[t]):i=new j.MathNode("mi",[t]),s!==Wb[i.type]&&i.setAttribute("mathvariant",s),i}});var Xg={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},Yg={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};Bl({type:"spacing",htmlBuilder(n,e){if(Yg.hasOwnProperty(n.text)){var t=Yg[n.text].className||"";if(n.mode==="text"){var s=B.makeOrd(n,e,"textord");return s.classes.push(t),s}else return B.makeSpan(["mspace",t],[B.mathsym(n.text,n.mode,e)],e)}else{if(Xg.hasOwnProperty(n.text))return B.makeSpan(["mspace",Xg[n.text]],[],e);throw new X('Unknown type of space "'+n.text+'"')}},mathmlBuilder(n,e){var t;if(Yg.hasOwnProperty(n.text))t=new j.MathNode("mtext",[new j.TextNode(" ")]);else{if(Xg.hasOwnProperty(n.text))return new j.MathNode("mspace");throw new X('Unknown type of space "'+n.text+'"')}return t}});var M5=()=>{var n=new j.MathNode("mtd",[]);return n.setAttribute("width","50%"),n};Bl({type:"tag",mathmlBuilder(n,e){var t=new j.MathNode("mtable",[new j.MathNode("mtr",[M5(),new j.MathNode("mtd",[Ha(n.body,e)]),M5(),new j.MathNode("mtd",[Ha(n.tag,e)])])]);return t.setAttribute("width","100%"),t}});var D5={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},R5={"\\textbf":"textbf","\\textmd":"textmd"},Zw={"\\textit":"textit","\\textup":"textup"},P5=(n,e)=>{var t=n.font;if(t){if(D5[t])return e.withTextFontFamily(D5[t]);if(R5[t])return e.withTextFontWeight(R5[t]);if(t==="\\emph")return e.fontShape==="textit"?e.withTextFontShape("textup"):e.withTextFontShape("textit")}else return e;return e.withTextFontShape(Zw[t])};ie({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup","\\emph"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(n,e){var{parser:t,funcName:s}=n,i=e[0];return{type:"text",mode:t.mode,body:Et(i),font:s}},htmlBuilder(n,e){var t=P5(n,e),s=Ot(n.body,t,!0);return B.makeSpan(["mord","text"],s,t)},mathmlBuilder(n,e){var t=P5(n,e);return Ha(n.body,t)}});ie({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(n,e){var{parser:t}=n;return{type:"underline",mode:t.mode,body:e[0]}},htmlBuilder(n,e){var t=Re(n.body,e),s=B.makeLineSpan("underline-line",e),i=e.fontMetrics().defaultRuleThickness,r=B.makeVList({positionType:"top",positionData:t.height,children:[{type:"kern",size:i},{type:"elem",elem:s},{type:"kern",size:3*i},{type:"elem",elem:t}]},e);return B.makeSpan(["mord","underline"],[r],e)},mathmlBuilder(n,e){var t=new j.MathNode("mo",[new j.TextNode("‾")]);t.setAttribute("stretchy","true");var s=new j.MathNode("munder",[Ye(n.body,e),t]);return s.setAttribute("accentunder","true"),s}});ie({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(n,e){var{parser:t}=n;return{type:"vcenter",mode:t.mode,body:e[0]}},htmlBuilder(n,e){var t=Re(n.body,e),s=e.fontMetrics().axisHeight,i=.5*(t.height-s-(t.depth+s));return B.makeVList({positionType:"shift",positionData:i,children:[{type:"elem",elem:t}]},e)},mathmlBuilder(n,e){return new j.MathNode("mpadded",[Ye(n.body,e)],["vcenter"])}});ie({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(n,e,t){throw new X("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(n,e){for(var t=L5(n),s=[],i=e.havingStyle(e.style.text()),r=0;r<t.length;r++){var a=t[r];a==="~"&&(a="\\textasciitilde"),s.push(B.makeSymbol(a,"Typewriter-Regular",n.mode,i,["mord","texttt"]))}return B.makeSpan(["mord","text"].concat(i.sizingClasses(e)),B.tryCombineChars(s),i)},mathmlBuilder(n,e){var t=new j.TextNode(L5(n)),s=new j.MathNode("mtext",[t]);return s.setAttribute("mathvariant","monospace"),s}});var L5=n=>n.body.replace(/ /g,n.star?"␣":" "),Na=gb,Xb=`[ \r
	]`,Qw="\\\\[a-zA-Z@]+",Jw="\\\\[^\uD800-\uDFFF]",e9="("+Qw+")"+Xb+"*",t9=`\\\\(
|[ \r	]+
?)[ \r	]*`,A4="[̀-ͯ]",s9=new RegExp(A4+"+$"),i9="("+Xb+"+)|"+(t9+"|")+"([!-\\[\\]-‧‪-퟿豈-￿]"+(A4+"*")+"|[\uD800-\uDBFF][\uDC00-\uDFFF]"+(A4+"*")+"|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5"+("|"+e9)+("|"+Jw+")");class I5{constructor(e,t){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=e,this.settings=t,this.tokenRegex=new RegExp(i9,"g"),this.catcodes={"%":14,"~":13}}setCatcode(e,t){this.catcodes[e]=t}lex(){var e=this.input,t=this.tokenRegex.lastIndex;if(t===e.length)return new hi("EOF",new Bs(this,t,t));var s=this.tokenRegex.exec(e);if(s===null||s.index!==t)throw new X("Unexpected character: '"+e[t]+"'",new hi(e[t],new Bs(this,t,t+1)));var i=s[6]||s[3]||(s[2]?"\\ ":" ");if(this.catcodes[i]===14){var r=e.indexOf(`
`,this.tokenRegex.lastIndex);return r===-1?(this.tokenRegex.lastIndex=e.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=r+1,this.lex()}return new hi(i,new Bs(this,t,this.tokenRegex.lastIndex))}}class r9{constructor(e,t){e===void 0&&(e={}),t===void 0&&(t={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=t,this.builtins=e,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0)throw new X("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var e=this.undefStack.pop();for(var t in e)e.hasOwnProperty(t)&&(e[t]==null?delete this.current[t]:this.current[t]=e[t])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(e){return this.current.hasOwnProperty(e)||this.builtins.hasOwnProperty(e)}get(e){return this.current.hasOwnProperty(e)?this.current[e]:this.builtins[e]}set(e,t,s){if(s===void 0&&(s=!1),s){for(var i=0;i<this.undefStack.length;i++)delete this.undefStack[i][e];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][e]=t)}else{var r=this.undefStack[this.undefStack.length-1];r&&!r.hasOwnProperty(e)&&(r[e]=this.current[e])}t==null?delete this.current[e]:this.current[e]=t}}var n9=Fb;C("\\noexpand",function(n){var e=n.popToken();return n.isExpandable(e.text)&&(e.noexpand=!0,e.treatAsRelax=!0),{tokens:[e],numArgs:0}});C("\\expandafter",function(n){var e=n.popToken();return n.expandOnce(!0),{tokens:[e],numArgs:0}});C("\\@firstoftwo",function(n){var e=n.consumeArgs(2);return{tokens:e[0],numArgs:0}});C("\\@secondoftwo",function(n){var e=n.consumeArgs(2);return{tokens:e[1],numArgs:0}});C("\\@ifnextchar",function(n){var e=n.consumeArgs(3);n.consumeSpaces();var t=n.future();return e[0].length===1&&e[0][0].text===t.text?{tokens:e[1],numArgs:0}:{tokens:e[2],numArgs:0}});C("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}");C("\\TextOrMath",function(n){var e=n.consumeArgs(2);return n.mode==="text"?{tokens:e[0],numArgs:0}:{tokens:e[1],numArgs:0}});var B5={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};C("\\char",function(n){var e=n.popToken(),t,s="";if(e.text==="'")t=8,e=n.popToken();else if(e.text==='"')t=16,e=n.popToken();else if(e.text==="`")if(e=n.popToken(),e.text[0]==="\\")s=e.text.charCodeAt(1);else{if(e.text==="EOF")throw new X("\\char` missing argument");s=e.text.charCodeAt(0)}else t=10;if(t){if(s=B5[e.text],s==null||s>=t)throw new X("Invalid base-"+t+" digit "+e.text);for(var i;(i=B5[n.future().text])!=null&&i<t;)s*=t,s+=i,n.popToken()}return"\\@char{"+s+"}"});var k3=(n,e,t,s)=>{var i=n.consumeArg().tokens;if(i.length!==1)throw new X("\\newcommand's first argument must be a macro name");var r=i[0].text,a=n.isDefined(r);if(a&&!e)throw new X("\\newcommand{"+r+"} attempting to redefine "+(r+"; use \\renewcommand"));if(!a&&!t)throw new X("\\renewcommand{"+r+"} when command "+r+" does not yet exist; use \\newcommand");var l=0;if(i=n.consumeArg().tokens,i.length===1&&i[0].text==="["){for(var h="",c=n.expandNextToken();c.text!=="]"&&c.text!=="EOF";)h+=c.text,c=n.expandNextToken();if(!h.match(/^\s*[0-9]+\s*$/))throw new X("Invalid number of arguments: "+h);l=parseInt(h),i=n.consumeArg().tokens}return a&&s||n.macros.set(r,{tokens:i,numArgs:l}),""};C("\\newcommand",n=>k3(n,!1,!0,!1));C("\\renewcommand",n=>k3(n,!0,!1,!1));C("\\providecommand",n=>k3(n,!0,!0,!0));C("\\message",n=>{var e=n.consumeArgs(1)[0];return console.log(e.reverse().map(t=>t.text).join("")),""});C("\\errmessage",n=>{var e=n.consumeArgs(1)[0];return console.error(e.reverse().map(t=>t.text).join("")),""});C("\\show",n=>{var e=n.popToken(),t=e.text;return console.log(e,n.macros.get(t),Na[t],tt.math[t],tt.text[t]),""});C("\\bgroup","{");C("\\egroup","}");C("~","\\nobreakspace");C("\\lq","`");C("\\rq","'");C("\\aa","\\r a");C("\\AA","\\r A");C("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`©}");C("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}");C("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`®}");C("ℬ","\\mathscr{B}");C("ℰ","\\mathscr{E}");C("ℱ","\\mathscr{F}");C("ℋ","\\mathscr{H}");C("ℐ","\\mathscr{I}");C("ℒ","\\mathscr{L}");C("ℳ","\\mathscr{M}");C("ℛ","\\mathscr{R}");C("ℭ","\\mathfrak{C}");C("ℌ","\\mathfrak{H}");C("ℨ","\\mathfrak{Z}");C("\\Bbbk","\\Bbb{k}");C("·","\\cdotp");C("\\llap","\\mathllap{\\textrm{#1}}");C("\\rlap","\\mathrlap{\\textrm{#1}}");C("\\clap","\\mathclap{\\textrm{#1}}");C("\\mathstrut","\\vphantom{(}");C("\\underbar","\\underline{\\text{#1}}");C("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}');C("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`≠}}");C("\\ne","\\neq");C("≠","\\neq");C("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`∉}}");C("∉","\\notin");C("≘","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`≘}}");C("≙","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`≘}}");C("≚","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`≚}}");C("≛","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`≛}}");C("≝","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`≝}}");C("≞","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`≞}}");C("≟","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`≟}}");C("⟂","\\perp");C("‼","\\mathclose{!\\mkern-0.8mu!}");C("∌","\\notni");C("⌜","\\ulcorner");C("⌝","\\urcorner");C("⌞","\\llcorner");C("⌟","\\lrcorner");C("©","\\copyright");C("®","\\textregistered");C("️","\\textregistered");C("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}');C("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}');C("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}');C("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}');C("\\vdots","{\\varvdots\\rule{0pt}{15pt}}");C("⋮","\\vdots");C("\\varGamma","\\mathit{\\Gamma}");C("\\varDelta","\\mathit{\\Delta}");C("\\varTheta","\\mathit{\\Theta}");C("\\varLambda","\\mathit{\\Lambda}");C("\\varXi","\\mathit{\\Xi}");C("\\varPi","\\mathit{\\Pi}");C("\\varSigma","\\mathit{\\Sigma}");C("\\varUpsilon","\\mathit{\\Upsilon}");C("\\varPhi","\\mathit{\\Phi}");C("\\varPsi","\\mathit{\\Psi}");C("\\varOmega","\\mathit{\\Omega}");C("\\substack","\\begin{subarray}{c}#1\\end{subarray}");C("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax");C("\\boxed","\\fbox{$\\displaystyle{#1}$}");C("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;");C("\\implies","\\DOTSB\\;\\Longrightarrow\\;");C("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");C("\\dddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ...}}{#1}}");C("\\ddddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ....}}{#1}}");var N5={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};C("\\dots",function(n){var e="\\dotso",t=n.expandAfterFuture().text;return t in N5?e=N5[t]:(t.slice(0,4)==="\\not"||t in tt.math&&["bin","rel"].includes(tt.math[t].group))&&(e="\\dotsb"),e});var T3={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};C("\\dotso",function(n){var e=n.future().text;return e in T3?"\\ldots\\,":"\\ldots"});C("\\dotsc",function(n){var e=n.future().text;return e in T3&&e!==","?"\\ldots\\,":"\\ldots"});C("\\cdots",function(n){var e=n.future().text;return e in T3?"\\@cdots\\,":"\\@cdots"});C("\\dotsb","\\cdots");C("\\dotsm","\\cdots");C("\\dotsi","\\!\\cdots");C("\\dotsx","\\ldots\\,");C("\\DOTSI","\\relax");C("\\DOTSB","\\relax");C("\\DOTSX","\\relax");C("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax");C("\\,","\\tmspace+{3mu}{.1667em}");C("\\thinspace","\\,");C("\\>","\\mskip{4mu}");C("\\:","\\tmspace+{4mu}{.2222em}");C("\\medspace","\\:");C("\\;","\\tmspace+{5mu}{.2777em}");C("\\thickspace","\\;");C("\\!","\\tmspace-{3mu}{.1667em}");C("\\negthinspace","\\!");C("\\negmedspace","\\tmspace-{4mu}{.2222em}");C("\\negthickspace","\\tmspace-{5mu}{.277em}");C("\\enspace","\\kern.5em ");C("\\enskip","\\hskip.5em\\relax");C("\\quad","\\hskip1em\\relax");C("\\qquad","\\hskip2em\\relax");C("\\tag","\\@ifstar\\tag@literal\\tag@paren");C("\\tag@paren","\\tag@literal{({#1})}");C("\\tag@literal",n=>{if(n.macros.get("\\df@tag"))throw new X("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"});C("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}");C("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)");C("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}");C("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1");C("\\newline","\\\\\\relax");C("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var Yb=Q(Er["Main-Regular"]["T".charCodeAt(0)][1]-.7*Er["Main-Regular"]["A".charCodeAt(0)][1]);C("\\LaTeX","\\textrm{\\html@mathml{"+("L\\kern-.36em\\raisebox{"+Yb+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{LaTeX}}");C("\\KaTeX","\\textrm{\\html@mathml{"+("K\\kern-.17em\\raisebox{"+Yb+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{KaTeX}}");C("\\hspace","\\@ifstar\\@hspacer\\@hspace");C("\\@hspace","\\hskip #1\\relax");C("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax");C("\\ordinarycolon",":");C("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}");C("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}');C("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}');C("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}');C("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}');C("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}');C("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}');C("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}');C("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}');C("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}');C("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}');C("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}');C("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}');C("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}');C("∷","\\dblcolon");C("∹","\\eqcolon");C("≔","\\coloneqq");C("≕","\\eqqcolon");C("⩴","\\Coloneqq");C("\\ratio","\\vcentcolon");C("\\coloncolon","\\dblcolon");C("\\colonequals","\\coloneqq");C("\\coloncolonequals","\\Coloneqq");C("\\equalscolon","\\eqqcolon");C("\\equalscoloncolon","\\Eqqcolon");C("\\colonminus","\\coloneq");C("\\coloncolonminus","\\Coloneq");C("\\minuscolon","\\eqcolon");C("\\minuscoloncolon","\\Eqcolon");C("\\coloncolonapprox","\\Colonapprox");C("\\coloncolonsim","\\Colonsim");C("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}");C("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}");C("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}");C("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}");C("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`∌}}");C("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}");C("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}");C("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}");C("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}");C("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}");C("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}");C("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}");C("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}");C("\\gvertneqq","\\html@mathml{\\@gvertneqq}{≩}");C("\\lvertneqq","\\html@mathml{\\@lvertneqq}{≨}");C("\\ngeqq","\\html@mathml{\\@ngeqq}{≱}");C("\\ngeqslant","\\html@mathml{\\@ngeqslant}{≱}");C("\\nleqq","\\html@mathml{\\@nleqq}{≰}");C("\\nleqslant","\\html@mathml{\\@nleqslant}{≰}");C("\\nshortmid","\\html@mathml{\\@nshortmid}{∤}");C("\\nshortparallel","\\html@mathml{\\@nshortparallel}{∦}");C("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{⊈}");C("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{⊉}");C("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{⊊}");C("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{⫋}");C("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{⊋}");C("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{⫌}");C("\\imath","\\html@mathml{\\@imath}{ı}");C("\\jmath","\\html@mathml{\\@jmath}{ȷ}");C("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`⟦}}");C("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`⟧}}");C("⟦","\\llbracket");C("⟧","\\rrbracket");C("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`⦃}}");C("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`⦄}}");C("⦃","\\lBrace");C("⦄","\\rBrace");C("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`⦵}}");C("⦵","\\minuso");C("\\darr","\\downarrow");C("\\dArr","\\Downarrow");C("\\Darr","\\Downarrow");C("\\lang","\\langle");C("\\rang","\\rangle");C("\\uarr","\\uparrow");C("\\uArr","\\Uparrow");C("\\Uarr","\\Uparrow");C("\\N","\\mathbb{N}");C("\\R","\\mathbb{R}");C("\\Z","\\mathbb{Z}");C("\\alef","\\aleph");C("\\alefsym","\\aleph");C("\\Alpha","\\mathrm{A}");C("\\Beta","\\mathrm{B}");C("\\bull","\\bullet");C("\\Chi","\\mathrm{X}");C("\\clubs","\\clubsuit");C("\\cnums","\\mathbb{C}");C("\\Complex","\\mathbb{C}");C("\\Dagger","\\ddagger");C("\\diamonds","\\diamondsuit");C("\\empty","\\emptyset");C("\\Epsilon","\\mathrm{E}");C("\\Eta","\\mathrm{H}");C("\\exist","\\exists");C("\\harr","\\leftrightarrow");C("\\hArr","\\Leftrightarrow");C("\\Harr","\\Leftrightarrow");C("\\hearts","\\heartsuit");C("\\image","\\Im");C("\\infin","\\infty");C("\\Iota","\\mathrm{I}");C("\\isin","\\in");C("\\Kappa","\\mathrm{K}");C("\\larr","\\leftarrow");C("\\lArr","\\Leftarrow");C("\\Larr","\\Leftarrow");C("\\lrarr","\\leftrightarrow");C("\\lrArr","\\Leftrightarrow");C("\\Lrarr","\\Leftrightarrow");C("\\Mu","\\mathrm{M}");C("\\natnums","\\mathbb{N}");C("\\Nu","\\mathrm{N}");C("\\Omicron","\\mathrm{O}");C("\\plusmn","\\pm");C("\\rarr","\\rightarrow");C("\\rArr","\\Rightarrow");C("\\Rarr","\\Rightarrow");C("\\real","\\Re");C("\\reals","\\mathbb{R}");C("\\Reals","\\mathbb{R}");C("\\Rho","\\mathrm{P}");C("\\sdot","\\cdot");C("\\sect","\\S");C("\\spades","\\spadesuit");C("\\sub","\\subset");C("\\sube","\\subseteq");C("\\supe","\\supseteq");C("\\Tau","\\mathrm{T}");C("\\thetasym","\\vartheta");C("\\weierp","\\wp");C("\\Zeta","\\mathrm{Z}");C("\\argmin","\\DOTSB\\operatorname*{arg\\,min}");C("\\argmax","\\DOTSB\\operatorname*{arg\\,max}");C("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits");C("\\bra","\\mathinner{\\langle{#1}|}");C("\\ket","\\mathinner{|{#1}\\rangle}");C("\\braket","\\mathinner{\\langle{#1}\\rangle}");C("\\Bra","\\left\\langle#1\\right|");C("\\Ket","\\left|#1\\right\\rangle");var Kb=n=>e=>{var t=e.consumeArg().tokens,s=e.consumeArg().tokens,i=e.consumeArg().tokens,r=e.consumeArg().tokens,a=e.macros.get("|"),l=e.macros.get("\\|");e.macros.beginGroup();var h=d=>f=>{n&&(f.macros.set("|",a),i.length&&f.macros.set("\\|",l));var p=d;if(!d&&i.length){var w=f.future();w.text==="|"&&(f.popToken(),p=!0)}return{tokens:p?i:s,numArgs:0}};e.macros.set("|",h(!1)),i.length&&e.macros.set("\\|",h(!0));var c=e.consumeArg().tokens,u=e.expandTokens([...r,...c,...t]);return e.macros.endGroup(),{tokens:u.reverse(),numArgs:0}};C("\\bra@ket",Kb(!1));C("\\bra@set",Kb(!0));C("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}");C("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}");C("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}");C("\\angln","{\\angl n}");C("\\blue","\\textcolor{##6495ed}{#1}");C("\\orange","\\textcolor{##ffa500}{#1}");C("\\pink","\\textcolor{##ff00af}{#1}");C("\\red","\\textcolor{##df0030}{#1}");C("\\green","\\textcolor{##28ae7b}{#1}");C("\\gray","\\textcolor{gray}{#1}");C("\\purple","\\textcolor{##9d38bd}{#1}");C("\\blueA","\\textcolor{##ccfaff}{#1}");C("\\blueB","\\textcolor{##80f6ff}{#1}");C("\\blueC","\\textcolor{##63d9ea}{#1}");C("\\blueD","\\textcolor{##11accd}{#1}");C("\\blueE","\\textcolor{##0c7f99}{#1}");C("\\tealA","\\textcolor{##94fff5}{#1}");C("\\tealB","\\textcolor{##26edd5}{#1}");C("\\tealC","\\textcolor{##01d1c1}{#1}");C("\\tealD","\\textcolor{##01a995}{#1}");C("\\tealE","\\textcolor{##208170}{#1}");C("\\greenA","\\textcolor{##b6ffb0}{#1}");C("\\greenB","\\textcolor{##8af281}{#1}");C("\\greenC","\\textcolor{##74cf70}{#1}");C("\\greenD","\\textcolor{##1fab54}{#1}");C("\\greenE","\\textcolor{##0d923f}{#1}");C("\\goldA","\\textcolor{##ffd0a9}{#1}");C("\\goldB","\\textcolor{##ffbb71}{#1}");C("\\goldC","\\textcolor{##ff9c39}{#1}");C("\\goldD","\\textcolor{##e07d10}{#1}");C("\\goldE","\\textcolor{##a75a05}{#1}");C("\\redA","\\textcolor{##fca9a9}{#1}");C("\\redB","\\textcolor{##ff8482}{#1}");C("\\redC","\\textcolor{##f9685d}{#1}");C("\\redD","\\textcolor{##e84d39}{#1}");C("\\redE","\\textcolor{##bc2612}{#1}");C("\\maroonA","\\textcolor{##ffbde0}{#1}");C("\\maroonB","\\textcolor{##ff92c6}{#1}");C("\\maroonC","\\textcolor{##ed5fa6}{#1}");C("\\maroonD","\\textcolor{##ca337c}{#1}");C("\\maroonE","\\textcolor{##9e034e}{#1}");C("\\purpleA","\\textcolor{##ddd7ff}{#1}");C("\\purpleB","\\textcolor{##c6b9fc}{#1}");C("\\purpleC","\\textcolor{##aa87ff}{#1}");C("\\purpleD","\\textcolor{##7854ab}{#1}");C("\\purpleE","\\textcolor{##543b78}{#1}");C("\\mintA","\\textcolor{##f5f9e8}{#1}");C("\\mintB","\\textcolor{##edf2df}{#1}");C("\\mintC","\\textcolor{##e0e5cc}{#1}");C("\\grayA","\\textcolor{##f6f7f7}{#1}");C("\\grayB","\\textcolor{##f0f1f2}{#1}");C("\\grayC","\\textcolor{##e3e5e6}{#1}");C("\\grayD","\\textcolor{##d6d8da}{#1}");C("\\grayE","\\textcolor{##babec2}{#1}");C("\\grayF","\\textcolor{##888d93}{#1}");C("\\grayG","\\textcolor{##626569}{#1}");C("\\grayH","\\textcolor{##3b3e40}{#1}");C("\\grayI","\\textcolor{##21242c}{#1}");C("\\kaBlue","\\textcolor{##314453}{#1}");C("\\kaGreen","\\textcolor{##71B307}{#1}");var Zb={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class a9{constructor(e,t,s){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=t,this.expansionCount=0,this.feed(e),this.macros=new r9(n9,t.macros),this.mode=s,this.stack=[]}feed(e){this.lexer=new I5(e,this.settings)}switchMode(e){this.mode=e}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(e){this.stack.push(e)}pushTokens(e){this.stack.push(...e)}scanArgument(e){var t,s,i;if(e){if(this.consumeSpaces(),this.future().text!=="[")return null;t=this.popToken(),{tokens:i,end:s}=this.consumeArg(["]"])}else({tokens:i,start:t,end:s}=this.consumeArg());return this.pushToken(new hi("EOF",s.loc)),this.pushTokens(i),new hi("",Bs.range(t,s))}consumeSpaces(){for(;;){var e=this.future();if(e.text===" ")this.stack.pop();else break}}consumeArg(e){var t=[],s=e&&e.length>0;s||this.consumeSpaces();var i=this.future(),r,a=0,l=0;do{if(r=this.popToken(),t.push(r),r.text==="{")++a;else if(r.text==="}"){if(--a,a===-1)throw new X("Extra }",r)}else if(r.text==="EOF")throw new X("Unexpected end of input in a macro argument, expected '"+(e&&s?e[l]:"}")+"'",r);if(e&&s)if((a===0||a===1&&e[l]==="{")&&r.text===e[l]){if(++l,l===e.length){t.splice(-l,l);break}}else l=0}while(a!==0||s);return i.text==="{"&&t[t.length-1].text==="}"&&(t.pop(),t.shift()),t.reverse(),{tokens:t,start:i,end:r}}consumeArgs(e,t){if(t){if(t.length!==e+1)throw new X("The length of delimiters doesn't match the number of args!");for(var s=t[0],i=0;i<s.length;i++){var r=this.popToken();if(s[i]!==r.text)throw new X("Use of the macro doesn't match its definition",r)}}for(var a=[],l=0;l<e;l++)a.push(this.consumeArg(t&&t[l+1]).tokens);return a}countExpansion(e){if(this.expansionCount+=e,this.expansionCount>this.settings.maxExpand)throw new X("Too many expansions: infinite loop or need to increase maxExpand setting")}expandOnce(e){var t=this.popToken(),s=t.text,i=t.noexpand?null:this._getExpansion(s);if(i==null||e&&i.unexpandable){if(e&&i==null&&s[0]==="\\"&&!this.isDefined(s))throw new X("Undefined control sequence: "+s);return this.pushToken(t),!1}this.countExpansion(1);var r=i.tokens,a=this.consumeArgs(i.numArgs,i.delimiters);if(i.numArgs){r=r.slice();for(var l=r.length-1;l>=0;--l){var h=r[l];if(h.text==="#"){if(l===0)throw new X("Incomplete placeholder at end of macro body",h);if(h=r[--l],h.text==="#")r.splice(l+1,1);else if(/^[1-9]$/.test(h.text))r.splice(l,2,...a[+h.text-1]);else throw new X("Not a valid argument number",h)}}}return this.pushTokens(r),r.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(this.expandOnce()===!1){var e=this.stack.pop();return e.treatAsRelax&&(e.text="\\relax"),e}throw new Error}expandMacro(e){return this.macros.has(e)?this.expandTokens([new hi(e)]):void 0}expandTokens(e){var t=[],s=this.stack.length;for(this.pushTokens(e);this.stack.length>s;)if(this.expandOnce(!0)===!1){var i=this.stack.pop();i.treatAsRelax&&(i.noexpand=!1,i.treatAsRelax=!1),t.push(i)}return this.countExpansion(t.length),t}expandMacroAsText(e){var t=this.expandMacro(e);return t&&t.map(s=>s.text).join("")}_getExpansion(e){var t=this.macros.get(e);if(t==null)return t;if(e.length===1){var s=this.lexer.catcodes[e];if(s!=null&&s!==13)return}var i=typeof t=="function"?t(this):t;if(typeof i=="string"){var r=0;if(i.indexOf("#")!==-1)for(var a=i.replace(/##/g,"");a.indexOf("#"+(r+1))!==-1;)++r;for(var l=new I5(i,this.settings),h=[],c=l.lex();c.text!=="EOF";)h.push(c),c=l.lex();h.reverse();var u={tokens:h,numArgs:r};return u}return i}isDefined(e){return this.macros.has(e)||Na.hasOwnProperty(e)||tt.math.hasOwnProperty(e)||tt.text.hasOwnProperty(e)||Zb.hasOwnProperty(e)}isExpandable(e){var t=this.macros.get(e);return t!=null?typeof t=="string"||typeof t=="function"||!t.unexpandable:Na.hasOwnProperty(e)&&!Na[e].primitive}}var F5=/^[₊₋₌₍₎₀₁₂₃₄₅₆₇₈₉ₐₑₕᵢⱼₖₗₘₙₒₚᵣₛₜᵤᵥₓᵦᵧᵨᵩᵪ]/,t1=Object.freeze({"₊":"+","₋":"-","₌":"=","₍":"(","₎":")","₀":"0","₁":"1","₂":"2","₃":"3","₄":"4","₅":"5","₆":"6","₇":"7","₈":"8","₉":"9","ₐ":"a","ₑ":"e","ₕ":"h","ᵢ":"i","ⱼ":"j","ₖ":"k","ₗ":"l","ₘ":"m","ₙ":"n","ₒ":"o","ₚ":"p","ᵣ":"r","ₛ":"s","ₜ":"t","ᵤ":"u","ᵥ":"v","ₓ":"x","ᵦ":"β","ᵧ":"γ","ᵨ":"ρ","ᵩ":"ϕ","ᵪ":"χ","⁺":"+","⁻":"-","⁼":"=","⁽":"(","⁾":")","⁰":"0","¹":"1","²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","ᴬ":"A","ᴮ":"B","ᴰ":"D","ᴱ":"E","ᴳ":"G","ᴴ":"H","ᴵ":"I","ᴶ":"J","ᴷ":"K","ᴸ":"L","ᴹ":"M","ᴺ":"N","ᴼ":"O","ᴾ":"P","ᴿ":"R","ᵀ":"T","ᵁ":"U","ⱽ":"V","ᵂ":"W","ᵃ":"a","ᵇ":"b","ᶜ":"c","ᵈ":"d","ᵉ":"e","ᶠ":"f","ᵍ":"g",ʰ:"h","ⁱ":"i",ʲ:"j","ᵏ":"k",ˡ:"l","ᵐ":"m",ⁿ:"n","ᵒ":"o","ᵖ":"p",ʳ:"r",ˢ:"s","ᵗ":"t","ᵘ":"u","ᵛ":"v",ʷ:"w",ˣ:"x",ʸ:"y","ᶻ":"z","ᵝ":"β","ᵞ":"γ","ᵟ":"δ","ᵠ":"ϕ","ᵡ":"χ","ᶿ":"θ"}),Kg={"́":{text:"\\'",math:"\\acute"},"̀":{text:"\\`",math:"\\grave"},"̈":{text:'\\"',math:"\\ddot"},"̃":{text:"\\~",math:"\\tilde"},"̄":{text:"\\=",math:"\\bar"},"̆":{text:"\\u",math:"\\breve"},"̌":{text:"\\v",math:"\\check"},"̂":{text:"\\^",math:"\\hat"},"̇":{text:"\\.",math:"\\dot"},"̊":{text:"\\r",math:"\\mathring"},"̋":{text:"\\H"},"̧":{text:"\\c"}},O5={á:"á",à:"à",ä:"ä",ǟ:"ǟ",ã:"ã",ā:"ā",ă:"ă",ắ:"ắ",ằ:"ằ",ẵ:"ẵ",ǎ:"ǎ",â:"â",ấ:"ấ",ầ:"ầ",ẫ:"ẫ",ȧ:"ȧ",ǡ:"ǡ",å:"å",ǻ:"ǻ",ḃ:"ḃ",ć:"ć",ḉ:"ḉ",č:"č",ĉ:"ĉ",ċ:"ċ",ç:"ç",ď:"ď",ḋ:"ḋ",ḑ:"ḑ",é:"é",è:"è",ë:"ë",ẽ:"ẽ",ē:"ē",ḗ:"ḗ",ḕ:"ḕ",ĕ:"ĕ",ḝ:"ḝ",ě:"ě",ê:"ê",ế:"ế",ề:"ề",ễ:"ễ",ė:"ė",ȩ:"ȩ",ḟ:"ḟ",ǵ:"ǵ",ḡ:"ḡ",ğ:"ğ",ǧ:"ǧ",ĝ:"ĝ",ġ:"ġ",ģ:"ģ",ḧ:"ḧ",ȟ:"ȟ",ĥ:"ĥ",ḣ:"ḣ",ḩ:"ḩ",í:"í",ì:"ì",ï:"ï",ḯ:"ḯ",ĩ:"ĩ",ī:"ī",ĭ:"ĭ",ǐ:"ǐ",î:"î",ǰ:"ǰ",ĵ:"ĵ",ḱ:"ḱ",ǩ:"ǩ",ķ:"ķ",ĺ:"ĺ",ľ:"ľ",ļ:"ļ",ḿ:"ḿ",ṁ:"ṁ",ń:"ń",ǹ:"ǹ",ñ:"ñ",ň:"ň",ṅ:"ṅ",ņ:"ņ",ó:"ó",ò:"ò",ö:"ö",ȫ:"ȫ",õ:"õ",ṍ:"ṍ",ṏ:"ṏ",ȭ:"ȭ",ō:"ō",ṓ:"ṓ",ṑ:"ṑ",ŏ:"ŏ",ǒ:"ǒ",ô:"ô",ố:"ố",ồ:"ồ",ỗ:"ỗ",ȯ:"ȯ",ȱ:"ȱ",ő:"ő",ṕ:"ṕ",ṗ:"ṗ",ŕ:"ŕ",ř:"ř",ṙ:"ṙ",ŗ:"ŗ",ś:"ś",ṥ:"ṥ",š:"š",ṧ:"ṧ",ŝ:"ŝ",ṡ:"ṡ",ş:"ş",ẗ:"ẗ",ť:"ť",ṫ:"ṫ",ţ:"ţ",ú:"ú",ù:"ù",ü:"ü",ǘ:"ǘ",ǜ:"ǜ",ǖ:"ǖ",ǚ:"ǚ",ũ:"ũ",ṹ:"ṹ",ū:"ū",ṻ:"ṻ",ŭ:"ŭ",ǔ:"ǔ",û:"û",ů:"ů",ű:"ű",ṽ:"ṽ",ẃ:"ẃ",ẁ:"ẁ",ẅ:"ẅ",ŵ:"ŵ",ẇ:"ẇ",ẘ:"ẘ",ẍ:"ẍ",ẋ:"ẋ",ý:"ý",ỳ:"ỳ",ÿ:"ÿ",ỹ:"ỹ",ȳ:"ȳ",ŷ:"ŷ",ẏ:"ẏ",ẙ:"ẙ",ź:"ź",ž:"ž",ẑ:"ẑ",ż:"ż",Á:"Á",À:"À",Ä:"Ä",Ǟ:"Ǟ",Ã:"Ã",Ā:"Ā",Ă:"Ă",Ắ:"Ắ",Ằ:"Ằ",Ẵ:"Ẵ",Ǎ:"Ǎ",Â:"Â",Ấ:"Ấ",Ầ:"Ầ",Ẫ:"Ẫ",Ȧ:"Ȧ",Ǡ:"Ǡ",Å:"Å",Ǻ:"Ǻ",Ḃ:"Ḃ",Ć:"Ć",Ḉ:"Ḉ",Č:"Č",Ĉ:"Ĉ",Ċ:"Ċ",Ç:"Ç",Ď:"Ď",Ḋ:"Ḋ",Ḑ:"Ḑ",É:"É",È:"È",Ë:"Ë",Ẽ:"Ẽ",Ē:"Ē",Ḗ:"Ḗ",Ḕ:"Ḕ",Ĕ:"Ĕ",Ḝ:"Ḝ",Ě:"Ě",Ê:"Ê",Ế:"Ế",Ề:"Ề",Ễ:"Ễ",Ė:"Ė",Ȩ:"Ȩ",Ḟ:"Ḟ",Ǵ:"Ǵ",Ḡ:"Ḡ",Ğ:"Ğ",Ǧ:"Ǧ",Ĝ:"Ĝ",Ġ:"Ġ",Ģ:"Ģ",Ḧ:"Ḧ",Ȟ:"Ȟ",Ĥ:"Ĥ",Ḣ:"Ḣ",Ḩ:"Ḩ",Í:"Í",Ì:"Ì",Ï:"Ï",Ḯ:"Ḯ",Ĩ:"Ĩ",Ī:"Ī",Ĭ:"Ĭ",Ǐ:"Ǐ",Î:"Î",İ:"İ",Ĵ:"Ĵ",Ḱ:"Ḱ",Ǩ:"Ǩ",Ķ:"Ķ",Ĺ:"Ĺ",Ľ:"Ľ",Ļ:"Ļ",Ḿ:"Ḿ",Ṁ:"Ṁ",Ń:"Ń",Ǹ:"Ǹ",Ñ:"Ñ",Ň:"Ň",Ṅ:"Ṅ",Ņ:"Ņ",Ó:"Ó",Ò:"Ò",Ö:"Ö",Ȫ:"Ȫ",Õ:"Õ",Ṍ:"Ṍ",Ṏ:"Ṏ",Ȭ:"Ȭ",Ō:"Ō",Ṓ:"Ṓ",Ṑ:"Ṑ",Ŏ:"Ŏ",Ǒ:"Ǒ",Ô:"Ô",Ố:"Ố",Ồ:"Ồ",Ỗ:"Ỗ",Ȯ:"Ȯ",Ȱ:"Ȱ",Ő:"Ő",Ṕ:"Ṕ",Ṗ:"Ṗ",Ŕ:"Ŕ",Ř:"Ř",Ṙ:"Ṙ",Ŗ:"Ŗ",Ś:"Ś",Ṥ:"Ṥ",Š:"Š",Ṧ:"Ṧ",Ŝ:"Ŝ",Ṡ:"Ṡ",Ş:"Ş",Ť:"Ť",Ṫ:"Ṫ",Ţ:"Ţ",Ú:"Ú",Ù:"Ù",Ü:"Ü",Ǘ:"Ǘ",Ǜ:"Ǜ",Ǖ:"Ǖ",Ǚ:"Ǚ",Ũ:"Ũ",Ṹ:"Ṹ",Ū:"Ū",Ṻ:"Ṻ",Ŭ:"Ŭ",Ǔ:"Ǔ",Û:"Û",Ů:"Ů",Ű:"Ű",Ṽ:"Ṽ",Ẃ:"Ẃ",Ẁ:"Ẁ",Ẅ:"Ẅ",Ŵ:"Ŵ",Ẇ:"Ẇ",Ẍ:"Ẍ",Ẋ:"Ẋ",Ý:"Ý",Ỳ:"Ỳ",Ÿ:"Ÿ",Ỹ:"Ỹ",Ȳ:"Ȳ",Ŷ:"Ŷ",Ẏ:"Ẏ",Ź:"Ź",Ž:"Ž",Ẑ:"Ẑ",Ż:"Ż",ά:"ά",ὰ:"ὰ",ᾱ:"ᾱ",ᾰ:"ᾰ",έ:"έ",ὲ:"ὲ",ή:"ή",ὴ:"ὴ",ί:"ί",ὶ:"ὶ",ϊ:"ϊ",ΐ:"ΐ",ῒ:"ῒ",ῑ:"ῑ",ῐ:"ῐ",ό:"ό",ὸ:"ὸ",ύ:"ύ",ὺ:"ὺ",ϋ:"ϋ",ΰ:"ΰ",ῢ:"ῢ",ῡ:"ῡ",ῠ:"ῠ",ώ:"ώ",ὼ:"ὼ",Ύ:"Ύ",Ὺ:"Ὺ",Ϋ:"Ϋ",Ῡ:"Ῡ",Ῠ:"Ῠ",Ώ:"Ώ",Ὼ:"Ὼ"};class xg{constructor(e,t){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new a9(e,t,this.mode),this.settings=t,this.leftrightDepth=0}expect(e,t){if(t===void 0&&(t=!0),this.fetch().text!==e)throw new X("Expected '"+e+"', got '"+this.fetch().text+"'",this.fetch());t&&this.consume()}consume(){this.nextToken=null}fetch(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(e){this.mode=e,this.gullet.switchMode(e)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var e=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),e}finally{this.gullet.endGroups()}}subparse(e){var t=this.nextToken;this.consume(),this.gullet.pushToken(new hi("}")),this.gullet.pushTokens(e);var s=this.parseExpression(!1);return this.expect("}"),this.nextToken=t,s}parseExpression(e,t){for(var s=[];;){this.mode==="math"&&this.consumeSpaces();var i=this.fetch();if(xg.endOfExpression.indexOf(i.text)!==-1||t&&i.text===t||e&&Na[i.text]&&Na[i.text].infix)break;var r=this.parseAtom(t);if(r){if(r.type==="internal")continue}else break;s.push(r)}return this.mode==="text"&&this.formLigatures(s),this.handleInfixNodes(s)}handleInfixNodes(e){for(var t=-1,s,i=0;i<e.length;i++)if(e[i].type==="infix"){if(t!==-1)throw new X("only one infix operator per group",e[i].token);t=i,s=e[i].replaceWith}if(t!==-1&&s){var r,a,l=e.slice(0,t),h=e.slice(t+1);l.length===1&&l[0].type==="ordgroup"?r=l[0]:r={type:"ordgroup",mode:this.mode,body:l},h.length===1&&h[0].type==="ordgroup"?a=h[0]:a={type:"ordgroup",mode:this.mode,body:h};var c;return s==="\\\\abovefrac"?c=this.callFunction(s,[r,e[t],a],[]):c=this.callFunction(s,[r,a],[]),[c]}else return e}handleSupSubscript(e){var t=this.fetch(),s=t.text;this.consume(),this.consumeSpaces();var i;do{var r;i=this.parseGroup(e)}while(((r=i)==null?void 0:r.type)==="internal");if(!i)throw new X("Expected group after '"+s+"'",t);return i}formatUnsupportedCmd(e){for(var t=[],s=0;s<e.length;s++)t.push({type:"textord",mode:"text",text:e[s]});var i={type:"text",mode:this.mode,body:t},r={type:"color",mode:this.mode,color:this.settings.errorColor,body:[i]};return r}parseAtom(e){var t=this.parseGroup("atom",e);if((t==null?void 0:t.type)==="internal"||this.mode==="text")return t;for(var s,i;;){this.consumeSpaces();var r=this.fetch();if(r.text==="\\limits"||r.text==="\\nolimits"){if(t&&t.type==="op"){var a=r.text==="\\limits";t.limits=a,t.alwaysHandleSupSub=!0}else if(t&&t.type==="operatorname")t.alwaysHandleSupSub&&(t.limits=r.text==="\\limits");else throw new X("Limit controls must follow a math operator",r);this.consume()}else if(r.text==="^"){if(s)throw new X("Double superscript",r);s=this.handleSupSubscript("superscript")}else if(r.text==="_"){if(i)throw new X("Double subscript",r);i=this.handleSupSubscript("subscript")}else if(r.text==="'"){if(s)throw new X("Double superscript",r);var l={type:"textord",mode:this.mode,text:"\\prime"},h=[l];for(this.consume();this.fetch().text==="'";)h.push(l),this.consume();this.fetch().text==="^"&&h.push(this.handleSupSubscript("superscript")),s={type:"ordgroup",mode:this.mode,body:h}}else if(t1[r.text]){var c=F5.test(r.text),u=[];for(u.push(new hi(t1[r.text])),this.consume();;){var d=this.fetch().text;if(!t1[d]||F5.test(d)!==c)break;u.unshift(new hi(t1[d])),this.consume()}var f=this.subparse(u);c?i={type:"ordgroup",mode:"math",body:f}:s={type:"ordgroup",mode:"math",body:f}}else break}return s||i?{type:"supsub",mode:this.mode,base:t,sup:s,sub:i}:t}parseFunction(e,t){var s=this.fetch(),i=s.text,r=Na[i];if(!r)return null;if(this.consume(),t&&t!=="atom"&&!r.allowedInArgument)throw new X("Got function '"+i+"' with no arguments"+(t?" as "+t:""),s);if(this.mode==="text"&&!r.allowedInText)throw new X("Can't use function '"+i+"' in text mode",s);if(this.mode==="math"&&r.allowedInMath===!1)throw new X("Can't use function '"+i+"' in math mode",s);var{args:a,optArgs:l}=this.parseArguments(i,r);return this.callFunction(i,a,l,s,e)}callFunction(e,t,s,i,r){var a={funcName:e,parser:this,token:i,breakOnTokenText:r},l=Na[e];if(l&&l.handler)return l.handler(a,t,s);throw new X("No function handler for "+e)}parseArguments(e,t){var s=t.numArgs+t.numOptionalArgs;if(s===0)return{args:[],optArgs:[]};for(var i=[],r=[],a=0;a<s;a++){var l=t.argTypes&&t.argTypes[a],h=a<t.numOptionalArgs;(t.primitive&&l==null||t.type==="sqrt"&&a===1&&r[0]==null)&&(l="primitive");var c=this.parseGroupOfType("argument to '"+e+"'",l,h);if(h)r.push(c);else if(c!=null)i.push(c);else throw new X("Null argument, please report this as a bug")}return{args:i,optArgs:r}}parseGroupOfType(e,t,s){switch(t){case"color":return this.parseColorGroup(s);case"size":return this.parseSizeGroup(s);case"url":return this.parseUrlGroup(s);case"math":case"text":return this.parseArgumentGroup(s,t);case"hbox":{var i=this.parseArgumentGroup(s,"text");return i!=null?{type:"styling",mode:i.mode,body:[i],style:"text"}:null}case"raw":{var r=this.parseStringGroup("raw",s);return r!=null?{type:"raw",mode:"text",string:r.text}:null}case"primitive":{if(s)throw new X("A primitive argument cannot be optional");var a=this.parseGroup(e);if(a==null)throw new X("Expected group as "+e,this.fetch());return a}case"original":case null:case void 0:return this.parseArgumentGroup(s);default:throw new X("Unknown group type as "+e,this.fetch())}}consumeSpaces(){for(;this.fetch().text===" ";)this.consume()}parseStringGroup(e,t){var s=this.gullet.scanArgument(t);if(s==null)return null;for(var i="",r;(r=this.fetch()).text!=="EOF";)i+=r.text,this.consume();return this.consume(),s.text=i,s}parseRegexGroup(e,t){for(var s=this.fetch(),i=s,r="",a;(a=this.fetch()).text!=="EOF"&&e.test(r+a.text);)i=a,r+=i.text,this.consume();if(r==="")throw new X("Invalid "+t+": '"+s.text+"'",s);return s.range(i,r)}parseColorGroup(e){var t=this.parseStringGroup("color",e);if(t==null)return null;var s=/^(#[a-f0-9]{3,4}|#[a-f0-9]{6}|#[a-f0-9]{8}|[a-f0-9]{6}|[a-z]+)$/i.exec(t.text);if(!s)throw new X("Invalid color: '"+t.text+"'",t);var i=s[0];return/^[0-9a-f]{6}$/i.test(i)&&(i="#"+i),{type:"color-token",mode:this.mode,color:i}}parseSizeGroup(e){var t,s=!1;if(this.gullet.consumeSpaces(),!e&&this.gullet.future().text!=="{"?t=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):t=this.parseStringGroup("size",e),!t)return null;!e&&t.text.length===0&&(t.text="0pt",s=!0);var i=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(t.text);if(!i)throw new X("Invalid size: '"+t.text+"'",t);var r={number:+(i[1]+i[2]),unit:i[3]};if(!ob(r))throw new X("Invalid unit: '"+r.unit+"'",t);return{type:"size",mode:this.mode,value:r,isBlank:s}}parseUrlGroup(e){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var t=this.parseStringGroup("url",e);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),t==null)return null;var s=t.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:s}}parseArgumentGroup(e,t){var s=this.gullet.scanArgument(e);if(s==null)return null;var i=this.mode;t&&this.switchMode(t),this.gullet.beginGroup();var r=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var a={type:"ordgroup",mode:this.mode,loc:s.loc,body:r};return t&&this.switchMode(i),a}parseGroup(e,t){var s=this.fetch(),i=s.text,r;if(i==="{"||i==="\\begingroup"){this.consume();var a=i==="{"?"}":"\\endgroup";this.gullet.beginGroup();var l=this.parseExpression(!1,a),h=this.fetch();this.expect(a),this.gullet.endGroup(),r={type:"ordgroup",mode:this.mode,loc:Bs.range(s,h),body:l,semisimple:i==="\\begingroup"||void 0}}else if(r=this.parseFunction(t,e)||this.parseSymbol(),r==null&&i[0]==="\\"&&!Zb.hasOwnProperty(i)){if(this.settings.throwOnError)throw new X("Undefined control sequence: "+i,s);r=this.formatUnsupportedCmd(i),this.consume()}return r}formLigatures(e){for(var t=e.length-1,s=0;s<t;++s){var i=e[s],r=i.text;r==="-"&&e[s+1].text==="-"&&(s+1<t&&e[s+2].text==="-"?(e.splice(s,3,{type:"textord",mode:"text",loc:Bs.range(i,e[s+2]),text:"---"}),t-=2):(e.splice(s,2,{type:"textord",mode:"text",loc:Bs.range(i,e[s+1]),text:"--"}),t-=1)),(r==="'"||r==="`")&&e[s+1].text===r&&(e.splice(s,2,{type:"textord",mode:"text",loc:Bs.range(i,e[s+1]),text:r+r}),t-=1)}}parseSymbol(){var e=this.fetch(),t=e.text;if(/^\\verb[^a-zA-Z]/.test(t)){this.consume();var s=t.slice(5),i=s.charAt(0)==="*";if(i&&(s=s.slice(1)),s.length<2||s.charAt(0)!==s.slice(-1))throw new X(`\\verb assertion failed --
                    please report what input caused this bug`);return s=s.slice(1,-1),{type:"verb",mode:"text",body:s,star:i}}O5.hasOwnProperty(t[0])&&!tt[this.mode][t[0]]&&(this.settings.strict&&this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+t[0]+'" used in math mode',e),t=O5[t[0]]+t.slice(1));var r=s9.exec(t);r&&(t=t.substring(0,r.index),t==="i"?t="ı":t==="j"&&(t="ȷ"));var a;if(tt[this.mode][t]){this.settings.strict&&this.mode==="math"&&g4.indexOf(t)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+t[0]+'" used in math mode',e);var l=tt[this.mode][t].group,h=Bs.range(e),c;if(Xy.hasOwnProperty(l)){var u=l;c={type:"atom",mode:this.mode,family:u,loc:h,text:t}}else c={type:l,mode:this.mode,loc:h,text:t};a=c}else if(t.charCodeAt(0)>=128)this.settings.strict&&(ab(t.charCodeAt(0))?this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+t[0]+'" used in math mode',e):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+t[0]+'"'+(" ("+t.charCodeAt(0)+")"),e)),a={type:"textord",mode:"text",loc:Bs.range(e),text:t};else return null;if(this.consume(),r)for(var d=0;d<r[0].length;d++){var f=r[0][d];if(!Kg[f])throw new X("Unknown accent ' "+f+"'",e);var p=Kg[f][this.mode]||Kg[f].text;if(!p)throw new X("Accent "+f+" unsupported in "+this.mode+" mode",e);a={type:"accent",mode:this.mode,loc:Bs.range(e),label:p,isStretchy:!1,isShifty:!0,base:a}}return a}}xg.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var C3=function(e,t){if(!(typeof e=="string"||e instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var s=new xg(e,t);delete s.gullet.macros.current["\\df@tag"];var i=s.parse();if(delete s.gullet.macros.current["\\current@color"],delete s.gullet.macros.current["\\color"],s.gullet.macros.get("\\df@tag")){if(!t.displayMode)throw new X("\\tag works only in display equations");i=[{type:"tag",mode:"text",body:i,tag:s.subparse([new hi("\\df@tag")])}]}return i},Qb=function(e,t,s){t.textContent="";var i=E3(e,s).toNode();t.appendChild(i)};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),Qb=function(){throw new X("KaTeX doesn't work in quirks mode.")});var o9=function(e,t){var s=E3(e,t).toMarkup();return s},l9=function(e,t){var s=new l3(t);return C3(e,s)},Jb=function(e,t,s){if(s.throwOnError||!(e instanceof X))throw e;var i=B.makeSpan(["katex-error"],[new _i(t)]);return i.setAttribute("title",e.toString()),i.setAttribute("style","color:"+s.errorColor),i},E3=function(e,t){var s=new l3(t);try{var i=C3(e,s);return bw(i,e,s)}catch(r){return Jb(r,e,s)}},h9=function(e,t){var s=new l3(t);try{var i=C3(e,s);return vw(i,e,s)}catch(r){return Jb(r,e,s)}},c9="0.16.25",u9={Span:Nf,Anchor:u3,SymbolNode:_i,SvgNode:Dn,PathNode:za,LineNode:m4},d9={version:c9,render:Qb,renderToString:o9,ParseError:X,SETTINGS_SCHEMA:m1,__parse:l9,__renderToDomTree:E3,__renderToHTMLTree:h9,__setFontMetrics:Hy,__defineSymbol:m,__defineFunction:ie,__defineMacro:C,__domTree:u9};function z5(n,e,t){const s=n.slice();return s[9]=e[t],s}function f9(n){let e;return{c(){e=oe("p"),e.textContent="No chats yet.",U(e,"class","conversation-empty svelte-1ykznrw")},m(t,s){Le(t,e,s)},p:Ns,d(t){t&&De(e)}}}function p9(n){let e,t=Fa(n[0]),s=[];for(let i=0;i<t.length;i+=1)s[i]=H5(z5(n,t,i));return{c(){e=oe("div");for(let i=0;i<s.length;i+=1)s[i].c();U(e,"class","conversation-list svelte-1ykznrw")},m(i,r){Le(i,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(i,r){if(r&19){t=Fa(i[0]);let a;for(a=0;a<t.length;a+=1){const l=z5(i,t,a);s[a]?s[a].p(l,r):(s[a]=H5(l),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(i){i&&De(e),A8(s,i)}}}function H5(n){let e,t,s,i=(n[9].title||"New chat")+"",r,a,l,h=U5(n[9])+"",c,u,d,f,p,w,y;function x(){return n[7](n[9])}function S(){return n[8](n[9])}return{c(){e=oe("div"),t=oe("button"),s=oe("span"),r=Xt(i),a=ke(),l=oe("span"),c=Xt(h),u=ke(),d=oe("button"),d.textContent="✕",f=ke(),U(s,"class","conversation-title svelte-1ykznrw"),U(l,"class","conversation-subtitle svelte-1ykznrw"),U(t,"type","button"),U(t,"class","conversation-select svelte-1ykznrw"),U(d,"type","button"),U(d,"class","conversation-delete svelte-1ykznrw"),U(d,"aria-label","Delete chat"),U(e,"class",p=Wt(`conversation-item ${n[9].id===n[1]?"active":""}`)+" svelte-1ykznrw")},m(E,T){Le(E,e,T),K(e,t),K(t,s),K(s,r),K(t,a),K(t,l),K(l,c),K(e,u),K(e,d),K(e,f),w||(y=[rt(t,"click",x),rt(d,"click",S)],w=!0)},p(E,T){n=E,T&1&&i!==(i=(n[9].title||"New chat")+"")&&Mr(r,i),T&1&&h!==(h=U5(n[9])+"")&&Mr(c,h),T&3&&p!==(p=Wt(`conversation-item ${n[9].id===n[1]?"active":""}`)+" svelte-1ykznrw")&&U(e,"class",p)},d(E){E&&De(e),w=!1,Rr(y)}}}function m9(n){let e,t,s,i,r,a,l,h,c,u,d;function f(y,x){return y[0].length>0?p9:f9}let p=f(n),w=p(n);return{c(){e=oe("aside"),t=oe("div"),s=oe("span"),s.textContent="Chats",i=ke(),r=oe("button"),r.textContent="✕",a=ke(),l=oe("button"),l.textContent="+ New chat",h=ke(),w.c(),U(s,"class","svelte-1ykznrw"),U(r,"class","sidebar-close svelte-1ykznrw"),U(r,"type","button"),U(r,"aria-label","Close chat list"),U(t,"class","sidebar-header svelte-1ykznrw"),U(l,"class","new-chat-btn svelte-1ykznrw"),U(l,"type","button"),U(e,"class",c=Wt(`sidebar ${n[3]?"open":""} ${n[2]?"collapsed":""}`)+" svelte-1ykznrw")},m(y,x){Le(y,e,x),K(e,t),K(t,s),K(t,i),K(t,r),K(e,a),K(e,l),K(e,h),w.m(e,null),u||(d=[rt(r,"click",n[5]),rt(l,"click",n[6])],u=!0)},p(y,[x]){p===(p=f(y))&&w?w.p(y,x):(w.d(1),w=p(y),w&&(w.c(),w.m(e,null))),x&12&&c!==(c=Wt(`sidebar ${y[3]?"open":""} ${y[2]?"collapsed":""}`)+" svelte-1ykznrw")&&U(e,"class",c)},i:Ns,o:Ns,d(y){y&&De(e),w.d(),u=!1,Rr(d)}}}function U5(n){if(!n||!Array.isArray(n.messages)||n.messages.length===0)return"No messages yet";const e=n.messages[n.messages.length-1],t=((e==null?void 0:e.content)||"").replace(/\s+/g," ").trim();return t?t.length>50?`${t.slice(0,50)}…`:t:"No messages yet"}function g9(n,e,t){let{conversations:s=[]}=e,{currentId:i=null}=e,{sidebarCollapsed:r=!1}=e,{sidebarOpen:a=!1}=e;const l=G6(),h=()=>l("close"),c=()=>l("create"),u=f=>l("select",{id:f.id}),d=f=>l("delete",{id:f.id});return n.$$set=f=>{"conversations"in f&&t(0,s=f.conversations),"currentId"in f&&t(1,i=f.currentId),"sidebarCollapsed"in f&&t(2,r=f.sidebarCollapsed),"sidebarOpen"in f&&t(3,a=f.sidebarOpen)},[s,i,r,a,l,h,c,u,d]}class b9 extends fg{constructor(e){super(),dg(this,e,g9,m9,ug,{conversations:0,currentId:1,sidebarCollapsed:2,sidebarOpen:3})}}function q5(n,e,t){const s=n.slice();return s[4]=e[t],s[6]=t,s}function $5(n,e,t){const s=n.slice();return s[7]=e[t],s}function G5(n){let e;return{c(){e=oe("div"),e.innerHTML='<h1 class="svelte-z3xru0">How can I help you today?</h1> <p>Ask anything. Enable web search to pull in fresh context.</p>',U(e,"class","empty-state svelte-z3xru0")},m(t,s){Le(t,e,s)},d(t){t&&De(e)}}}function V5(n){let e=[],t=new Map,s,i,r=Fa(n[1]);const a=h=>h[6];for(let h=0;h<r.length;h+=1){let c=q5(n,r,h),u=a(c);t.set(u,e[h]=K5(u,c))}let l=n[3]&&Z5();return{c(){for(let h=0;h<e.length;h+=1)e[h].c();s=ke(),l&&l.c(),i=a4()},m(h,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(h,c);Le(h,s,c),l&&l.m(h,c),Le(h,i,c)},p(h,c){c&6&&(r=Fa(h[1]),e=Q2(e,c,a,1,h,r,t,s.parentNode,Z2,K5,s,q5)),h[3]?l||(l=Z5(),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null)},d(h){h&&(De(s),De(i));for(let c=0;c<e.length;c+=1)e[c].d(h);l&&l.d(h)}}}function j5(n){let e,t,s,i=n[2](n[4].displayContent??n[4].content)+"",r,a,l=n[4].attachmentsMeta&&n[4].attachmentsMeta.length>0&&W5(n);return{c(){e=oe("div"),t=oe("div"),s=oe("div"),r=ke(),l&&l.c(),U(s,"class","message-content svelte-z3xru0"),U(t,"class","bubble svelte-z3xru0"),U(e,"class",a=Wt(`message ${n[4].role==="user"?"user":"assistant"}`)+" svelte-z3xru0")},m(h,c){Le(h,e,c),K(e,t),K(t,s),s.innerHTML=i,K(t,r),l&&l.m(t,null)},p(h,c){c&6&&i!==(i=h[2](h[4].displayContent??h[4].content)+"")&&(s.innerHTML=i),h[4].attachmentsMeta&&h[4].attachmentsMeta.length>0?l?l.p(h,c):(l=W5(h),l.c(),l.m(t,null)):l&&(l.d(1),l=null),c&2&&a!==(a=Wt(`message ${h[4].role==="user"?"user":"assistant"}`)+" svelte-z3xru0")&&U(e,"class",a)},d(h){h&&De(e),l&&l.d()}}}function W5(n){let e,t=[],s=new Map,i=Fa(n[4].attachmentsMeta);const r=a=>a[7].id??a[7].name;for(let a=0;a<i.length;a+=1){let l=$5(n,i,a),h=r(l);s.set(h,t[a]=Y5(h,l))}return{c(){e=oe("div");for(let a=0;a<t.length;a+=1)t[a].c();U(e,"class","message-attachments svelte-z3xru0")},m(a,l){Le(a,e,l);for(let h=0;h<t.length;h+=1)t[h]&&t[h].m(e,null)},p(a,l){l&2&&(i=Fa(a[4].attachmentsMeta),t=Q2(t,l,r,1,a,i,s,e,Z2,Y5,null,$5))},d(a){a&&De(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function X5(n){let e,t=n[7].sizeLabel+"",s;return{c(){e=oe("span"),s=Xt(t),U(e,"class","file-size svelte-z3xru0")},m(i,r){Le(i,e,r),K(e,s)},p(i,r){r&2&&t!==(t=i[7].sizeLabel+"")&&Mr(s,t)},d(i){i&&De(e)}}}function Y5(n,e){let t,s,i=e[7].name+"",r,a,l=e[7].sizeLabel&&X5(e);return{key:n,first:null,c(){t=oe("div"),s=oe("span"),r=Xt(i),a=ke(),l&&l.c(),U(s,"class","file-name"),U(t,"class","attachment-token svelte-z3xru0"),this.first=t},m(h,c){Le(h,t,c),K(t,s),K(s,r),K(t,a),l&&l.m(t,null)},p(h,c){e=h,c&2&&i!==(i=e[7].name+"")&&Mr(r,i),e[7].sizeLabel?l?l.p(e,c):(l=X5(e),l.c(),l.m(t,null)):l&&(l.d(1),l=null)},d(h){h&&De(t),l&&l.d()}}}function K5(n,e){let t,s=e[4].role!=="assistant"||e[4].content&&e[4].content.trim().length>0,i,r=s&&j5(e);return{key:n,first:null,c(){t=a4(),r&&r.c(),i=a4(),this.first=t},m(a,l){Le(a,t,l),r&&r.m(a,l),Le(a,i,l)},p(a,l){e=a,l&2&&(s=e[4].role!=="assistant"||e[4].content&&e[4].content.trim().length>0),s?r?r.p(e,l):(r=j5(e),r.c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null)},d(a){a&&(De(t),De(i)),r&&r.d(a)}}}function Z5(n){let e;return{c(){e=oe("div"),e.innerHTML='<div class="bubble loading-bubble svelte-z3xru0" aria-live="polite"><span class="dot svelte-z3xru0"></span> <span class="dot svelte-z3xru0"></span> <span class="dot svelte-z3xru0"></span></div>',U(e,"class","message assistant svelte-z3xru0")},m(t,s){Le(t,e,s)},d(t){t&&De(e)}}}function v9(n){let e,t,s,i,r=(!n[0]||n[1].length===0)&&G5(),a=n[0]&&V5(n);return{c(){e=oe("div"),r&&r.c(),t=ke(),a&&a.c(),U(e,"id","messages"),U(e,"class","messages svelte-z3xru0")},m(l,h){Le(l,e,h),r&&r.m(e,null),K(e,t),a&&a.m(e,null),s||(i=rt(e,"click",y9),s=!0)},p(l,[h]){!l[0]||l[1].length===0?r||(r=G5(),r.c(),r.m(e,t)):r&&(r.d(1),r=null),l[0]?a?a.p(l,h):(a=V5(l),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i:Ns,o:Ns,d(l){l&&De(e),r&&r.d(),a&&a.d(),s=!1,i()}}}function y9(n){var a,l;const e=n.target.closest(".copy-btn");if(!e)return;const t=(a=e.parentElement)==null?void 0:a.querySelector("code");if(!t)return;const s=t.innerText;if(!s)return;const i=e.textContent,r=()=>{e.textContent=i};if(e.textContent="Copied!",setTimeout(r,1500),(l=navigator==null?void 0:navigator.clipboard)!=null&&l.writeText)navigator.clipboard.writeText(s).catch(r);else{const h=document.createElement("textarea");h.value=s,document.body.appendChild(h),h.select();try{document.execCommand("copy")}finally{document.body.removeChild(h)}}}function w9(n,e,t){let{currentConversation:s=null}=e,{currentMessages:i=[]}=e,{renderMarkdown:r=l=>l??""}=e,{loading:a=!1}=e;return n.$$set=l=>{"currentConversation"in l&&t(0,s=l.currentConversation),"currentMessages"in l&&t(1,i=l.currentMessages),"renderMarkdown"in l&&t(2,r=l.renderMarkdown),"loading"in l&&t(3,a=l.loading)},[s,i,r,a]}class A9 extends fg{constructor(e){super(),dg(this,e,w9,v9,ug,{currentConversation:0,currentMessages:1,renderMarkdown:2,loading:3})}}const x9="modulepreload",S9=function(n){return"/"+n},Q5={},k9=function(e,t,s){if(!t||t.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(t.map(r=>{if(r=S9(r),r in Q5)return;Q5[r]=!0;const a=r.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!s)for(let u=i.length-1;u>=0;u--){const d=i[u];if(d.href===r&&(!a||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${l}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":x9,a||(c.as="script",c.crossOrigin=""),c.href=r,document.head.appendChild(c),a)return new Promise((u,d)=>{c.addEventListener("load",u),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e()).catch(r=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r})},ys=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),x4=[.001,0,0,.001,0,0],Zg=1.35,ai={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},On={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Wc="pdfjs_internal_editor_",be={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Te={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},T9={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},S4={TRIANGLES:1,LATTICE:2,PATCH:3},Kt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},b1={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Mt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ql={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Sg={ERRORS:0,WARNINGS:1,INFOS:5},Xc={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},dc={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},C9={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let kg=Sg.WARNINGS;function E9(n){Number.isInteger(n)&&(kg=n)}function _9(){return kg}function Tg(n){kg>=Sg.INFOS&&console.info(`Info: ${n}`)}function pe(n){kg>=Sg.WARNINGS&&console.warn(`Warning: ${n}`)}function Xe(n){throw new Error(n)}function Ce(n,e){n||Xe(e)}function M9(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function e7(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=I9(n)}catch{}}const s=e?URL.parse(n,e):URL.parse(n);return M9(s)?s:null}function t7(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&e7(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function me(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Nl=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class J5 extends Nl{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Qg extends Nl{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class k4 extends Nl{constructor(e){super(e,"InvalidPDFException")}}class ap extends Nl{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class D9 extends Nl{constructor(e){super(e,"FormatError")}}class Ua extends Nl{constructor(e){super(e,"AbortException")}}function s7(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Xe("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),a=n.subarray(i,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function Of(n){typeof n!="string"&&Xe("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function R9(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function P9(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function L9(){try{return new Function(""),!0}catch{return!1}}class rs{static get isLittleEndian(){return me(this,"isLittleEndian",P9())}static get isEvalSupported(){return me(this,"isEvalSupported",L9())}static get isOffscreenCanvasSupported(){return me(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return me(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return me(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return me(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return me(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return me(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Jg=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var n0,v1,Jc,T4;class ae{static makeHexColor(e,t,s){return`#${Jg[e]}${Jg[t]}${Jg[s]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,s=0){const i=e[s],r=e[s+1];e[s]=i*t[0]+r*t[2]+t[4],e[s+1]=i*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const i=t[0],r=t[1],a=t[2],l=t[3],h=t[4],c=t[5];for(let u=0;u<6;u+=2){const d=e[s+u],f=e[s+u+1];e[s+u]=d*i+f*a+h,e[s+u+1]=d*r+f*l+c}}static applyInverseTransform(e,t){const s=e[0],i=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-s*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,s){const i=t[0],r=t[1],a=t[2],l=t[3],h=t[4],c=t[5],u=e[0],d=e[1],f=e[2],p=e[3];let w=i*u+h,y=w,x=i*f+h,S=x,E=l*d+c,T=E,_=l*p+c,M=_;if(r!==0||a!==0){const D=r*u,L=r*f,F=a*d,N=a*p;w+=F,S+=F,x+=N,y+=N,E+=D,M+=D,_+=L,T+=L}s[0]=Math.min(s[0],w,x,y,S),s[1]=Math.min(s[1],E,_,T,M),s[2]=Math.max(s[2],w,x,y,S),s[3]=Math.max(s[3],E,_,T,M)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],i=e[1],r=e[2],a=e[3],l=s**2+i**2,h=s*r+i*a,c=r**2+a**2,u=(l+c)/2,d=Math.sqrt(u**2-(l*c-h**2));t[0]=Math.sqrt(u+d||1),t[1]=Math.sqrt(u-d||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,i,a]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,i,r){r[0]=Math.min(r[0],e,s),r[1]=Math.min(r[1],t,i),r[2]=Math.max(r[2],e,s),r[3]=Math.max(r[3],t,i)}static bezierBoundingBox(e,t,s,i,r,a,l,h,c){c[0]=Math.min(c[0],e,l),c[1]=Math.min(c[1],t,h),c[2]=Math.max(c[2],e,l),c[3]=Math.max(c[3],t,h),A(this,Jc,T4).call(this,e,s,r,l,t,i,a,h,3*(-e+3*(s-r)+l),6*(e-2*s+r),3*(s-e),c),A(this,Jc,T4).call(this,e,s,r,l,t,i,a,h,3*(-t+3*(i-a)+h),6*(t-2*i+a),3*(i-t),c)}}n0=new WeakSet,v1=function(e,t,s,i,r,a,l,h,c,u){if(c<=0||c>=1)return;const d=1-c,f=c*c,p=f*c,w=d*(d*(d*e+3*c*t)+3*f*s)+p*i,y=d*(d*(d*r+3*c*a)+3*f*l)+p*h;u[0]=Math.min(u[0],w),u[1]=Math.min(u[1],y),u[2]=Math.max(u[2],w),u[3]=Math.max(u[3],y)},Jc=new WeakSet,T4=function(e,t,s,i,r,a,l,h,c,u,d,f){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&A(this,n0,v1).call(this,e,t,s,i,r,a,l,h,-d/u,f);return}const p=u**2-4*d*c;if(p<0)return;const w=Math.sqrt(p),y=2*c;A(this,n0,v1).call(this,e,t,s,i,r,a,l,h,(-u+w)/y,f),A(this,n0,v1).call(this,e,t,s,i,r,a,l,h,(-u-w)/y,f)},g(ae,n0),g(ae,Jc);function I9(n){return decodeURIComponent(escape(n))}let e4=null,e6=null;function B9(n){return e4||(e4=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,e6=new Map([["ﬅ","ſt"]])),n.replaceAll(e4,(e,t,s)=>t?t.normalize("NFKC"):e6.get(s))}function i7(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),s7(n)}const Kl="pdfjs_internal_id_";function N9(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,i,...r]=t;if(!n(s)&&!Number.isInteger(s)||!e(i))return!1;const a=r.length;let l=!0;switch(i.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;l=!1;break;default:return!1}for(const h of r)if(!(typeof h=="number"||l&&h===null))return!1;return!0}function ws(n,e,t){return Math.min(Math.max(n,e),t)}function r7(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(s7(n))}function F9(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):Of(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class Yc{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var h;if(!r)return;let a=null;const l=r.name;if(l==="#text")a=r.value;else if(Yc.shouldBuildText(l))(h=r==null?void 0:r.attributes)!=null&&h.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const c of r.children)i(c)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class n7{static setupStorage(e,t,s,i,r){const a=i.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",l=>{i.setValue(t,{value:l.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",l=>{i.setValue(t,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",l=>{i.setValue(t,{value:l.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const l of s.children)l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}e.addEventListener("input",l=>{const h=l.target.options,c=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:a}=t,l=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[h,c]of Object.entries(a))if(c!=null)switch(h){case"class":c.length&&e.setAttribute(h,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!l||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,c)}l&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var d,f;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:s});const l=r!=="richText",h=e.div;if(h.append(a),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=p}l&&h.setAttribute("class","xfaLayer xfaFont");const c=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);a.append(p),l&&Yc.shouldBuildText(i.name)&&c.push(p)}return{textDivs:c}}const u=[[i,-1,a]];for(;u.length>0;){const[p,w,y]=u.at(-1);if(w+1===p.children.length){u.pop();continue}const x=p.children[++u.at(-1)[1]];if(x===null)continue;const{name:S}=x;if(S==="#text"){const T=document.createTextNode(x.value);c.push(T),y.append(T);continue}const E=(d=x==null?void 0:x.attributes)!=null&&d.xmlns?document.createElementNS(x.attributes.xmlns,S):document.createElement(S);if(y.append(E),x.attributes&&this.setAttributes({html:E,element:x,storage:t,intent:r,linkService:s}),((f=x.children)==null?void 0:f.length)>0)u.push([x,-1,E]);else if(x.value){const T=document.createTextNode(x.value);l&&Yc.shouldBuildText(S)&&c.push(T),E.append(T)}}for(const p of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Or="http://www.w3.org/2000/svg",Ya=class Ya{};O(Ya,"CSS",96),O(Ya,"PDF",72),O(Ya,"PDF_TO_CSS_UNITS",Ya.CSS/Ya.PDF);let qa=Ya;async function zf(n,e="text"){if(yc(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Hf{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:l=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=a,s*=t;const h=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let u,d,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:u=-1,d=0,f=0,p=1;break;case 90:u=0,d=1,f=1,p=0;break;case 270:u=0,d=-1,f=-1,p=0;break;case 0:u=1,d=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(f=-f,p=-p);let w,y,x,S;u===0?(w=Math.abs(c-e[1])*s+r,y=Math.abs(h-e[0])*s+a,x=(e[3]-e[1])*s,S=(e[2]-e[0])*s):(w=Math.abs(h-e[0])*s+r,y=Math.abs(c-e[1])*s+a,x=(e[2]-e[0])*s,S=(e[3]-e[1])*s),this.transform=[u*s,d*s,f*s,p*s,w-u*s*h-f*s*c,y-d*s*h-p*s*c],this.width=x,this.height=S}get rawDims(){const e=this.viewBox;return me(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new Hf({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){const s=[e,t];return ae.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];ae.applyTransform(t,this.transform);const s=[e[2],e[3]];return ae.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return ae.applyInverseTransform(s,this.transform),s}}class _3 extends Nl{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Cg(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function M3(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function O9(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function z9(n,e="document.pdf"){if(typeof n!="string")return e;if(Cg(n))return pe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(l=>{try{return new URL(l)}catch{try{return new URL(decodeURIComponent(l))}catch{try{return new URL(l,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(l),"https://foo.bar")}catch{return null}}}}})(n);if(!s)return e;const i=l=>{try{let h=decodeURIComponent(l);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:l):h}catch{return l}},r=/\.pdf$/i,a=s.pathname.split("/").at(-1);if(r.test(a))return i(a);if(s.searchParams.size>0){const l=Array.from(s.searchParams.values()).reverse();for(const c of l)if(r.test(c))return i(c);const h=Array.from(s.searchParams.keys()).reverse();for(const c of h)if(r.test(c))return i(c)}if(s.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(h)return i(h[0])}return e}class t6{constructor(){O(this,"started",Object.create(null));O(this,"times",[])}time(e){e in this.started&&pe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||pe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function yc(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Di(n){n.preventDefault()}function St(n){n.preventDefault(),n.stopPropagation()}function H9(n){console.log("Deprecated API usage: "+n)}var eu;class op{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;o(this,eu)||b(this,eu,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=o(this,eu).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let l=parseInt(t[5],10);l=l>=0&&l<=59?l:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const c=t[7]||"Z";let u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,c==="-"?(a+=u,l+=d):c==="+"&&(a-=u,l-=d),new Date(Date.UTC(s,i,r,a,l,h))}}eu=new WeakMap,g(op,eu,void 0);function U9(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new Hf({viewBox:r,userUnit:1,scale:e,rotation:t})}function Uf(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(pe(`Not a valid color format: "${n}"`),[0,0,0])}function q9(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Uf(s))}e.remove()}function pt(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform();return[e,t,s,i,r,a]}function er(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform().invertSelf();return[e,t,s,i,r,a]}function Rl(n,e,t=!1,s=!0){if(e instanceof Hf){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=n,l=rs.isCSSRoundSupported,h=`var(--total-scale-factor) * ${i}px`,c=`var(--total-scale-factor) * ${r}px`,u=l?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,d=l?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=u,a.height=d):(a.width=d,a.height=u)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Dr{constructor(){const{pixelRatio:e}=Dr;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,i,r=-1){let a=1/0,l=1/0,h=1/0;s=Dr.capPixels(s,r),s>0&&(a=Math.sqrt(s/(e*t))),i!==-1&&(l=i/e,h=i/t);const c=Math.min(a,l,h);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const C4=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class $9{static get isDarkMode(){var e;return me(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class G9{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:s}=window.getComputedStyle(e);return e.remove(),me(this,"commentForegroundColor",Uf(s))}}function V9(n,e,t,s){s=Math.min(Math.max(s??1,0),1);const i=255*(1-s);return n=Math.round(n*s+i),e=Math.round(e*s+i),t=Math.round(t*s+i),[n,e,t]}function s6(n,e){const t=n[0]/255,s=n[1]/255,i=n[2]/255,r=Math.max(t,s,i),a=Math.min(t,s,i),l=(r+a)/2;if(r===a)e[0]=e[1]=0;else{const h=r-a;switch(e[1]=l<.5?h/(r+a):h/(2-r-a),r){case t:e[0]=((s-i)/h+(s<i?6:0))*60;break;case s:e[0]=((i-t)/h+2)*60;break;case i:e[0]=((t-s)/h+4)*60;break}}e[2]=l}function E4(n,e){const t=n[0],s=n[1],i=n[2],r=(1-Math.abs(2*i-1))*s,a=r*(1-Math.abs(t/60%2-1)),l=i-r/2;switch(Math.floor(t/60)){case 0:e[0]=r+l,e[1]=a+l,e[2]=l;break;case 1:e[0]=a+l,e[1]=r+l,e[2]=l;break;case 2:e[0]=l,e[1]=r+l,e[2]=a+l;break;case 3:e[0]=l,e[1]=a+l,e[2]=r+l;break;case 4:e[0]=a+l,e[1]=l,e[2]=r+l;break;case 5:case 6:e[0]=r+l,e[1]=l,e[2]=a+l;break}}function i6(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function r6(n,e,t){E4(n,t),t.map(i6);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];E4(e,t),t.map(i6);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return s>i?(s+.05)/(i+.05):(i+.05)/(s+.05)}const n6=new Map;function j9(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let s=n6.get(t);if(s)return s;const i=new Float32Array(9),r=i.subarray(0,3),a=i.subarray(3,6);s6(n,a);const l=i.subarray(6,9);s6(e,l);const h=l[2]<.5,c=h?12:4.5;if(a[2]=h?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),r6(a,l,r)<c){let u,d;h?(u=a[2],d=1):(u=0,d=a[2]);const f=.005;for(;d-u>f;){const p=a[2]=(u+d)/2;h===r6(a,l,r)<c?u=p:d=p}a[2]=h?d:u}return E4(a,r),s=ae.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),n6.set(t,s),s}function a7({html:n,dir:e,className:t},s){const i=document.createDocumentFragment();if(typeof n=="string"){const r=document.createElement("p");r.dir=e||"auto";const a=n.split(/(?:\r\n?|\n)/);for(let l=0,h=a.length;l<h;++l){const c=a[l];r.append(document.createTextNode(c)),l<h-1&&r.append(document.createElement("br"))}i.append(r)}else n7.render({xfaHtml:n,div:i,intent:"richText"});i.firstElementChild.classList.add("richText",t),s.append(i)}function o7(n){const e=new Path2D;if(!n)return e;for(let t=0,s=n.length;t<s;)switch(n[t++]){case dc.moveTo:e.moveTo(n[t++],n[t++]);break;case dc.lineTo:e.lineTo(n[t++],n[t++]);break;case dc.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case dc.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case dc.closePath:e.closePath();break;default:pe(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}var zn,Hn,pi,mi,tu,Un,a0,o0,su,yp,l7,wp,h7,Ap,c7,qn,$l,Qa,wc;const Ur=class Ur{constructor(e){g(this,wp);g(this,Ap);g(this,qn);g(this,Qa);g(this,zn,null);g(this,Hn,null);g(this,pi,void 0);g(this,mi,null);g(this,tu,null);g(this,Un,null);g(this,a0,null);g(this,o0,null);b(this,pi,e),o(Ur,su)||b(Ur,su,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=b(this,zn,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=o(this,pi)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Di,{signal:t}),e.addEventListener("pointerdown",A(Ur,yp,l7),{signal:t}));const s=b(this,mi,document.createElement("div"));s.className="buttons",e.append(s);const i=o(this,pi).toolbarPosition;if(i){const{style:r}=e,a=o(this,pi)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return o(this,zn)}hide(){var e;o(this,zn).classList.add("hidden"),(e=o(this,Hn))==null||e.hideDropdown()}show(){var e,t;o(this,zn).classList.remove("hidden"),(e=o(this,tu))==null||e.shown(),(t=o(this,Un))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=o(this,pi),s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",o(Ur,su)[e]),A(this,qn,$l).call(this,s)&&s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),o(this,mi).append(s)}async addAltText(e){const t=await e.render();A(this,qn,$l).call(this,t),o(this,mi).append(t,o(this,Qa,wc)),b(this,tu,e)}addComment(e,t=null){if(o(this,Un))return;const s=e.renderForToolbar();if(!s)return;A(this,qn,$l).call(this,s);const i=b(this,a0,o(this,Qa,wc));t?(o(this,mi).insertBefore(s,t),o(this,mi).insertBefore(i,t)):o(this,mi).append(s,i),b(this,Un,e),e.toolbar=this}addColorPicker(e){if(o(this,Hn))return;b(this,Hn,e);const t=e.renderButton();A(this,qn,$l).call(this,t),o(this,mi).append(t,o(this,Qa,wc))}async addEditSignatureButton(e){const t=b(this,o0,await e.renderEditButton(o(this,pi)));A(this,qn,$l).call(this,t),o(this,mi).append(t,o(this,Qa,wc))}removeButton(e){var t,s;switch(e){case"comment":(t=o(this,Un))==null||t.removeToolbarCommentButton(),b(this,Un,null),(s=o(this,a0))==null||s.remove(),b(this,a0,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,s){if(!t&&e==="comment")return;const i=o(this,mi).querySelector(s);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){o(this,o0)&&(o(this,o0).title=e)}remove(){var e;o(this,zn).remove(),(e=o(this,Hn))==null||e.destroy(),b(this,Hn,null)}};zn=new WeakMap,Hn=new WeakMap,pi=new WeakMap,mi=new WeakMap,tu=new WeakMap,Un=new WeakMap,a0=new WeakMap,o0=new WeakMap,su=new WeakMap,yp=new WeakSet,l7=function(e){e.stopPropagation()},wp=new WeakSet,h7=function(e){o(this,pi)._focusEventsAllowed=!1,St(e)},Ap=new WeakSet,c7=function(e){o(this,pi)._focusEventsAllowed=!0,St(e)},qn=new WeakSet,$l=function(e){const t=o(this,pi)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",A(this,wp,h7).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",A(this,Ap,c7).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Di,{signal:t}),!0)},Qa=new WeakSet,wc=function(){const e=document.createElement("div");return e.className="divider",e},g(Ur,yp),g(Ur,su,null);let _4=Ur;var iu,Ja,Gr,xp,u7,Sp,d7,ru,M4;class W9{constructor(e){g(this,xp);g(this,Sp);g(this,ru);g(this,iu,null);g(this,Ja,null);g(this,Gr,void 0);b(this,Gr,e)}show(e,t,s){const[i,r]=A(this,Sp,d7).call(this,t,s),{style:a}=o(this,Ja)||b(this,Ja,A(this,xp,u7).call(this));e.append(o(this,Ja)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){o(this,Ja).remove()}}iu=new WeakMap,Ja=new WeakMap,Gr=new WeakMap,xp=new WeakSet,u7=function(){const e=b(this,Ja,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=o(this,Gr)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Di,{signal:t});const s=b(this,iu,document.createElement("div"));return s.className="buttons",e.append(s),o(this,Gr).hasCommentManager()&&A(this,ru,M4).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{o(this,Gr).commentSelection("floating_button")}),A(this,ru,M4).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{o(this,Gr).highlightSelection("floating_button")}),e},Sp=new WeakSet,d7=function(e,t){let s=0,i=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const l=r.x+(t?r.width:0);if(a>s){i=l,s=a;continue}t?l>i&&(i=l):l<i&&(i=l)}return[t?1-i:i,s]},ru=new WeakSet,M4=function(e,t,s,i){const r=document.createElement("button");r.classList.add("basic",e),r.tabIndex=0,r.setAttribute("data-l10n-id",t);const a=document.createElement("span");r.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",s);const l=o(this,Gr)._signal;l instanceof AbortSignal&&!l.aborted&&(r.addEventListener("contextmenu",Di,{signal:l}),r.addEventListener("click",i,{signal:l})),o(this,iu).append(r)};function f7(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var eo,to,l0,so;const He=class He{static initializeAndAddPointerId(e){(o(He,to)||b(He,to,new Set)).add(e)}static setPointer(e,t){o(He,eo)||b(He,eo,t),o(He,so)??b(He,so,e)}static setTimeStamp(e){b(He,l0,e)}static isSamePointerId(e){return o(He,eo)===e}static isSamePointerIdOrRemove(e){var t;return o(He,eo)===e?!0:((t=o(He,to))==null||t.delete(e),!1)}static isSamePointerType(e){return o(He,so)===e}static isInitializedAndDifferentPointerType(e){return o(He,so)!==null&&!He.isSamePointerType(e)}static isSameTimeStamp(e){return o(He,l0)===e}static isUsingMultiplePointers(){var e;return((e=o(He,to))==null?void 0:e.size)>=1}static clearPointerType(){b(He,so,null)}static clearPointerIds(){b(He,eo,NaN),b(He,to,null)}static clearTimeStamp(){b(He,l0,NaN)}};eo=new WeakMap,to=new WeakMap,l0=new WeakMap,so=new WeakMap,g(He,eo,NaN),g(He,to,null),g(He,l0,NaN),g(He,so,null);let os=He;var kp;class X9{constructor(){g(this,kp,0)}get id(){return`${Wc}${Lt(this,kp)._++}`}}kp=new WeakMap;var h0,nu,ls,c0,y1;const F3=class F3{constructor(){g(this,c0);g(this,h0,i7());g(this,nu,0);g(this,ls,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return me(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return A(this,c0,y1).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return A(this,c0,y1).call(this,e,e)}async getFromBlob(e,t){const s=await t;return A(this,c0,y1).call(this,e,s)}async getFromId(e){o(this,ls)||b(this,ls,new Map);const t=o(this,ls).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){o(this,ls)||b(this,ls,new Map);let s=o(this,ls).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${o(this,h0)}_${Lt(this,nu)._++}`,refCounter:1,isSvg:!1},o(this,ls).set(e,s),o(this,ls).set(s.id,s),s}getSvgUrl(e){const t=o(this,ls).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;o(this,ls)||b(this,ls,new Map);const t=o(this,ls).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${o(this,h0)}_`)}};h0=new WeakMap,nu=new WeakMap,ls=new WeakMap,c0=new WeakSet,y1=async function(e,t){o(this,ls)||b(this,ls,new Map);let s=o(this,ls).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${o(this,h0)}_${Lt(this,nu)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await zf(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=F3._isSVGFittingCanvas,a=new FileReader,l=new Image,h=new Promise((c,u)=>{l.onload=()=>{s.bitmap=l,s.isSvg=!0,c()},a.onload=async()=>{const d=s.svgUrl=a.result;l.src=await r?`${d}#svgView(preserveAspectRatio(none))`:d},l.onerror=a.onerror=u});a.readAsDataURL(i),await h}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){pe(i),s=null}return o(this,ls).set(e,s),s&&o(this,ls).set(s.id,s),s};let D4=F3;var Tt,$n,au,dt;class Y9{constructor(e=128){g(this,Tt,[]);g(this,$n,!1);g(this,au,void 0);g(this,dt,-1);b(this,au,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:l=!1}){if(i&&e(),o(this,$n))return;const h={cmd:e,undo:t,post:s,type:r};if(o(this,dt)===-1){o(this,Tt).length>0&&(o(this,Tt).length=0),b(this,dt,0),o(this,Tt).push(h);return}if(a&&o(this,Tt)[o(this,dt)].type===r){l&&(h.undo=o(this,Tt)[o(this,dt)].undo),o(this,Tt)[o(this,dt)]=h;return}const c=o(this,dt)+1;c===o(this,au)?o(this,Tt).splice(0,1):(b(this,dt,c),c<o(this,Tt).length&&o(this,Tt).splice(c)),o(this,Tt).push(h)}undo(){if(o(this,dt)===-1)return;b(this,$n,!0);const{undo:e,post:t}=o(this,Tt)[o(this,dt)];e(),t==null||t(),b(this,$n,!1),b(this,dt,o(this,dt)-1)}redo(){if(o(this,dt)<o(this,Tt).length-1){b(this,dt,o(this,dt)+1),b(this,$n,!0);const{cmd:e,post:t}=o(this,Tt)[o(this,dt)];e(),t==null||t(),b(this,$n,!1)}}hasSomethingToUndo(){return o(this,dt)!==-1}hasSomethingToRedo(){return o(this,dt)<o(this,Tt).length-1}cleanType(e){if(o(this,dt)!==-1){for(let t=o(this,dt);t>=0;t--)if(o(this,Tt)[t].type!==e){o(this,Tt).splice(t+1,o(this,dt)-t),b(this,dt,t);return}o(this,Tt).length=0,b(this,dt,-1)}}destroy(){b(this,Tt,null)}}Tt=new WeakMap,$n=new WeakMap,au=new WeakMap,dt=new WeakMap;var Tp,p7;class qf{constructor(e){g(this,Tp);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=rs.platform;for(const[s,i,r={}]of e)for(const a of s){const l=a.startsWith("mac+");t&&l?(this.callbacks.set(a.slice(4),{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!l&&(this.callbacks.set(a,{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(A(this,Tp,p7).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:l=null}}=s;l&&!l(e,t)||(i.bind(e,...a,t)(),r||St(t))}}Tp=new WeakSet,p7=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Cp=class Cp{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return q9(e),me(this,"_colors",e)}convert(e){const t=Uf(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,a)=>r===t[a]))return Cp._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?ae.makeHexColor(...t):e}};O(Cp,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let R4=Cp;var u0,Us,d0,yt,Bt,f0,gi,p0,bi,hs,Gn,Vn,m0,jn,ir,vi,io,ou,lu,g0,hu,rr,Wn,b0,Xn,nr,Ep,Yn,v0,cu,Kn,ro,y0,Zn,uu,Dt,Oe,Vr,Qn,Jn,du,w0,fu,ea,ar,jr,pu,mu,yi,A0,w1,gu,P4,_p,m7,Mp,g7,no,Ac,Dp,b7,Rp,v7,Pp,y7,bu,L4,Lp,w7,Ip,A7,Bp,x7,Np,S7,Zt,ps,Bi,zr,Fp,k7,Op,T7,vu,I4,zp,C7,ao,xc,yu,B4;const Ql=class Ql{constructor(e,t,s,i,r,a,l,h,c,u,d,f,p,w,y,x){g(this,A0);g(this,gu);g(this,_p);g(this,Mp);g(this,no);g(this,Dp);g(this,Rp);g(this,Pp);g(this,bu);g(this,Lp);g(this,Ip);g(this,Bp);g(this,Np);g(this,Zt);g(this,Bi);g(this,Fp);g(this,Op);g(this,vu);g(this,zp);g(this,ao);g(this,yu);g(this,u0,new AbortController);g(this,Us,null);g(this,d0,null);g(this,yt,new Map);g(this,Bt,new Map);g(this,f0,null);g(this,gi,null);g(this,p0,null);g(this,bi,new Y9);g(this,hs,null);g(this,Gn,null);g(this,Vn,null);g(this,m0,0);g(this,jn,new Set);g(this,ir,null);g(this,vi,null);g(this,io,new Set);O(this,"_editorUndoBar",null);g(this,ou,!1);g(this,lu,!1);g(this,g0,!1);g(this,hu,null);g(this,rr,null);g(this,Wn,null);g(this,b0,null);g(this,Xn,!1);g(this,nr,null);g(this,Ep,new X9);g(this,Yn,!1);g(this,v0,!1);g(this,cu,!1);g(this,Kn,null);g(this,ro,null);g(this,y0,null);g(this,Zn,null);g(this,uu,null);g(this,Dt,be.NONE);g(this,Oe,new Set);g(this,Vr,null);g(this,Qn,null);g(this,Jn,null);g(this,du,null);g(this,w0,null);g(this,fu,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});g(this,ea,[0,0]);g(this,ar,null);g(this,jr,null);g(this,pu,null);g(this,mu,null);g(this,yi,null);const S=this._signal=o(this,u0).signal;b(this,jr,e),b(this,pu,t),b(this,mu,s),b(this,f0,i),b(this,hs,r),b(this,Qn,a),b(this,w0,h),this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:S}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:S}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:S}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:S}),l._on("setpreference",this.onSetPreference.bind(this),{signal:S}),l._on("switchannotationeditorparams",E=>this.updateParams(E.type,E.value),{signal:S}),window.addEventListener("pointerdown",()=>{b(this,v0,!0)},{capture:!0,signal:S}),window.addEventListener("pointerup",()=>{b(this,v0,!1)},{capture:!0,signal:S}),A(this,Dp,b7).call(this),A(this,Np,S7).call(this),A(this,bu,L4).call(this),b(this,gi,h.annotationStorage),b(this,hu,h.filterFactory),b(this,Jn,c),b(this,b0,u||null),b(this,ou,d),b(this,lu,f),b(this,g0,p),b(this,uu,w||null),this.viewParameters={realScale:qa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=y||null,this._supportsPinchToZoom=x!==!1,r==null||r.setSidebarUiManager(this)}static get _keyboardManager(){const e=Ql.prototype,t=a=>o(a,jr).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:l})=>{if(l instanceof HTMLInputElement){const{type:h}=l;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return me(this,"_keyboardManager",new qf([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&o(a,jr).contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&o(a,jr).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r,a,l,h,c;(e=o(this,yi))==null||e.resolve(),b(this,yi,null),(t=o(this,u0))==null||t.abort(),b(this,u0,null),this._signal=null;for(const u of o(this,Bt).values())u.destroy();o(this,Bt).clear(),o(this,yt).clear(),o(this,io).clear(),(s=o(this,Zn))==null||s.clear(),b(this,Us,null),o(this,Oe).clear(),o(this,bi).destroy(),(i=o(this,f0))==null||i.destroy(),(r=o(this,hs))==null||r.destroy(),(a=o(this,Qn))==null||a.destroy(),(l=o(this,nr))==null||l.hide(),b(this,nr,null),(h=o(this,y0))==null||h.destroy(),b(this,y0,null),b(this,d0,null),o(this,rr)&&(clearTimeout(o(this,rr)),b(this,rr,null)),o(this,ar)&&(clearTimeout(o(this,ar)),b(this,ar,null)),(c=this._editorUndoBar)==null||c.destroy(),b(this,w0,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return o(this,uu)}get useNewAltTextFlow(){return o(this,lu)}get useNewAltTextWhenAddingImage(){return o(this,g0)}get hcmFilter(){return me(this,"hcmFilter",o(this,Jn)?o(this,hu).addHCMFilter(o(this,Jn).foreground,o(this,Jn).background):"none")}get direction(){return me(this,"direction",getComputedStyle(o(this,jr)).direction)}get _highlightColors(){return me(this,"_highlightColors",o(this,b0)?new Map(o(this,b0).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return me(this,"highlightColors",null);const t=new Map,s=!!o(this,Jn);for(const[i,r]of e){const a=i.endsWith("_HCM");if(s&&a){t.set(i.replace("_HCM",""),r);continue}!s&&!a&&t.set(i,r)}return me(this,"highlightColors",t)}get highlightColorNames(){return me(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),b(this,Vn,e)}setMainHighlightColorPicker(e){b(this,y0,e)}editAltText(e,t=!1){var s;(s=o(this,f0))==null||s.editAltText(this,e,t)}hasCommentManager(){return!!o(this,hs)}editComment(e,t,s,i){var r;(r=o(this,hs))==null||r.showDialog(this,e,t,s,i)}selectComment(e,t){const s=o(this,Bt).get(e),i=s==null?void 0:s.getEditorByUID(t);i==null||i.toggleComment(!0,!0)}updateComment(e){var t;(t=o(this,hs))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=o(this,hs))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=o(this,hs))==null||t.removeComments([e.uid])}toggleComment(e,t,s=void 0){var i;(i=o(this,hs))==null||i.toggleCommentPopup(e,t,s)}makeCommentColor(e,t){var s;return e&&((s=o(this,hs))==null?void 0:s.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=o(this,hs))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(o(this,Bt).has(e-1))return;const{resolve:t,promise:s}=Promise.withResolvers(),i=r=>{r.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await s}getSignature(e){var t;(t=o(this,Qn))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return o(this,Qn)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":b(this,g0,t);break}}onPageChanging({pageNumber:e}){b(this,m0,e-1)}focusMainContainer(){o(this,jr).focus()}findParent(e,t){for(const s of o(this,Bt).values()){const{x:i,y:r,width:a,height:l}=s.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+l)return s}return null}disableUserSelect(e=!1){o(this,pu).classList.toggle("noUserSelect",e)}addShouldRescale(e){o(this,io).add(e)}removeShouldRescale(e){o(this,io).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*qa.PDF_TO_CSS_UNITS;for(const s of o(this,io))s.onScaleChanging();(t=o(this,Vn))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:l}=s,h=s.toString(),u=A(this,A0,w1).call(this,s).closest(".textLayer"),d=this.getSelectionBoxes(u);if(!d)return;s.empty();const f=A(this,gu,P4).call(this,u),p=o(this,Dt)===be.NONE,w=()=>{const y=f==null?void 0:f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:d,anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:l,text:h});p&&this.showAllEditors("highlight",!0,!0),t&&(y==null||y.editComment())};if(p){this.switchToMode(be.HIGHLIGHT,w);return}w()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!o(this,gi))return null;const t=`${Wc}${e}`,s=o(this,gi).getRawValue(t);return s&&o(this,gi).remove(t),s}addToAnnotationStorage(e){!e.isEmpty()&&o(this,gi)&&!o(this,gi).has(e.id)&&o(this,gi).setValue(e.id,e)}a11yAlert(e,t=null){const s=o(this,mu);s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,o(this,Xn)&&(b(this,Xn,!1),A(this,no,Ac).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of o(this,Oe))if(t.div.contains(e)){b(this,ro,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!o(this,ro))return;const[e,t]=o(this,ro);b(this,ro,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){A(this,bu,L4).call(this),this.setEditingState(!0)}removeEditListeners(){A(this,Lp,w7).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of o(this,vi))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of o(this,vi))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=o(this,Us))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of o(this,Oe)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of o(this,vi))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){pe(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const h of s){const c=await i.deserialize(h);if(!c)return;r.push(c)}const a=()=>{for(const h of r)A(this,vu,I4).call(this,h);A(this,yu,B4).call(this,r)},l=()=>{for(const h of r)h.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(r){pe(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),o(this,Dt)!==be.NONE&&!this.isEditorHandlingKeyboard&&Ql._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,o(this,Xn)&&(b(this,Xn,!1),A(this,no,Ac).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(A(this,Rp,v7).call(this),A(this,Ip,A7).call(this),A(this,Zt,ps).call(this,{isEditing:o(this,Dt)!==be.NONE,isEmpty:A(this,ao,xc).call(this),hasSomethingToUndo:o(this,bi).hasSomethingToUndo(),hasSomethingToRedo:o(this,bi).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,Pp,y7).call(this),A(this,Bp,x7).call(this),A(this,Zt,ps).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!o(this,vi)){b(this,vi,e);for(const t of o(this,vi))A(this,Bi,zr).call(this,t.defaultPropertiesToUpdate)}}getId(){return o(this,Ep).id}get currentLayer(){return o(this,Bt).get(o(this,m0))}getLayer(e){return o(this,Bt).get(e)}get currentPageIndex(){return o(this,m0)}addLayer(e){o(this,Bt).set(e.pageIndex,e),o(this,Yn)?e.enable():e.disable()}removeLayer(e){o(this,Bt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1,i=!1,r=!1){var a,l,h,c,u,d;if(o(this,Dt)!==e&&!(o(this,yi)&&(await o(this,yi).promise,!o(this,yi)))){if(b(this,yi,Promise.withResolvers()),(a=o(this,Vn))==null||a.commitOrRemove(),o(this,Dt)===be.POPUP&&((l=o(this,hs))==null||l.hideSidebar()),(h=o(this,hs))==null||h.destroyPopup(),b(this,Dt,e),e===be.NONE){this.setEditingState(!1),A(this,Op,T7).call(this);for(const f of o(this,yt).values())f.hideStandaloneCommentButton();(c=this._editorUndoBar)==null||c.hide(),this.toggleComment(null),o(this,yi).resolve();return}for(const f of o(this,yt).values())f.addStandaloneCommentButton();e===be.SIGNATURE&&await((u=o(this,Qn))==null?void 0:u.loadSignatures()),this.setEditingState(!0),await A(this,Fp,k7).call(this),this.unselectAll();for(const f of o(this,Bt).values())f.updateMode(e);if(e===be.POPUP){o(this,d0)||b(this,d0,await o(this,w0).getAnnotationsByType(new Set(o(this,vi).map(w=>w._editorType))));const f=new Set,p=[];for(const w of o(this,yt).values()){const{annotationElementId:y,hasComment:x,deleted:S}=w;y&&f.add(y),x&&!S&&p.push(w.getData())}for(const w of o(this,d0)){const{id:y,popupRef:x,contentsObj:S}=w;x&&(S!=null&&S.str)&&!f.has(y)&&!o(this,jn).has(y)&&p.push(w)}(d=o(this,hs))==null||d.showSidebar(p)}if(!t){s&&this.addNewEditorFromKeyboard(),o(this,yi).resolve();return}for(const f of o(this,yt).values())f.uid===t?(this.setSelected(f),r?f.editComment():i?f.enterInEditMode():f.focus()):f.unselect();o(this,yi).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==o(this,Dt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(o(this,vi)){switch(e){case Te.CREATE:this.currentLayer.addNewEditor(t);return;case Te.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(o(this,du)||b(this,du,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const s of o(this,Oe))s.updateParams(e,t);else for(const s of o(this,vi))s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const a of o(this,yt).values())a.editorType===e&&a.show(t);(((r=o(this,du))==null?void 0:r.get(Te.HIGHLIGHT_SHOW_ALL))??!0)!==t&&A(this,Bi,zr).call(this,[[Te.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(o(this,cu)!==e){b(this,cu,e);for(const t of o(this,Bt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of o(this,yt).values())t.pageIndex===e&&(yield t)}getEditor(e){return o(this,yt).get(e)}addEditor(e){o(this,yt).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(o(this,rr)&&clearTimeout(o(this,rr)),b(this,rr,setTimeout(()=>{this.focusMainContainer(),b(this,rr,null)},0))),o(this,yt).delete(e.id),e.annotationElementId&&((t=o(this,Zn))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!o(this,jn).has(e.annotationElementId))&&((s=o(this,gi))==null||s.remove(e.id))}addDeletedAnnotationElement(e){o(this,jn).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return o(this,jn).has(e)}removeDeletedAnnotationElement(e){o(this,jn).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){o(this,Us)!==e&&(b(this,Us,e),e&&A(this,Bi,zr).call(this,e.propertiesToUpdate))}updateUI(e){o(this,zp,C7)===e&&A(this,Bi,zr).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){A(this,Bi,zr).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(o(this,Oe).has(e)){o(this,Oe).delete(e),e.unselect(),A(this,Zt,ps).call(this,{hasSelectedEditor:this.hasSelection});return}o(this,Oe).add(e),e.select(),A(this,Bi,zr).call(this,e.propertiesToUpdate),A(this,Zt,ps).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=o(this,Vn))==null||t.commitOrRemove();for(const s of o(this,Oe))s!==e&&s.unselect();o(this,Oe).clear(),o(this,Oe).add(e),e.select(),A(this,Bi,zr).call(this,e.propertiesToUpdate),A(this,Zt,ps).call(this,{hasSelectedEditor:!0})}isSelected(e){return o(this,Oe).has(e)}get firstSelectedEditor(){return o(this,Oe).values().next().value}unselect(e){e.unselect(),o(this,Oe).delete(e),A(this,Zt,ps).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return o(this,Oe).size!==0}get isEnterHandled(){return o(this,Oe).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;o(this,bi).undo(),A(this,Zt,ps).call(this,{hasSomethingToUndo:o(this,bi).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,ao,xc).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){o(this,bi).redo(),A(this,Zt,ps).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:o(this,bi).hasSomethingToRedo(),isEmpty:A(this,ao,xc).call(this)})}addCommands(e){o(this,bi).add(e),A(this,Zt,ps).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,ao,xc).call(this)})}cleanUndoStack(e){o(this,bi).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...o(this,Oe)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const l of t)l.remove()},i=()=>{for(const a of t)A(this,vu,I4).call(this,a)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=o(this,Us))==null||e.commitOrRemove()}hasSomethingToControl(){return o(this,Us)||this.hasSelection}selectAll(){for(const e of o(this,Oe))e.commit();A(this,yu,B4).call(this,o(this,yt).values())}unselectAll(){var e;if(!(o(this,Us)&&(o(this,Us).commitOrRemove(),o(this,Dt)!==be.NONE))&&!((e=o(this,Vn))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of o(this,Oe))t.unselect();o(this,Oe).clear(),A(this,Zt,ps).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;o(this,ea)[0]+=e,o(this,ea)[1]+=t;const[i,r]=o(this,ea),a=[...o(this,Oe)],l=1e3;o(this,ar)&&clearTimeout(o(this,ar)),b(this,ar,setTimeout(()=>{b(this,ar,null),o(this,ea)[0]=o(this,ea)[1]=0,this.addCommands({cmd:()=>{for(const h of a)o(this,yt).has(h.id)&&(h.translateInPage(i,r),h.translationDone())},undo:()=>{for(const h of a)o(this,yt).has(h.id)&&(h.translateInPage(-i,-r),h.translationDone())},mustExec:!1})},l));for(const h of a)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),b(this,ir,new Map);for(const e of o(this,Oe))o(this,ir).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!o(this,ir))return!1;this.disableUserSelect(!1);const e=o(this,ir);b(this,ir,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},l]of e)l.newX=i,l.newY=r,l.newPageIndex=a,t||(t=i!==l.savedX||r!==l.savedY||a!==l.savedPageIndex);if(!t)return!1;const s=(i,r,a,l)=>{if(o(this,yt).has(i.id)){const h=o(this,Bt).get(l);h?i._setParentAndPosition(h,r,a):(i.pageIndex=l,i.x=r,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:a,newPageIndex:l}]of e)s(i,r,a,l)},undo:()=>{for(const[i,{savedX:r,savedY:a,savedPageIndex:l}]of e)s(i,r,a,l)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(o(this,ir))for(const s of o(this,ir).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||o(this,Oe).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return o(this,Us)===e}getActive(){return o(this,Us)}getMode(){return o(this,Dt)}isEditingMode(){return o(this,Dt)!==be.NONE}get imageManager(){return me(this,"imageManager",new D4)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,u=t.rangeCount;c<u;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:a}=e.getBoundingClientRect();let l;switch(e.getAttribute("data-main-rotation")){case"90":l=(c,u,d,f)=>({x:(u-i)/a,y:1-(c+d-s)/r,width:f/a,height:d/r});break;case"180":l=(c,u,d,f)=>({x:1-(c+d-s)/r,y:1-(u+f-i)/a,width:d/r,height:f/a});break;case"270":l=(c,u,d,f)=>({x:1-(u+f-i)/a,y:(c-s)/r,width:f/a,height:d/r});break;default:l=(c,u,d,f)=>({x:(c-s)/r,y:(u-i)/a,width:d/r,height:f/a});break}const h=[];for(let c=0,u=t.rangeCount;c<u;c++){const d=t.getRangeAt(c);if(!d.collapsed)for(const{x:f,y:p,width:w,height:y}of d.getClientRects())w===0||y===0||h.push(l(f,p,w,y))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(o(this,p0)||b(this,p0,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=o(this,p0))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=o(this,p0))==null?void 0:i.get(e.data.id);if(!t)return;const s=o(this,gi).getRawValue(t);s&&(o(this,Dt)===be.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var r;const i=(r=o(this,Zn))==null?void 0:r.get(e);i&&(i.setCanvas(t,s),o(this,Zn).delete(e))}addMissingCanvas(e,t){(o(this,Zn)||b(this,Zn,new Map)).set(e,t)}};u0=new WeakMap,Us=new WeakMap,d0=new WeakMap,yt=new WeakMap,Bt=new WeakMap,f0=new WeakMap,gi=new WeakMap,p0=new WeakMap,bi=new WeakMap,hs=new WeakMap,Gn=new WeakMap,Vn=new WeakMap,m0=new WeakMap,jn=new WeakMap,ir=new WeakMap,vi=new WeakMap,io=new WeakMap,ou=new WeakMap,lu=new WeakMap,g0=new WeakMap,hu=new WeakMap,rr=new WeakMap,Wn=new WeakMap,b0=new WeakMap,Xn=new WeakMap,nr=new WeakMap,Ep=new WeakMap,Yn=new WeakMap,v0=new WeakMap,cu=new WeakMap,Kn=new WeakMap,ro=new WeakMap,y0=new WeakMap,Zn=new WeakMap,uu=new WeakMap,Dt=new WeakMap,Oe=new WeakMap,Vr=new WeakMap,Qn=new WeakMap,Jn=new WeakMap,du=new WeakMap,w0=new WeakMap,fu=new WeakMap,ea=new WeakMap,ar=new WeakMap,jr=new WeakMap,pu=new WeakMap,mu=new WeakMap,yi=new WeakMap,A0=new WeakSet,w1=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},gu=new WeakSet,P4=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of o(this,Bt).values())if(s.hasTextLayer(e))return s;return null},_p=new WeakSet,m7=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=A(this,A0,w1).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(o(this,nr)||b(this,nr,new W9(this)),o(this,nr).show(s,i,this.direction==="ltr"))},Mp=new WeakSet,g7=function(){var r,a,l;const e=document.getSelection();if(!e||e.isCollapsed){o(this,Vr)&&((r=o(this,nr))==null||r.hide(),b(this,Vr,null),A(this,Zt,ps).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===o(this,Vr))return;const i=A(this,A0,w1).call(this,e).closest(".textLayer");if(!i){o(this,Vr)&&((a=o(this,nr))==null||a.hide(),b(this,Vr,null),A(this,Zt,ps).call(this,{hasSelectedText:!1}));return}if((l=o(this,nr))==null||l.hide(),b(this,Vr,t),A(this,Zt,ps).call(this,{hasSelectedText:!0}),!(o(this,Dt)!==be.HIGHLIGHT&&o(this,Dt)!==be.NONE)&&(o(this,Dt)===be.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),b(this,Xn,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=o(this,Dt)===be.HIGHLIGHT?A(this,gu,P4).call(this,i):null;if(h==null||h.toggleDrawing(),o(this,v0)){const c=new AbortController,u=this.combinedSignal(c),d=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),h==null||h.toggleDrawing(!0),f.type==="pointerup"&&A(this,no,Ac).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else h==null||h.toggleDrawing(!0),A(this,no,Ac).call(this,"main_toolbar")}},no=new WeakSet,Ac=function(e=""){o(this,Dt)===be.HIGHLIGHT?this.highlightSelection(e):o(this,ou)&&A(this,_p,m7).call(this)},Dp=new WeakSet,b7=function(){document.addEventListener("selectionchange",A(this,Mp,g7).bind(this),{signal:this._signal})},Rp=new WeakSet,v7=function(){if(o(this,Wn))return;b(this,Wn,new AbortController);const e=this.combinedSignal(o(this,Wn));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},Pp=new WeakSet,y7=function(){var e;(e=o(this,Wn))==null||e.abort(),b(this,Wn,null)},bu=new WeakSet,L4=function(){if(o(this,Kn))return;b(this,Kn,new AbortController);const e=this.combinedSignal(o(this,Kn));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},Lp=new WeakSet,w7=function(){var e;(e=o(this,Kn))==null||e.abort(),b(this,Kn,null)},Ip=new WeakSet,A7=function(){if(o(this,Gn))return;b(this,Gn,new AbortController);const e=this.combinedSignal(o(this,Gn));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Bp=new WeakSet,x7=function(){var e;(e=o(this,Gn))==null||e.abort(),b(this,Gn,null)},Np=new WeakSet,S7=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Zt=new WeakSet,ps=function(e){Object.entries(e).some(([s,i])=>o(this,fu)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(o(this,fu),e)}),o(this,Dt)===be.HIGHLIGHT&&e.hasSelectedEditor===!1&&A(this,Bi,zr).call(this,[[Te.HIGHLIGHT_FREE,!0]]))},Bi=new WeakSet,zr=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Fp=new WeakSet,k7=async function(){if(!o(this,Yn)){b(this,Yn,!0);const e=[];for(const t of o(this,Bt).values())e.push(t.enable());await Promise.all(e);for(const t of o(this,yt).values())t.enable()}},Op=new WeakSet,T7=function(){if(this.unselectAll(),o(this,Yn)){b(this,Yn,!1);for(const e of o(this,Bt).values())e.disable();for(const e of o(this,yt).values())e.disable()}},vu=new WeakSet,I4=function(e){const t=o(this,Bt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},zp=new WeakSet,C7=function(){let e=null;for(e of o(this,Oe));return e},ao=new WeakSet,xc=function(){if(o(this,yt).size===0)return!0;if(o(this,yt).size===1)for(const e of o(this,yt).values())return e.isEmpty();return!1},yu=new WeakSet,B4=function(e){for(const t of o(this,Oe))t.unselect();o(this,Oe).clear();for(const t of e)t.isEmpty()||(o(this,Oe).add(t),t.select());A(this,Zt,ps).call(this,{hasSelectedEditor:this.hasSelection})},O(Ql,"TRANSLATE_SMALL",1),O(Ql,"TRANSLATE_BIG",10);let Pl=Ql;var zt,or,Ni,x0,lr,qs,S0,hr,Cs,Wr,oo,cr,ta,lo,Sc,k0,A1;const ms=class ms{constructor(e){g(this,lo);g(this,k0);g(this,zt,null);g(this,or,!1);g(this,Ni,null);g(this,x0,null);g(this,lr,null);g(this,qs,null);g(this,S0,!1);g(this,hr,null);g(this,Cs,null);g(this,Wr,null);g(this,oo,null);g(this,cr,!1);b(this,Cs,e),b(this,cr,e._uiManager.useNewAltTextFlow),o(ms,ta)||b(ms,ta,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){ms._l10n??(ms._l10n=e)}async render(){const e=b(this,Ni,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=b(this,x0,document.createElement("span"));e.append(t),o(this,cr)?(e.classList.add("new"),e.setAttribute("data-l10n-id",o(ms,ta).missing),t.setAttribute("data-l10n-id",o(ms,ta)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=o(this,Cs)._uiManager._signal;e.addEventListener("contextmenu",Di,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),o(this,Cs)._uiManager.editAltText(o(this,Cs)),o(this,cr)&&o(this,Cs)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:o(this,lo,Sc)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(b(this,S0,!0),i(r))},{signal:s}),await A(this,k0,A1).call(this),e}finish(){o(this,Ni)&&(o(this,Ni).focus({focusVisible:o(this,S0)}),b(this,S0,!1))}isEmpty(){return o(this,cr)?o(this,zt)===null:!o(this,zt)&&!o(this,or)}hasData(){return o(this,cr)?o(this,zt)!==null||!!o(this,Wr):this.isEmpty()}get guessedText(){return o(this,Wr)}async setGuessedText(e){o(this,zt)===null&&(b(this,Wr,e),b(this,oo,await ms._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),A(this,k0,A1).call(this))}toggleAltTextBadge(e=!1){var t;if(!o(this,cr)||o(this,zt)){(t=o(this,hr))==null||t.remove(),b(this,hr,null);return}if(!o(this,hr)){const s=b(this,hr,document.createElement("div"));s.className="noAltTextBadge",o(this,Cs).div.append(s)}o(this,hr).classList.toggle("hidden",!e)}serialize(e){let t=o(this,zt);return!e&&o(this,Wr)===t&&(t=o(this,oo)),{altText:t,decorative:o(this,or),guessedText:o(this,Wr),textWithDisclaimer:o(this,oo)}}get data(){return{altText:o(this,zt),decorative:o(this,or)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(b(this,Wr,s),b(this,oo,i)),!(o(this,zt)===e&&o(this,or)===t)&&(r||(b(this,zt,e),b(this,or,t)),A(this,k0,A1).call(this))}toggle(e=!1){o(this,Ni)&&(!e&&o(this,qs)&&(clearTimeout(o(this,qs)),b(this,qs,null)),o(this,Ni).disabled=!e)}shown(){o(this,Cs)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:o(this,lo,Sc)}})}destroy(){var e,t;(e=o(this,Ni))==null||e.remove(),b(this,Ni,null),b(this,x0,null),b(this,lr,null),(t=o(this,hr))==null||t.remove(),b(this,hr,null)}};zt=new WeakMap,or=new WeakMap,Ni=new WeakMap,x0=new WeakMap,lr=new WeakMap,qs=new WeakMap,S0=new WeakMap,hr=new WeakMap,Cs=new WeakMap,Wr=new WeakMap,oo=new WeakMap,cr=new WeakMap,ta=new WeakMap,lo=new WeakSet,Sc=function(){return o(this,zt)&&"added"||o(this,zt)===null&&this.guessedText&&"review"||"missing"},k0=new WeakSet,A1=async function(){var i,r,a;const e=o(this,Ni);if(!e)return;if(o(this,cr)){if(e.classList.toggle("done",!!o(this,zt)),e.setAttribute("data-l10n-id",o(ms,ta)[o(this,lo,Sc)]),(i=o(this,x0))==null||i.setAttribute("data-l10n-id",o(ms,ta)[`${o(this,lo,Sc)}-label`]),!o(this,zt)){(r=o(this,lr))==null||r.remove();return}}else{if(!o(this,zt)&&!o(this,or)){e.classList.remove("done"),(a=o(this,lr))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=o(this,lr);if(!t){b(this,lr,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${o(this,Cs).id}`;const l=100,h=o(this,Cs)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(o(this,qs)),b(this,qs,null)},{once:!0}),e.addEventListener("mouseenter",()=>{b(this,qs,setTimeout(()=>{b(this,qs,null),o(this,lr).classList.add("show"),o(this,Cs)._reportTelemetry({action:"alt_text_tooltip"})},l))},{signal:h}),e.addEventListener("mouseleave",()=>{var c;o(this,qs)&&(clearTimeout(o(this,qs)),b(this,qs,null)),(c=o(this,lr))==null||c.classList.remove("show")},{signal:h})}o(this,or)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=o(this,zt)),t.parentNode||e.append(t);const s=o(this,Cs).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},g(ms,ta,null),O(ms,"_l10n",null);let lp=ms;var Qt,wi,ho,Je,wu,co,Fi,uo,fo,po,Au,N4;class s1{constructor(e){g(this,Au);g(this,Qt,null);g(this,wi,null);g(this,ho,!1);g(this,Je,null);g(this,wu,null);g(this,co,null);g(this,Fi,null);g(this,uo,null);g(this,fo,!1);g(this,po,null);b(this,Je,e)}renderForToolbar(){const e=b(this,wi,document.createElement("button"));return e.className="comment",A(this,Au,N4).call(this,e,!1)}renderForStandalone(){const e=b(this,Qt,document.createElement("button"));e.className="annotationCommentButton";const t=o(this,Je).commentButtonPosition;if(t){const{style:s}=e;s.insetInlineEnd=`calc(${100*(o(this,Je)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=o(this,Je).commentButtonColor;i&&(s.backgroundColor=i)}return A(this,Au,N4).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=o(this,Qt)??o(this,wi))==null||e.focus()},0)}onUpdatedColor(){if(!o(this,Qt))return;const e=o(this,Je).commentButtonColor;e&&(o(this,Qt).style.backgroundColor=e),o(this,Je)._uiManager.updatePopupColor(o(this,Je))}get commentButtonWidth(){var e;return(((e=o(this,Qt))==null?void 0:e.getBoundingClientRect().width)??0)/o(this,Je).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(o(this,po))return o(this,po);if(!o(this,Qt))return null;const{x:e,y:t,height:s}=o(this,Qt).getBoundingClientRect(),{x:i,y:r,width:a,height:l}=o(this,Je).parent.boundingClientRect;return[(e-i)/a,(t+s-r)/l]}set commentPopupPositionInLayer(e){b(this,po,e)}hasDefaultPopupPosition(){return o(this,po)===null}removeStandaloneCommentButton(){var e;(e=o(this,Qt))==null||e.remove(),b(this,Qt,null)}removeToolbarCommentButton(){var e;(e=o(this,wi))==null||e.remove(),b(this,wi,null)}setCommentButtonStates({selected:e,hasPopup:t}){o(this,Qt)&&(o(this,Qt).classList.toggle("selected",e),o(this,Qt).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let s,i;if(t)[s,i]=t;else{[s,i]=o(this,Je).commentButtonPosition;const{width:u,height:d,x:f,y:p}=o(this,Je);s=f+s*u,i=p+i*d}const r=o(this,Je).parent.boundingClientRect,{x:a,y:l,width:h,height:c}=r;o(this,Je)._uiManager.editComment(o(this,Je),a+s*h,l+i*c,{...e,parentDimensions:r})}finish(){o(this,wi)&&(o(this,wi).focus({focusVisible:o(this,ho)}),b(this,ho,!1))}isDeleted(){return o(this,fo)||o(this,Fi)===""}isEmpty(){return o(this,Fi)===null}hasBeenEdited(){return this.isDeleted()||o(this,Fi)!==o(this,wu)}serialize(){return this.data}get data(){return{text:o(this,Fi),richText:o(this,co),date:o(this,uo),deleted:this.isDeleted()}}set data(e){if(e!==o(this,Fi)&&b(this,co,null),e===null){b(this,Fi,""),b(this,fo,!0);return}b(this,Fi,e),b(this,uo,new Date),b(this,fo,!1)}setInitialText(e,t=null){b(this,wu,e),this.data=e,b(this,uo,null),b(this,co,t)}shown(){}destroy(){var e,t;(e=o(this,wi))==null||e.remove(),b(this,wi,null),(t=o(this,Qt))==null||t.remove(),b(this,Qt,null),b(this,Fi,""),b(this,co,null),b(this,uo,null),b(this,Je,null),b(this,ho,!1),b(this,fo,!1)}}Qt=new WeakMap,wi=new WeakMap,ho=new WeakMap,Je=new WeakMap,wu=new WeakMap,co=new WeakMap,Fi=new WeakMap,uo=new WeakMap,fo=new WeakMap,po=new WeakMap,Au=new WeakSet,N4=function(e,t){if(!o(this,Je)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[o(this,Je)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=o(this,Je)._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return e;e.addEventListener("contextmenu",Di,{signal:s}),t&&(e.addEventListener("focusin",r=>{o(this,Je)._focusEventsAllowed=!1,St(r)},{capture:!0,signal:s}),e.addEventListener("focusout",r=>{o(this,Je)._focusEventsAllowed=!0,St(r)},{capture:!0,signal:s})),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),e===o(this,wi)?this.edit():o(this,Je).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(b(this,ho,!0),i(r))},{signal:s}),e.addEventListener("pointerenter",()=>{o(this,Je).toggleComment(!1,!0)},{signal:s}),e.addEventListener("pointerleave",()=>{o(this,Je).toggleComment(!1,!1)},{signal:s}),e};var T0,mo,xu,Su,ku,Tu,Cu,Xr,go,Yr,bo,Kr,Hp,E7,Up,_7,qp,M7;const O3=class O3{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:l}){g(this,Hp);g(this,Up);g(this,qp);g(this,T0,void 0);g(this,mo,!1);g(this,xu,null);g(this,Su,void 0);g(this,ku,void 0);g(this,Tu,void 0);g(this,Cu,void 0);g(this,Xr,null);g(this,go,void 0);g(this,Yr,null);g(this,bo,void 0);g(this,Kr,null);b(this,T0,e),b(this,xu,s),b(this,Su,t),b(this,ku,i),b(this,Tu,r),b(this,Cu,a),b(this,bo,new AbortController),b(this,go,AbortSignal.any([l,o(this,bo).signal])),e.addEventListener("touchstart",A(this,Hp,E7).bind(this),{passive:!1,signal:o(this,go)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Dr.pixelRatio}destroy(){var e,t;(e=o(this,bo))==null||e.abort(),b(this,bo,null),(t=o(this,Xr))==null||t.abort(),b(this,Xr,null)}};T0=new WeakMap,mo=new WeakMap,xu=new WeakMap,Su=new WeakMap,ku=new WeakMap,Tu=new WeakMap,Cu=new WeakMap,Xr=new WeakMap,go=new WeakMap,Yr=new WeakMap,bo=new WeakMap,Kr=new WeakMap,Hp=new WeakSet,E7=function(e){var i,r,a;if((i=o(this,Su))!=null&&i.call(this))return;if(e.touches.length===1){if(o(this,Xr))return;const l=b(this,Xr,new AbortController),h=AbortSignal.any([o(this,go),l.signal]),c=o(this,T0),u={capture:!0,signal:h,passive:!1},d=f=>{var p;f.pointerType==="touch"&&((p=o(this,Xr))==null||p.abort(),b(this,Xr,null))};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(St(f),d(f))},u),c.addEventListener("pointerup",d,u),c.addEventListener("pointercancel",d,u);return}if(!o(this,Kr)){b(this,Kr,new AbortController);const l=AbortSignal.any([o(this,go),o(this,Kr).signal]),h=o(this,T0),c={signal:l,capture:!1,passive:!1};h.addEventListener("touchmove",A(this,Up,_7).bind(this),c);const u=A(this,qp,M7).bind(this);h.addEventListener("touchend",u,c),h.addEventListener("touchcancel",u,c),c.capture=!0,h.addEventListener("pointerdown",St,c),h.addEventListener("pointermove",St,c),h.addEventListener("pointercancel",St,c),h.addEventListener("pointerup",St,c),(r=o(this,ku))==null||r.call(this)}if(St(e),e.touches.length!==2||(a=o(this,xu))!=null&&a.call(this)){b(this,Yr,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),b(this,Yr,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},Up=new WeakSet,_7=function(e){var _;if(!o(this,Yr)||e.touches.length!==2)return;St(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:a,screenY:l}=s,h=o(this,Yr),{touch0X:c,touch0Y:u,touch1X:d,touch1Y:f}=h,p=d-c,w=f-u,y=a-i,x=l-r,S=Math.hypot(y,x)||1,E=Math.hypot(p,w)||1;if(!o(this,mo)&&Math.abs(E-S)<=O3.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=i,h.touch0Y=r,h.touch1X=a,h.touch1Y=l,!o(this,mo)){b(this,mo,!0);return}const T=[(i+a)/2,(r+l)/2];(_=o(this,Tu))==null||_.call(this,T,E,S)},qp=new WeakSet,M7=function(e){var t;e.touches.length>=2||(o(this,Kr)&&(o(this,Kr).abort(),b(this,Kr,null),(t=o(this,Cu))==null||t.call(this)),o(this,Yr)&&(St(e),b(this,Yr,null),b(this,mo,!1)))};let hp=O3;var vo,Oi,at,je,Zr,C0,sa,Eu,Jt,yo,Qr,Ai,ia,_u,wo,$s,Mu,Ao,Jr,ur,E0,_0,xi,xo,Du,$p,Ru,F4,Pu,O4,M0,x1,Gp,D7,Vp,R7,Lu,z4,D0,S1,Iu,H4,jp,P7,Wp,L7,Xp,I7,Bu,U4,Yp,B7,Nu,q4,Kp,N7,Zp,F7,Qp,O7,Fu,$4,So,kc;const ge=class ge{constructor(e){g(this,Ru);g(this,M0);g(this,Gp);g(this,Vp);g(this,Lu);g(this,D0);g(this,Iu);g(this,jp);g(this,Wp);g(this,Xp);g(this,Bu);g(this,Yp);g(this,Nu);g(this,Kp);g(this,Zp);g(this,Qp);g(this,Fu);g(this,So);g(this,vo,null);g(this,Oi,null);g(this,at,null);g(this,je,null);g(this,Zr,null);g(this,C0,!1);g(this,sa,null);g(this,Eu,"");g(this,Jt,null);g(this,yo,null);g(this,Qr,null);g(this,Ai,null);g(this,ia,null);g(this,_u,"");g(this,wo,!1);g(this,$s,null);g(this,Mu,!1);g(this,Ao,!1);g(this,Jr,!1);g(this,ur,null);g(this,E0,0);g(this,_0,0);g(this,xi,null);g(this,xo,null);O(this,"isSelected",!1);O(this,"_isCopy",!1);O(this,"_editToolbar",null);O(this,"_initialOptions",Object.create(null));O(this,"_initialData",null);O(this,"_isVisible",!0);O(this,"_uiManager",null);O(this,"_focusEventsAllowed",!0);g(this,Du,!1);g(this,$p,ge._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,a];const[l,h]=this.parentDimensions;this.x=e.x/l,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ge.prototype._resizeWithKeyboard,t=Pl.TRANSLATE_SMALL,s=Pl.TRANSLATE_BIG;return me(this,"_resizerKeyboardManager",new qf([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],ge.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return me(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new K9({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ge._l10n??(ge._l10n=e),ge._l10nResizer||(ge._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ge._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ge._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Xe("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return o(this,Du)}set _isDraggable(e){var t;b(this,Du,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=o(this,$p)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(A(this,So,kc).call(this),(t=o(this,Ai))==null||t.remove(),b(this,Ai,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(o(this,wo)?b(this,wo,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,a]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),this._onTranslated()}translate(e,t){A(this,Ru,F4).call(this,this.parentDimensions,e,t)}translateInPage(e,t){o(this,$s)||b(this,$s,[this.x,this.y,this.width,this.height]),A(this,Ru,F4).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){o(this,$s)||b(this,$s,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:l}=this;const[h,c]=this.getBaseTranslation();a+=h,l+=c;const{style:u}=s;u.left=`${(100*a).toFixed(2)}%`,u.top=`${(100*l).toFixed(2)}%`,this._onTranslating(a,l),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!o(this,$s)&&(o(this,$s)[0]!==this.x||o(this,$s)[1]!==this.y)}get _hasBeenResized(){return!!o(this,$s)&&(o(this,$s)[2]!==this.width||o(this,$s)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=ge,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:a,width:l,height:h}=this;if(l*=s,h*=i,r*=s,a*=i,this._mustFixPosition)switch(e){case 0:r=ws(r,0,s-l),a=ws(a,0,i-h);break;case 90:r=ws(r,0,s-h),a=ws(a,l,i);break;case 180:r=ws(r,l,s),a=ws(a,h,i);break;case 270:r=ws(r,h,s),a=ws(a,0,i-l);break}this.x=r/=s,this.y=a/=i;const[c,u]=this.getBaseTranslation();r+=c,a+=u,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return A(s=ge,Pu,O4).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return A(s=ge,Pu,O4).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(){const{div:{style:e},width:t,height:s}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=o(this,at))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||o(this,Ao))return this._editToolbar;this._editToolbar=new _4(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=o(this,at))==null||t.destroy()}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return o(this,at)||(lp.initialize(ge._l10n),b(this,at,new lp(this)),o(this,vo)&&(o(this,at).data=o(this,vo),b(this,vo,null))),o(this,at)}get altTextData(){var e;return(e=o(this,at))==null?void 0:e.data}set altTextData(e){o(this,at)&&(o(this,at).data=e)}get guessedAltText(){var e;return(e=o(this,at))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=o(this,at))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=o(this,at))==null?void 0:t.serialize(e)}hasAltText(){return!!o(this,at)&&!o(this,at).isEmpty()}hasAltTextData(){var e;return((e=o(this,at))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=o(this,je))==null||e.focusButton()}addCommentButton(){return this.canAddComment?o(this,je)||b(this,je,new s1(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(o(this,Zr)){this._uiManager.isEditingMode()&&o(this,Zr).classList.remove("hidden");return}this.hasComment&&(b(this,Zr,o(this,je).renderForStandalone()),this.div.append(o(this,Zr)))}}removeStandaloneCommentButton(){o(this,je).removeStandaloneCommentButton(),b(this,Zr,null)}hideStandaloneCommentButton(){var e;(e=o(this,Zr))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:s,deleted:i}}=o(this,je);return{text:t,richText:e,date:s,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){o(this,je)||b(this,je,new s1(this)),o(this,je).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:s}){if(!t||(o(this,je)||b(this,je,new s1(this)),o(this,je).setInitialText(e,s),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=o(this,je))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=o(this,je))==null?void 0:e.isDeleted()}get hasComment(){return!!o(this,je)&&!o(this,je).isEmpty()&&!o(this,je).isDeleted()}async editComment(e){o(this,je)||b(this,je,new s1(this)),o(this,je).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){o(this,je).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[r]=this.pageDimensions,[a]=this.pageTranslation,l=a+r+1,h=i-100,c=l+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[l,h,c,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){o(this,je).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=o(this,C0)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),A(this,Nu,q4).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),f7(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(o(this,xo)||b(this,xo,new hp({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:A(this,jp,P7).bind(this),onPinching:A(this,Wp,L7).bind(this),onPinchEnd:A(this,Xp,I7).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=rs.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(b(this,wo,!0),this._isDraggable){A(this,Yp,B7).call(this,e);return}A(this,Bu,U4).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){o(this,ur)&&clearTimeout(o(this,ur)),b(this,ur,setTimeout(()=>{var e;b(this,ur,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[l,h]=this.pageTranslation,c=e/i,u=t/i,d=this.x*r,f=this.y*a,p=this.width*r,w=this.height*a;switch(s){case 0:return[d+c+l,a-f-u-w+h,d+c+p+l,a-f-u+h];case 90:return[d+u+l,a-f+c+h,d+u+w+l,a-f+c+p+h];case 180:return[d-c-p+l,a-f+u+h,d-c+l,a-f+u+w+h];case 270:return[d-u-w+l,a-f-c-p+h,d-u+l,a-f-c+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,a]=e,l=r-s,h=a-i;switch(this.rotation){case 0:return[s,t-a,l,h];case 90:return[s,t-i,h,l];case 180:return[r,t-i,l,h];case 270:return[r,t-a,h,l];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&ge._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=o(this,je))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:s,opacity:i,deleted:r,richText:a},uid:l,pageIndex:h,creationDate:c,modificationDate:u}=this;return{id:l,pageIndex:h,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:c,modificationDate:s||u,popupRef:!r,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),b(this,Ao,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),b(this,Ao,!1),!0):!1}isInEditMode(){return o(this,Ao)}shouldGetKeyboardEvents(){return o(this,Jr)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&s>0}rebuild(){A(this,Nu,q4).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var s;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((s=this._initialData)==null?void 0:s.popupRef)||""}}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,b(i,vo,e.accessibilityData),i._isCopy=e.isCopy||!1;const[r,a]=i.pageDimensions,[l,h,c,u]=i.getRectInCurrentCoords(e.rect,a);return i.x=l/r,i.y=h/a,i.width=c/r,i.height=u/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,s;if((e=o(this,ia))==null||e.abort(),b(this,ia,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),o(this,ur)&&(clearTimeout(o(this,ur)),b(this,ur,null)),A(this,So,kc).call(this),this.removeEditToolbar(),o(this,xi)){for(const i of o(this,xi).values())clearTimeout(i);b(this,xi,null)}this.parent=null,(t=o(this,xo))==null||t.destroy(),b(this,xo,null),(s=o(this,Ai))==null||s.remove(),b(this,Ai,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,Gp,D7).call(this),o(this,Jt).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[s,i,r,a]=this.getPDFRect();return[ge._round(s+(r-s)*e),ge._round(i+(a-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return o(this,je).commentPopupPositionInLayer}set commentPopupPosition(e){o(this,je).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return o(this,je).hasDefaultPopupPosition()}get commentButtonWidth(){return o(this,je).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=o(this,je))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),b(this,Qr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=o(this,Jt).children;if(!o(this,Oi)){b(this,Oi,Array.from(t));const a=A(this,Kp,N7).bind(this),l=A(this,Zp,F7).bind(this),h=this._uiManager._signal;for(const c of o(this,Oi)){const u=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:h}),c.addEventListener("blur",l,{signal:h}),c.addEventListener("focus",A(this,Qp,O7).bind(this,u),{signal:h}),c.setAttribute("data-l10n-id",ge._l10nResizer[u])}}const s=o(this,Oi)[0];let i=0;for(const a of t){if(a===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(o(this,Oi).length/4);if(r!==i){if(r<i)for(let l=0;l<i-r;l++)o(this,Jt).append(o(this,Jt).firstElementChild);else if(r>i)for(let l=0;l<r-i;l++)o(this,Jt).firstElementChild.before(o(this,Jt).lastElementChild);let a=0;for(const l of t){const c=o(this,Oi)[a++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",ge._l10nResizer[c])}}A(this,Fu,$4).call(this,0),b(this,Jr,!0),o(this,Jt).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){o(this,Jr)&&A(this,Iu,H4).call(this,o(this,_u),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){A(this,So,kc).call(this),this.div.focus()}select(){var e,t,s;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=o(this,at))==null||s.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,s,i,r;this.isSelected&&(this.isSelected=!1,(e=o(this,Jt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=o(this,at))==null||r.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return o(this,Mu)}set isEditing(e){b(this,Mu,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){o(this,xi)||b(this,xi,new Map);const{action:s}=e;let i=o(this,xi).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),o(this,xi).delete(s),o(this,xi).size===0&&b(this,xi,null)},ge._telemetryTimeout),o(this,xi).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),b(this,C0,!1)}disable(){this.div&&(this.div.tabIndex=-1),b(this,C0,!0)}updateFakeAnnotationElement(e){if(!o(this,Ai)&&!this.deleted){b(this,Ai,e.addFakeAnnotation(this));return}if(this.deleted){o(this,Ai).remove(),b(this,Ai,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&o(this,Ai).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};vo=new WeakMap,Oi=new WeakMap,at=new WeakMap,je=new WeakMap,Zr=new WeakMap,C0=new WeakMap,sa=new WeakMap,Eu=new WeakMap,Jt=new WeakMap,yo=new WeakMap,Qr=new WeakMap,Ai=new WeakMap,ia=new WeakMap,_u=new WeakMap,wo=new WeakMap,$s=new WeakMap,Mu=new WeakMap,Ao=new WeakMap,Jr=new WeakMap,ur=new WeakMap,E0=new WeakMap,_0=new WeakMap,xi=new WeakMap,xo=new WeakMap,Du=new WeakMap,$p=new WeakMap,Ru=new WeakSet,F4=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Pu=new WeakSet,O4=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},M0=new WeakSet,x1=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},Gp=new WeakSet,D7=function(){if(o(this,Jt))return;b(this,Jt,document.createElement("div")),o(this,Jt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");o(this,Jt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",A(this,Vp,R7).bind(this,s),{signal:t}),i.addEventListener("contextmenu",Di,{signal:t}),i.tabIndex=-1}this.div.prepend(o(this,Jt))},Vp=new WeakSet,R7=function(e,t){var u;t.preventDefault();const{isMac:s}=rs.platform;if(t.button!==0||t.ctrlKey&&s)return;(u=o(this,at))==null||u.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,b(this,yo,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",A(this,Iu,H4).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",St,{passive:!1,signal:a}),window.addEventListener("contextmenu",Di,{signal:a}),b(this,Qr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const l=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var d;r.abort(),this.parent.togglePointerEvents(!0),(d=o(this,at))==null||d.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=l,this.div.style.cursor=h,A(this,D0,S1).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},Lu=new WeakSet,z4=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},D0=new WeakSet,S1=function(){if(!o(this,Qr))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=o(this,Qr);b(this,Qr,null);const r=this.x,a=this.y,l=this.width,h=this.height;r===e&&a===t&&l===s&&h===i||this.addCommands({cmd:A(this,Lu,z4).bind(this,r,a,l,h),undo:A(this,Lu,z4).bind(this,e,t,s,i),mustExec:!0})},Iu=new WeakSet,H4=function(e,t){const[s,i]=this.parentDimensions,r=this.x,a=this.y,l=this.width,h=this.height,c=ge.MIN_SIZE/s,u=ge.MIN_SIZE/i,d=A(this,M0,x1).call(this,this.rotation),f=(Y,Z)=>[d[0]*Y+d[2]*Z,d[1]*Y+d[3]*Z],p=A(this,M0,x1).call(this,360-this.rotation),w=(Y,Z)=>[p[0]*Y+p[2]*Z,p[1]*Y+p[3]*Z];let y,x,S=!1,E=!1;switch(e){case"topLeft":S=!0,y=(Y,Z)=>[0,0],x=(Y,Z)=>[Y,Z];break;case"topMiddle":y=(Y,Z)=>[Y/2,0],x=(Y,Z)=>[Y/2,Z];break;case"topRight":S=!0,y=(Y,Z)=>[Y,0],x=(Y,Z)=>[0,Z];break;case"middleRight":E=!0,y=(Y,Z)=>[Y,Z/2],x=(Y,Z)=>[0,Z/2];break;case"bottomRight":S=!0,y=(Y,Z)=>[Y,Z],x=(Y,Z)=>[0,0];break;case"bottomMiddle":y=(Y,Z)=>[Y/2,Z],x=(Y,Z)=>[Y/2,0];break;case"bottomLeft":S=!0,y=(Y,Z)=>[0,Z],x=(Y,Z)=>[Y,0];break;case"middleLeft":E=!0,y=(Y,Z)=>[0,Z/2],x=(Y,Z)=>[Y,Z/2];break}const T=y(l,h),_=x(l,h);let M=f(..._);const D=ge._round(r+M[0]),L=ge._round(a+M[1]);let F=1,N=1,W,$;if(t.fromKeyboard)({deltaX:W,deltaY:$}=t);else{const{screenX:Y,screenY:Z}=t,[V,we]=o(this,yo);[W,$]=this.screenToPageTranslation(Y-V,Z-we),o(this,yo)[0]=Y,o(this,yo)[1]=Z}if([W,$]=w(W/s,$/i),S){const Y=Math.hypot(l,h);F=N=Math.max(Math.min(Math.hypot(_[0]-T[0]-W,_[1]-T[1]-$)/Y,1/l,1/h),c/l,u/h)}else E?F=ws(Math.abs(_[0]-T[0]-W),c,1)/l:N=ws(Math.abs(_[1]-T[1]-$),u,1)/h;const q=ge._round(l*F),se=ge._round(h*N);M=f(...x(q,se));const z=D-M[0],ee=L-M[1];o(this,$s)||b(this,$s,[this.x,this.y,this.width,this.height]),this.width=q,this.height=se,this.x=z,this.y=ee,this.setDims(),this.fixAndSetPosition(),this._onResizing()},jp=new WeakSet,P7=function(){var e;b(this,Qr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=o(this,at))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},Wp=new WeakSet,L7=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const a=A(this,M0,x1).call(this,this.rotation),l=(D,L)=>[a[0]*D+a[2]*L,a[1]*D+a[3]*L],[h,c]=this.parentDimensions,u=this.x,d=this.y,f=this.width,p=this.height,w=ge.MIN_SIZE/h,y=ge.MIN_SIZE/c;r=Math.max(Math.min(r,1/f,1/p),w/f,y/p);const x=ge._round(f*r),S=ge._round(p*r);if(x===f&&S===p)return;o(this,$s)||b(this,$s,[u,d,f,p]);const E=l(f/2,p/2),T=ge._round(u+E[0]),_=ge._round(d+E[1]),M=l(x/2,S/2);this.x=T-M[0],this.y=_-M[1],this.width=x,this.height=S,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Xp=new WeakSet,I7=function(){var e;(e=o(this,at))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),A(this,D0,S1).call(this)},Bu=new WeakSet,U4=function(e){const{isMac:t}=rs.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},Yp=new WeakSet,B7=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},l=c=>{i.abort(),b(this,sa,null),b(this,wo,!1),this._uiManager.endDragSession()||A(this,Bu,U4).call(this,c),s&&this._onStopDragging()};t&&(b(this,E0,e.clientX),b(this,_0,e.clientY),b(this,sa,e.pointerId),b(this,Eu,e.pointerType),window.addEventListener("pointermove",c=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:u,clientY:d,pointerId:f}=c;if(f!==o(this,sa)){St(c);return}const[p,w]=this.screenToPageTranslation(u-o(this,E0),d-o(this,_0));b(this,E0,u),b(this,_0,d),this._uiManager.dragSelectedEditors(p,w)},a),window.addEventListener("touchmove",St,a),window.addEventListener("pointerdown",c=>{c.pointerType===o(this,Eu)&&(o(this,xo)||c.isPrimary)&&l(c),St(c)},a));const h=c=>{if(!o(this,sa)||o(this,sa)===c.pointerId){l(c);return}St(c)};window.addEventListener("pointerup",h,{signal:r}),window.addEventListener("blur",h,{signal:r})},Nu=new WeakSet,q4=function(){if(o(this,ia)||!this.div)return;b(this,ia,new AbortController);const e=this._uiManager.combinedSignal(o(this,ia));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},Kp=new WeakSet,N7=function(e){ge._resizerKeyboardManager.exec(this,e)},Zp=new WeakSet,F7=function(e){var t;o(this,Jr)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==o(this,Jt)&&A(this,So,kc).call(this)},Qp=new WeakSet,O7=function(e){b(this,_u,o(this,Jr)?e:"")},Fu=new WeakSet,$4=function(e){if(o(this,Oi))for(const t of o(this,Oi))t.tabIndex=e},So=new WeakSet,kc=function(){b(this,Jr,!1),A(this,Fu,$4).call(this,-1),A(this,D0,S1).call(this)},g(ge,Pu),O(ge,"_l10n",null),O(ge,"_l10nResizer",null),O(ge,"_borderLineWidth",-1),O(ge,"_colorManager",new R4),O(ge,"_zIndex",1),O(ge,"_telemetryTimeout",1e3);let et=ge;class K9 extends et{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const a6=3285377520,di=4294901760,tr=65535;class z7{constructor(e){this.h1=e?e&4294967295:a6,this.h2=e?e&4294967295:a6}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let y=0,x=e.length;y<x;y++){const S=e.charCodeAt(y);S<=255?t[s++]=S:(t[s++]=S>>>8,t[s++]=S&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,a=new Uint32Array(t.buffer,0,i);let l=0,h=0,c=this.h1,u=this.h2;const d=3432918353,f=461845907,p=d&tr,w=f&tr;for(let y=0;y<i;y++)y&1?(l=a[y],l=l*d&di|l*p&tr,l=l<<15|l>>>17,l=l*f&di|l*w&tr,c^=l,c=c<<13|c>>>19,c=c*5+3864292196):(h=a[y],h=h*d&di|h*p&tr,h=h<<15|h>>>17,h=h*f&di|h*w&tr,u^=h,u=u<<13|u>>>19,u=u*5+3864292196);switch(l=0,r){case 3:l^=t[i*4+2]<<16;case 2:l^=t[i*4+1]<<8;case 1:l^=t[i*4],l=l*d&di|l*p&tr,l=l<<15|l>>>17,l=l*f&di|l*w&tr,i&1?c^=l:u^=l}this.h1=c,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&di|e*36045&tr,t=t*4283543511&di|((t<<16|e>>>16)*2950163797&di)>>>16,e^=t>>>1,e=e*444984403&di|e*60499&tr,t=t*3301882366&di|((t<<16|e>>>16)*3120437893&di)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const G4=Object.freeze({map:null,hash:"",transfer:void 0});var ko,To,en,es,Jp,H7;class D3{constructor(){g(this,Jp);g(this,ko,!1);g(this,To,null);g(this,en,null);g(this,es,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=o(this,es).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return o(this,es).get(e)}remove(e){const t=o(this,es).get(e);if(t!==void 0&&(t instanceof et&&o(this,en).delete(t.annotationElementId),o(this,es).delete(e),o(this,es).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of o(this,es).values())if(s instanceof et)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=o(this,es).get(e);let i=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(i=!0,s[r]=a);else i=!0,o(this,es).set(e,t);i&&A(this,Jp,H7).call(this),t instanceof et&&((o(this,en)||b(this,en,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return o(this,es).has(e)}get size(){return o(this,es).size}resetModified(){o(this,ko)&&(b(this,ko,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new U7(this)}get serializable(){if(o(this,es).size===0)return G4;const e=new Map,t=new z7,s=[],i=Object.create(null);let r=!1;for(const[a,l]of o(this,es)){const h=l instanceof et?l.serialize(!1,i):l;h&&(e.set(a,h),t.update(`${a}:${JSON.stringify(h)}`),r||(r=!!h.bitmap))}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:G4}get editorStats(){let e=null;const t=new Map;let s=0,i=0;for(const r of o(this,es).values()){if(!(r instanceof et)){r.popup&&(r.popup.deleted?i+=1:s+=1);continue}r.isCommentDeleted?i+=1:r.hasEditedComment&&(s+=1);const a=r.telemetryFinalData;if(!a)continue;const{type:l}=a;t.has(l)||t.set(l,Object.getPrototypeOf(r).constructor),e||(e=Object.create(null));const h=e[l]||(e[l]=new Map);for(const[c,u]of Object.entries(a)){if(c==="type")continue;let d=h.get(c);d||(d=new Map,h.set(c,d));const f=d.get(u)??0;d.set(u,f+1)}}if((i>0||s>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:s}),!e)return null;for(const[r,a]of t)e[r]=a.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){b(this,To,null)}updateEditor(e,t){var i;const s=(i=o(this,en))==null?void 0:i.get(e);return s?(s.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=o(this,en))==null?void 0:t.get(e))||null}get modifiedIds(){if(o(this,To))return o(this,To);const e=[];if(o(this,en))for(const t of o(this,en).values())t.serialize()&&e.push(t.annotationElementId);return b(this,To,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return o(this,es).entries()}}ko=new WeakMap,To=new WeakMap,en=new WeakMap,es=new WeakMap,Jp=new WeakSet,H7=function(){o(this,ko)||(b(this,ko,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Ou;class U7 extends D3{constructor(t){super();g(this,Ou,void 0);const{map:s,hash:i,transfer:r}=t.serializable,a=structuredClone(s,r?{transfer:r}:null);b(this,Ou,{map:a,hash:i,transfer:r})}get print(){Xe("Should not call PrintAnnotationStorage.print")}get serializable(){return o(this,Ou)}get modifiedIds(){return me(this,"modifiedIds",{ids:new Set,hash:""})}}Ou=new WeakMap;var R0;class Z9{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){g(this,R0,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),o(this,R0).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||o(this,R0).has(e.loadedName))){if(Ce(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:a}=e,l=new FontFace(i,r,a);this.addNativeFontFace(l);try{await l.load(),o(this,R0).add(i),s==null||s(e)}catch{pe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}Xe("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw pe(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return me(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return me(this,"isSyncFontLoadingSupported",ys||rs.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Ce(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return me(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(_,M){return _.charCodeAt(M)<<24|_.charCodeAt(M+1)<<16|_.charCodeAt(M+2)<<8|_.charCodeAt(M+3)&255}function i(_,M,D,L){const F=_.substring(0,M),N=_.substring(M+D);return F+L+N}let r,a;const l=this._document.createElement("canvas");l.width=1,l.height=1;const h=l.getContext("2d");let c=0;function u(_,M){if(++c>30){pe("Load test font never loaded."),M();return}if(h.font="30px "+_,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){M();return}setTimeout(u.bind(null,_,M))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,d.length,d);const w=16,y=1482184792;let x=s(f,w);for(r=0,a=d.length-3;r<a;r+=4)x=x-y+s(d,r)|0;r<d.length&&(x=x-y+s(d+"XXX",r)|0),f=i(f,w,4,R9(x));const S=`url(data:font/opentype;base64,${btoa(f)});`,E=`@font-face {font-family:"${d}";src:${S}}`;this.insertRule(E);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const _ of[e.loadedName,d]){const M=this._document.createElement("span");M.textContent="Hi",M.style.fontFamily=_,T.append(M)}this._document.body.append(T),u(d,()=>{T.remove(),t.complete()})}}R0=new WeakMap;var Ue;class Q9{constructor(e,t=null,s,i){g(this,Ue,void 0);this.compiledGlyphs=Object.create(null),b(this,Ue,e),this._inspectFont=t,s&&Object.assign(this,s),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${r7(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(a){pe(`getPathGenerator - ignoring character: "${a}".`)}const r=o7(i);return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}get black(){return o(this,Ue).black}get bold(){return o(this,Ue).bold}get disableFontFace(){return o(this,Ue).disableFontFace??!1}set disableFontFace(e){me(this,"disableFontFace",!!e)}get fontExtraProperties(){return o(this,Ue).fontExtraProperties??!1}get isInvalidPDFjsFont(){return o(this,Ue).isInvalidPDFjsFont}get isType3Font(){return o(this,Ue).isType3Font}get italic(){return o(this,Ue).italic}get missingFile(){return o(this,Ue).missingFile}get remeasure(){return o(this,Ue).remeasure}get vertical(){return o(this,Ue).vertical}get ascent(){return o(this,Ue).ascent}get defaultWidth(){return o(this,Ue).defaultWidth}get descent(){return o(this,Ue).descent}get bbox(){return o(this,Ue).bbox}set bbox(e){me(this,"bbox",e)}get fontMatrix(){return o(this,Ue).fontMatrix}get fallbackName(){return o(this,Ue).fallbackName}get loadedName(){return o(this,Ue).loadedName}get mimetype(){return o(this,Ue).mimetype}get name(){return o(this,Ue).name}get data(){return o(this,Ue).data}clearData(){o(this,Ue).clearData()}get cssFontInfo(){return o(this,Ue).cssFontInfo}get systemFontInfo(){return o(this,Ue).systemFontInfo}get defaultVMetrics(){return o(this,Ue).defaultVMetrics}}Ue=new WeakMap;var P0,L0,zu,I0,k1;const Jl=class Jl{constructor(e){g(this,I0);g(this,P0,void 0);g(this,L0,void 0);g(this,zu,void 0);b(this,P0,e),b(this,L0,new DataView(o(this,P0))),b(this,zu,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let i=0;for(const c of Jl.strings){const u=t.encode(e[c]);s[c]=u,i+=4+u.length}const r=new ArrayBuffer(i),a=new Uint8Array(r),l=new DataView(r);let h=0;for(const c of Jl.strings){const u=s[c],d=u.length;l.setUint32(h,d),a.set(u,h+4),h+=4+d}return Ce(h===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}get fontFamily(){return A(this,I0,k1).call(this,0)}get fontWeight(){return A(this,I0,k1).call(this,1)}get italicAngle(){return A(this,I0,k1).call(this,2)}};P0=new WeakMap,L0=new WeakMap,zu=new WeakMap,I0=new WeakSet,k1=function(e){Ce(e<Jl.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=o(this,L0).getUint32(t)+4;const s=o(this,L0).getUint32(t);return o(this,zu).decode(new Uint8Array(o(this,P0),t+4,s))},O(Jl,"strings",["fontFamily","fontWeight","italicAngle"]);let cp=Jl;var ra,dr,Co,Eo,Tc;const e0=class e0{constructor(e){g(this,Eo);g(this,ra,void 0);g(this,dr,void 0);g(this,Co,void 0);b(this,ra,e),b(this,dr,new DataView(o(this,ra))),b(this,Co,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let i=0;for(const f of e0.strings){const p=t.encode(e[f]);s[f]=p,i+=4+p.length}i+=4;let r,a,l=1+i;e.style&&(r=t.encode(e.style.style),a=t.encode(e.style.weight),l+=4+r.length+4+a.length);const h=new ArrayBuffer(l),c=new Uint8Array(h),u=new DataView(h);let d=0;u.setUint8(d++,e.guessFallback?1:0),u.setUint32(d,0),d+=4,i=0;for(const f of e0.strings){const p=s[f],w=p.length;i+=4+w,u.setUint32(d,w),c.set(p,d+4),d+=4+w}return u.setUint32(d-i-4,i),e.style&&(u.setUint32(d,r.length),c.set(r,d+4),d+=4+r.length,u.setUint32(d,a.length),c.set(a,d+4),d+=4+a.length),Ce(d<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(d)}get guessFallback(){return o(this,dr).getUint8(0)!==0}get css(){return A(this,Eo,Tc).call(this,0)}get loadedName(){return A(this,Eo,Tc).call(this,1)}get baseFontName(){return A(this,Eo,Tc).call(this,2)}get src(){return A(this,Eo,Tc).call(this,3)}get style(){let e=1;e+=4+o(this,dr).getUint32(e);const t=o(this,dr).getUint32(e),s=o(this,Co).decode(new Uint8Array(o(this,ra),e+4,t));e+=4+t;const i=o(this,dr).getUint32(e),r=o(this,Co).decode(new Uint8Array(o(this,ra),e+4,i));return{style:s,weight:r}}};ra=new WeakMap,dr=new WeakMap,Co=new WeakMap,Eo=new WeakSet,Tc=function(e){Ce(e<e0.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=o(this,dr).getUint32(t)+4;const s=o(this,dr).getUint32(t);return o(this,Co).decode(new Uint8Array(o(this,ra),t+4,s))},O(e0,"strings",["css","loadedName","baseFontName","src"]);let up=e0;var B0,N0,F0,O0,Gs,fr,Hu,qe,Vs,Pi,z0,T1,_o,Cc;const ve=class ve{constructor({data:e,extra:t}){g(this,Vs);g(this,z0);g(this,_o);g(this,fr,void 0);g(this,Hu,void 0);g(this,qe,void 0);b(this,fr,e),b(this,Hu,new TextDecoder),b(this,qe,new DataView(o(this,fr))),t&&Object.assign(this,t)}get black(){return A(this,Vs,Pi).call(this,0)}get bold(){return A(this,Vs,Pi).call(this,1)}get disableFontFace(){return A(this,Vs,Pi).call(this,2)}get fontExtraProperties(){return A(this,Vs,Pi).call(this,3)}get isInvalidPDFjsFont(){return A(this,Vs,Pi).call(this,4)}get isType3Font(){return A(this,Vs,Pi).call(this,5)}get italic(){return A(this,Vs,Pi).call(this,6)}get missingFile(){return A(this,Vs,Pi).call(this,7)}get remeasure(){return A(this,Vs,Pi).call(this,8)}get vertical(){return A(this,Vs,Pi).call(this,9)}get ascent(){return A(this,z0,T1).call(this,0)}get defaultWidth(){return A(this,z0,T1).call(this,1)}get descent(){return A(this,z0,T1).call(this,2)}get bbox(){let e=o(ve,N0);if(o(this,qe).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<4;i++)s.push(o(this,qe).getInt16(e,!0)),e+=2;return s}get fontMatrix(){let e=o(ve,F0);if(o(this,qe).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<6;i++)s.push(o(this,qe).getFloat64(e,!0)),e+=8;return s}get defaultVMetrics(){let e=o(ve,O0);if(o(this,qe).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<3;i++)s.push(o(this,qe).getInt16(e,!0)),e+=2;return s}get fallbackName(){return A(this,_o,Cc).call(this,0)}get loadedName(){return A(this,_o,Cc).call(this,1)}get mimetype(){return A(this,_o,Cc).call(this,2)}get name(){return A(this,_o,Cc).call(this,3)}get data(){let e=o(ve,Gs);const t=o(this,qe).getUint32(e);e+=4+t;const s=o(this,qe).getUint32(e);e+=4+s;const i=o(this,qe).getUint32(e);e+=4+i;const r=o(this,qe).getUint32(e);if(r!==0)return new Uint8Array(o(this,fr),e+4,r)}clearData(){let e=o(ve,Gs);const t=o(this,qe).getUint32(e);e+=4+t;const s=o(this,qe).getUint32(e);e+=4+s;const i=o(this,qe).getUint32(e);e+=4+i;const r=o(this,qe).getUint32(e);new Uint8Array(o(this,fr),e+4,r).fill(0),o(this,qe).setUint32(e,0)}get cssFontInfo(){let e=o(ve,Gs);const t=o(this,qe).getUint32(e);e+=4+t;const s=o(this,qe).getUint32(e);e+=4+s;const i=o(this,qe).getUint32(e);if(i===0)return null;const r=new Uint8Array(i);return r.set(new Uint8Array(o(this,fr),e+4,i)),new cp(r.buffer)}get systemFontInfo(){let e=o(ve,Gs);const t=o(this,qe).getUint32(e);e+=4+t;const s=o(this,qe).getUint32(e);if(s===0)return null;const i=new Uint8Array(s);return i.set(new Uint8Array(o(this,fr),e+4,s)),new up(i.buffer)}static write(e){const t=e.systemFontInfo?up.write(e.systemFontInfo):null,s=e.cssFontInfo?cp.write(e.cssFontInfo):null,i=new TextEncoder,r={};let a=0;for(const y of ve.strings)r[y]=i.encode(e[y]),a+=4+r[y].length;const l=o(ve,Gs)+4+a+4+(t?t.byteLength:0)+4+(s?s.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(l),c=new Uint8Array(h),u=new DataView(h);let d=0;const f=ve.bools.length;let p=0,w=0;for(let y=0;y<f;y++){const x=e[ve.bools[y]];p|=(x===void 0?0:x?2:1)<<w,w+=2,(w===8||y===f-1)&&(u.setUint8(d++,p),p=0,w=0)}Ce(d===o(ve,B0),"FontInfo.write: Boolean properties offset mismatch");for(const y of ve.numbers)u.setFloat64(d,e[y]),d+=8;if(Ce(d===o(ve,N0),"FontInfo.write: Number properties offset mismatch"),e.bbox){u.setUint8(d++,4);for(const y of e.bbox)u.setInt16(d,y,!0),d+=2}else u.setUint8(d++,0),d+=2*4;if(Ce(d===o(ve,F0),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){u.setUint8(d++,6);for(const y of e.fontMatrix)u.setFloat64(d,y,!0),d+=8}else u.setUint8(d++,0),d+=8*6;if(Ce(d===o(ve,O0),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){u.setUint8(d++,1);for(const y of e.defaultVMetrics)u.setInt16(d,y,!0),d+=2}else u.setUint8(d++,0),d+=3*2;Ce(d===o(ve,Gs),"FontInfo.write: DefaultVMetrics properties offset mismatch"),u.setUint32(o(ve,Gs),0),d+=4;for(const y of ve.strings){const x=r[y],S=x.length;u.setUint32(d,S),c.set(x,d+4),d+=4+S}if(u.setUint32(o(ve,Gs),d-o(ve,Gs)-4),!t)u.setUint32(d,0),d+=4;else{const y=t.byteLength;u.setUint32(d,y),Ce(d+4+y<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),c.set(new Uint8Array(t),d+4),d+=4+y}if(!s)u.setUint32(d,0),d+=4;else{const y=s.byteLength;u.setUint32(d,y),Ce(d+4+y<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),c.set(new Uint8Array(s),d+4),d+=4+y}return e.data===void 0?(u.setUint32(d,0),d+=4):(u.setUint32(d,e.data.length),c.set(e.data,d+4),d+=4+e.data.length),Ce(d<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(d)}};B0=new WeakMap,N0=new WeakMap,F0=new WeakMap,O0=new WeakMap,Gs=new WeakMap,fr=new WeakMap,Hu=new WeakMap,qe=new WeakMap,Vs=new WeakSet,Pi=function(e){Ce(e<ve.bools.length,"Invalid boolean index");const t=Math.floor(e/4),s=e*2%8,i=o(this,qe).getUint8(t)>>s&3;return i===0?void 0:i===2},z0=new WeakSet,T1=function(e){return Ce(e<ve.numbers.length,"Invalid number index"),o(this,qe).getFloat64(o(ve,B0)+e*8)},_o=new WeakSet,Cc=function(e){Ce(e<ve.strings.length,"Invalid string index");let t=o(ve,Gs)+4;for(let r=0;r<e;r++)t+=o(this,qe).getUint32(t)+4;const s=o(this,qe).getUint32(t),i=new Uint8Array(s);return i.set(new Uint8Array(o(this,fr),t+4,s)),o(this,Hu).decode(i)},O(ve,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),O(ve,"numbers",["ascent","defaultWidth","descent"]),O(ve,"strings",["fallbackName","loadedName","mimetype","name"]),g(ve,B0,Math.ceil(ve.bools.length*2/8)),g(ve,N0,o(ve,B0)+ve.numbers.length*8),g(ve,F0,o(ve,N0)+1+2*4),g(ve,O0,o(ve,F0)+1+8*6),g(ve,Gs,o(ve,O0)+1+2*3);let V4=ve;var Uu,qu,$u,Gu,Vu,ju,Wu,Xu;const Ze=class Ze{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,s=null,i=[],r=[],a=[],l=[],h=null,c=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,s=e[2],a=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,h=e[1],i=e[2],r=e[3],l=e[4]||[],s=e[6],c=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const u=Math.floor(i.length/2),d=Math.floor(r.length/3),f=a.length,p=l.length;let w=0;for(const M of l)w+=1,w=Math.ceil(w/4)*4,w+=4+M.coords.length*4,w+=4+M.colors.length*4,M.verticesPerRow!==void 0&&(w+=4);const y=20+u*8+d*3+f*8+(s?16:0)+(c?3:0)+w,x=new ArrayBuffer(y),S=new DataView(x),E=new Uint8Array(x);S.setUint8(o(Ze,Uu),t),S.setUint8(o(Ze,qu),s?1:0),S.setUint8(o(Ze,$u),c?1:0),S.setUint8(o(Ze,Gu),h),S.setUint32(o(Ze,Vu),u,!0),S.setUint32(o(Ze,ju),d,!0),S.setUint32(o(Ze,Wu),f,!0),S.setUint32(o(Ze,Xu),p,!0);let T=20;new Float32Array(x,T,u*2).set(i),T+=u*8,E.set(r,T),T+=d*3;for(const[M,D]of a)S.setFloat32(T,M,!0),T+=4,S.setUint32(T,parseInt(D.slice(1),16),!0),T+=4;if(s)for(const M of s)S.setFloat32(T,M,!0),T+=4;c&&(E.set(c,T),T+=3);for(let M=0;M<l.length;M++){const D=l[M];S.setUint8(T,D.type),T+=1,T=Math.ceil(T/4)*4,S.setUint32(T,D.coords.length,!0),T+=4,new Int32Array(x,T,D.coords.length).set(D.coords),T+=D.coords.length*4,S.setUint32(T,D.colors.length,!0),T+=4,new Int32Array(x,T,D.colors.length).set(D.colors),T+=D.colors.length*4,D.verticesPerRow!==void 0&&(S.setUint32(T,D.verticesPerRow,!0),T+=4)}return x}getIR(){const e=this.view,t=this.data[o(Ze,Uu)],s=!!this.data[o(Ze,qu)],i=!!this.data[o(Ze,$u)],r=e.getUint32(o(Ze,Vu),!0),a=e.getUint32(o(Ze,ju),!0),l=e.getUint32(o(Ze,Wu),!0),h=e.getUint32(o(Ze,Xu),!0);let c=20;const u=new Float32Array(this.buffer,c,r*2);c+=r*8;const d=new Uint8Array(this.buffer,c,a*3);c+=a*3;const f=[];for(let x=0;x<l;++x){const S=e.getFloat32(c,!0);c+=4;const E=e.getUint32(c,!0);c+=4,f.push([S,`#${E.toString(16).padStart(6,"0")}`])}let p=null;if(s){p=[];for(let x=0;x<4;++x)p.push(e.getFloat32(c,!0)),c+=4}let w=null;i&&(w=new Uint8Array(this.buffer,c,3),c+=3);const y=[];for(let x=0;x<h;++x){const S=e.getUint8(c);c+=1,c=Math.ceil(c/4)*4;const E=e.getUint32(c,!0);c+=4;const T=new Int32Array(this.buffer,c,E);c+=E*4;const _=e.getUint32(c,!0);c+=4;const M=new Int32Array(this.buffer,c,_);c+=_*4;const D={type:S,coords:T,colors:M};S===S4.LATTICE&&(D.verticesPerRow=e.getUint32(c,!0),c+=4),y.push(D)}if(t===1)return["RadialAxial","axial",p,f,Array.from(u.slice(0,2)),Array.from(u.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",p,f,[u[0],u[1]],[u[3],u[4]],u[2],u[5]];if(t===3){const x=this.data[o(Ze,Gu)];let S=null;if(u.length>0){let E=u[0],T=u[0],_=u[1],M=u[1];for(let D=0;D<u.length;D+=2){const L=u[D],F=u[D+1];E=E>L?L:E,_=_>F?F:_,T=T<L?L:T,M=M<F?F:M}S=[E,_,T,M]}return["Mesh",x,u,d,y,S,p,w]}throw new Error(`Unsupported pattern kind: ${t}`)}};Uu=new WeakMap,qu=new WeakMap,$u=new WeakMap,Gu=new WeakMap,Vu=new WeakMap,ju=new WeakMap,Wu=new WeakMap,Xu=new WeakMap,g(Ze,Uu,0),g(Ze,qu,1),g(Ze,$u,2),g(Ze,Gu,3),g(Ze,Vu,4),g(Ze,ju,8),g(Ze,Wu,12),g(Ze,Xu,16);let j4=Ze;function J9(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(ys)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function eA(n){if(ys&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Of(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function i1(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const W4=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,tA=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",sA=N9.bind(null,W4,tA);var tn,em;class iA{constructor(){g(this,tn,new Map);g(this,em,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};o(this,em).then(()=>{for(const[i]of o(this,tn))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){pe("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}o(this,tn).set(t,i)}removeEventListener(e,t){const s=o(this,tn).get(t);s==null||s(),o(this,tn).delete(t)}terminate(){for(const[,e]of o(this,tn))e==null||e();o(this,tn).clear()}}tn=new WeakMap,em=new WeakMap;const r1={DATA:1,ERROR:2},_t={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function o6(){}function ks(n){if(n instanceof Ua||n instanceof k4||n instanceof J5||n instanceof ap||n instanceof Qg)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Xe('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Ua(n.message);case"InvalidPDFException":return new k4(n.message);case"PasswordException":return new J5(n.message,n.code);case"ResponseException":return new ap(n.message,n.status,n.missing);case"UnknownErrorException":return new Qg(n.message,n.details)}return new Qg(n.message,n.toString())}var H0,tm,q7,sm,$7,im,G7,U0,C1;class Ec{constructor(e,t,s){g(this,tm);g(this,sm);g(this,im);g(this,U0);g(this,H0,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",A(this,tm,q7).bind(this),{signal:o(this,H0).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,a=this.sourceName,l=this.targetName,h=this.comObj;return new ReadableStream({start:c=>{const u=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:a,targetName:l,action:e,streamId:r,data:t,desiredSize:c.desiredSize},i),u.promise},pull:c=>{const u=Promise.withResolvers();return this.streamControllers[r].pullCall=u,h.postMessage({sourceName:a,targetName:l,stream:_t.PULL,streamId:r,desiredSize:c.desiredSize}),u.promise},cancel:c=>{Ce(c instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[r].cancelCall=u,this.streamControllers[r].isClosed=!0,h.postMessage({sourceName:a,targetName:l,stream:_t.CANCEL,streamId:r,reason:ks(c)}),u.promise}},s)}destroy(){var e;(e=o(this,H0))==null||e.abort(),b(this,H0,null)}}H0=new WeakMap,tm=new WeakSet,q7=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){A(this,im,G7).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===r1.DATA)i.resolve(e.data);else if(e.callback===r1.ERROR)i.reject(ks(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:i,callback:r1.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:i,callback:r1.ERROR,callbackId:e.callbackId,reason:ks(a)})});return}if(e.streamId){A(this,sm,$7).call(this,e);return}t(e.data)},sm=new WeakSet,$7=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this,l=this.actionHandler[e.action],h={enqueue(c,u=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=u,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:_t.ENQUEUE,streamId:t,chunk:c},d)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:_t.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){Ce(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:_t.ERROR,streamId:t,reason:ks(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(l,e.data,h).then(function(){r.postMessage({sourceName:s,targetName:i,stream:_t.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:s,targetName:i,stream:_t.START_COMPLETE,streamId:t,reason:ks(c)})})},im=new WeakSet,G7=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],l=this.streamSinks[t];switch(e.stream){case _t.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ks(e.reason));break;case _t.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ks(e.reason));break;case _t.PULL:if(!l){r.postMessage({sourceName:s,targetName:i,stream:_t.PULL_COMPLETE,streamId:t,success:!0});break}l.desiredSize<=0&&e.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=e.desiredSize,Promise.try(l.onPull||o6).then(function(){r.postMessage({sourceName:s,targetName:i,stream:_t.PULL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:s,targetName:i,stream:_t.PULL_COMPLETE,streamId:t,reason:ks(c)})});break;case _t.ENQUEUE:if(Ce(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case _t.CLOSE:if(Ce(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),A(this,U0,C1).call(this,a,t);break;case _t.ERROR:Ce(a,"error should have stream controller"),a.controller.error(ks(e.reason)),A(this,U0,C1).call(this,a,t);break;case _t.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ks(e.reason)),A(this,U0,C1).call(this,a,t);break;case _t.CANCEL:if(!l)break;const h=ks(e.reason);Promise.try(l.onCancel||o6,h).then(function(){r.postMessage({sourceName:s,targetName:i,stream:_t.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:s,targetName:i,stream:_t.CANCEL_COMPLETE,streamId:t,reason:ks(c)})}),l.sinkCapability.reject(h),l.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},U0=new WeakSet,C1=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var Yu;class V7{constructor({enableHWA:e=!1}){g(this,Yu,!1);b(this,Yu,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!o(this,Yu)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Xe("Abstract method `_createCanvas` called.")}}Yu=new WeakMap;class rA extends V7{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class j7{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Xe("Abstract method `_fetch` called.")}}class l6 extends j7{async _fetch(e){const t=await zf(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Of(t)}}class W7{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var Mo,q0,sn,rn,cs,Do,Ro,Ht,as,Po,_c,na,Gl,$0,E1,aa,Vl,rm,X7,Ku,X4,oa,jl,Lo,Mc,Io,Dc,Zu,Y4,Bo,Rc;class nA extends W7{constructor({docId:t,ownerDocument:s=globalThis.document}){super();g(this,Ht);g(this,Po);g(this,na);g(this,$0);g(this,aa);g(this,rm);g(this,Ku);g(this,oa);g(this,Lo);g(this,Io);g(this,Zu);g(this,Bo);g(this,Mo,void 0);g(this,q0,void 0);g(this,sn,void 0);g(this,rn,void 0);g(this,cs,void 0);g(this,Do,void 0);g(this,Ro,0);b(this,rn,t),b(this,cs,s)}addFilter(t){if(!t)return"none";let s=o(this,Ht,as).get(t);if(s)return s;const[i,r,a]=A(this,$0,E1).call(this,t),l=t.length===1?i:`${i}${r}${a}`;if(s=o(this,Ht,as).get(l),s)return o(this,Ht,as).set(t,s),s;const h=`g_${o(this,rn)}_transfer_map_${Lt(this,Ro)._++}`,c=A(this,aa,Vl).call(this,h);o(this,Ht,as).set(t,c),o(this,Ht,as).set(l,c);const u=A(this,oa,jl).call(this,h);return A(this,Io,Dc).call(this,i,r,a,u),c}addHCMFilter(t,s){var w;const i=`${t}-${s}`,r="base";let a=o(this,Po,_c).get(r);if((a==null?void 0:a.key)===i||(a?((w=a.filter)==null||w.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},o(this,Po,_c).set(r,a)),!t||!s))return a.url;const l=A(this,Bo,Rc).call(this,t);t=ae.makeHexColor(...l);const h=A(this,Bo,Rc).call(this,s);if(s=ae.makeHexColor(...h),o(this,na,Gl).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const c=new Array(256);for(let y=0;y<=255;y++){const x=y/255;c[y]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const u=c.join(","),d=`g_${o(this,rn)}_hcm_filter`,f=a.filter=A(this,oa,jl).call(this,d);A(this,Io,Dc).call(this,u,u,u,f),A(this,Ku,X4).call(this,f);const p=(y,x)=>{const S=l[y]/255,E=h[y]/255,T=new Array(x+1);for(let _=0;_<=x;_++)T[_]=S+_/x*(E-S);return T.join(",")};return A(this,Io,Dc).call(this,p(0,5),p(1,5),p(2,5),f),a.url=A(this,aa,Vl).call(this,d),a.url}addAlphaFilter(t){let s=o(this,Ht,as).get(t);if(s)return s;const[i]=A(this,$0,E1).call(this,[t]),r=`alpha_${i}`;if(s=o(this,Ht,as).get(r),s)return o(this,Ht,as).set(t,s),s;const a=`g_${o(this,rn)}_alpha_map_${Lt(this,Ro)._++}`,l=A(this,aa,Vl).call(this,a);o(this,Ht,as).set(t,l),o(this,Ht,as).set(r,l);const h=A(this,oa,jl).call(this,a);return A(this,Zu,Y4).call(this,i,h),l}addLuminosityFilter(t){let s=o(this,Ht,as).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=A(this,$0,E1).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=o(this,Ht,as).get(r),s)return o(this,Ht,as).set(t,s),s;const a=`g_${o(this,rn)}_luminosity_map_${Lt(this,Ro)._++}`,l=A(this,aa,Vl).call(this,a);o(this,Ht,as).set(t,l),o(this,Ht,as).set(r,l);const h=A(this,oa,jl).call(this,a);return A(this,rm,X7).call(this,h),t&&A(this,Zu,Y4).call(this,i,h),l}addHighlightHCMFilter(t,s,i,r,a){var E;const l=`${s}-${i}-${r}-${a}`;let h=o(this,Po,_c).get(t);if((h==null?void 0:h.key)===l||(h?((E=h.filter)==null||E.remove(),h.key=l,h.url="none",h.filter=null):(h={key:l,url:"none",filter:null},o(this,Po,_c).set(t,h)),!s||!i))return h.url;const[c,u]=[s,i].map(A(this,Bo,Rc).bind(this));let d=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[p,w]=[r,a].map(A(this,Bo,Rc).bind(this));f<d&&([d,f,p,w]=[f,d,w,p]),o(this,na,Gl).style.color="";const y=(T,_,M)=>{const D=new Array(256),L=(f-d)/M,F=T/255,N=(_-T)/(255*M);let W=0;for(let $=0;$<=M;$++){const q=Math.round(d+$*L),se=F+$*N;for(let z=W;z<=q;z++)D[z]=se;W=q+1}for(let $=W;$<256;$++)D[$]=D[W-1];return D.join(",")},x=`g_${o(this,rn)}_hcm_${t}_filter`,S=h.filter=A(this,oa,jl).call(this,x);return A(this,Ku,X4).call(this,S),A(this,Io,Dc).call(this,y(p[0],w[0],5),y(p[1],w[1],5),y(p[2],w[2],5),S),h.url=A(this,aa,Vl).call(this,x),h.url}destroy(t=!1){var s,i,r,a;t&&((s=o(this,Do))!=null&&s.size)||((i=o(this,sn))==null||i.parentNode.parentNode.remove(),b(this,sn,null),(r=o(this,q0))==null||r.clear(),b(this,q0,null),(a=o(this,Do))==null||a.clear(),b(this,Do,null),b(this,Ro,0))}}Mo=new WeakMap,q0=new WeakMap,sn=new WeakMap,rn=new WeakMap,cs=new WeakMap,Do=new WeakMap,Ro=new WeakMap,Ht=new WeakSet,as=function(){return o(this,q0)||b(this,q0,new Map)},Po=new WeakSet,_c=function(){return o(this,Do)||b(this,Do,new Map)},na=new WeakSet,Gl=function(){if(!o(this,sn)){const t=o(this,cs).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=o(this,cs).createElementNS(Or,"svg");i.setAttribute("width",0),i.setAttribute("height",0),b(this,sn,o(this,cs).createElementNS(Or,"defs")),t.append(i),i.append(o(this,sn)),o(this,cs).body.append(t)}return o(this,sn)},$0=new WeakSet,E1=function(t){if(t.length===1){const c=t[0],u=new Array(256);for(let f=0;f<256;f++)u[f]=c[f]/255;const d=u.join(",");return[d,d,d]}const[s,i,r]=t,a=new Array(256),l=new Array(256),h=new Array(256);for(let c=0;c<256;c++)a[c]=s[c]/255,l[c]=i[c]/255,h[c]=r[c]/255;return[a.join(","),l.join(","),h.join(",")]},aa=new WeakSet,Vl=function(t){if(o(this,Mo)===void 0){b(this,Mo,"");const s=o(this,cs).URL;s!==o(this,cs).baseURI&&(Cg(s)?pe('#createUrl: ignore "data:"-URL for performance reasons.'):b(this,Mo,t7(s,"")))}return`url(${o(this,Mo)}#${t})`},rm=new WeakSet,X7=function(t){const s=o(this,cs).createElementNS(Or,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},Ku=new WeakSet,X4=function(t){const s=o(this,cs).createElementNS(Or,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},oa=new WeakSet,jl=function(t){const s=o(this,cs).createElementNS(Or,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),o(this,na,Gl).append(s),s},Lo=new WeakSet,Mc=function(t,s,i){const r=o(this,cs).createElementNS(Or,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},Io=new WeakSet,Dc=function(t,s,i,r){const a=o(this,cs).createElementNS(Or,"feComponentTransfer");r.append(a),A(this,Lo,Mc).call(this,a,"feFuncR",t),A(this,Lo,Mc).call(this,a,"feFuncG",s),A(this,Lo,Mc).call(this,a,"feFuncB",i)},Zu=new WeakSet,Y4=function(t,s){const i=o(this,cs).createElementNS(Or,"feComponentTransfer");s.append(i),A(this,Lo,Mc).call(this,i,"feFuncA",t)},Bo=new WeakSet,Rc=function(t){return o(this,na,Gl).style.color=t,Uf(getComputedStyle(o(this,na,Gl)).getPropertyValue("color"))};class Y7{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Xe("Abstract method `_fetch` called.")}}class h6 extends Y7{async _fetch(e){const t=await zf(e,"arraybuffer");return new Uint8Array(t)}}class K7{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Xe("Abstract method `_fetch` called.")}}class c6 extends K7{async _fetch(e){const t=await zf(e,"arraybuffer");return new Uint8Array(t)}}ys&&pe("Please use the `legacy` build in Node.js environments.");async function R3(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class aA extends W7{}class oA extends V7{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class lA extends j7{async _fetch(e){return R3(e)}}class hA extends Y7{async _fetch(e){return R3(e)}}class cA extends K7{async _fetch(e){return R3(e)}}const Hl="__forcedDependency",{floor:u6,ceil:d6}=Math;function n1(n,e,t,s,i,r){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],s),n[e*4+2]=Math.max(n[e*4+2],i),n[e*4+3]=Math.max(n[e*4+3],r)}const K4=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var G0,la;class uA{constructor(e,t){g(this,G0,void 0);g(this,la,void 0);b(this,G0,e),b(this,la,t)}get length(){return o(this,G0).length}isEmpty(e){return o(this,G0)[e]===K4}minX(e){return o(this,la)[e*4+0]/256}minY(e){return o(this,la)[e*4+1]/256}maxX(e){return(o(this,la)[e*4+2]+1)/256}maxY(e){return(o(this,la)[e*4+3]+1)/256}}G0=new WeakMap,la=new WeakMap;const a1=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var Es,_s,No,zi,Fo,nn,ze,$e,an,Ms,Qu,V0,Oo,zo,on,us,pr,Ju,Z4;class dA{constructor(e,t,s=!1){g(this,Ju);g(this,Es,{__proto__:null});g(this,_s,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Hl]:[]});g(this,No,new Map);g(this,zi,[]);g(this,Fo,[]);g(this,nn,[[1,0,0,1,0,0]]);g(this,ze,[-1/0,-1/0,1/0,1/0]);g(this,$e,new Float64Array([1/0,1/0,-1/0,-1/0]));g(this,an,-1);g(this,Ms,new Set);g(this,Qu,new Map);g(this,V0,new Map);g(this,Oo,void 0);g(this,zo,void 0);g(this,on,void 0);g(this,us,void 0);g(this,pr,void 0);b(this,Oo,e.width),b(this,zo,e.height),A(this,Ju,Z4).call(this,t),s&&b(this,pr,new Map)}growOperationsCount(e){e>=o(this,us).length&&A(this,Ju,Z4).call(this,e,o(this,us))}save(e){return b(this,Es,{__proto__:o(this,Es)}),b(this,_s,{__proto__:o(this,_s),transform:{__proto__:o(this,_s).transform},moveText:{__proto__:o(this,_s).moveText},sameLineText:{__proto__:o(this,_s).sameLineText},[Hl]:{__proto__:o(this,_s)[Hl]}}),b(this,ze,{__proto__:o(this,ze)}),o(this,zi).push(e),this}restore(e){var i;const t=Object.getPrototypeOf(o(this,Es));if(t===null)return this;b(this,Es,t),b(this,_s,Object.getPrototypeOf(o(this,_s))),b(this,ze,Object.getPrototypeOf(o(this,ze)));const s=o(this,zi).pop();return s!==void 0&&((i=a1(o(this,pr),e))==null||i.dependencies.add(s),o(this,us)[e]=o(this,us)[s]),this}recordOpenMarker(e){return o(this,zi).push(e),this}getOpenMarker(){return o(this,zi).length===0?null:o(this,zi).at(-1)}recordCloseMarker(e){var s;const t=o(this,zi).pop();return t!==void 0&&((s=a1(o(this,pr),e))==null||s.dependencies.add(t),o(this,us)[e]=o(this,us)[t]),this}beginMarkedContent(e){return o(this,Fo).push(e),this}endMarkedContent(e){var s;const t=o(this,Fo).pop();return t!==void 0&&((s=a1(o(this,pr),e))==null||s.dependencies.add(t),o(this,us)[e]=o(this,us)[t]),this}pushBaseTransform(e){return o(this,nn).push(ae.multiplyByDOMMatrix(o(this,nn).at(-1),e.getTransform())),this}popBaseTransform(){return o(this,nn).length>1&&o(this,nn).pop(),this}recordSimpleData(e,t){return o(this,Es)[e]=t,this}recordIncrementalData(e,t){return o(this,_s)[e].push(t),this}resetIncrementalData(e,t){return o(this,_s)[e].length=0,this}recordNamedData(e,t){return o(this,No).set(e,t),this}recordSimpleDataFromNamed(e,t,s){o(this,Es)[e]=o(this,No).get(t)??s}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Hl,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in o(this,Es)&&this.recordFutureForcedDependency(t,o(this,Es)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of o(this,Ms))this.recordFutureForcedDependency(Hl,e);return this}resetBBox(e){return o(this,an)!==e&&(b(this,an,e),o(this,$e)[0]=1/0,o(this,$e)[1]=1/0,o(this,$e)[2]=-1/0,o(this,$e)[3]=-1/0),this}recordClipBox(e,t,s,i,r,a){const l=ae.multiplyByDOMMatrix(o(this,nn).at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];ae.axialAlignedBoundingBox([s,r,i,a],l,h);const c=ae.intersect(o(this,ze),h);return c?(o(this,ze)[0]=c[0],o(this,ze)[1]=c[1],o(this,ze)[2]=c[2],o(this,ze)[3]=c[3]):(o(this,ze)[0]=o(this,ze)[1]=1/0,o(this,ze)[2]=o(this,ze)[3]=-1/0),this}recordBBox(e,t,s,i,r,a){const l=o(this,ze);if(l[0]===1/0)return this;const h=ae.multiplyByDOMMatrix(o(this,nn).at(-1),t.getTransform());if(l[0]===-1/0)return ae.axialAlignedBoundingBox([s,r,i,a],h,o(this,$e)),this;const c=[1/0,1/0,-1/0,-1/0];return ae.axialAlignedBoundingBox([s,r,i,a],h,c),o(this,$e)[0]=Math.min(o(this,$e)[0],Math.max(c[0],l[0])),o(this,$e)[1]=Math.min(o(this,$e)[1],Math.max(c[1],l[1])),o(this,$e)[2]=Math.max(o(this,$e)[2],Math.min(c[2],l[2])),o(this,$e)[3]=Math.max(o(this,$e)[3],Math.min(c[3],l[3])),this}recordCharacterBBox(e,t,s,i=1,r=0,a=0,l){const h=s.bbox;let c,u;if(h&&(c=h[2]!==h[0]&&h[3]!==h[1]&&o(this,V0).get(s),c!==!1&&(u=[0,0,0,0],ae.axialAlignedBoundingBox(h,s.fontMatrix,u),(i!==1||r!==0||a!==0)&&ae.scaleMinMax([i,0,0,-i,r,a],u),c)))return this.recordBBox(e,t,u[0],u[2],u[1],u[3]);if(!l)return this.recordFullPageBBox(e);const d=l();return h&&u&&c===void 0&&(c=u[0]<=r-d.actualBoundingBoxLeft&&u[2]>=r+d.actualBoundingBoxRight&&u[1]<=a-d.actualBoundingBoxAscent&&u[3]>=a+d.actualBoundingBoxDescent,o(this,V0).set(s,c),c)?this.recordBBox(e,t,u[0],u[2],u[1],u[3]):this.recordBBox(e,t,r-d.actualBoundingBoxLeft,r+d.actualBoundingBoxRight,a-d.actualBoundingBoxAscent,a+d.actualBoundingBoxDescent)}recordFullPageBBox(e){return o(this,$e)[0]=Math.max(0,o(this,ze)[0]),o(this,$e)[1]=Math.max(0,o(this,ze)[1]),o(this,$e)[2]=Math.min(o(this,Oo),o(this,ze)[2]),o(this,$e)[3]=Math.min(o(this,zo),o(this,ze)[3]),this}getSimpleIndex(e){return o(this,Es)[e]}recordDependencies(e,t){const s=o(this,Ms),i=o(this,Es),r=o(this,_s);for(const a of t)a in o(this,Es)?s.add(i[a]):a in r&&r[a].forEach(s.add,s);return this}recordNamedDependency(e,t){return o(this,No).has(t)&&o(this,Ms).add(o(this,No).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Hl]),o(this,pr)){const s=a1(o(this,pr),e),{dependencies:i}=s;o(this,Ms).forEach(i.add,i),o(this,zi).forEach(i.add,i),o(this,Fo).forEach(i.add,i),i.delete(e),s.isRenderingOperation=!0}if(o(this,an)===e){const s=u6(o(this,$e)[0]*256/o(this,Oo)),i=u6(o(this,$e)[1]*256/o(this,zo)),r=d6(o(this,$e)[2]*256/o(this,Oo)),a=d6(o(this,$e)[3]*256/o(this,zo));n1(o(this,on),e,s,i,r,a);for(const l of o(this,Ms))l!==e&&n1(o(this,on),l,s,i,r,a);for(const l of o(this,zi))l!==e&&n1(o(this,on),l,s,i,r,a);for(const l of o(this,Fo))l!==e&&n1(o(this,on),l,s,i,r,a);t||(o(this,Ms).clear(),b(this,an,-1))}return this}recordShowTextOperation(e,t=!1){const s=Array.from(o(this,Ms));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of s)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return o(this,an)===e&&(b(this,an,-1),o(this,ze)[0]=Math.max(o(this,ze)[0],o(this,$e)[0]),o(this,ze)[1]=Math.max(o(this,ze)[1],o(this,$e)[1]),o(this,ze)[2]=Math.min(o(this,ze)[2],o(this,$e)[2]),o(this,ze)[3]=Math.min(o(this,ze)[3],o(this,$e)[3]),t||o(this,Ms).clear()),this}_takePendingDependencies(){const e=o(this,Ms);return b(this,Ms,new Set),e}_extractOperation(e){const t=o(this,Qu).get(e);return o(this,Qu).delete(e),t}_pushPendingDependencies(e){for(const t of e)o(this,Ms).add(t)}take(){return o(this,V0).clear(),new uA(o(this,us),o(this,on))}takeDebugMetadata(){return o(this,pr)}}Es=new WeakMap,_s=new WeakMap,No=new WeakMap,zi=new WeakMap,Fo=new WeakMap,nn=new WeakMap,ze=new WeakMap,$e=new WeakMap,an=new WeakMap,Ms=new WeakMap,Qu=new WeakMap,V0=new WeakMap,Oo=new WeakMap,zo=new WeakMap,on=new WeakMap,us=new WeakMap,pr=new WeakMap,Ju=new WeakSet,Z4=function(e,t){const s=new ArrayBuffer(e*4);b(this,on,new Uint8ClampedArray(s)),b(this,us,new Uint32Array(s)),t&&t.length>0?(o(this,us).set(t),o(this,us).fill(K4,t.length)):o(this,us).fill(K4)};var We,wt,Hi,j0,W0;const z3=class z3{constructor(e,t,s){g(this,We,void 0);g(this,wt,void 0);g(this,Hi,void 0);g(this,j0,0);g(this,W0,0);if(e instanceof z3&&o(e,Hi)===!!s)return e;b(this,We,e),b(this,wt,t),b(this,Hi,!!s)}growOperationsCount(){throw new Error("Unreachable")}save(e){return Lt(this,W0)._++,o(this,We).save(o(this,wt)),this}restore(e){return o(this,W0)>0&&(o(this,We).restore(o(this,wt)),Lt(this,W0)._--),this}recordOpenMarker(e){return Lt(this,j0)._++,this}getOpenMarker(){return o(this,j0)>0?o(this,wt):o(this,We).getOpenMarker()}recordCloseMarker(e){return Lt(this,j0)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return o(this,We).pushBaseTransform(e),this}popBaseTransform(){return o(this,We).popBaseTransform(),this}recordSimpleData(e,t){return o(this,We).recordSimpleData(e,o(this,wt)),this}recordIncrementalData(e,t){return o(this,We).recordIncrementalData(e,o(this,wt)),this}resetIncrementalData(e,t){return o(this,We).resetIncrementalData(e,o(this,wt)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,s){return o(this,We).recordSimpleDataFromNamed(e,t,o(this,wt)),this}recordFutureForcedDependency(e,t){return o(this,We).recordFutureForcedDependency(e,o(this,wt)),this}inheritSimpleDataAsFutureForcedDependencies(e){return o(this,We).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return o(this,We).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return o(this,Hi)||o(this,We).resetBBox(o(this,wt)),this}recordClipBox(e,t,s,i,r,a){return o(this,Hi)||o(this,We).recordClipBox(o(this,wt),t,s,i,r,a),this}recordBBox(e,t,s,i,r,a){return o(this,Hi)||o(this,We).recordBBox(o(this,wt),t,s,i,r,a),this}recordCharacterBBox(e,t,s,i,r,a,l){return o(this,Hi)||o(this,We).recordCharacterBBox(o(this,wt),t,s,i,r,a,l),this}recordFullPageBBox(e){return o(this,Hi)||o(this,We).recordFullPageBBox(o(this,wt)),this}getSimpleIndex(e){return o(this,We).getSimpleIndex(e)}recordDependencies(e,t){return o(this,We).recordDependencies(o(this,wt),t),this}recordNamedDependency(e,t){return o(this,We).recordNamedDependency(o(this,wt),t),this}recordOperation(e){return o(this,We).recordOperation(o(this,wt),!0),this}recordShowTextOperation(e){return o(this,We).recordShowTextOperation(o(this,wt),!0),this}bboxToClipBoxDropOperation(e){return o(this,Hi)||o(this,We).bboxToClipBoxDropOperation(o(this,wt),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};We=new WeakMap,wt=new WeakMap,Hi=new WeakMap,j0=new WeakMap,W0=new WeakMap;let dp=z3;const fi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},is={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Q4(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class P3{isModifyingCurrentTransform(){return!1}getPattern(){Xe("Abstract method `getPattern` called.")}}class fA extends P3{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===is.STROKE||i===is.FILL){const a=t.current.getClippedPathBoundingBox(i,pt(e))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,h=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",l,h),u=c.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-a[0],-a[1]),s=ae.transform(s,[1,0,0,1,a[0],a[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),Q4(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),r=e.createPattern(c.canvas,"no-repeat");const d=new DOMMatrix(s);r.setTransform(d)}else Q4(e,this._bbox),r=this._createGradient(e);return r}}function t4(n,e,t,s,i,r,a,l){const h=e.coords,c=e.colors,u=n.data,d=n.width*4;let f;h[t+1]>h[s+1]&&(f=t,t=s,s=f,f=r,r=a,a=f),h[s+1]>h[i+1]&&(f=s,s=i,i=f,f=a,a=l,l=f),h[t+1]>h[s+1]&&(f=t,t=s,s=f,f=r,r=a,a=f);const p=(h[t]+e.offsetX)*e.scaleX,w=(h[t+1]+e.offsetY)*e.scaleY,y=(h[s]+e.offsetX)*e.scaleX,x=(h[s+1]+e.offsetY)*e.scaleY,S=(h[i]+e.offsetX)*e.scaleX,E=(h[i+1]+e.offsetY)*e.scaleY;if(w>=E)return;const T=c[r],_=c[r+1],M=c[r+2],D=c[a],L=c[a+1],F=c[a+2],N=c[l],W=c[l+1],$=c[l+2],q=Math.round(w),se=Math.round(E);let z,ee,Y,Z,V,we,Fe,st;for(let ue=q;ue<=se;ue++){if(ue<x){const _e=ue<w?0:(w-ue)/(w-x);z=p-(p-y)*_e,ee=T-(T-D)*_e,Y=_-(_-L)*_e,Z=M-(M-F)*_e}else{let _e;ue>E?_e=1:x===E?_e=0:_e=(x-ue)/(x-E),z=y-(y-S)*_e,ee=D-(D-N)*_e,Y=L-(L-W)*_e,Z=F-(F-$)*_e}let Ae;ue<w?Ae=0:ue>E?Ae=1:Ae=(w-ue)/(w-E),V=p-(p-S)*Ae,we=T-(T-N)*Ae,Fe=_-(_-W)*Ae,st=M-(M-$)*Ae;const Be=Math.round(Math.min(z,V)),Ee=Math.round(Math.max(z,V));let Yt=d*ue+Be*4;for(let _e=Be;_e<=Ee;_e++)Ae=(z-_e)/(z-V),Ae<0?Ae=0:Ae>1&&(Ae=1),u[Yt++]=ee-(ee-we)*Ae|0,u[Yt++]=Y-(Y-Fe)*Ae|0,u[Yt++]=Z-(Z-st)*Ae|0,u[Yt++]=255}}function pA(n,e,t){const s=e.coords,i=e.colors;let r,a;switch(e.type){case S4.LATTICE:const l=e.verticesPerRow,h=Math.floor(s.length/l)-1,c=l-1;for(r=0;r<h;r++){let u=r*l;for(let d=0;d<c;d++,u++)t4(n,t,s[u],s[u+1],s[u+l],i[u],i[u+1],i[u+l]),t4(n,t,s[u+l+1],s[u+1],s[u+l],i[u+l+1],i[u+1],i[u+l])}break;case S4.TRIANGLES:for(r=0,a=s.length;r<a;r+=3)t4(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class mA extends P3{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const l=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-l,u=Math.ceil(this._bounds[3])-h,d=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(u*e[1]*1.1)),3e3),p=c/d,w=u/f,y={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-h,scaleX:1/p,scaleY:1/w},x=d+2*2,S=f+2*2,E=s.getCanvas("mesh",x,S),T=E.context,_=T.createImageData(d,f);if(t){const D=_.data;for(let L=0,F=D.length;L<F;L+=4)D[L]=t[0],D[L+1]=t[1],D[L+2]=t[2],D[L+3]=255}for(const D of this._figures)pA(_,D,y);return T.putImageData(_,2,2),{canvas:E.canvas,offsetX:l-2*p,offsetY:h-2*w,scaleX:p,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,i){Q4(e,this._bbox);const r=new Float32Array(2);if(i===is.SHADING)ae.singularValueDecompose2dScale(pt(e),r);else if(this.matrix){ae.singularValueDecompose2dScale(this.matrix,r);const[l,h]=r;ae.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=l,r[1]*=h}else ae.singularValueDecompose2dScale(t.baseTransform,r);const a=this._createMeshCanvas(r,i===is.SHADING?null:this._background,t.cachedCanvases);return i!==is.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class gA extends P3{getPattern(){return"hotpink"}}function bA(n){switch(n[0]){case"RadialAxial":return new fA(n);case"Mesh":return new mA(n);case"Dummy":return new gA}throw new Error(`Unknown IR type: ${n[0]}`)}const f6={COLORED:1,UNCOLORED:2},nm=class nm{constructor(e,t,s,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e,t){var we,Fe;const{bbox:s,operatorList:i,paintType:r,tilingType:a,color:l,canvasGraphicsFactory:h}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),Tg("TilingType: "+a);const d=s[0],f=s[1],p=s[2],w=s[3],y=p-d,x=w-f,S=new Float32Array(2);ae.singularValueDecompose2dScale(this.matrix,S);const[E,T]=S;ae.singularValueDecompose2dScale(this.baseTransform,S);const _=E*S[0],M=T*S[1];let D=y,L=x,F=!1,N=!1;const W=Math.ceil(c*_),$=Math.ceil(u*M),q=Math.ceil(y*_),se=Math.ceil(x*M);W>=q?D=c:F=!0,$>=se?L=u:N=!0;const z=this.getSizeAndScale(D,this.ctx.canvas.width,_),ee=this.getSizeAndScale(L,this.ctx.canvas.height,M),Y=e.cachedCanvases.getCanvas("pattern",z.size,ee.size),Z=Y.context,V=h.createCanvasGraphics(Z,t);if(V.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(V,r,l),Z.translate(-z.scale*d,-ee.scale*f),V.transform(0,z.scale,0,0,ee.scale,0,0),Z.save(),(we=V.dependencyTracker)==null||we.save(),this.clipBbox(V,d,f,p,w),V.baseTransform=pt(V.ctx),V.executeOperatorList(i),V.endDrawing(),(Fe=V.dependencyTracker)==null||Fe.restore(),Z.restore(),F||N){const st=Y.canvas;F&&(D=c),N&&(L=u);const ue=this.getSizeAndScale(D,this.ctx.canvas.width,_),Ae=this.getSizeAndScale(L,this.ctx.canvas.height,M),Be=ue.size,Ee=Ae.size,Yt=e.cachedCanvases.getCanvas("pattern-workaround",Be,Ee),_e=Yt.context,ht=F?Math.floor(y/c):0,it=N?Math.floor(x/u):0;for(let Ve=0;Ve<=ht;Ve++)for(let Ke=0;Ke<=it;Ke++)_e.drawImage(st,Be*Ve,Ee*Ke,Be,Ee,0,0,Be,Ee);return{canvas:Yt.canvas,scaleX:ue.scale,scaleY:Ae.scale,offsetX:d,offsetY:f}}return{canvas:Y.canvas,scaleX:z.scale,scaleY:ee.scale,offsetX:d,offsetY:f}}getSizeAndScale(e,t,s){const i=Math.max(nm.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const a=i-t,l=r-s;e.ctx.rect(t,s,a,l),ae.axialAlignedBoundingBox([t,s,i,r],pt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case f6.COLORED:const{fillStyle:a,strokeStyle:l}=this.ctx;i.fillStyle=r.fillColor=a,i.strokeStyle=r.strokeColor=l;break;case f6.UNCOLORED:i.fillStyle=i.strokeStyle=s,r.fillColor=r.strokeColor=s;break;default:throw new D9(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,i,r){let a=s;i!==is.SHADING&&(a=ae.transform(a,t.baseTransform),this.matrix&&(a=ae.transform(a,this.matrix)));const l=this.createPatternCanvas(t,r);let h=new DOMMatrix(a);h=h.translate(l.offsetX,l.offsetY),h=h.scale(1/l.scaleX,1/l.scaleY);const c=e.createPattern(l.canvas,"repeat");return c.setTransform(h),c}};O(nm,"MAX_PATTERN_SIZE",3e3);let J4=nm;function vA({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const l=rs.isLittleEndian?4278190080:255,[h,c]=a?[r,l]:[l,r],u=s>>3,d=s&7,f=n.length;t=new Uint32Array(t.buffer);let p=0;for(let w=0;w<i;w++){for(const x=e+u;e<x;e++){const S=e<f?n[e]:255;t[p++]=S&128?c:h,t[p++]=S&64?c:h,t[p++]=S&32?c:h,t[p++]=S&16?c:h,t[p++]=S&8?c:h,t[p++]=S&4?c:h,t[p++]=S&2?c:h,t[p++]=S&1?c:h}if(d===0)continue;const y=e<f?n[e++]:255;for(let x=0;x<d;x++)t[p++]=y&1<<7-x?c:h}return{srcPos:e,destPos:p}}const p6=16,m6=100,yA=15,g6=10,Is=16,s4=new DOMMatrix,oi=new Float32Array(2),Zl=new Float32Array([1/0,1/0,-1/0,-1/0]);function wA(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,i,r,a,l){e.transform(t,s,i,r,a,l),this.__originalTransform(t,s,i,r,a,l)},n.setTransform=function(t,s,i,r,a,l){e.setTransform(t,s,i,r,a,l),this.__originalSetTransform(t,s,i,r,a,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,a,l){e.bezierCurveTo(t,s,i,r,a,l),this.__originalBezierCurveTo(t,s,i,r,a,l)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class AA{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function o1(n,e,t,s,i,r,a,l,h,c){const[u,d,f,p,w,y]=pt(n);if(d===0&&f===0){const E=a*u+w,T=Math.round(E),_=l*p+y,M=Math.round(_),D=(a+h)*u+w,L=Math.abs(Math.round(D)-T)||1,F=(l+c)*p+y,N=Math.abs(Math.round(F)-M)||1;return n.setTransform(Math.sign(u),0,0,Math.sign(p),T,M),n.drawImage(e,t,s,i,r,0,0,L,N),n.setTransform(u,d,f,p,w,y),[L,N]}if(u===0&&p===0){const E=l*f+w,T=Math.round(E),_=a*d+y,M=Math.round(_),D=(l+c)*f+w,L=Math.abs(Math.round(D)-T)||1,F=(a+h)*d+y,N=Math.abs(Math.round(F)-M)||1;return n.setTransform(0,Math.sign(d),Math.sign(f),0,T,M),n.drawImage(e,t,s,i,r,0,0,N,L),n.setTransform(u,d,f,p,w,y),[N,L]}n.drawImage(e,t,s,i,r,a,l,h,c);const x=Math.hypot(u,d),S=Math.hypot(f,p);return[x*h,S*c]}class b6{constructor(e,t,s){O(this,"alphaIsShape",!1);O(this,"fontSize",0);O(this,"fontSizeScale",1);O(this,"textMatrix",null);O(this,"textMatrixScale",1);O(this,"fontMatrix",x4);O(this,"leading",0);O(this,"x",0);O(this,"y",0);O(this,"lineX",0);O(this,"lineY",0);O(this,"charSpacing",0);O(this,"wordSpacing",0);O(this,"textHScale",1);O(this,"textRenderingMode",Kt.FILL);O(this,"textRise",0);O(this,"fillColor","#000000");O(this,"strokeColor","#000000");O(this,"patternFill",!1);O(this,"patternStroke",!1);O(this,"fillAlpha",1);O(this,"strokeAlpha",1);O(this,"lineWidth",1);O(this,"activeSMask",null);O(this,"transferMaps","none");s==null||s(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Zl.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=is.FILL,t=null){const s=this.minMax.slice();if(e===is.STROKE){t||Xe("Stroke bounding box must include transform."),ae.singularValueDecompose2dScale(t,oi);const i=oi[0]*this.lineWidth/2,r=oi[1]*this.lineWidth/2;s[0]-=i,s[1]-=r,s[2]+=i,s[3]+=r}return s}updateClipFromPath(){const e=ae.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Zl,0)}getClippedPathBoundingBox(e=is.FILL,t=null){return ae.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function v6(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%Is,r=(t-i)/Is,a=i===0?r:r+1,l=n.createImageData(s,Is);let h=0,c;const u=e.data,d=l.data;let f,p,w,y;if(e.kind===b1.GRAYSCALE_1BPP){const x=u.byteLength,S=new Uint32Array(d.buffer,0,d.byteLength>>2),E=S.length,T=s+7>>3,_=4294967295,M=rs.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(w=f<r?Is:i,c=0,p=0;p<w;p++){const D=x-h;let L=0;const F=D>T?s:D*8-7,N=F&-8;let W=0,$=0;for(;L<N;L+=8)$=u[h++],S[c++]=$&128?_:M,S[c++]=$&64?_:M,S[c++]=$&32?_:M,S[c++]=$&16?_:M,S[c++]=$&8?_:M,S[c++]=$&4?_:M,S[c++]=$&2?_:M,S[c++]=$&1?_:M;for(;L<F;L++)W===0&&($=u[h++],W=128),S[c++]=$&W?_:M,W>>=1}for(;c<E;)S[c++]=0;n.putImageData(l,0,f*Is)}}else if(e.kind===b1.RGBA_32BPP){for(p=0,y=s*Is*4,f=0;f<r;f++)d.set(u.subarray(h,h+y)),h+=y,n.putImageData(l,0,p),p+=Is;f<a&&(y=s*i*4,d.set(u.subarray(h,h+y)),n.putImageData(l,0,p))}else if(e.kind===b1.RGB_24BPP)for(w=Is,y=s*w,f=0;f<a;f++){for(f>=r&&(w=i,y=s*w),c=0,p=y;p--;)d[c++]=u[h++],d[c++]=u[h++],d[c++]=u[h++],d[c++]=255;n.putImageData(l,0,f*Is)}else throw new Error(`bad image kind: ${e.kind}`)}function y6(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%Is,r=(t-i)/Is,a=i===0?r:r+1,l=n.createImageData(s,Is);let h=0;const c=e.data,u=l.data;for(let d=0;d<a;d++){const f=d<r?Is:i;({srcPos:h}=vA({src:c,srcPos:h,dest:u,width:s,height:f,nonBlackColor:0})),n.putImageData(l,0,d*Is)}}function fc(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function l1(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function w6(n,e){if(e)return!0;ae.singularValueDecompose2dScale(n,oi);const t=Math.fround(Dr.pixelRatio*qa.PDF_TO_CSS_UNITS);return oi[0]<=t&&oi[1]<=t}const xA=["butt","round","square"],SA=["miter","round","bevel"],kA={},A6={};var ed,e2,td,t2,sd,s2;const H3=class H3{constructor(e,t,s,i,r,{optionalContentConfig:a,markedContentStack:l=null},h,c,u){g(this,ed);g(this,td);g(this,sd);this.ctx=e,this.current=new b6(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=a,this.cachedCanvases=new AA(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=u??null}getObject(e,t,s=null){var i;return typeof t=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):s}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=l,s){const h=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...pt(this.compositeCtx))}this.ctx.save(),l1(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=pt(this.ctx)}executeOperatorList(e,t,s,i,r){var S;const a=e.argsArray,l=e.fnArray;let h=t||0;const c=a.length;if(c===h)return h;const u=c-h>g6&&typeof s=="function",d=u?Date.now()+yA:0;let f=0;const p=this.commonObjs,w=this.objs;let y,x;for(;;){if(i!==void 0&&h===i.nextBreakPoint)return i.breakIt(h,s),h;if(!r||r(h))if(y=l[h],x=a[h]??null,y!==Xc.dependency)x===null?this[y](h):this[y](h,...x);else for(const E of x){(S=this.dependencyTracker)==null||S.recordNamedData(E,h);const T=E.startsWith("g_")?p:w;if(!T.has(E))return T.get(E,s),h}if(h++,h===c)return h;if(u&&++f>g6){if(Date.now()>d)return s(),h;f=0}}}endDrawing(){A(this,ed,e2).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),A(this,td,t2).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),l=s,h=i,c="prescale1",u,d;for(;r>2&&l>1||a>2&&h>1;){let f=l,p=h;r>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),r/=l/f),a>2&&h>1&&(p=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,a/=h/p),u=this.cachedCanvases.getCanvas(c,f,p),d=u.context,d.clearRect(0,0,f,p),d.drawImage(e,0,0,l,h,0,0,f,p),e=u.canvas,l=f,h=p,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:h}}_createMaskCanvas(e,t){var W,$;const s=this.ctx,{width:i,height:r}=t,a=this.current.fillColor,l=this.current.patternFill,h=pt(s);let c,u,d,f;if((t.bitmap||t.data)&&t.count>1){const q=t.bitmap||t.data.buffer;u=JSON.stringify(l?h:[h.slice(0,4),a]),c=this._cachedBitmapsMap.get(q),c||(c=new Map,this._cachedBitmapsMap.set(q,c));const se=c.get(u);if(se&&!l){const z=Math.round(Math.min(h[0],h[2])+h[4]),ee=Math.round(Math.min(h[1],h[3])+h[5]);return(W=this.dependencyTracker)==null||W.recordDependencies(e,fi.transformAndFill),{canvas:se,offsetX:z,offsetY:ee}}d=se}d||(f=this.cachedCanvases.getCanvas("maskCanvas",i,r),y6(f.context,t));let p=ae.transform(h,[1/i,0,0,-1/r,0,0]);p=ae.transform(p,[1,0,0,1,0,-r]);const w=Zl.slice();ae.axialAlignedBoundingBox([0,0,i,r],p,w);const[y,x,S,E]=w,T=Math.round(S-y)||1,_=Math.round(E-x)||1,M=this.cachedCanvases.getCanvas("fillCanvas",T,_),D=M.context,L=y,F=x;D.translate(-L,-F),D.transform(...p),d||(d=this._scaleImage(f.canvas,er(D)),d=d.img,c&&l&&c.set(u,d)),D.imageSmoothingEnabled=w6(pt(D),t.interpolate),o1(D,d,0,0,d.width,d.height,0,0,i,r),D.globalCompositeOperation="source-in";const N=ae.transform(er(D),[1,0,0,1,-L,-F]);return D.fillStyle=l?a.getPattern(s,this,N,is.FILL,e):a,D.fillRect(0,0,i,r),c&&!l&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,M.canvas)),($=this.dependencyTracker)==null||$.recordDependencies(e,fi.transformAndFill),{canvas:M.canvas,offsetX:Math.round(L),offsetY:Math.round(F)}}setLineWidth(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineCap",e),this.ctx.lineCap=xA[t]}setLineJoin(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineJoin",e),this.ctx.lineJoin=SA[t]}setMiterLimit(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,s){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=s)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var s,i,r,a,l;for(const[h,c]of t)switch(h){case"LW":this.setLineWidth(e,c);break;case"LC":this.setLineCap(e,c);break;case"LJ":this.setLineJoin(e,c);break;case"ML":this.setMiterLimit(e,c);break;case"D":this.setDash(e,c[0],c[1]);break;case"RI":this.setRenderingIntent(e,c);break;case"FL":this.setFlatness(e,c);break;case"Font":this.setFont(e,c[0],c[1]);break;case"CA":(s=this.dependencyTracker)==null||s.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=c;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=c;break;case"BM":(r=this.dependencyTracker)==null||r.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=c;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",e),this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(l=this.dependencyTracker)==null||l.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,t,s);this.suspendedCtx=this.ctx;const a=this.ctx=r.context;a.setTransform(this.suspendedCtx.getTransform()),fc(this.suspendedCtx,a),wA(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),fc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],a=i[1],l=i[2]-r,h=i[3]-a;l===0||h===0||(this.genericComposeSMask(t.context,s,l,h,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,a,l,h,c,u,d){let f=e.canvas,p=h-u,w=c-d;if(a)if(p<0||w<0||p+s>f.width||w+i>f.height){const x=this.cachedCanvases.getCanvas("maskExtension",s,i),S=x.context;S.drawImage(f,-p,-w),S.globalCompositeOperation="destination-atop",S.fillStyle=a,S.fillRect(0,0,s,i),S.globalCompositeOperation="source-over",f=x.canvas,p=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(p,w,s,i),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(p,w,s,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&l?t.filter=this.filterFactory.addAlphaFilter(l):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(l));const y=new Path2D;y.rect(h,c,s,i),t.clip(y),t.globalCompositeOperation="destination-in",t.drawImage(f,p,w,s,i,h,c,s,i),t.restore()}save(e){var s;this.inSMaskMode&&fc(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(s=this.dependencyTracker)==null||s.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&fc(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,i,r,a,l){var h;(h=this.dependencyTracker)==null||h.recordIncrementalData("transform",e),this.ctx.transform(t,s,i,r,a,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s,i){let[r]=s;if(!i){r||(r=s[0]=new Path2D),this[t](e,r);return}if(this.dependencyTracker!==null){const a=t===Xc.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-a,i[2]+a,i[1]-a,i[3]+a).recordDependencies(e,["transform"])}r instanceof Path2D||(r=s[0]=o7(r)),ae.axialAlignedBoundingBox(i,pt(this.ctx),this.current.minMax),this[t](e,r),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,s=!0){var a;const i=this.ctx,r=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const l=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=r.getPattern(i,this,er(i),is.STROKE,e),l){const h=new Path2D;h.addPath(t,i.getTransform().invertSelf().multiplySelf(l)),t=h}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);(a=this.dependencyTracker)==null||a.recordDependencies(e,fi.stroke),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(is.STROKE,pt(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,s=!0){var c,u,d;const i=this.ctx,r=this.current.fillColor,a=this.current.patternFill;let l=!1;if(a){const f=r.isModifyingCurrentTransform()?i.getTransform():null;if((c=this.dependencyTracker)==null||c.save(e),i.save(),i.fillStyle=r.getPattern(i,this,er(i),is.FILL,e),f){const p=new Path2D;p.addPath(t,i.getTransform().invertSelf().multiplySelf(f)),t=p}l=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),(u=this.dependencyTracker)==null||u.recordDependencies(e,fi.fill),l&&(i.restore(),(d=this.dependencyTracker)==null||d.restore(e)),s&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var s;this.ctx.fill(t),(s=this.dependencyTracker)==null||s.recordDependencies(e,fi.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=kA}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=A6}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,r=s.getTransform().invertSelf();for(const{transform:a,x:l,y:h,fontSize:c,path:u}of t)u&&i.addPath(u,new DOMMatrix(a).preMultiplySelf(r).translate(l,h).scale(c,-c));s.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,s){var d,f;(d=this.dependencyTracker)==null||d.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),r=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=i.fontMatrix||x4,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&pe("Invalid font matrix for font "+t),s<0?(s=-s,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=s,i.isType3Font)return;const a=i.loadedName||"sans-serif",l=((f=i.systemFontInfo)==null?void 0:f.css)||`"${a}", ${i.fallbackName}`;let h="normal";i.black?h="900":i.bold&&(h="bold");const c=i.italic?"italic":"normal";let u=s;s<p6?u=p6:s>m6&&(u=m6),this.current.fontSizeScale=s/u,this.ctx.font=`${c} ${h} ${u}px ${l}`}setTextRenderingMode(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,s){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,t,s){this.setLeading(e,-s),this.moveText(e,t,s)}setTextMatrix(e,t){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,s,i,r,a){var S,E,T,_;const l=this.ctx,h=this.current,c=h.font,u=h.textRenderingMode,d=h.fontSize/h.fontSizeScale,f=u&Kt.FILL_STROKE_MASK,p=!!(u&Kt.ADD_TO_PATH_FLAG),w=h.patternFill&&!c.missingFile,y=h.patternStroke&&!c.missingFile;let x;if((c.disableFontFace||p||w||y)&&!c.missingFile&&(x=c.getPathGenerator(this.commonObjs,t)),x&&(c.disableFontFace||w||y)){l.save(),l.translate(s,i),l.scale(d,-d),(S=this.dependencyTracker)==null||S.recordCharacterBBox(e,l,c);let M;if(f===Kt.FILL||f===Kt.FILL_STROKE)if(r){M=l.getTransform(),l.setTransform(...r);const D=A(this,sd,s2).call(this,x,M,r);l.fill(D)}else l.fill(x);if(f===Kt.STROKE||f===Kt.FILL_STROKE)if(a){M||(M=l.getTransform()),l.setTransform(...a);const{a:D,b:L,c:F,d:N}=M,W=ae.inverseTransform(a),$=ae.transform([D,L,F,N,0,0],W);ae.singularValueDecompose2dScale($,oi),l.lineWidth*=Math.max(oi[0],oi[1])/d,l.stroke(A(this,sd,s2).call(this,x,M,a))}else l.lineWidth/=d,l.stroke(x);l.restore()}else(f===Kt.FILL||f===Kt.FILL_STROKE)&&(l.fillText(t,s,i),(E=this.dependencyTracker)==null||E.recordCharacterBBox(e,l,c,d,s,i,()=>l.measureText(t))),(f===Kt.STROKE||f===Kt.FILL_STROKE)&&(this.dependencyTracker&&((T=this.dependencyTracker)==null||T.recordCharacterBBox(e,l,c,d,s,i,()=>l.measureText(t)).recordDependencies(e,fi.stroke)),l.strokeText(t,s,i));p&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:pt(l),x:s,y:i,fontSize:d,path:x}),(_=this.dependencyTracker)==null||_.recordCharacterBBox(e,l,c,d,s,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return me(this,"isFontSubpixelAAEnabled",s)}showText(e,t){var F,N,W,$;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,fi.showText).resetBBox(e),this.current.textRenderingMode&Kt.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,i=s.font;if(i.isType3Font){this.showType3Text(e,t),(F=this.dependencyTracker)==null||F.recordShowTextOperation(e);return}const r=s.fontSize;if(r===0){(N=this.dependencyTracker)==null||N.recordOperation(e);return}const a=this.ctx,l=s.fontSizeScale,h=s.charSpacing,c=s.wordSpacing,u=s.fontDirection,d=s.textHScale*u,f=t.length,p=i.vertical,w=p?1:-1,y=i.defaultVMetrics,x=r*s.fontMatrix[0],S=s.textRenderingMode===Kt.FILL&&!i.disableFontFace&&!s.patternFill;a.save(),s.textMatrix&&a.transform(...s.textMatrix),a.translate(s.x,s.y+s.textRise),u>0?a.scale(d,-1):a.scale(d,1);let E,T;if(s.patternFill){a.save();const q=s.fillColor.getPattern(a,this,er(a),is.FILL,e);E=pt(a),a.restore(),a.fillStyle=q}if(s.patternStroke){a.save();const q=s.strokeColor.getPattern(a,this,er(a),is.STROKE,e);T=pt(a),a.restore(),a.strokeStyle=q}let _=s.lineWidth;const M=s.textMatrixScale;if(M===0||_===0){const q=s.textRenderingMode&Kt.FILL_STROKE_MASK;(q===Kt.STROKE||q===Kt.FILL_STROKE)&&(_=this.getSinglePixelWidth())}else _/=M;if(l!==1&&(a.scale(l,l),_/=l),a.lineWidth=_,i.isInvalidPDFjsFont){const q=[];let se=0;for(const ee of t)q.push(ee.unicode),se+=ee.width;const z=q.join("");if(a.fillText(z,0,0),this.dependencyTracker!==null){const ee=a.measureText(z);this.dependencyTracker.recordBBox(e,this.ctx,-ee.actualBoundingBoxLeft,ee.actualBoundingBoxRight,-ee.actualBoundingBoxAscent,ee.actualBoundingBoxDescent).recordShowTextOperation(e)}s.x+=se*x*d,a.restore(),this.compose();return}let D=0,L;for(L=0;L<f;++L){const q=t[L];if(typeof q=="number"){D+=w*q*r/1e3;continue}let se=!1;const z=(q.isSpace?c:0)+h,ee=q.fontChar,Y=q.accent;let Z,V,we=q.width;if(p){const ue=q.vmetric||y,Ae=-(q.vmetric?ue[1]:we*.5)*x,Be=ue[2]*x;we=ue?-ue[0]:we,Z=Ae/l,V=(D+Be)/l}else Z=D/l,V=0;let Fe;if(i.remeasure&&we>0){Fe=a.measureText(ee);const ue=Fe.width*1e3/r*l;if(we<ue&&this.isFontSubpixelAAEnabled){const Ae=we/ue;se=!0,a.save(),a.scale(Ae,1),Z/=Ae}else we!==ue&&(Z+=(we-ue)/2e3*r/l)}if(this.contentVisible&&(q.isInFont||i.missingFile)){if(S&&!Y)a.fillText(ee,Z,V),(W=this.dependencyTracker)==null||W.recordCharacterBBox(e,a,Fe?{bbox:null}:i,r/l,Z,V,()=>Fe??a.measureText(ee));else if(this.paintChar(e,ee,Z,V,E,T),Y){const ue=Z+r*Y.offset.x/l,Ae=V-r*Y.offset.y/l;this.paintChar(e,Y.fontChar,ue,Ae,E,T)}}const st=p?we*x-z*u:we*x+z*u;D+=st,se&&a.restore()}p?s.y-=D:s.x+=D*d,a.restore(),this.compose(),($=this.dependencyTracker)==null||$.recordShowTextOperation(e)}showType3Text(e,t){const s=this.ctx,i=this.current,r=i.font,a=i.fontSize,l=i.fontDirection,h=r.vertical?1:-1,c=i.charSpacing,u=i.wordSpacing,d=i.textHScale*l,f=i.fontMatrix||x4,p=t.length,w=i.textRenderingMode===Kt.INVISIBLE;let y,x,S,E;if(w||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),i.textMatrix&&s.transform(...i.textMatrix),s.translate(i.x,i.y+i.textRise),s.scale(d,l);const T=this.dependencyTracker;for(this.dependencyTracker=T?new dp(T,e):null,y=0;y<p;++y){if(x=t[y],typeof x=="number"){E=h*x*a/1e3,this.ctx.translate(E,0),i.x+=E*d;continue}const _=(x.isSpace?u:0)+c,M=r.charProcOperatorList[x.operatorListId];M?this.contentVisible&&(this.save(),s.scale(a,a),s.transform(...f),this.executeOperatorList(M),this.restore()):pe(`Type3 character "${x.operatorListId}" is not available.`);const D=[x.width,0];ae.applyTransform(D,f),S=D[0]*a+_,s.translate(S,0),i.x+=S*d}s.restore(),T&&(this.dependencyTracker=T)}setCharWidth(e,t,s){}setCharWidthAndBounds(e,t,s,i,r,a,l){var c;const h=new Path2D;h.rect(i,r,a-i,l-r),this.ctx.clip(h),(c=this.dependencyTracker)==null||c.recordBBox(e,this.ctx,i,a,r,l).recordClipBox(e,this.ctx,i,a,r,l),this.endPath(e)}getColorN_Pattern(e,t){let s;if(t[0]==="TilingPattern"){const i=this.baseTransform||pt(this.ctx),r={createCanvasGraphics:(a,l)=>new H3(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new dp(this.dependencyTracker,l,!0):null)};s=new J4(t,this.ctx,r,i)}else s=this._getPattern(e,t[1],t[2]);return s}setStrokeColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,s=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=bA(this.getObject(e,t)),this.cachedPatterns.set(t,i)),s&&(i.matrix=s),i}shadingFill(e,t){var a;if(!this.contentVisible)return;const s=this.ctx;this.save(e);const i=this._getPattern(e,t);s.fillStyle=i.getPattern(s,this,er(s),is.SHADING,e);const r=er(s);if(r){const{width:l,height:h}=s.canvas,c=Zl.slice();ae.axialAlignedBoundingBox([0,0,l,h],r,c);const[u,d,f,p]=c;this.ctx.fillRect(u,d,f-u,p-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,fi.transform).recordDependencies(e,fi.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Xe("Should not call beginInlineImage")}beginImageData(){Xe("Should not call beginImageData")}paintFormXObjectBegin(e,t,s){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=pt(this.ctx),s)){ae.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,a,l,h]=s,c=new Path2D;c.rect(r,a,l-r,h-a),this.ctx.clip(c),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,r,l,a,h),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var T;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||Tg("TODO: Support non-isolated groups."),t.knockout&&pe("Knockout groups not supported.");const i=pt(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=Zl.slice();ae.axialAlignedBoundingBox(t.bbox,pt(s),r);const a=[0,0,s.canvas.width,s.canvas.height];r=ae.intersect(r,a)||[0,0,0,0];const l=Math.floor(r[0]),h=Math.floor(r[1]),c=Math.max(Math.ceil(r[2])-l,1),u=Math.max(Math.ceil(r[3])-h,1);this.current.startNewPathAndClipBox([0,0,c,u]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(d,c,u),p=f.context;p.translate(-l,-h),p.transform(...i);let w=new Path2D;const[y,x,S,E]=t.bbox;if(w.rect(y,x,S-y,E-x),t.matrix){const _=new Path2D;_.addPath(w,new DOMMatrix(t.matrix)),w=_}p.clip(w),t.smask&&this.smaskStack.push({canvas:f.canvas,context:p,offsetX:l,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(l,h),s.save()),fc(s,p),this.ctx=p,(T=this.dependencyTracker)==null||T.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){var r;if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(r=this.dependencyTracker)==null||r.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=pt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const l=Zl.slice();ae.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],a,l),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(e,t,s,i,r,a){if(A(this,ed,e2).call(this),l1(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const l=s[2]-s[0],h=s[3]-s[1];if(a&&this.annotationCanvasMap){i=i.slice(),i[4]-=s[0],i[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=l,s[3]=h,ae.singularValueDecompose2dScale(pt(this.ctx),oi);const{viewportScale:c}=this,u=Math.ceil(l*this.outputScaleX*c),d=Math.ceil(h*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(u,d);const{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(t,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(oi[0],0,0,-oi[1],0,h*oi[1]),l1(this.ctx)}else{l1(this.ctx),this.endPath(e);const c=new Path2D;c.rect(s[0],s[1],l,h),this.ctx.clip(c)}}this.current=new b6(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...r)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),A(this,td,t2).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var l;if(!this.contentVisible)return;const s=t.count;t=this.getObject(e,t.data,t),t.count=s;const i=this.ctx,r=this._createMaskCanvas(e,t),a=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,r.offsetX,r.offsetY),(l=this.dependencyTracker)==null||l.resetBBox(e).recordBBox(e,this.ctx,r.offsetX,r.offsetX+a.width,r.offsetY,r.offsetY+a.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s,i=0,r=0,a,l){var d,f,p;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const c=pt(h);h.transform(s,i,r,a,0,0);const u=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]),(d=this.dependencyTracker)==null||d.resetBBox(e);for(let w=0,y=l.length;w<y;w+=2){const x=ae.transform(c,[s,i,r,a,l[w],l[w+1]]);h.drawImage(u.canvas,x[4],x[5]),(f=this.dependencyTracker)==null||f.recordBBox(e,this.ctx,x[4],x[4]+u.canvas.width,x[5],x[5]+u.canvas.height)}h.restore(),this.compose(),(p=this.dependencyTracker)==null||p.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var a,l,h;if(!this.contentVisible)return;const s=this.ctx,i=this.current.fillColor,r=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(e).recordDependencies(e,fi.transformAndFill);for(const c of t){const{data:u,width:d,height:f,transform:p}=c,w=this.cachedCanvases.getCanvas("maskCanvas",d,f),y=w.context;y.save();const x=this.getObject(e,u,c);y6(y,x),y.globalCompositeOperation="source-in",y.fillStyle=r?i.getPattern(y,this,er(s),is.FILL,e):i,y.fillRect(0,0,d,f),y.restore(),s.save(),s.transform(...p),s.scale(1,-1),o1(s,w.canvas,0,0,d,f,0,-1,1,1),(l=this.dependencyTracker)==null||l.recordBBox(e,s,0,d,0,f),s.restore()}this.compose(),(h=this.dependencyTracker)==null||h.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s){pe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,s)}paintImageXObjectRepeat(e,t,s,i,r){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){pe("Dependent image isn't ready yet");return}const l=a.width,h=a.height,c=[];for(let u=0,d=r.length;u<d;u+=2)c.push({transform:[s,0,0,i,r[u],r[u+1]],x:0,y:0,w:l,h});this.paintInlineImageXObjectGroup(e,a,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e,t){var c;if(!this.contentVisible)return;const s=t.width,i=t.height,r=this.ctx;this.save(e);const{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none"),r.scale(1/s,-1/i);let l;if(t.bitmap)l=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)l=t;else{const d=this.cachedCanvases.getCanvas("inlineImage",s,i).context;v6(d,t),l=this.applyTransferMapsToCanvas(d)}const h=this._scaleImage(l,er(r));r.imageSmoothingEnabled=w6(pt(r),t.interpolate),(c=this.dependencyTracker)==null||c.resetBBox(e).recordBBox(e,r,0,s,-i,0).recordDependencies(e,fi.imageXObject).recordOperation(e),o1(r,h.img,0,0,h.paintWidth,h.paintHeight,0,-i,s,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,s){var a,l,h;if(!this.contentVisible)return;const i=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const c=t.width,u=t.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;v6(f,t),r=this.applyTransferMapsToCanvas(f)}(a=this.dependencyTracker)==null||a.resetBBox(e);for(const c of s)i.save(),i.transform(...c.transform),i.scale(1,-1),o1(i,r,c.x,c.y,c.w,c.h,0,-1,1,1),(l=this.dependencyTracker)==null||l.recordBBox(e,i,0,1,-1,0),i.restore();(h=this.dependencyTracker)==null||h.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,fi.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,s){}beginMarkedContent(e,t){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,s){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,s){var a,l;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const r=this.ctx;this.pendingClip?(i||(this.pendingClip===A6?r.clip(t,"evenodd"):r.clip(t)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(l=this.dependencyTracker)==null||l.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=pt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let a,l;if(s===0&&i===0){const h=Math.abs(t),c=Math.abs(r);if(h===c)if(e===0)a=l=1/h;else{const u=h*e;a=l=u<1?1/u:1}else if(e===0)a=1/h,l=1/c;else{const u=h*e,d=c*e;a=u<1?1/u:1,l=d<1?1/d:1}}else{const h=Math.abs(t*r-s*i),c=Math.hypot(t,s),u=Math.hypot(i,r);if(e===0)a=u/h,l=c/h;else{const d=e*h;a=u>d?u/d:1,l=c>d?c/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:i}}=this,[r,a]=this.getScaleForStroking();if(r===a){s.lineWidth=(i||1)*r,s.stroke(e);return}const l=s.getLineDash();t&&s.save(),s.scale(r,a),s4.a=1/r,s4.d=1/a;const h=new Path2D;if(h.addPath(e,s4),l.length>0){const c=Math.max(r,a);s.setLineDash(l.map(u=>u/c)),s.lineDashOffset/=c}s.lineWidth=i||1,s.stroke(h),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};ed=new WeakSet,e2=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},td=new WeakSet,t2=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},sd=new WeakSet,s2=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let r0=H3;for(const n in Xc)r0.prototype[n]!==void 0&&(r0.prototype[Xc[n]]=r0.prototype[n]);var id,rd;class Qi{static get workerPort(){return o(this,id)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");b(this,id,e)}static get workerSrc(){return o(this,rd)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");b(this,rd,e)}}id=new WeakMap,rd=new WeakMap,g(Qi,id,null),g(Qi,rd,"");var X0,nd;class TA{constructor({parsedData:e,rawData:t}){g(this,X0,void 0);g(this,nd,void 0);b(this,X0,e),b(this,nd,t)}getRaw(){return o(this,nd)}get(e){return o(this,X0).get(e)??null}[Symbol.iterator](){return o(this,X0).entries()}}X0=new WeakMap,nd=new WeakMap;const Wl=Symbol("INTERNAL");var ad,od,ld,Y0;class CA{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){g(this,ad,!1);g(this,od,!1);g(this,ld,!1);g(this,Y0,!0);b(this,ad,!!(e&ai.DISPLAY)),b(this,od,!!(e&ai.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(o(this,ld))return o(this,Y0);if(!o(this,Y0))return!1;const{print:e,view:t}=this.usage;return o(this,ad)?(t==null?void 0:t.viewState)!=="OFF":o(this,od)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Wl&&Xe("Internal method `_setVisible` called."),b(this,ld,s),b(this,Y0,t)}}ad=new WeakMap,od=new WeakMap,ld=new WeakMap,Y0=new WeakMap;var ha,Ge,K0,Z0,hd,i2;class EA{constructor(e,t=ai.DISPLAY){g(this,hd);g(this,ha,null);g(this,Ge,new Map);g(this,K0,null);g(this,Z0,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,b(this,Z0,e.order);for(const s of e.groups)o(this,Ge).set(s.id,new CA(t,s));if(e.baseState==="OFF")for(const s of o(this,Ge).values())s._setVisible(Wl,!1);for(const s of e.on)o(this,Ge).get(s)._setVisible(Wl,!0);for(const s of e.off)o(this,Ge).get(s)._setVisible(Wl,!1);b(this,K0,this.getHash())}}isVisible(e){if(o(this,Ge).size===0)return!0;if(!e)return Tg("Optional content group not defined."),!0;if(e.type==="OCG")return o(this,Ge).has(e.id)?o(this,Ge).get(e.id).visible:(pe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return A(this,hd,i2).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!o(this,Ge).has(t))return pe(`Optional content group not found: ${t}`),!0;if(o(this,Ge).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!o(this,Ge).has(t))return pe(`Optional content group not found: ${t}`),!0;if(!o(this,Ge).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!o(this,Ge).has(t))return pe(`Optional content group not found: ${t}`),!0;if(!o(this,Ge).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!o(this,Ge).has(t))return pe(`Optional content group not found: ${t}`),!0;if(o(this,Ge).get(t).visible)return!1}return!0}return pe(`Unknown optional content policy ${e.policy}.`),!0}return pe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=o(this,Ge).get(e);if(!i){pe(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const l of a)l!==e&&((r=o(this,Ge).get(l))==null||r._setVisible(Wl,!1,!0));i._setVisible(Wl,!!t,!0),b(this,ha,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=o(this,Ge).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}b(this,ha,null)}get hasInitialVisibility(){return o(this,K0)===null||this.getHash()===o(this,K0)}getOrder(){return o(this,Ge).size?o(this,Z0)?o(this,Z0).slice():[...o(this,Ge).keys()]:null}getGroup(e){return o(this,Ge).get(e)||null}getHash(){if(o(this,ha)!==null)return o(this,ha);const e=new z7;for(const[t,s]of o(this,Ge))e.update(`${t}:${s.visible}`);return b(this,ha,e.hexdigest())}[Symbol.iterator](){return o(this,Ge).entries()}}ha=new WeakMap,Ge=new WeakMap,K0=new WeakMap,Z0=new WeakMap,hd=new WeakSet,i2=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let a;if(Array.isArray(r))a=A(this,hd,i2).call(this,r);else if(o(this,Ge).has(r))a=o(this,Ge).get(r).visible;else return pe(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class _A{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Ce(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:l}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=l,(r==null?void 0:r.length)>0){const h=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,c)=>{this._onReceiveData({begin:h,chunk:c})}),e.addProgressListener((h,c)=>{this._onProgress({loaded:h,total:c})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});Ce(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ce(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new MA(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new DA(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class MA{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=M3(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class DA{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function RA(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let u=l(t);return u=unescape(u),u=h(u),u=c(u),r(u)}if(t=a(n),t){const u=c(t);return r(u)}if(t=s("filename","i").exec(n),t){t=t[1];let u=l(t);return u=c(u),r(u)}function s(u,d){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function i(u,d){if(u){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(u,{fatal:!0}),p=Of(d);d=f.decode(p),e=!1}catch{}}return d}function r(u){return e&&/[\x80-\xff]/.test(u)&&(u=i("utf-8",u),e&&(u=i("iso-8859-1",u))),u}function a(u){const d=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(u))!==null;){let[,y,x,S]=f;if(y=parseInt(y,10),y in d){if(y===0)break;continue}d[y]=[x,S]}const w=[];for(let y=0;y<d.length&&y in d;++y){let[x,S]=d[y];S=l(S),x&&(S=unescape(S),y===0&&(S=h(S))),w.push(S)}return w.join("")}function l(u){if(u.startsWith('"')){const d=u.slice(1).split('\\"');for(let f=0;f<d.length;++f){const p=d[f].indexOf('"');p!==-1&&(d[f]=d[f].slice(0,p),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}u=d.join('"')}return u}function h(u){const d=u.indexOf("'");if(d===-1)return u;const f=u.slice(0,d),w=u.slice(d+1).replace(/^[^']*'/,"");return i(f,w)}function c(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,p,w){if(p==="q"||p==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,x){return String.fromCharCode(parseInt(x,16))}),i(f,w);try{w=atob(w)}catch{}return i(f,w)})}return""}function Z7(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function Eg(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function Q7({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function J7(n){const e=n.get("Content-Disposition");if(e){let t=RA(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(M3(t))return t}return null}function $f(n,e){return new ap(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function ev(n){return n===200||n===206}function tv(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function sv(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(pe(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class PA{constructor(e){O(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Z7(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ce(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new LA(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new IA(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class LA{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,tv(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Eg(r.url),!ev(r.status))throw $f(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:l,suggestedLength:h}=Q7({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=h||this._contentLength,this._filename=J7(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ua("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:sv(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class IA{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const a=i.url;fetch(a,tv(r,this._withCredentials,this._abortController)).then(l=>{const h=Eg(l.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!ev(l.status))throw $f(l.status,a);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:sv(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const i4=200,r4=206;function BA(n){const e=n.response;return typeof e!="string"?e:Of(e).buffer}class NA{constructor({url:e,httpHeaders:t,withCredentials:s}){O(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Z7(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=r4):i.expectedStatus=i4,t.responseType="arraybuffer",Ce(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||i4;if(!(r===i4&&s.expectedStatus===r4)&&r!==s.expectedStatus){s.onError(i.status);return}const l=BA(i);if(r===r4){const h=i.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);c?s.onDone({begin:parseInt(c[1],10),chunk:l}):(pe('Missing or invalid "Content-Range" header.'),s.onError(0))}else l?s.onDone({begin:0,chunk:l}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class FA{constructor(e){this._source=e,this._manager=new NA(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ce(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new OA(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new zA(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class OA{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Eg(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[h,...c]=l.split(": ");return[h,c.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=Q7({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=J7(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=$f(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class zA{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Eg((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=$f(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const HA=/^[a-z][a-z0-9\-+.]+:/i;function UA(n){if(HA.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class qA{constructor(e){this.source=e,this.url=UA(e.url),Ce(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ce(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new $A(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new GA(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class $A{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=$f(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ua("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class GA{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const pc=Symbol("INITIAL_DATA");var js,cd,r2;class iv{constructor(){g(this,cd);g(this,js,Object.create(null))}get(e,t=null){if(t){const i=A(this,cd,r2).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=o(this,js)[e];if(!s||s.data===pc)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=o(this,js)[e];return!!t&&t.data!==pc}delete(e){const t=o(this,js)[e];return!t||t.data===pc?!1:(delete o(this,js)[e],!0)}resolve(e,t=null){const s=A(this,cd,r2).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in o(this,js)){const{data:s}=o(this,js)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}b(this,js,Object.create(null))}*[Symbol.iterator](){for(const e in o(this,js)){const{data:t}=o(this,js)[e];t!==pc&&(yield[e,t])}}}js=new WeakMap,cd=new WeakSet,r2=function(e){var t;return(t=o(this,js))[e]||(t[e]={...Promise.withResolvers(),data:pc})};const VA=1e5,x6=30;var H6,ca,Ds,ud,dd,Ho,ln,fd,pd,Uo,Q0,J0,ua,eh,md,th,qo,gd,bd,sh,$o,vd,da,ih,am,rv,om,nv,yd,n2,rh,_1,wd,a2,lm,av,hm,ov;const vt=class vt{constructor({textContentSource:e,container:t,viewport:s}){g(this,am);g(this,om);g(this,yd);g(this,ca,Promise.withResolvers());g(this,Ds,null);g(this,ud,!1);g(this,dd,!!((H6=globalThis.FontInspector)!=null&&H6.enabled));g(this,Ho,null);g(this,ln,null);g(this,fd,0);g(this,pd,0);g(this,Uo,null);g(this,Q0,null);g(this,J0,0);g(this,ua,0);g(this,eh,Object.create(null));g(this,md,[]);g(this,th,null);g(this,qo,[]);g(this,gd,new WeakMap);g(this,bd,null);var h;if(e instanceof ReadableStream)b(this,th,e);else if(typeof e=="object")b(this,th,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');b(this,Ds,b(this,Q0,t)),b(this,ua,s.scale*Dr.pixelRatio),b(this,J0,s.rotation),b(this,ln,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:a,pageY:l}=s.rawDims;b(this,bd,[1,0,0,-1,-a,l+r]),b(this,pd,i),b(this,fd,r),A(h=vt,lm,av).call(h),Rl(t,s),o(this,ca).promise.finally(()=>{o(vt,ih).delete(this),b(this,ln,null),b(this,eh,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=rs.platform;return me(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{o(this,Uo).read().then(({value:t,done:s})=>{if(s){o(this,ca).resolve();return}o(this,Ho)??b(this,Ho,t.lang),Object.assign(o(this,eh),t.styles),A(this,am,rv).call(this,t.items),e()},o(this,ca).reject)};return b(this,Uo,o(this,th).getReader()),o(vt,ih).add(this),e(),o(this,ca).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*Dr.pixelRatio,i=e.rotation;if(i!==o(this,J0)&&(t==null||t(),b(this,J0,i),Rl(o(this,Q0),{rotation:i})),s!==o(this,ua)){t==null||t(),b(this,ua,s);const a={div:null,properties:null,ctx:A(r=vt,rh,_1).call(r,o(this,Ho))};for(const l of o(this,qo))a.properties=o(this,gd).get(l),a.div=l,A(this,yd,n2).call(this,a)}}cancel(){var t;const e=new Ua("TextLayer task cancelled.");(t=o(this,Uo))==null||t.cancel(e).catch(()=>{}),b(this,Uo,null),o(this,ca).reject(e)}get textDivs(){return o(this,qo)}get textContentItemsStr(){return o(this,md)}static cleanup(){if(!(o(this,ih).size>0)){o(this,sh).clear();for(const{canvas:e}of o(this,$o).values())e.remove();o(this,$o).clear()}}};ca=new WeakMap,Ds=new WeakMap,ud=new WeakMap,dd=new WeakMap,Ho=new WeakMap,ln=new WeakMap,fd=new WeakMap,pd=new WeakMap,Uo=new WeakMap,Q0=new WeakMap,J0=new WeakMap,ua=new WeakMap,eh=new WeakMap,md=new WeakMap,th=new WeakMap,qo=new WeakMap,gd=new WeakMap,bd=new WeakMap,sh=new WeakMap,$o=new WeakMap,vd=new WeakMap,da=new WeakMap,ih=new WeakMap,am=new WeakSet,rv=function(e){var i,r;if(o(this,ud))return;(r=o(this,ln)).ctx??(r.ctx=A(i=vt,rh,_1).call(i,o(this,Ho)));const t=o(this,qo),s=o(this,md);for(const a of e){if(t.length>VA){pe("Ignoring additional textDivs for performance reasons."),b(this,ud,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const l=o(this,Ds);b(this,Ds,document.createElement("span")),o(this,Ds).classList.add("markedContent"),a.id&&o(this,Ds).setAttribute("id",`${a.id}`),l.append(o(this,Ds))}else a.type==="endMarkedContent"&&b(this,Ds,o(this,Ds).parentNode);continue}s.push(a.str),A(this,om,nv).call(this,a)}},om=new WeakSet,nv=function(e){var y;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};o(this,qo).push(t);const i=ae.transform(o(this,bd),e.transform);let r=Math.atan2(i[1],i[0]);const a=o(this,eh)[e.fontName];a.vertical&&(r+=Math.PI/2);let l=o(this,dd)&&a.fontSubstitution||a.fontFamily;l=vt.fontFamilyMap.get(l)||l;const h=Math.hypot(i[2],i[3]),c=h*A(y=vt,hm,ov).call(y,l,a,o(this,Ho));let u,d;r===0?(u=i[4],d=i[5]-c):(u=i[4]+c*Math.sin(r),d=i[5]-c*Math.cos(r));const f="calc(var(--total-scale-factor) *",p=t.style;o(this,Ds)===o(this,Q0)?(p.left=`${(100*u/o(this,pd)).toFixed(2)}%`,p.top=`${(100*d/o(this,fd)).toFixed(2)}%`):(p.left=`${f}${u.toFixed(2)}px)`,p.top=`${f}${d.toFixed(2)}px)`),p.fontSize=`${f}${(o(vt,da)*h).toFixed(2)}px)`,p.fontFamily=l,s.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,o(this,dd)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const x=Math.abs(e.transform[0]),S=Math.abs(e.transform[3]);x!==S&&Math.max(x,S)/Math.min(x,S)>1.5&&(w=!0)}if(w&&(s.canvasWidth=a.vertical?e.height:e.width),o(this,gd).set(t,s),o(this,ln).div=t,o(this,ln).properties=s,A(this,yd,n2).call(this,o(this,ln)),s.hasText&&o(this,Ds).append(t),s.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),o(this,Ds).append(x)}},yd=new WeakSet,n2=function(e){var l;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let a="";if(o(vt,da)>1&&(a=`scale(${1/o(vt,da)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:h}=r,{canvasWidth:c,fontSize:u}=s;A(l=vt,wd,a2).call(l,i,u*o(this,ua),h);const{width:d}=i.measureText(t.textContent);d>0&&(a=`scaleX(${c*o(this,ua)/d}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)},rh=new WeakSet,_1=function(e=null){let t=o(this,$o).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),o(this,$o).set(e,t),o(this,vd).set(t,{size:0,family:""})}return t},wd=new WeakSet,a2=function(e,t,s){const i=o(this,vd).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},lm=new WeakSet,av=function(){if(o(this,da)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),b(this,da,e.getBoundingClientRect().height),e.remove()},hm=new WeakSet,ov=function(e,t,s){const i=o(this,sh).get(e);if(i)return i;const r=A(this,rh,_1).call(this,s);r.canvas.width=r.canvas.height=x6,A(this,wd,a2).call(this,r,x6,e);const a=r.measureText(""),l=a.fontBoundingBoxAscent,h=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let c=.8;return l?c=l/(l+h):(rs.platform.isFirefox&&pe("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),o(this,sh).set(e,c),c},g(vt,rh),g(vt,wd),g(vt,lm),g(vt,hm),g(vt,sh,new Map),g(vt,$o,new Map),g(vt,vd,new WeakMap),g(vt,da,null),g(vt,ih,new Set);let Kc=vt;const jA=100;function lv(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new o2,{docId:t}=e,s=n.url?J9(n.url):null,i=n.data?eA(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,l=n.password??null,h=n.range instanceof hv?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let u=n.worker instanceof Zc?n.worker:null;const d=n.verbosity,f=typeof n.docBaseUrl=="string"&&!Cg(n.docBaseUrl)?n.docBaseUrl:null,p=i1(n.cMapUrl),w=n.cMapPacked!==!1,y=n.CMapReaderFactory||(ys?lA:l6),x=i1(n.iccUrl),S=i1(n.standardFontDataUrl),E=n.StandardFontDataFactory||(ys?hA:h6),T=i1(n.wasmUrl),_=n.WasmFactory||(ys?cA:c6),M=n.stopAtErrors!==!0,D=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,L=n.isEvalSupported!==!1,F=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!ys,N=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!ys&&(rs.platform.isFirefox||!globalThis.chrome),W=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,$=typeof n.disableFontFace=="boolean"?n.disableFontFace:ys,q=n.fontExtraProperties===!0,se=n.enableXfa===!0,z=n.ownerDocument||globalThis.document,ee=n.disableRange===!0,Y=n.disableStream===!0,Z=n.disableAutoFetch===!0,V=n.pdfBug===!0,we=n.CanvasFactory||(ys?oA:rA),Fe=n.FilterFactory||(ys?aA:nA),st=n.enableHWA===!0,ue=n.useWasm!==!1,Ae=h?h.length:n.length??NaN,Be=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!ys&&!$,Ee=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(y===l6&&E===h6&&_===c6&&p&&S&&T&&yc(p,document.baseURI)&&yc(S,document.baseURI)&&yc(T,document.baseURI)),Yt=null;E9(d);const _e={canvasFactory:new we({ownerDocument:z,enableHWA:st}),filterFactory:new Fe({docId:t,ownerDocument:z}),cMapReaderFactory:Ee?null:new y({baseUrl:p,isCompressed:w}),standardFontDataFactory:Ee?null:new E({baseUrl:S}),wasmFactory:Ee?null:new _({baseUrl:T})};u||(u=Zc.create({verbosity:d,port:Qi.workerPort}),e._worker=u);const ht={docId:t,apiVersion:"5.4.449",data:i,password:l,disableAutoFetch:Z,rangeChunkSize:c,length:Ae,docBaseUrl:f,enableXfa:se,evaluatorOptions:{maxImageSize:D,disableFontFace:$,ignoreErrors:M,isEvalSupported:L,isOffscreenCanvasSupported:F,isImageDecoderSupported:N,canvasMaxAreaInBytes:W,fontExtraProperties:q,useSystemFonts:Be,useWasm:ue,useWorkerFetch:Ee,cMapUrl:p,iccUrl:x,standardFontDataUrl:S,wasmUrl:T}},it={ownerDocument:z,pdfBug:V,styleElement:Yt,loadingParams:{disableAutoFetch:Z,enableXfa:se}};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const Ve=u.messageHandler.sendWithPromise("GetDocRequest",ht,i?[i.buffer]:null);let Ke;if(h)Ke=new _A(h,{disableRange:ee,disableStream:Y});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Ji=yc(s)?PA:ys?qA:FA;Ke=new Ji({url:s,length:Ae,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:ee,disableStream:Y})}return Ve.then(Ji=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const Ri=new Ec(t,Ji,u.port),ns=new YA(Ri,e,Ke,it,_e,st);e._transport=ns,Ri.send("Ready",null)})}).catch(e._capability.reject),e}var cm;const um=class um{constructor(){O(this,"_capability",Promise.withResolvers());O(this,"_transport",null);O(this,"_worker",null);O(this,"docId",`d${Lt(um,cm)._++}`);O(this,"destroyed",!1);O(this,"onPassword",null);O(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};cm=new WeakMap,g(um,cm,0);let o2=um;var Go,Ad,xd,Sd,kd;class hv{constructor(e,t,s=!1,i=null){g(this,Go,Promise.withResolvers());g(this,Ad,[]);g(this,xd,[]);g(this,Sd,[]);g(this,kd,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i}addRangeListener(e){o(this,kd).push(e)}addProgressListener(e){o(this,Sd).push(e)}addProgressiveReadListener(e){o(this,xd).push(e)}addProgressiveDoneListener(e){o(this,Ad).push(e)}onDataRange(e,t){for(const s of o(this,kd))s(e,t)}onDataProgress(e,t){o(this,Go).promise.then(()=>{for(const s of o(this,Sd))s(e,t)})}onDataProgressiveRead(e){o(this,Go).promise.then(()=>{for(const t of o(this,xd))t(e)})}onDataProgressiveDone(){o(this,Go).promise.then(()=>{for(const e of o(this,Ad))e()})}transportReady(){o(this,Go).resolve()}requestDataRange(e,t){Xe("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Go=new WeakMap,Ad=new WeakMap,xd=new WeakMap,Sd=new WeakMap,kd=new WeakMap;class WA{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return me(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var hn,Vo,Pc;class XA{constructor(e,t,s,i=!1){g(this,Vo);g(this,hn,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new t6:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new iv,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new Hf({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return me(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:s,intent:i="display",annotationMode:r=On.ENABLE,transform:a=null,background:l=null,optionalContentConfigPromise:h=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:d=null,isEditing:f=!1,recordOperations:p=!1,operationsFilter:w=null}){var N,W,$;(N=this._stats)==null||N.time("Overall");const y=this._transport.getRenderingIntent(i,r,d,f),{renderingIntent:x,cacheKey:S}=y;b(this,hn,!1),h||(h=this._transport.getOptionalContentConfig(x));let E=this._intentStates.get(S);E||(E=Object.create(null),this._intentStates.set(S,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const T=!!(x&ai.PRINT);E.displayReadyCapability||(E.displayReadyCapability=Promise.withResolvers(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(W=this._stats)==null||W.time("Page Request"),this._pumpOperatorList(y));const _=!!(this._pdfBug&&(($=globalThis.StepperManager)!=null&&$.enabled)),M=!this.recordedBBoxes&&(p||_),D=q=>{var se,z;if(E.renderTasks.delete(L),M){const ee=(se=L.gfx)==null?void 0:se.dependencyTracker.take();ee&&(L.stepper&&L.stepper.setOperatorBBoxes(ee,L.gfx.dependencyTracker.takeDebugMetadata()),p&&(this.recordedBBoxes=ee))}T&&b(this,hn,!0),A(this,Vo,Pc).call(this),q?(L.capability.reject(q),this._abortOperatorList({intentState:E,reason:q instanceof Error?q:new Error(q)})):L.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(z=globalThis.Stats)!=null&&z.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},L=new l2({callback:D,params:{canvas:t,canvasContext:e,dependencyTracker:M?new dA(t,E.operatorList.length,_):null,viewport:s,transform:a,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:u,enableHWA:this._transport.enableHWA,operationsFilter:w});(E.renderTasks||(E.renderTasks=new Set)).add(L);const F=L.task;return Promise.all([E.displayReadyCapability.promise,h]).then(([q,se])=>{var z;if(this.destroyed){D();return}if((z=this._stats)==null||z.time("Rendering"),!(se.renderingIntent&x))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");L.initializeGraphics({transparency:q,optionalContentConfig:se}),L.operatorListChanged()}).catch(D),F}getOperatorList({intent:e="display",annotationMode:t=On.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var c;function r(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(h))}const a=this._transport.getRenderingIntent(e,t,s,i,!0);let l=this._intentStates.get(a.cacheKey);l||(l=Object.create(null),this._intentStates.set(a.cacheKey,l));let h;return l.opListReadCapability||(h=Object.create(null),h.operatorListChanged=r,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||(l.renderTasks=new Set)).add(h),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Yc.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){a.read().then(function({value:h,done:c}){if(c){s(l);return}l.lang??(l.lang=h.lang),Object.assign(l.styles,h.styles),l.items.push(...h.items),r()},i)}const a=t.getReader(),l={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),b(this,hn,!1),Promise.all(e)}cleanup(e=!1){b(this,hn,!0);const t=A(this,Vo,Pc).call(this);return e&&t&&this._stats&&(this._stats=new t6),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&A(this,Vo,Pc).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:a}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),c=this._intentStates.get(t);c.streamReader=h;const u=()=>{h.read().then(({value:d,done:f})=>{if(f){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,c),u())},d=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const f of c.renderTasks)f.operatorListChanged();A(this,Vo,Pc).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(d);else if(c.opListReadCapability)c.opListReadCapability.reject(d);else throw d}})};u()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof _3){let i=jA;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Ua(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}hn=new WeakMap,Vo=new WeakSet,Pc=function(){if(!o(this,hn)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),b(this,hn,!1),!0};var fa,Ui,cn,jo,dm,Wo,Xo,nh,M1,fm,cv,pm,uv,Yo,Lc,ah,D1;const nt=class nt{constructor({name:e=null,port:t=null,verbosity:s=_9()}={}){g(this,nh);g(this,fm);g(this,pm);g(this,Yo);g(this,fa,Promise.withResolvers());g(this,Ui,null);g(this,cn,null);g(this,jo,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(o(nt,Xo).has(t))throw new Error("Cannot use more than one PDFWorker per port.");o(nt,Xo).set(t,this),A(this,fm,cv).call(this,t)}else A(this,pm,uv).call(this)}get promise(){return o(this,fa).promise}get port(){return o(this,cn)}get messageHandler(){return o(this,Ui)}destroy(){var e,t;this.destroyed=!0,(e=o(this,jo))==null||e.terminate(),b(this,jo,null),o(nt,Xo).delete(o(this,cn)),b(this,cn,null),(t=o(this,Ui))==null||t.destroy(),b(this,Ui,null)}static create(e){const t=o(this,Xo).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new nt(e)}static get workerSrc(){if(Qi.workerSrc)return Qi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return me(this,"_setupFakeWorkerGlobal",(async()=>o(this,ah,D1)?o(this,ah,D1):(await k9(()=>import(this.workerSrc),[])).WorkerMessageHandler)())}};fa=new WeakMap,Ui=new WeakMap,cn=new WeakMap,jo=new WeakMap,dm=new WeakMap,Wo=new WeakMap,Xo=new WeakMap,nh=new WeakSet,M1=function(){o(this,fa).resolve(),o(this,Ui).send("configure",{verbosity:this.verbosity})},fm=new WeakSet,cv=function(e){b(this,cn,e),b(this,Ui,new Ec("main","worker",e)),o(this,Ui).on("ready",()=>{}),A(this,nh,M1).call(this)},pm=new WeakSet,uv=function(){if(o(nt,Wo)||o(nt,ah,D1)){A(this,Yo,Lc).call(this);return}let{workerSrc:e}=nt;try{nt._isSameOrigin(window.location,e)||(e=nt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Ec("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?o(this,fa).reject(new Error("Worker was destroyed")):A(this,Yo,Lc).call(this)},r=new AbortController;t.addEventListener("error",()=>{o(this,jo)||i()},{signal:r.signal}),s.on("test",l=>{if(r.abort(),this.destroyed||!l){i();return}b(this,Ui,s),b(this,cn,t),b(this,jo,t),A(this,nh,M1).call(this)}),s.on("ready",l=>{if(r.abort(),this.destroyed){i();return}try{a()}catch{A(this,Yo,Lc).call(this)}});const a=()=>{const l=new Uint8Array;s.send("test",l,[l.buffer])};a();return}catch{Tg("The worker has been disabled.")}A(this,Yo,Lc).call(this)},Yo=new WeakSet,Lc=function(){o(nt,Wo)||(pe("Setting up fake worker."),b(nt,Wo,!0)),nt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){o(this,fa).reject(new Error("Worker was destroyed"));return}const t=new iA;b(this,cn,t);const s=`fake${Lt(nt,dm)._++}`,i=new Ec(s+"_worker",s,t);e.setup(i,t),b(this,Ui,new Ec(s,s+"_worker",t)),A(this,nh,M1).call(this)}).catch(e=>{o(this,fa).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},ah=new WeakSet,D1=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},g(nt,ah),g(nt,dm,0),g(nt,Wo,!1),g(nt,Xo,new WeakMap),ys&&(b(nt,Wo,!0),Qi.workerSrc||(Qi.workerSrc="./pdf.worker.mjs")),nt._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const i=new URL(t,s);return s.origin===i.origin},nt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},nt.fromPort=e=>{if(H9("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return nt.create(e)};let Zc=nt;var un,mr,oh,lh,dn,Ko,Ic;class YA{constructor(e,t,s,i,r,a){g(this,Ko);g(this,un,new Map);g(this,mr,new Map);g(this,oh,new Map);g(this,lh,new Map);g(this,dn,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new iv,this.fontLoader=new Z9({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return me(this,"annotationStorage",new D3)}getRenderingIntent(e,t=On.ENABLE,s=null,i=!1,r=!1){let a=ai.DISPLAY,l=G4;switch(e){case"any":a=ai.ANY;break;case"display":break;case"print":a=ai.PRINT;break;default:pe(`getRenderingIntent - invalid intent: ${e}`)}const h=a&ai.PRINT&&s instanceof U7?s:this.annotationStorage;switch(t){case On.DISABLE:a+=ai.ANNOTATIONS_DISABLE;break;case On.ENABLE:break;case On.ENABLE_FORMS:a+=ai.ANNOTATIONS_FORMS;break;case On.ENABLE_STORAGE:a+=ai.ANNOTATIONS_STORAGE,l=h.serializable;break;default:pe(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=ai.IS_EDITING),r&&(a+=ai.OPLIST);const{ids:c,hash:u}=h.modifiedIds,d=[a,l.hash,u];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:l,modifiedIds:c}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=o(this,dn))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of o(this,mr).values())e.push(i._destroy());o(this,mr).clear(),o(this,oh).clear(),o(this,lh).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),o(this,un).clear(),this.filterFactory.destroy(),Kc.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Ua("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Ce(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){i.close();return}Ce(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{var l;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((l=t.onProgress)==null||l.call(t,this._lastProgress)),this._fullReader.onProgress=h=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,i)=>{Ce(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:a,done:l}){if(l){i.close();return}Ce(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{r.cancel(a),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new WA(s,this))}),e.on("DocException",s=>{t._capability.reject(ks(s))}),e.on("PasswordRequest",s=>{b(this,dn,Promise.withResolvers());try{if(!t.onPassword)throw ks(s);const i=r=>{r instanceof Error?o(this,dn).reject(r):o(this,dn).resolve({password:r})};t.onPassword(i,s.code)}catch(i){o(this,dn).reject(i)}return o(this,dn).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;o(this,mr).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in r){const f=r.error;pe(`Error during font loading: ${f}`),this.commonObjs.resolve(s,f);break}const l=new V4(r),h=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,c=new Q9(l,h,r.extra,r.charProcOperatorList);this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c.fontExtraProperties&&c.data&&c.clearData(),this.commonObjs.resolve(s,c)});break;case"CopyLocalImage":const{imageRef:u}=r;Ce(u,"The imageRef must be defined.");for(const f of o(this,mr).values())for(const[,p]of f.objs)if((p==null?void 0:p.ref)===u)return p.dataLen?(this.commonObjs.resolve(s,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(s,r);break;case"Pattern":const d=new j4(r);this.commonObjs.resolve(s,d.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,a])=>{var h;if(this.destroyed)return;const l=o(this,mr).get(i);if(!l.objs.has(s)){if(l._intentStates.size===0){(h=a==null?void 0:a.bitmap)==null||h.close();return}switch(r){case"Image":case"Pattern":l.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&pe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=o(this,oh).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&o(this,lh).set(r.refStr,e);const a=new XA(t,r,this,this._params.pdfBug);return o(this,mr).set(t,a),a});return o(this,oh).set(t,i),i}getPageIndex(e){return W4(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return A(this,Ko,Ic).call(this,"GetFieldObjects")}hasJSActions(){return A(this,Ko,Ic).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return A(this,Ko,Ic).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return A(this,Ko,Ic).call(this,"GetOptionalContentConfig").then(t=>new EA(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=o(this,un).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,a;return{info:i[0],metadata:i[1]?new TA(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null,hasStructTree:i[2]}});return o(this,un).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of o(this,mr).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),o(this,un).clear(),this.filterFactory.destroy(!0),Kc.cleanup()}}cachedPageNumber(e){if(!W4(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return o(this,lh).get(t)??null}}un=new WeakMap,mr=new WeakMap,oh=new WeakMap,lh=new WeakMap,dn=new WeakMap,Ko=new WeakSet,Ic=function(e,t=null){const s=o(this,un).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return o(this,un).set(e,i),i};var pa;class KA{constructor(e){g(this,pa,null);O(this,"onContinue",null);O(this,"onError",null);b(this,pa,e)}get promise(){return o(this,pa).capability.promise}cancel(e=0){o(this,pa).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=o(this,pa).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=o(this,pa);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}pa=new WeakMap;var ma,Zo;const Ka=class Ka{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:l,canvasFactory:h,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:d=!1,pageColors:f=null,enableHWA:p=!1,operationsFilter:w=null}){g(this,ma,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=h,this.filterFactory=c,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new KA(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=p,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var h,c;if(this.cancelled)return;if(this._canvas){if(o(Ka,Zo).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");o(Ka,Zo).add(this._canvas)}this._pdfBug&&((h=globalThis.StepperManager)!=null&&h.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:i,background:r,dependencyTracker:a}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new r0(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:i,viewport:s,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s,i,r;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),o(this,ma)&&(window.cancelAnimationFrame(o(this,ma)),b(this,ma,null)),o(Ka,Zo).delete(this._canvas),e||(e=new _3(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(i=this.task).onError)==null||r.call(i,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?b(this,ma,window.requestAnimationFrame(()=>{b(this,ma,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),o(Ka,Zo).delete(this._canvas),this.callback())))}};ma=new WeakMap,Zo=new WeakMap,g(Ka,Zo,new WeakSet);let l2=Ka;const ZA="5.4.449",QA="f44e5f0e6";var Ws,Qo,hh,Nt,Td,ch,fn,Cd,ga,qi,Ed,_d,h2,Md,c2,Dd,u2,pn,ja,mm,dv,gr,Fn;const Ts=class Ts{constructor({editor:e=null,uiManager:t=null}){g(this,_d);g(this,Md);g(this,Dd);g(this,pn);g(this,mm);g(this,gr);g(this,Ws,null);g(this,Qo,null);g(this,hh,void 0);g(this,Nt,null);g(this,Td,!1);g(this,ch,!1);g(this,fn,null);g(this,Cd,void 0);g(this,ga,null);g(this,qi,null);var s,i;e?(b(this,ch,!1),b(this,fn,e)):b(this,ch,!0),b(this,qi,(e==null?void 0:e._uiManager)||t),b(this,Cd,o(this,qi)._eventBus),b(this,hh,((s=e==null?void 0:e.color)==null?void 0:s.toUpperCase())||((i=o(this,qi))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),o(Ts,Ed)||b(Ts,Ed,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return me(this,"_keyboardManager",new qf([[["Escape","mac+Escape"],Ts.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ts.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ts.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ts.prototype._moveToPrevious],[["Home","mac+Home"],Ts.prototype._moveToBeginning],[["End","mac+End"],Ts.prototype._moveToEnd]]))}renderButton(){const e=b(this,Ws,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",o(this,fn)&&(e.ariaControls=`${o(this,fn).id}_colorpicker_dropdown`);const t=o(this,qi)._signal;e.addEventListener("click",A(this,pn,ja).bind(this),{signal:t}),e.addEventListener("keydown",A(this,Dd,u2).bind(this),{signal:t});const s=b(this,Qo,document.createElement("span"));return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=o(this,hh),e.append(s),e}renderMainDropdown(){const e=b(this,Nt,A(this,_d,h2).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===o(this,Ws)){A(this,pn,ja).call(this,e);return}const t=e.target.getAttribute("data-color");t&&A(this,Md,c2).call(this,t,e)}_moveToNext(e){var t,s;if(!o(this,gr,Fn)){A(this,pn,ja).call(this,e);return}if(e.target===o(this,Ws)){(t=o(this,Nt).firstElementChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=o(this,Nt))==null?void 0:t.firstElementChild)||e.target===o(this,Ws)){o(this,gr,Fn)&&this._hideDropdownFromKeyboard();return}o(this,gr,Fn)||A(this,pn,ja).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!o(this,gr,Fn)){A(this,pn,ja).call(this,e);return}(t=o(this,Nt).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!o(this,gr,Fn)){A(this,pn,ja).call(this,e);return}(t=o(this,Nt).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=o(this,Nt))==null||e.classList.add("hidden"),o(this,Ws).ariaExpanded="false",(t=o(this,ga))==null||t.abort(),b(this,ga,null)}_hideDropdownFromKeyboard(){var e;if(!o(this,ch)){if(!o(this,gr,Fn)){(e=o(this,fn))==null||e.unselect();return}this.hideDropdown(),o(this,Ws).focus({preventScroll:!0,focusVisible:o(this,Td)})}}updateColor(e){if(o(this,Qo)&&(o(this,Qo).style.backgroundColor=e),!o(this,Nt))return;const t=o(this,qi).highlightColors.values();for(const s of o(this,Nt).children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=o(this,Ws))==null||e.remove(),b(this,Ws,null),b(this,Qo,null),(t=o(this,Nt))==null||t.remove(),b(this,Nt,null)}};Ws=new WeakMap,Qo=new WeakMap,hh=new WeakMap,Nt=new WeakMap,Td=new WeakMap,ch=new WeakMap,fn=new WeakMap,Cd=new WeakMap,ga=new WeakMap,qi=new WeakMap,Ed=new WeakMap,_d=new WeakSet,h2=function(){const e=document.createElement("div"),t=o(this,qi)._signal;e.addEventListener("contextmenu",Di,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),o(this,fn)&&(e.id=`${o(this,fn).id}_colorpicker_dropdown`);for(const[s,i]of o(this,qi).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",o(Ts,Ed)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.ariaSelected=i===o(this,hh),r.addEventListener("click",A(this,Md,c2).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",A(this,Dd,u2).bind(this),{signal:t}),e},Md=new WeakSet,c2=function(e,t){t.stopPropagation(),o(this,Cd).dispatch("switchannotationeditorparams",{source:this,type:Te.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},Dd=new WeakSet,u2=function(e){Ts._keyboardManager.exec(this,e)},pn=new WeakSet,ja=function(e){if(o(this,gr,Fn)){this.hideDropdown();return}if(b(this,Td,e.detail===0),o(this,ga)||(b(this,ga,new AbortController),window.addEventListener("pointerdown",A(this,mm,dv).bind(this),{signal:o(this,qi).combinedSignal(o(this,ga))})),o(this,Ws).ariaExpanded="true",o(this,Nt)){o(this,Nt).classList.remove("hidden");return}const t=b(this,Nt,A(this,_d,h2).call(this));o(this,Ws).append(t)},mm=new WeakSet,dv=function(e){var t;(t=o(this,Nt))!=null&&t.contains(e.target)||this.hideDropdown()},gr=new WeakSet,Fn=function(){return o(this,Nt)&&!o(this,Nt).classList.contains("hidden")},g(Ts,Ed,null);let fp=Ts;var br,Rd,uh,Pd;const Za=class Za{constructor(e){g(this,br,null);g(this,Rd,null);g(this,uh,null);b(this,Rd,e),b(this,uh,e._uiManager),o(Za,Pd)||b(Za,Pd,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(o(this,br))return o(this,br);const{editorType:e,colorType:t,color:s}=o(this,Rd),i=b(this,br,document.createElement("input"));return i.type="color",i.value=s||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",o(Za,Pd)[e]),i.addEventListener("input",()=>{o(this,uh).updateParams(t,i.value)},{signal:o(this,uh)._signal}),i}update(e){o(this,br)&&(o(this,br).value=e)}destroy(){var e;(e=o(this,br))==null||e.remove(),b(this,br,null)}hideDropdown(){}};br=new WeakMap,Rd=new WeakMap,uh=new WeakMap,Pd=new WeakMap,g(Za,Pd,null);let pp=Za;function S6(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function mc(n){return Math.max(0,Math.min(255,255*n))}class k6{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=mc(e),[e,e,e]}static G_HTML([e]){const t=S6(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(mc)}static RGB_HTML(e){return`#${e.map(S6).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[mc(1-Math.min(1,e+i)),mc(1-Math.min(1,s+i)),mc(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,a=1-s,l=Math.min(i,r,a);return["CMYK",i,r,a,l]}}class JA{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Xe("Abstract method `_createSVG` called.")}}class mp extends JA{_createSVG(e){return document.createElementNS(Or,e)}}const ex=9,Ll=new WeakSet,tx=new Date().getTimezoneOffset()*60*1e3;class n4{static create(e){switch(e.data.annotationType){case Mt.LINK:return new L3(e);case Mt.TEXT:return new ix(e);case Mt.WIDGET:switch(e.data.fieldType){case"Tx":return new rx(e);case"Btn":return e.data.radioButton?new mv(e):e.data.checkBox?new ax(e):new ox(e);case"Ch":return new lx(e);case"Sig":return new nx(e)}return new Fl(e);case Mt.POPUP:return new f2(e);case Mt.FREETEXT:return new wv(e);case Mt.LINE:return new cx(e);case Mt.SQUARE:return new ux(e);case Mt.CIRCLE:return new dx(e);case Mt.POLYLINE:return new Av(e);case Mt.CARET:return new px(e);case Mt.INK:return new I3(e);case Mt.POLYGON:return new fx(e);case Mt.HIGHLIGHT:return new xv(e);case Mt.UNDERLINE:return new mx(e);case Mt.SQUIGGLY:return new gx(e);case Mt.STRIKEOUT:return new bx(e);case Mt.STAMP:return new Sv(e);case Mt.FILEATTACHMENT:return new vx(e);default:return new gt(e)}}}var Jo,dh,Si,Ld,d2;const U3=class U3{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){g(this,Ld);g(this,Jo,null);g(this,dh,!1);g(this,Si,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return U3._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var s;const{data:e}=this,t=(s=this.annotationStorage)==null?void 0:s.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var l;const e=(l=this.annotationStorage)==null?void 0:l.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:s,rect:i}=this.data;let r=-1/0,a=-1/0;if((t==null?void 0:t.length)>=8){for(let h=0;h<t.length;h+=8)t[h+1]>a?(a=t[h+1],r=t[h+2]):t[h+1]===a&&(r=Math.max(r,t[h+2]));return[r,a]}if((s==null?void 0:s.length)>=1){for(const h of s)for(let c=0,u=h.length;c<u;c+=2)h[c+1]>a?(a=h[c+1],r=h[c]):h[c+1]===a&&(r=Math.max(r,h[c]));if(r!==1/0)return[r,a]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-r)/s,e[1]=100*(e[1]-a)/i,e}get commentText(){var t,s,i;const{data:e}=this;return((s=(t=this.annotationStorage.getRawValue(`${Wc}${e.id}`))==null?void 0:t.popup)==null?void 0:s.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:t}=this,s={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:s})||this.annotationStorage.setValue(`${Wc}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=o(this,Si))==null?void 0:e.popup)||this.popup)==null||t.remove(),b(this,Si,this.popup=null)}updateEdited(e){var r;if(!this.container)return;e.rect&&(o(this,Jo)||b(this,Jo,{rect:this.data.rect.slice(0)}));const{rect:t,popup:s}=e;t&&A(this,Ld,d2).call(this,t);let i=((r=o(this,Si))==null?void 0:r.popup)||this.popup;!i&&(s!=null&&s.text)&&(this._createPopup(s),i=o(this,Si).popup),i&&(i.updateEdited(e),s!=null&&s.deleted&&(i.remove(),b(this,Si,null),this.popup=null))}resetEdited(){var e;o(this,Jo)&&(A(this,Ld,d2).call(this,o(this,Jo).rect),(e=o(this,Si))==null||e.popup.resetEdited(),b(this,Jo,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),!(this instanceof Fl)&&!(this instanceof L3)&&(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof f2){const{rotation:y}=t;return!t.hasOwnCanvas&&y!==0&&this.setRotation(y,r),r}const{width:l,height:h}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const y=t.borderStyle.horizontalCornerRadius,x=t.borderStyle.verticalCornerRadius;if(y>0||x>0){const E=`calc(${y}px * var(--total-scale-factor)) / calc(${x}px * var(--total-scale-factor))`;a.borderRadius=E}else if(this instanceof mv){const E=`calc(${l}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;a.borderRadius=E}switch(t.borderStyle.style){case ql.SOLID:a.borderStyle="solid";break;case ql.DASHED:a.borderStyle="dashed";break;case ql.BEVELED:pe("Unimplemented border style: beveled");break;case ql.INSET:pe("Unimplemented border style: inset");break;case ql.UNDERLINE:a.borderBottomStyle="solid";break}const S=t.borderColor||null;S?(b(this,dh,!0),a.borderColor=ae.makeHexColor(S[0]|0,S[1]|0,S[2]|0)):a.borderWidth=0}const c=ae.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:u,pageHeight:d,pageX:f,pageY:p}=i.rawDims;a.left=`${100*(c[0]-f)/u}%`,a.top=`${100*(c[1]-p)/d}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(a.width=`${100*l/u}%`,a.height=`${100*h/d}%`):this.setRotation(w,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:a}=this;e%180!==0&&([r,a]=[a,r]),t.style.width=`${100*r/s}%`,t.style.height=`${100*a/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],a=r[0],l=r.slice(1);i.target.style[s]=k6[`${a}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[s]:k6[`${a}_rgb`](l)})};return me(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const a=s[i];if(a){const l={detail:{[i]:r},target:e};a(l),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(y=>Math.fround(y));if(e.length===8){const[y,x,S,E]=e.subarray(2,6);if(i===y&&r===x&&t===S&&s===E)return}const{style:a}=this.container;let l;if(o(this,dh)){const{borderColor:y,borderWidth:x}=a;a.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const h=i-t,c=r-s,{svgFactory:u}=this,d=u.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0),d.role="none";const f=u.createElement("defs");d.append(f);const p=u.createElement("clipPath"),w=`clippath_${this.data.id}`;p.setAttribute("id",w),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let y=2,x=e.length;y<x;y+=8){const S=e[y],E=e[y+1],T=e[y+2],_=e[y+3],M=u.createElement("rect"),D=(T-t)/h,L=(r-E)/c,F=(S-T)/h,N=(E-_)/c;M.setAttribute("x",D),M.setAttribute("y",L),M.setAttribute("width",F),M.setAttribute("height",N),p.append(M),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${L}" width="${F}" height="${N}"/>`)}o(this,dh)&&(l.push("</g></svg>')"),a.backgroundImage=l.join("")),this.container.append(d),this.container.style.clipPath=`url(#${w})`}_createPopup(e=null){const{data:t}=this;let s,i;e?(s={str:e.text},i=e.date):(s=t.contentsObj,i=t.modificationDate),b(this,Si,new f2({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:s,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(o(this,Si)||this.popup||this.data.popupRef)}get extraPopupElement(){return o(this,Si)}render(){Xe("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:a,exportValues:l}of i){if(r===-1||a===t)continue;const h=typeof l=="string"?l:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!Ll.has(c)){pe(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:h,domElement:c})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,a=i.getAttribute("data-element-id");a!==t&&Ll.has(i)&&s.push({id:a,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Jo=new WeakMap,dh=new WeakMap,Si=new WeakMap,Ld=new WeakSet,d2=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:l,pageY:h}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-l)/r}%`,t.top=`${100*(a-e[3]+h)/a}%`,i===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(i)};let gt=U3;class sx extends gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var mn,Wa,gm,fv,bm,pv;class L3 extends gt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});g(this,mn);g(this,gm);g(this,bm);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),r=!0):t.attachment?(A(this,gm,fv).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(A(this,bm,pv).call(this,i,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=i,this.container.append(i)),this.container}_bindLink(t,s,i=""){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&A(this,mn,Wa).call(this),i&&(t.title=i)}_bindNamedAction(t,s,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),i&&(t.title=i),A(this,mn,Wa).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=i.get(r);a&&(t[a]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}s.overlaidText&&(t.title=s.overlaidText),t.onclick||(t.onclick=()=>!1),A(this,mn,Wa).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),A(this,mn,Wa).call(this),!this._fieldObjects){pe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var d;i==null||i();const{fields:r,refs:a,include:l}=s,h=[];if(r.length!==0||a.length!==0){const f=new Set(a);for(const p of r){const w=this._fieldObjects[p]||[];for(const{id:y}of w)f.add(y)}for(const p of Object.values(this._fieldObjects))for(const w of p)f.has(w.id)===l&&h.push(w)}else for(const f of Object.values(this._fieldObjects))h.push(...f);const c=this.annotationStorage,u=[];for(const f of h){const{id:p}=f;switch(u.push(p),f.type){case"text":{const y=f.defaultValue||"";c.setValue(p,{value:y});break}case"checkbox":case"radiobutton":{const y=f.defaultValue===f.exportValues;c.setValue(p,{value:y});break}case"combobox":case"listbox":{const y=f.defaultValue||"";c.setValue(p,{value:y});break}default:continue}const w=document.querySelector(`[data-element-id="${p}"]`);if(w){if(!Ll.has(w)){pe(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;w.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}})),!1}}}mn=new WeakSet,Wa=function(){this.container.setAttribute("data-internal-link","")},gm=new WeakSet,fv=function(t,s,i="",r=null){t.href=this.linkService.getAnchorUrl(""),s.description?t.title=s.description:i&&(t.title=i),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(s.content,s.filename,r),!1},A(this,mn,Wa).call(this)},bm=new WeakSet,pv=function(t,s,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),i&&(t.title=i),A(this,mn,Wa).call(this)};class ix extends gt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class Fl extends gt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return rs.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,a=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var l;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a)}}))})}_setEventListeners(e,t,s,i){var r,a,l;for(const[h,c]of s)(c==="Action"||(r=this.data.actions)!=null&&r[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,h,c,i),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":ae.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||ex,r=e.style;let a;const l=2,h=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-l),u=Math.round(c/(Zg*i))||1,d=c/u;a=Math.min(i,h(d/Zg))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-l);a=Math.min(i,h(c/Zg))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=ae.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class rx extends Fl{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let l=a.value||"";const h=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;h&&l.length>h&&(l=l.slice(0,h));let c=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const u={userValue:l,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=c??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",c??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Ll.add(s),this.contentElement=s,s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:d,datetimeType:f,timeStep:p}=this.data,w=!!f&&this.enableScripting;d&&(s.title=d),this._setRequired(s,this.data.required),h&&(s.maxLength=h),s.addEventListener("input",x=>{e.setValue(t,{value:x.target.value}),this.setPropertyOnSiblings(s,"value",x.target.value,"value"),u.formattedValue=null}),s.addEventListener("resetform",x=>{const S=this.data.defaultFieldValue??"";s.value=u.userValue=S,u.formattedValue=null});let y=x=>{const{formattedValue:S}=u;S!=null&&(x.target.value=S),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",S=>{var T;if(u.focused)return;const{target:E}=S;if(w&&(E.type=f,p&&(E.step=p)),u.userValue){const _=u.userValue;if(w)if(f==="time"){const M=new Date(_),D=[M.getHours(),M.getMinutes(),M.getSeconds()];E.value=D.map(L=>L.toString().padStart(2,"0")).join(":")}else E.value=new Date(_-tx).toISOString().split(f==="date"?"T":".",1)[0];else E.value=_}u.lastCommittedValue=E.value,u.commitKey=1,(T=this.data.actions)!=null&&T.Focus||(u.focused=!0)}),s.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const E={value(T){u.userValue=T.detail.value??"",w||e.setValue(t,{value:u.userValue.toString()}),T.target.value=u.userValue},formattedValue(T){const{formattedValue:_}=T.detail;u.formattedValue=_,_!=null&&T.target!==document.activeElement&&(T.target.value=_);const M={formattedValue:_};w&&(M.value=_),e.setValue(t,M)},selRange(T){T.target.setSelectionRange(...T.detail.selRange)},charLimit:T=>{var L;const{charLimit:_}=T.detail,{target:M}=T;if(_===0){M.removeAttribute("maxLength");return}M.setAttribute("maxLength",_);let D=u.userValue;!D||D.length<=_||(D=D.slice(0,_),M.value=u.userValue=D,e.setValue(t,{value:D}),(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:D,willCommit:!0,commitKey:1,selStart:M.selectionStart,selEnd:M.selectionEnd}}))}};this._dispatchEventFromSandbox(E,S)}),s.addEventListener("keydown",S=>{var _;u.commitKey=1;let E=-1;if(S.key==="Escape"?E=0:S.key==="Enter"&&!this.data.multiLine?E=2:S.key==="Tab"&&(u.commitKey=3),E===-1)return;const{value:T}=S.target;u.lastCommittedValue!==T&&(u.lastCommittedValue=T,u.userValue=T,(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,willCommit:!0,commitKey:E,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const x=y;y=null,s.addEventListener("blur",S=>{var _,M;if(!u.focused||!S.relatedTarget)return;(_=this.data.actions)!=null&&_.Blur||(u.focused=!1);const{target:E}=S;let{value:T}=E;if(w){if(T&&f==="time"){const D=T.split(":").map(L=>parseInt(L,10));T=new Date(2e3,0,1,D[0],D[1],D[2]||0).valueOf(),E.step=""}else T.includes("T")||(T=`${T}T00:00`),T=new Date(T).valueOf();E.type="text"}u.userValue=T,u.lastCommittedValue!==T&&((M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,willCommit:!0,commitKey:u.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}})),x(S)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",S=>{var N;u.lastCommittedValue=null;const{data:E,target:T}=S,{value:_,selectionStart:M,selectionEnd:D}=T;let L=M,F=D;switch(S.inputType){case"deleteWordBackward":{const W=_.substring(0,M).match(/\w*[^\w]*$/);W&&(L-=W[0].length);break}case"deleteWordForward":{const W=_.substring(M).match(/^[^\w]*\w*/);W&&(F+=W[0].length);break}case"deleteContentBackward":M===D&&(L-=1);break;case"deleteContentForward":M===D&&(F+=1);break}S.preventDefault(),(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,change:E||"",willCommit:!1,selStart:L,selEnd:F}})}),this._setEventListeners(s,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(y&&s.addEventListener("blur",y),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/h;s.classList.add("comb"),s.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class nx extends Fl{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class ax extends Fl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Ll.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:l,checked:h}=a.target;for(const c of this._getElementsByName(l,s)){const u=h&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=u),e.setValue(c.id,{value:u})}e.setValue(s,{value:h})}),r.addEventListener("resetform",a=>{const l=t.defaultFieldValue||"Off";a.target.checked=l===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const l={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class mv extends Fl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(Ll.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:l,checked:h}=a.target;for(const c of this._getElementsByName(l,s))e.setValue(c.id,{value:!1});e.setValue(s,{value:h})}),r.addEventListener("resetform",a=>{const l=t.defaultFieldValue;a.target.checked=l!=null&&l===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",l=>{const h={value:c=>{const u=a===c.detail.value;for(const d of this._getElementsByName(c.target.name)){const f=u&&d.id===s;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(h,l)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class ox extends L3{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class lx extends Fl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Ll.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",u=>{const d=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===d});for(const u of this.data.options){const d=document.createElement("option");d.textContent=u.displayValue,d.value=u.exportValue,s.value.includes(u.exportValue)&&(d.setAttribute("selected",!0),r=!1),i.append(d)}let a=null;if(r){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),i.prepend(u),a=()=>{u.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const l=u=>{const d=u?"value":"textContent",{options:f,multiple:p}=i;return p?Array.prototype.filter.call(f,w=>w.selected).map(w=>w[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let h=l(!1);const c=u=>{const d=u.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",u=>{const d={value(f){a==null||a();const p=f.detail.value,w=new Set(Array.isArray(p)?p:[p]);for(const y of i.options)y.selected=w.has(y.value);e.setValue(t,{value:l(!0)}),h=l(!1)},multipleSelection(f){i.multiple=!0},remove(f){const p=i.options,w=f.detail.remove;p[w].selected=!1,i.remove(w),p.length>0&&Array.prototype.findIndex.call(p,x=>x.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:l(!0),items:c(f)}),h=l(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),h=l(!1)},insert(f){const{index:p,displayValue:w,exportValue:y}=f.detail.insert,x=i.children[p],S=document.createElement("option");S.textContent=w,S.value=y,x?x.before(S):i.append(S),e.setValue(t,{value:l(!0),items:c(f)}),h=l(!1)},items(f){const{items:p}=f.detail;for(;i.length!==0;)i.remove(0);for(const w of p){const{displayValue:y,exportValue:x}=w,S=document.createElement("option");S.textContent=y,S.value=x,i.append(S)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:l(!0),items:c(f)}),h=l(!1)},indices(f){const p=new Set(f.detail.indices);for(const w of f.target.options)w.selected=p.has(w.index);e.setValue(t,{value:l(!0)}),h=l(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,u)}),i.addEventListener("input",u=>{var p;const d=l(!0),f=l(!1);e.setValue(t,{value:d}),u.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):i.addEventListener("input",function(u){e.setValue(t,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var Id,p2;class f2 extends gt{constructor(t){const{data:s,elements:i,parent:r}=t,a=!!r._commentManager;super(t,{isRenderable:!a&&gt._hasPopupData(s)});g(this,Id);if(this.elements=i,a&&gt._hasPopupData(s)){const l=this.popup=A(this,Id,p2).call(this);for(const h of i)h.popup=l}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const s=this.popup=A(this,Id,p2).call(this),i=[];for(const r of this.elements)r.popup=s,r.container.ariaHasPopup="dialog",i.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(r=>`${Kl}${r}`).join(",")),this.container}}Id=new WeakSet,p2=function(){return new hx({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Xs,ba,vm,ym,fh,ph,At,vr,va,el,mh,gh,yr,Ys,gn,bn,xt,vn,ya,Bd,yn,bh,tl,wa,Ut,Aa,vh,R1,Nd,m2,Fd,g2,Od,b2,yh,P1,zd,v2,wm,gv,Am,bv,xm,vv,Sm,yv,wh,L1,Ah,I1,Hd,y2;class hx{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:a,richText:l,parent:h,rect:c,parentRect:u,open:d,commentManager:f=null}){g(this,vh);g(this,Nd);g(this,Fd);g(this,Od);g(this,yh);g(this,zd);g(this,wm);g(this,Am);g(this,xm);g(this,Sm);g(this,wh);g(this,Ah);g(this,Hd);g(this,Xs,null);g(this,ba,A(this,xm,vv).bind(this));g(this,vm,A(this,Hd,y2).bind(this));g(this,ym,A(this,Ah,I1).bind(this));g(this,fh,A(this,wh,L1).bind(this));g(this,ph,null);g(this,At,null);g(this,vr,null);g(this,va,null);g(this,el,null);g(this,mh,null);g(this,gh,null);g(this,yr,!1);g(this,Ys,null);g(this,gn,null);g(this,bn,null);g(this,xt,null);g(this,vn,null);g(this,ya,null);g(this,Bd,null);g(this,yn,null);g(this,bh,null);g(this,tl,null);g(this,wa,!1);g(this,Ut,null);g(this,Aa,null);b(this,At,e),b(this,bh,i),b(this,vr,a),b(this,yn,l),b(this,mh,h),b(this,ph,t),b(this,Bd,c),b(this,gh,u),b(this,el,s),b(this,Xs,f),b(this,Ut,s[0]),b(this,va,op.toDateObject(r)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup()),f||(A(this,vh,R1).call(this),o(this,At).hidden=!0,d&&A(this,wh,L1).call(this))}renderCommentButton(){if(o(this,xt)){o(this,xt).parentNode||o(this,Ut).container.after(o(this,xt));return}if(o(this,vn)||A(this,Nd,m2).call(this),!o(this,vn))return;const{signal:e}=b(this,gn,new AbortController),t=o(this,Ut).hasOwnCommentButton,s=()=>{o(this,Xs).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{o(this,Xs).toggleCommentPopup(this,!1,!0,!t)},r=()=>{o(this,Xs).toggleCommentPopup(this,!1,!1)};if(t){b(this,xt,o(this,Ut).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",o(this,ba),{signal:e}),a.addEventListener("click",s,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=b(this,xt,document.createElement("button"));a.className="annotationCommentButton";const l=o(this,Ut).container;a.style.zIndex=l.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),A(this,Od,b2).call(this),A(this,Fd,g2).call(this),a.addEventListener("keydown",o(this,ba),{signal:e}),a.addEventListener("click",s,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),l.after(a)}}get commentButtonColor(){const{color:e,opacity:t}=o(this,Ut).commentData;return e?o(this,mh)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=o(this,xt))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:s,creationDate:i,modificationDate:r}=o(this,Ut).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:s,creationDate:i,modificationDate:r}}get elementBeforePopup(){return o(this,xt)}get comment(){return o(this,Aa)||b(this,Aa,o(this,Ut).commentText),o(this,Aa)}set comment(e){e!==this.comment&&(o(this,Ut).commentText=b(this,Aa,e))}focus(){var e;(e=o(this,Ut).container)==null||e.focus()}get parentBoundingClientRect(){return o(this,Ut).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){o(this,xt)&&(o(this,xt).classList.toggle("selected",e),o(this,xt).ariaExpanded=t)}setSelectedCommentButton(e){o(this,xt).classList.toggle("selected",e)}get commentPopupPosition(){if(o(this,ya))return o(this,ya);const{x:e,y:t,height:s}=o(this,xt).getBoundingClientRect(),{x:i,y:r,width:a,height:l}=o(this,Ut).layer.getBoundingClientRect();return[(e-i)/a,(t+s-r)/l]}set commentPopupPosition(e){b(this,ya,e)}hasDefaultPopupPosition(){return o(this,ya)===null}get commentButtonPosition(){return o(this,vn)}get commentButtonWidth(){return o(this,xt).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,s]=o(this,ya)||this.commentButtonPosition.map(c=>c/100),i=this.parentBoundingClientRect,{x:r,y:a,width:l,height:h}=i;o(this,Xs).showDialog(null,this,r+t*l,a+s*h,{...e,parentDimensions:i})}render(){var s,i;if(o(this,Ys))return;const e=b(this,Ys,document.createElement("div"));if(e.className="popup",o(this,ph)){const r=e.style.outlineColor=ae.makeHexColor(...o(this,ph));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");if(t.className="header",(s=o(this,bh))!=null&&s.str){const r=document.createElement("span");r.className="title",t.append(r),{dir:r.dir,str:r.textContent}=o(this,bh)}if(e.append(t),o(this,va)){const r=document.createElement("time");r.className="popupDate",r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:o(this,va).valueOf()})),r.dateTime=o(this,va).toISOString(),t.append(r)}a7({html:o(this,yh,P1)||o(this,vr).str,dir:(i=o(this,vr))==null?void 0:i.dir,className:"popupContent"},e),o(this,At).append(e)}updateEdited({rect:e,popup:t,deleted:s}){var i;if(o(this,Xs)){s?(this.remove(),b(this,Aa,null)):t&&(t.deleted?this.remove():(A(this,Od,b2).call(this),b(this,Aa,t.text))),e&&(b(this,vn,null),A(this,Nd,m2).call(this),A(this,Fd,g2).call(this));return}if(s||t!=null&&t.deleted){this.remove();return}A(this,vh,R1).call(this),o(this,tl)||b(this,tl,{contentsObj:o(this,vr),richText:o(this,yn)}),e&&b(this,bn,null),t&&t.text&&(b(this,yn,A(this,Am,bv).call(this,t.text)),b(this,va,op.toDateObject(t.date)),b(this,vr,null)),(i=o(this,Ys))==null||i.remove(),b(this,Ys,null)}resetEdited(){var e;o(this,tl)&&({contentsObj:Lt(this,vr)._,richText:Lt(this,yn)._}=o(this,tl),b(this,tl,null),(e=o(this,Ys))==null||e.remove(),b(this,Ys,null),b(this,bn,null))}remove(){var e,t,s;if((e=o(this,gn))==null||e.abort(),b(this,gn,null),(t=o(this,Ys))==null||t.remove(),b(this,Ys,null),b(this,wa,!1),b(this,yr,!1),(s=o(this,xt))==null||s.remove(),b(this,xt,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){b(this,wa,this.isVisible),o(this,wa)&&(o(this,At).hidden=!0)}maybeShow(){o(this,Xs)||(A(this,vh,R1).call(this),o(this,wa)&&(o(this,Ys)||A(this,Ah,I1).call(this),b(this,wa,!1),o(this,At).hidden=!1))}get isVisible(){return o(this,Xs)?!1:o(this,At).hidden===!1}}Xs=new WeakMap,ba=new WeakMap,vm=new WeakMap,ym=new WeakMap,fh=new WeakMap,ph=new WeakMap,At=new WeakMap,vr=new WeakMap,va=new WeakMap,el=new WeakMap,mh=new WeakMap,gh=new WeakMap,yr=new WeakMap,Ys=new WeakMap,gn=new WeakMap,bn=new WeakMap,xt=new WeakMap,vn=new WeakMap,ya=new WeakMap,Bd=new WeakMap,yn=new WeakMap,bh=new WeakMap,tl=new WeakMap,wa=new WeakMap,Ut=new WeakMap,Aa=new WeakMap,vh=new WeakSet,R1=function(){var t;if(o(this,gn))return;b(this,gn,new AbortController);const{signal:e}=o(this,gn);for(const s of this.trigger)s.addEventListener("click",o(this,fh),{signal:e}),s.addEventListener("pointerenter",o(this,ym),{signal:e}),s.addEventListener("pointerleave",o(this,vm),{signal:e}),s.classList.add("popupTriggerArea");for(const s of o(this,el))(t=s.container)==null||t.addEventListener("keydown",o(this,ba),{signal:e})},Nd=new WeakSet,m2=function(){const e=o(this,el).find(t=>t.hasCommentButton);e&&b(this,vn,e._normalizePoint(e.commentButtonPosition))},Fd=new WeakSet,g2=function(){if(o(this,Ut).extraPopupElement&&!o(this,Ut).editor)return;o(this,xt)||this.renderCommentButton();const[e,t]=o(this,vn),{style:s}=o(this,xt);s.left=`calc(${e}%)`,s.top=`calc(${t}% - var(--comment-button-dim))`},Od=new WeakSet,b2=function(){o(this,Ut).extraPopupElement||(o(this,xt)||this.renderCommentButton(),o(this,xt).style.backgroundColor=this.commentButtonColor||"")},yh=new WeakSet,P1=function(){const e=o(this,yn),t=o(this,vr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&o(this,yn).html||null},zd=new WeakSet,v2=function(){var e,t,s;return((s=(t=(e=o(this,yh,P1))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},wm=new WeakSet,gv=function(){var e,t,s;return((s=(t=(e=o(this,yh,P1))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},Am=new WeakSet,bv=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:o(this,wm,gv),fontSize:o(this,zd,v2)?`calc(${o(this,zd,v2)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},xm=new WeakSet,vv=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&o(this,yr))&&A(this,wh,L1).call(this)},Sm=new WeakSet,yv=function(){if(o(this,bn)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=o(this,mh);let a=!!o(this,gh),l=a?o(this,gh):o(this,Bd);for(const w of o(this,el))if(!l||ae.intersect(w.data.rect,l)!==null){l=w.data.rect,a=!0;break}const h=ae.normalizeRect([l[0],e[3]-l[1]+e[1],l[2],e[3]-l[3]+e[1]]),c=5,u=a?l[2]-l[0]+c:0,d=h[0]+u,f=h[1];b(this,bn,[100*(d-i)/t,100*(f-r)/s]);const{style:p}=o(this,At);p.left=`${o(this,bn)[0]}%`,p.top=`${o(this,bn)[1]}%`},wh=new WeakSet,L1=function(){if(o(this,Xs)){o(this,Xs).toggleCommentPopup(this,!1);return}b(this,yr,!o(this,yr)),o(this,yr)?(A(this,Ah,I1).call(this),o(this,At).addEventListener("click",o(this,fh)),o(this,At).addEventListener("keydown",o(this,ba))):(A(this,Hd,y2).call(this),o(this,At).removeEventListener("click",o(this,fh)),o(this,At).removeEventListener("keydown",o(this,ba)))},Ah=new WeakSet,I1=function(){o(this,Ys)||this.render(),this.isVisible?o(this,yr)&&o(this,At).classList.add("focused"):(A(this,Sm,yv).call(this),o(this,At).hidden=!1,o(this,At).style.zIndex=parseInt(o(this,At).style.zIndex)+1e3)},Hd=new WeakSet,y2=function(){o(this,At).classList.remove("focused"),!(o(this,yr)||!this.isVisible)&&(o(this,At).hidden=!0,o(this,At).style.zIndex=parseInt(o(this,At).style.zIndex)-1e3)};class wv extends gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=be.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Ud;class cx extends gt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});g(this,Ud,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=b(this,Ud,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,Ud)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ud=new WeakMap;var qd;class ux extends gt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});g(this,qd,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,l=b(this,qd,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",a/2),l.setAttribute("y",a/2),l.setAttribute("width",s-a),l.setAttribute("height",i-a),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,qd)}addHighlightArea(){this.container.classList.add("highlightArea")}}qd=new WeakMap;var $d;class dx extends gt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});g(this,$d,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,l=b(this,$d,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",s/2),l.setAttribute("cy",i/2),l.setAttribute("rx",s/2-a/2),l.setAttribute("ry",i/2-a/2),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,$d)}addHighlightArea(){this.container.classList.add("highlightArea")}}$d=new WeakMap;var Gd;class Av extends gt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});g(this,Gd,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r},width:a,height:l}=this;if(!s)return this.container;const h=this.svgFactory.create(a,l,!0);let c=[];for(let d=0,f=s.length;d<f;d+=2){const p=s[d]-t[0],w=t[3]-s[d+1];c.push(`${p},${w}`)}c=c.join(" ");const u=b(this,Gd,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",c),u.setAttribute("stroke-width",i.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),h.append(u),this.container.append(h),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,Gd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gd=new WeakMap;class fx extends Av{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class px extends gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var Vd,sl,jd,w2;class I3 extends gt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});g(this,jd);g(this,Vd,null);g(this,sl,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?be.HIGHLIGHT:be.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:l,width:h,height:c}=A(this,jd,w2).call(this,s,t),u=this.svgFactory.create(h,c,!0),d=b(this,Vd,this.svgFactory.createElement("svg:g"));u.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",l);for(let f=0,p=i.length;f<p;f++){const w=this.svgFactory.createElement(this.svgElementName);o(this,sl).push(w),w.setAttribute("points",i[f].join(",")),d.append(w)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,a=o(this,Vd);if(s>=0&&a.setAttribute("stroke-width",s||1),i)for(let l=0,h=o(this,sl).length;l<h;l++)o(this,sl)[l].setAttribute("points",i[l].join(","));if(r){const{transform:l,width:h,height:c}=A(this,jd,w2).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${h} ${c}`),a.setAttribute("transform",l)}}getElementsToTriggerPopup(){return o(this,sl)}addHighlightArea(){this.container.classList.add("highlightArea")}}Vd=new WeakMap,sl=new WeakMap,jd=new WeakSet,w2=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class xv extends gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=be.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class mx extends gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class gx extends gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class bx extends gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class Sv extends gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=be.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Wd,Xd,A2;class vx extends gt{constructor(t){var i;super(t,{isRenderable:!0});g(this,Xd);g(this,Wd,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",A(this,Xd,A2).bind(this)),b(this,Wd,i);const{isMac:r}=rs.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&A(this,Xd,A2).call(this)}),!s.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return o(this,Wd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Wd=new WeakMap,Xd=new WeakSet,A2=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var il,rl,xh,xa,Yd,nl,Ks,Kd,Sh,B1,Zd,S2;const q3=class q3{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:l,commentManager:h,linkService:c,annotationStorage:u}){g(this,Sh);g(this,Zd);g(this,il,null);g(this,rl,null);g(this,xh,null);g(this,xa,new Map);g(this,Yd,null);g(this,nl,null);g(this,Ks,[]);g(this,Kd,!1);this.div=e,b(this,il,t),b(this,rl,s),b(this,Yd,l||null),b(this,nl,c||null),b(this,xh,u||new D3),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=h||null}hasEditableAnnotations(){return o(this,xa).size>0}async render(e){var l;const{annotations:t}=e,s=this.div;Rl(s,this.viewport);const i=new Map,r=[],a={data:null,layer:s,linkService:o(this,nl),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new mp,annotationStorage:o(this,xh),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const h of t){if(h.noHTML)continue;const c=h.annotationType===Mt.POPUP;if(c){const f=i.get(h.id);if(!f)continue;if(!this._commentManager){r.push(h);continue}a.elements=f}else if(h.rect[2]===h.rect[0]||h.rect[3]===h.rect[1])continue;a.data=h;const u=n4.create(a);if(!u.isRenderable)continue;if(!c&&(o(this,Ks).push(u),h.popupRef)){const f=i.get(h.popupRef);f?f.push(u):i.set(h.popupRef,[u])}const d=u.render();h.hidden&&(d.style.visibility="hidden"),u._isEditable&&(o(this,xa).set(u.data.id,u),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(u))}await A(this,Sh,B1).call(this);for(const h of r){const c=a.elements=i.get(h.id);a.data=h;const u=n4.create(a);if(!u.isRenderable)continue;const d=u.render();u.contentElement.id=`${Kl}${h.id}`,h.hidden&&(d.style.visibility="hidden"),c.at(-1).container.after(d)}A(this,Zd,S2).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:o(this,nl),svgFactory:new mp,parent:this};for(const s of e){s.borderStyle||(s.borderStyle=q3._defaultBorderStyle),t.data=s;const i=n4.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${Kl}${s.id}`,o(this,Ks).push(i))}await A(this,Sh,B1).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Rl(t,{rotation:e.rotation}),A(this,Zd,S2).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(o(this,xa).values())}getEditableAnnotation(e){return o(this,xa).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:s,rotation:i}=e,r=new sx({data:{id:s,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:o(this,nl),annotationStorage:o(this,xh)});return r.render(),r.contentElement.id=`${Kl}${s}`,r.createOrUpdatePopup(),o(this,Ks).push(r),r}removeAnnotation(e){var i;const t=o(this,Ks).findIndex(r=>r.data.id===e);if(t<0)return;const[s]=o(this,Ks).splice(t,1);(i=o(this,il))==null||i.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);A(this,Sh,B1).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return me(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ql.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};il=new WeakMap,rl=new WeakMap,xh=new WeakMap,xa=new WeakMap,Yd=new WeakMap,nl=new WeakMap,Ks=new WeakMap,Kd=new WeakMap,Sh=new WeakSet,B1=async function(){var s,i,r;if(o(this,Ks).length===0)return;this.div.replaceChildren();const e=[];if(!o(this,Kd)){b(this,Kd,!0);for(const{contentElement:a,data:{id:l}}of o(this,Ks)){const h=a.id=`${Kl}${l}`;e.push((s=o(this,Yd))==null?void 0:s.getAriaAttributes(h).then(c=>{if(c)for(const[u,d]of c)a.setAttribute(u,d)}))}}o(this,Ks).sort(({data:{rect:[a,l,h,c]}},{data:{rect:[u,d,f,p]}})=>{if(a===h&&l===c)return 1;if(u===f&&d===p)return-1;const w=c,y=l,x=(l+c)/2,S=p,E=d,T=(d+p)/2;if(x>=S&&T<=y)return-1;if(T>=w&&x<=E)return 1;const _=(a+h)/2,M=(u+f)/2;return _-M});const t=document.createDocumentFragment();for(const a of o(this,Ks))t.append(a.container),this._commentManager?(r=((i=a.extraPopupElement)==null?void 0:i.popup)||a.popup)==null||r.renderCommentButton():a.extraPopupElement&&t.append(a.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),o(this,il))for(const a of o(this,Ks))o(this,il).addPointerInTextLayer(a.contentElement,!1)},Zd=new WeakSet,S2=function(){var t;if(!o(this,rl))return;const e=this.div;for(const[s,i]of o(this,rl)){const r=e.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):r.append(i);const l=o(this,xa).get(s);l&&(l._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,r.id,i),l._hasNoCanvas=!1):l.canvas=i)}o(this,rl).clear()};let x2=q3;const h1=/\r\n?|\n/g;var Zs,Qd,al,Qs,km,kv,Tm,Tv,Cm,Cv,kh,N1,Th,F1,Ch,O1,Em,Ev,Jd,T2,_m,_v;const Qe=class Qe extends et{constructor(t){super({...t,name:"freeTextEditor"});g(this,km);g(this,Tm);g(this,Cm);g(this,kh);g(this,Ch);g(this,Em);g(this,_m);g(this,Zs,"");g(this,Qd,`${this.id}-editor`);g(this,al,null);g(this,Qs,void 0);O(this,"_colorPicker",null);this.color=t.color||Qe._defaultColor||et._defaultLineColor,b(this,Qs,t.fontSize||Qe._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=Qe.prototype,s=a=>a.isEmpty(),i=Pl.TRANSLATE_SMALL,r=Pl.TRANSLATE_BIG;return me(this,"_keyboardManager",new qf([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){et.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case Te.FREETEXT_SIZE:Qe._defaultFontSize=s;break;case Te.FREETEXT_COLOR:Qe._defaultColor=s;break}}updateParams(t,s){switch(t){case Te.FREETEXT_SIZE:A(this,km,kv).call(this,s);break;case Te.FREETEXT_COLOR:A(this,Tm,Tv).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Te.FREETEXT_SIZE,Qe._defaultFontSize],[Te.FREETEXT_COLOR,Qe._defaultColor||et._defaultLineColor]]}get propertiesToUpdate(){return[[Te.FREETEXT_SIZE,o(this,Qs)],[Te.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new pp(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Te.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Qe._internalPadding*t,-(Qe._internalPadding+o(this,Qs))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),b(this,al,new AbortController);const t=this._uiManager.combinedSignal(o(this,al));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",o(this,Qd)),this._isDraggable=!0,(t=o(this,al))==null||t.abort(),b(this,al,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=o(this,Zs),s=b(this,Zs,A(this,Cm,Cv).call(this).trimEnd());if(t===s)return;const i=r=>{if(b(this,Zs,r),!r){this.remove();return}A(this,Ch,O1).call(this),this._uiManager.rebuild(this),A(this,kh,N1).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),A(this,kh,N1).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Qe._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",o(this,Qd)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${o(this,Qs)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[h,c]=this.getInitialTranslation();[h,c]=this.pageTranslationToScreen(h,c);const[u,d]=this.pageDimensions,[f,p]=this.pageTranslation;let w,y;switch(this.rotation){case 0:w=t+(l[0]-f)/u,y=s+this.height-(l[1]-p)/d;break;case 90:w=t+(l[0]-f)/u,y=s-(l[1]-p)/d,[h,c]=[c,-h];break;case 180:w=t-this.width+(l[0]-f)/u,y=s-(l[1]-p)/d,[h,c]=[-h,-c];break;case 270:w=t+(l[0]-f-this.height*d)/u,y=s+(l[1]-p-this.width*u)/d,[h,c]=[-c,h];break}this.setAt(w*r,y*a,h,c)}else this._moveAfterPaste(t,s);A(this,Ch,O1).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var w,y,x;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=A(w=Qe,Jd,T2).call(w,s.getData("text")||"").replaceAll(h1,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const l=a.getRangeAt(0);if(!r.includes(`
`)){l.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:h,startOffset:c}=l,u=[],d=[];if(h.nodeType===Node.TEXT_NODE){const S=h.parentElement;if(d.push(h.nodeValue.slice(c).replaceAll(h1,"")),S!==this.editorDiv){let E=u;for(const T of this.editorDiv.childNodes){if(T===S){E=d;continue}E.push(A(y=Qe,Th,F1).call(y,T))}}u.push(h.nodeValue.slice(0,c).replaceAll(h1,""))}else if(h===this.editorDiv){let S=u,E=0;for(const T of this.editorDiv.childNodes)E++===c&&(S=d),S.push(A(x=Qe,Th,F1).call(x,T))}b(this,Zs,`${u.join(`
`)}${r}${d.join(`
`)}`),A(this,Ch,O1).call(this);const f=new Range;let p=Math.sumPrecise(u.map(S=>S.length));for(const{firstChild:S}of this.editorDiv.childNodes)if(S.nodeType===Node.TEXT_NODE){const E=S.nodeValue.length;if(p<=E){f.setStart(S,p),f.setEnd(S,p);break}p-=E}a.removeAllRanges(),a.addRange(f)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Qe._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,s,i){var l;let r=null;if(t instanceof wv){const{data:{defaultAppearanceData:{fontSize:h,fontColor:c},rect:u,rotation:d,id:f,popupRef:p,richText:w,contentsObj:y,creationDate:x,modificationDate:S},textContent:E,textPosition:T,parent:{page:{pageNumber:_}}}=t;if(!E||E.length===0)return null;r=t={annotationType:be.FREETEXT,color:Array.from(c),fontSize:h,value:E.join(`
`),position:T,pageIndex:_-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:p,comment:(y==null?void 0:y.str)||null,richText:w,creationDate:x,modificationDate:S}}const a=await super.deserialize(t,s,i);return b(a,Qs,t.fontSize),a.color=ae.makeHexColor(...t.color),b(a,Zs,A(l=Qe,Jd,T2).call(l,t.value)),a._initialData=r,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=et._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:s,fontSize:o(this,Qs),value:A(this,Em,Ev).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!A(this,_m,_v).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(!s)return null;const{style:i}=s;i.fontSize=`calc(${o(this,Qs)}px * var(--total-scale-factor))`,i.color=this.color,s.replaceChildren();for(const r of o(this,Zs).split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),s.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:o(this,Zs)}}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Zs=new WeakMap,Qd=new WeakMap,al=new WeakMap,Qs=new WeakMap,km=new WeakSet,kv=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-o(this,Qs))*this.parentScale),b(this,Qs,r),A(this,kh,N1).call(this)},i=o(this,Qs);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Tm=new WeakSet,Tv=function(t){const s=r=>{this.color=r,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Cm=new WeakSet,Cv=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(A(i=Qe,Th,F1).call(i,r)),s=r);return t.join(`
`)},kh=new WeakSet,N1=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,l=a.style.display,h=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=l,a.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},Th=new WeakSet,F1=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(h1,"")},Ch=new WeakSet,O1=function(){if(this.editorDiv.replaceChildren(),!!o(this,Zs))for(const t of o(this,Zs).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},Em=new WeakSet,Ev=function(){return o(this,Zs).replaceAll(" "," ")},Jd=new WeakSet,T2=function(t){return t.replaceAll(" "," ")},_m=new WeakSet,_v=function(t){const{value:s,fontSize:i,color:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((l,h)=>l!==r[h])||t.pageIndex!==a},g(Qe,Th),g(Qe,Jd),O(Qe,"_freeTextDefaultContent",""),O(Qe,"_internalPadding",0),O(Qe,"_defaultColor",null),O(Qe,"_defaultFontSize",10),O(Qe,"_type","freetext"),O(Qe,"_editorType",be.FREETEXT);let k2=Qe;class ne{toSVGPath(){Xe("Abstract method `toSVGPath` must be implemented.")}get box(){Xe("Abstract getter `box` must be implemented.")}serialize(e,t){Xe("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let l=0,h=e.length;l<h;l+=2)a[l]=t+e[l]*i,a[l+1]=s+e[l+1]*r;return a}static _rescaleAndSwap(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let l=0,h=e.length;l<h;l+=2)a[l]=t+e[l+1]*i,a[l+1]=s+e[l]*r;return a}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,a){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+a)/6,(s+r)/2,(i+a)/2]}}O(ne,"PRECISION",1e-4);var Js,$i,Eh,_h,wr,xe,ol,ll,ef,tf,Mh,Dh,Sa,sf,Mm,Dm,hl,Bc,Rm,Mv,Pm,Dv,Lm,Rv,Im,Pv,Bm,Lv,Nm,Iv;const qr=class qr{constructor({x:e,y:t},s,i,r,a,l=0){g(this,hl);g(this,Rm);g(this,Pm);g(this,Lm);g(this,Im);g(this,Bm);g(this,Nm);g(this,Js,void 0);g(this,$i,[]);g(this,Eh,void 0);g(this,_h,void 0);g(this,wr,[]);g(this,xe,new Float32Array(18));g(this,ol,void 0);g(this,ll,void 0);g(this,ef,void 0);g(this,tf,void 0);g(this,Mh,void 0);g(this,Dh,void 0);g(this,Sa,[]);b(this,Js,s),b(this,Dh,r*i),b(this,_h,a),o(this,xe).set([NaN,NaN,NaN,NaN,e,t],6),b(this,Eh,l),b(this,tf,o(qr,sf)*i),b(this,ef,o(qr,Dm)*i),b(this,Mh,i),o(this,Sa).push(e,t)}isEmpty(){return isNaN(o(this,xe)[8])}add({x:e,y:t}){var N;b(this,ol,e),b(this,ll,t);const[s,i,r,a]=o(this,Js);let[l,h,c,u]=o(this,xe).subarray(8,12);const d=e-c,f=t-u,p=Math.hypot(d,f);if(p<o(this,ef))return!1;const w=p-o(this,tf),y=w/p,x=y*d,S=y*f;let E=l,T=h;l=c,h=u,c+=x,u+=S,(N=o(this,Sa))==null||N.push(e,t);const _=-S/w,M=x/w,D=_*o(this,Dh),L=M*o(this,Dh);return o(this,xe).set(o(this,xe).subarray(2,8),0),o(this,xe).set([c+D,u+L],4),o(this,xe).set(o(this,xe).subarray(14,18),12),o(this,xe).set([c-D,u-L],16),isNaN(o(this,xe)[6])?(o(this,wr).length===0&&(o(this,xe).set([l+D,h+L],2),o(this,wr).push(NaN,NaN,NaN,NaN,(l+D-s)/r,(h+L-i)/a),o(this,xe).set([l-D,h-L],14),o(this,$i).push(NaN,NaN,NaN,NaN,(l-D-s)/r,(h-L-i)/a)),o(this,xe).set([E,T,l,h,c,u],6),!this.isEmpty()):(o(this,xe).set([E,T,l,h,c,u],6),Math.abs(Math.atan2(T-h,E-l)-Math.atan2(S,x))<Math.PI/2?([l,h,c,u]=o(this,xe).subarray(2,6),o(this,wr).push(NaN,NaN,NaN,NaN,((l+c)/2-s)/r,((h+u)/2-i)/a),[l,h,E,T]=o(this,xe).subarray(14,18),o(this,$i).push(NaN,NaN,NaN,NaN,((E+l)/2-s)/r,((T+h)/2-i)/a),!0):([E,T,l,h,c,u]=o(this,xe).subarray(0,6),o(this,wr).push(((E+5*l)/6-s)/r,((T+5*h)/6-i)/a,((5*l+c)/6-s)/r,((5*h+u)/6-i)/a,((l+c)/2-s)/r,((h+u)/2-i)/a),[c,u,l,h,E,T]=o(this,xe).subarray(12,18),o(this,$i).push(((E+5*l)/6-s)/r,((T+5*h)/6-i)/a,((5*l+c)/6-s)/r,((5*h+u)/6-i)/a,((l+c)/2-s)/r,((h+u)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=o(this,wr),t=o(this,$i);if(isNaN(o(this,xe)[6])&&!this.isEmpty())return A(this,Rm,Mv).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);A(this,Lm,Rv).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return A(this,Pm,Dv).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,a){return new Bv(e,t,s,i,r,a)}getOutlines(){var d;const e=o(this,wr),t=o(this,$i),s=o(this,xe),[i,r,a,l]=o(this,Js),h=new Float32Array((((d=o(this,Sa))==null?void 0:d.length)??0)+2);for(let f=0,p=h.length-2;f<p;f+=2)h[f]=(o(this,Sa)[f]-i)/a,h[f+1]=(o(this,Sa)[f+1]-r)/l;if(h[h.length-2]=(o(this,ol)-i)/a,h[h.length-1]=(o(this,ll)-r)/l,isNaN(s[6])&&!this.isEmpty())return A(this,Im,Pv).call(this,h);const c=new Float32Array(o(this,wr).length+24+o(this,$i).length);let u=e.length;for(let f=0;f<u;f+=2){if(isNaN(e[f])){c[f]=c[f+1]=NaN;continue}c[f]=e[f],c[f+1]=e[f+1]}u=A(this,Nm,Iv).call(this,c,u);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){c[u]=c[u+1]=NaN,u+=2;continue}c[u]=t[f+p],c[u+1]=t[f+p+1],u+=2}return A(this,Bm,Lv).call(this,c,u),this.newFreeDrawOutline(c,h,o(this,Js),o(this,Mh),o(this,Eh),o(this,_h))}};Js=new WeakMap,$i=new WeakMap,Eh=new WeakMap,_h=new WeakMap,wr=new WeakMap,xe=new WeakMap,ol=new WeakMap,ll=new WeakMap,ef=new WeakMap,tf=new WeakMap,Mh=new WeakMap,Dh=new WeakMap,Sa=new WeakMap,sf=new WeakMap,Mm=new WeakMap,Dm=new WeakMap,hl=new WeakSet,Bc=function(){const e=o(this,xe).subarray(4,6),t=o(this,xe).subarray(16,18),[s,i,r,a]=o(this,Js);return[(o(this,ol)+(e[0]-t[0])/2-s)/r,(o(this,ll)+(e[1]-t[1])/2-i)/a,(o(this,ol)+(t[0]-e[0])/2-s)/r,(o(this,ll)+(t[1]-e[1])/2-i)/a]},Rm=new WeakSet,Mv=function(){const[e,t,s,i]=o(this,Js),[r,a,l,h]=A(this,hl,Bc).call(this);return`M${(o(this,xe)[2]-e)/s} ${(o(this,xe)[3]-t)/i} L${(o(this,xe)[4]-e)/s} ${(o(this,xe)[5]-t)/i} L${r} ${a} L${l} ${h} L${(o(this,xe)[16]-e)/s} ${(o(this,xe)[17]-t)/i} L${(o(this,xe)[14]-e)/s} ${(o(this,xe)[15]-t)/i} Z`},Pm=new WeakSet,Dv=function(e){const t=o(this,$i);e.push(`L${t[4]} ${t[5]} Z`)},Lm=new WeakSet,Rv=function(e){const[t,s,i,r]=o(this,Js),a=o(this,xe).subarray(4,6),l=o(this,xe).subarray(16,18),[h,c,u,d]=A(this,hl,Bc).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-s)/r} L${h} ${c} L${u} ${d} L${(l[0]-t)/i} ${(l[1]-s)/r}`)},Im=new WeakSet,Pv=function(e){const t=o(this,xe),[s,i,r,a]=o(this,Js),[l,h,c,u]=A(this,hl,Bc).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,l,h,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(d,e,o(this,Js),o(this,Mh),o(this,Eh),o(this,_h))},Bm=new WeakSet,Lv=function(e,t){const s=o(this,$i);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},Nm=new WeakSet,Iv=function(e,t){const s=o(this,xe).subarray(4,6),i=o(this,xe).subarray(16,18),[r,a,l,h]=o(this,Js),[c,u,d,f]=A(this,hl,Bc).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/l,(s[1]-a)/h,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(i[0]-r)/l,(i[1]-a)/h],t),t+=24},g(qr,sf,8),g(qr,Mm,2),g(qr,Dm,o(qr,sf)+o(qr,Mm));let gp=qr;var Rh,cl,wn,rf,ei,nf,Ct,Fm,Nv;class Bv extends ne{constructor(t,s,i,r,a,l){super();g(this,Fm);g(this,Rh,void 0);g(this,cl,new Float32Array(4));g(this,wn,void 0);g(this,rf,void 0);g(this,ei,void 0);g(this,nf,void 0);g(this,Ct,void 0);b(this,Ct,t),b(this,ei,s),b(this,Rh,i),b(this,nf,r),b(this,wn,a),b(this,rf,l),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],A(this,Fm,Nv).call(this,l);const[h,c,u,d]=o(this,cl);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-h)/u,t[f+1]=(t[f+1]-c)/d;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-h)/u,s[f+1]=(s[f+1]-c)/d}toSVGPath(){const t=[`M${o(this,Ct)[4]} ${o(this,Ct)[5]}`];for(let s=6,i=o(this,Ct).length;s<i;s+=6){if(isNaN(o(this,Ct)[s])){t.push(`L${o(this,Ct)[s+4]} ${o(this,Ct)[s+5]}`);continue}t.push(`C${o(this,Ct)[s]} ${o(this,Ct)[s+1]} ${o(this,Ct)[s+2]} ${o(this,Ct)[s+3]} ${o(this,Ct)[s+4]} ${o(this,Ct)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],a){const l=i-t,h=r-s;let c,u;switch(a){case 0:c=ne._rescale(o(this,Ct),t,r,l,-h),u=ne._rescale(o(this,ei),t,r,l,-h);break;case 90:c=ne._rescaleAndSwap(o(this,Ct),t,s,l,h),u=ne._rescaleAndSwap(o(this,ei),t,s,l,h);break;case 180:c=ne._rescale(o(this,Ct),i,s,-l,h),u=ne._rescale(o(this,ei),i,s,-l,h);break;case 270:c=ne._rescaleAndSwap(o(this,Ct),i,r,-l,-h),u=ne._rescaleAndSwap(o(this,ei),i,r,-l,-h);break}return{outline:Array.from(c),points:[Array.from(u)]}}get box(){return o(this,cl)}newOutliner(t,s,i,r,a,l=0){return new gp(t,s,i,r,a,l)}getNewOutline(t,s){const[i,r,a,l]=o(this,cl),[h,c,u,d]=o(this,Rh),f=a*u,p=l*d,w=i*u+h,y=r*d+c,x=this.newOutliner({x:o(this,ei)[0]*f+w,y:o(this,ei)[1]*p+y},o(this,Rh),o(this,nf),t,o(this,rf),s??o(this,wn));for(let S=2;S<o(this,ei).length;S+=2)x.add({x:o(this,ei)[S]*f+w,y:o(this,ei)[S+1]*p+y});return x.getOutlines()}}Rh=new WeakMap,cl=new WeakMap,wn=new WeakMap,rf=new WeakMap,ei=new WeakMap,nf=new WeakMap,Ct=new WeakMap,Fm=new WeakSet,Nv=function(t){const s=o(this,Ct);let i=s[4],r=s[5];const a=[i,r,i,r];let l=i,h=r,c=i,u=r;const d=t?Math.max:Math.min,f=new Float32Array(4);for(let w=6,y=s.length;w<y;w+=6){const x=s[w+4],S=s[w+5];isNaN(s[w])?(ae.pointBoundingBox(x,S,a),h>S?(l=x,h=S):h===S&&(l=d(l,x)),u<S?(c=x,u=S):u===S&&(c=d(c,x))):(f[0]=f[1]=1/0,f[2]=f[3]=-1/0,ae.bezierBoundingBox(i,r,...s.slice(w,w+6),f),ae.rectBoundingBox(f[0],f[1],f[2],f[3],a),h>f[1]?(l=f[0],h=f[1]):h===f[1]&&(l=d(l,f[0])),u<f[3]?(c=f[2],u=f[3]):u===f[3]&&(c=d(c,f[2]))),i=x,r=S}const p=o(this,cl);p[0]=a[0]-o(this,wn),p[1]=a[1]-o(this,wn),p[2]=a[2]-a[0]+2*o(this,wn),p[3]=a[3]-a[1]+2*o(this,wn),this.firstPoint=[l,h],this.lastPoint=[c,u]};var af,of,lf,ka,Gi,Om,Fv,Ph,z1,zm,Ov,Hm,zv,hf,E2;class C2{constructor(e,t=0,s=0,i=!0){g(this,Om);g(this,Ph);g(this,zm);g(this,Hm);g(this,hf);g(this,af,void 0);g(this,of,void 0);g(this,lf,void 0);g(this,ka,[]);g(this,Gi,[]);const r=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x,y:S,width:E,height:T}of e){const _=Math.floor((x-t)/l)*l,M=Math.ceil((x+E+t)/l)*l,D=Math.floor((S-t)/l)*l,L=Math.ceil((S+T+t)/l)*l,F=[_,D,L,!0],N=[M,D,L,!1];o(this,ka).push(F,N),ae.rectBoundingBox(_,D,M,L,r)}const h=r[2]-r[0]+2*s,c=r[3]-r[1]+2*s,u=r[0]-s,d=r[1]-s;let f=i?-1/0:1/0,p=1/0;const w=o(this,ka).at(i?-1:-2),y=[w[0],w[2]];for(const x of o(this,ka)){const[S,E,T,_]=x;!_&&i?E<p?(p=E,f=S):E===p&&(f=Math.max(f,S)):_&&!i&&(E<p?(p=E,f=S):E===p&&(f=Math.min(f,S))),x[0]=(S-u)/h,x[1]=(E-d)/c,x[2]=(T-d)/c}b(this,af,new Float32Array([u,d,h,c])),b(this,of,[f,p]),b(this,lf,y)}getOutlines(){o(this,ka).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of o(this,ka))t[3]?(e.push(...A(this,hf,E2).call(this,t)),A(this,zm,Ov).call(this,t)):(A(this,Hm,zv).call(this,t),e.push(...A(this,hf,E2).call(this,t)));return A(this,Om,Fv).call(this,e)}}af=new WeakMap,of=new WeakMap,lf=new WeakMap,ka=new WeakMap,Gi=new WeakMap,Om=new WeakSet,Fv=function(e){const t=[],s=new Set;for(const a of e){const[l,h,c]=a;t.push([l,h,a],[l,c,a])}t.sort((a,l)=>a[1]-l[1]||a[0]-l[0]);for(let a=0,l=t.length;a<l;a+=2){const h=t[a][2],c=t[a+1][2];h.push(c),c.push(h),s.add(h),s.add(c)}const i=[];let r;for(;s.size>0;){const a=s.values().next().value;let[l,h,c,u,d]=a;s.delete(a);let f=l,p=h;for(r=[l,c],i.push(r);;){let w;if(s.has(u))w=u;else if(s.has(d))w=d;else break;s.delete(w),[l,h,c,u,d]=w,f!==l&&(r.push(f,p,l,p===h?h:c),f=l),p=p===h?c:h}r.push(f,p)}return new yx(i,o(this,af),o(this,of),o(this,lf))},Ph=new WeakSet,z1=function(e){const t=o(this,Gi);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:i=r-1}return i+1},zm=new WeakSet,Ov=function([,e,t]){const s=A(this,Ph,z1).call(this,e);o(this,Gi).splice(s,0,[e,t])},Hm=new WeakSet,zv=function([,e,t]){const s=A(this,Ph,z1).call(this,e);for(let i=s;i<o(this,Gi).length;i++){const[r,a]=o(this,Gi)[i];if(r!==e)break;if(r===e&&a===t){o(this,Gi).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,a]=o(this,Gi)[i];if(r!==e)break;if(r===e&&a===t){o(this,Gi).splice(i,1);return}}},hf=new WeakSet,E2=function(e){const[t,s,i]=e,r=[[t,s,i]],a=A(this,Ph,z1).call(this,i);for(let l=0;l<a;l++){const[h,c]=o(this,Gi)[l];for(let u=0,d=r.length;u<d;u++){const[,f,p]=r[u];if(!(c<=f||p<=h)){if(f>=h){if(p>c)r[u][1]=c;else{if(d===1)return[];r.splice(u,1),u--,d--}continue}r[u][2]=h,p>c&&r.push([t,c,p])}}}return r};var cf,Lh;class yx extends ne{constructor(t,s,i,r){super();g(this,cf,void 0);g(this,Lh,void 0);b(this,Lh,t),b(this,cf,s),this.firstPoint=i,this.lastPoint=r}toSVGPath(){const t=[];for(const s of o(this,Lh)){let[i,r]=s;t.push(`M${i} ${r}`);for(let a=2;a<s.length;a+=2){const l=s[a],h=s[a+1];l===i?(t.push(`V${h}`),r=h):h===r&&(t.push(`H${l}`),i=l)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],a){const l=[],h=i-t,c=r-s;for(const u of o(this,Lh)){const d=new Array(u.length);for(let f=0;f<u.length;f+=2)d[f]=t+u[f]*h,d[f+1]=r-u[f+1]*c;l.push(d)}return l}get box(){return o(this,cf)}get classNamesForOutlining(){return["highlightOutline"]}}cf=new WeakMap,Lh=new WeakMap;class _2 extends gp{newFreeDrawOutline(e,t,s,i,r,a){return new wx(e,t,s,i,r,a)}}class wx extends Bv{newOutliner(e,t,s,i,r,a=0){return new _2(e,t,s,i,r,a)}}var Ih,uf,An,ul,df,Rs,ff,pf,dl,ti,si,ts,Bh,Nh,ds,Fh,ki,mf,gf,M2,Oh,H1,Um,Hv,qm,Uv,$m,qv,bf,D2,xn,Xa,Ta,Xl,Gm,$v,zh,U1,Hh,q1,Vm,Gv,jm,Vv,Wm,jv,Xm,Wv,Ym,Xv;const Me=class Me extends et{constructor(t){super({...t,name:"highlightEditor"});g(this,gf);g(this,Oh);g(this,Um);g(this,qm);g(this,$m);g(this,bf);g(this,xn);g(this,Gm);g(this,zh);g(this,Hh);g(this,Vm);g(this,jm);g(this,Ym);g(this,Ih,null);g(this,uf,0);g(this,An,void 0);g(this,ul,null);g(this,df,null);g(this,Rs,null);g(this,ff,null);g(this,pf,0);g(this,dl,null);g(this,ti,null);g(this,si,null);g(this,ts,!1);g(this,Bh,null);g(this,Nh,null);g(this,ds,null);g(this,Fh,"");g(this,ki,void 0);g(this,mf,"");this.color=t.color||Me._defaultColor,b(this,ki,t.thickness||Me._defaultThickness),this.opacity=t.opacity||Me._defaultOpacity,b(this,An,t.boxes||null),b(this,mf,t.methodOfCreation||""),b(this,Fh,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(b(this,ts,!0),A(this,Oh,H1).call(this,t),A(this,xn,Xa).call(this)):o(this,An)&&(b(this,Ih,t.anchorNode),b(this,uf,t.anchorOffset),b(this,ff,t.focusNode),b(this,pf,t.focusOffset),A(this,gf,M2).call(this),A(this,xn,Xa).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=Me.prototype;return me(this,"_keyboardManager",new qf([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:o(this,ts)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:o(this,ki),methodOfCreation:o(this,mf)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;et.initialize(t,s),Me._defaultColor||(Me._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case Te.HIGHLIGHT_COLOR:Me._defaultColor=s;break;case Te.HIGHLIGHT_THICKNESS:Me._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return o(this,Nh)}get commentButtonPosition(){return o(this,Bh)}updateParams(t,s){switch(t){case Te.HIGHLIGHT_COLOR:A(this,Um,Hv).call(this,s);break;case Te.HIGHLIGHT_THICKNESS:A(this,qm,Uv).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Te.HIGHLIGHT_COLOR,Me._defaultColor],[Te.HIGHLIGHT_THICKNESS,Me._defaultThickness]]}get propertiesToUpdate(){return[[Te.HIGHLIGHT_COLOR,this.color||Me._defaultColor],[Te.HIGHLIGHT_THICKNESS,o(this,ki)||Me._defaultThickness],[Te.HIGHLIGHT_FREE,o(this,ts)]]}onUpdatedColor(){var t,s;(t=this.parent)==null||t.drawLayer.updateProperties(o(this,si),{root:{fill:this.color,"fill-opacity":this.opacity}}),(s=o(this,df))==null||s.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",b(this,df,new fp({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,Hh,q1).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,A(this,Hh,q1).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){A(this,bf,D2).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,xn,Xa).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?A(this,bf,D2).call(this):t&&(A(this,xn,Xa).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,a,l;const{drawLayer:s}=this.parent;let i;o(this,ts)?(t=(t-this.rotation+360)%360,i=A(r=Me,Ta,Xl).call(r,o(this,ti).box,t)):i=A(a=Me,Ta,Xl).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(o(this,si),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(o(this,ds),{bbox:A(l=Me,Ta,Xl).call(l,o(this,Rs).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();o(this,Fh)&&(t.setAttribute("aria-label",o(this,Fh)),t.setAttribute("role","mark")),o(this,ts)?t.classList.add("free"):this.div.addEventListener("keydown",A(this,Gm,$v).bind(this),{signal:this._uiManager._signal});const s=b(this,dl,document.createElement("div"));return t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=o(this,ul),this.setDims(),f7(this,o(this,dl),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(o(this,ds),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(o(this,ds),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:A(this,zh,U1).call(this,!0);break;case 1:case 3:A(this,zh,U1).call(this,!1);break}}select(){var t;super.select(),o(this,ds)&&((t=this.parent)==null||t.drawLayer.updateProperties(o(this,ds),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),o(this,ds)&&((t=this.parent)==null||t.drawLayer.updateProperties(o(this,ds),{rootClass:{selected:!1}}),o(this,ts)||A(this,zh,U1).call(this,!1))}get _mustFixPosition(){return!o(this,ts)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(o(this,si),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(o(this,ds),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:a}){const{x:l,y:h,width:c,height:u}=i.getBoundingClientRect(),d=new AbortController,f=t.combinedSignal(d),p=w=>{d.abort(),A(this,Xm,Wv).call(this,t,w)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",St,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",Di,{signal:f}),i.addEventListener("pointermove",A(this,Wm,jv).bind(this,t),{signal:f}),this._freeHighlight=new _2({x:r,y:a},[l,h,c,u],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var y,x,S,E;let r=null;if(t instanceof xv){const{data:{quadPoints:T,rect:_,rotation:M,id:D,color:L,opacity:F,popupRef:N,richText:W,contentsObj:$,creationDate:q,modificationDate:se},parent:{page:{pageNumber:z}}}=t;r=t={annotationType:be.HIGHLIGHT,color:Array.from(L),opacity:F,quadPoints:T,boxes:null,pageIndex:z-1,rect:_.slice(0),rotation:M,annotationElementId:D,id:D,deleted:!1,popupRef:N,richText:W,comment:($==null?void 0:$.str)||null,creationDate:q,modificationDate:se}}else if(t instanceof I3){const{data:{inkLists:T,rect:_,rotation:M,id:D,color:L,borderStyle:{rawWidth:F},popupRef:N,richText:W,contentsObj:$,creationDate:q,modificationDate:se},parent:{page:{pageNumber:z}}}=t;r=t={annotationType:be.HIGHLIGHT,color:Array.from(L),thickness:F,inkLists:T,boxes:null,pageIndex:z-1,rect:_.slice(0),rotation:M,annotationElementId:D,id:D,deleted:!1,popupRef:N,richText:W,comment:($==null?void 0:$.str)||null,creationDate:q,modificationDate:se}}const{color:a,quadPoints:l,inkLists:h,opacity:c}=t,u=await super.deserialize(t,s,i);u.color=ae.makeHexColor(...a),u.opacity=c||1,h&&b(u,ki,t.thickness),u._initialData=r,t.comment&&u.setCommentData(t);const[d,f]=u.pageDimensions,[p,w]=u.pageTranslation;if(l){const T=b(u,An,[]);for(let _=0;_<l.length;_+=8)T.push({x:(l[_]-p)/d,y:1-(l[_+1]-w)/f,width:(l[_+2]-l[_])/d,height:(l[_+1]-l[_+5])/f});A(y=u,gf,M2).call(y),A(x=u,xn,Xa).call(x),u.rotate(u.rotation)}else if(h){b(u,ts,!0);const T=h[0],_={x:T[0]-p,y:f-(T[1]-w)},M=new _2(_,[0,0,d,f],1,o(u,ki)/2,!0,.001);for(let F=0,N=T.length;F<N;F+=2)_.x=T[F]-p,_.y=f-(T[F+1]-w),M.add(_);const{id:D,clipPathId:L}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:M.toSVGPath()}},!0,!0);A(S=u,Oh,H1).call(S,{highlightOutlines:M.getOutlines(),highlightId:D,clipPathId:L}),A(E=u,xn,Xa).call(E),u.rotate(u.parentRotation)}return u}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=et._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:s,opacity:this.opacity,thickness:o(this,ki),quadPoints:A(this,Vm,Gv).call(this),outlines:A(this,jm,Vv).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!A(this,Ym,Xv).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Ih=new WeakMap,uf=new WeakMap,An=new WeakMap,ul=new WeakMap,df=new WeakMap,Rs=new WeakMap,ff=new WeakMap,pf=new WeakMap,dl=new WeakMap,ti=new WeakMap,si=new WeakMap,ts=new WeakMap,Bh=new WeakMap,Nh=new WeakMap,ds=new WeakMap,Fh=new WeakMap,ki=new WeakMap,mf=new WeakMap,gf=new WeakSet,M2=function(){const t=new C2(o(this,An),.001);b(this,ti,t.getOutlines()),[this.x,this.y,this.width,this.height]=o(this,ti).box;const s=new C2(o(this,An),.0025,.001,this._uiManager.direction==="ltr");b(this,Rs,s.getOutlines());const{firstPoint:i}=o(this,ti);b(this,Bh,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:r}=o(this,Rs);b(this,Nh,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},Oh=new WeakSet,H1=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var f,p;b(this,ti,t);const r=1.5;if(b(this,Rs,t.getNewOutline(o(this,ki)/2+r,.0025)),s>=0)b(this,si,s),b(this,ul,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),b(this,ds,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:o(this,Rs).box,path:{d:o(this,Rs).toSVGPath()}},!0));else if(this.parent){const w=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(o(this,si),{bbox:A(f=Me,Ta,Xl).call(f,o(this,ti).box,(w-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(o(this,ds),{bbox:A(p=Me,Ta,Xl).call(p,o(this,Rs).box,w),path:{d:o(this,Rs).toSVGPath()}})}const[a,l,h,c]=t.box;switch(this.rotation){case 0:this.x=a,this.y=l,this.width=h,this.height=c;break;case 90:{const[w,y]=this.parentDimensions;this.x=l,this.y=1-a,this.width=h*y/w,this.height=c*w/y;break}case 180:this.x=1-a,this.y=1-l,this.width=h,this.height=c;break;case 270:{const[w,y]=this.parentDimensions;this.x=1-l,this.y=a,this.width=h*y/w,this.height=c*w/y;break}}const{firstPoint:u}=t;b(this,Bh,[(u[0]-a)/h,(u[1]-l)/c]);const{lastPoint:d}=o(this,Rs);b(this,Nh,[(d[0]-a)/h,(d[1]-l)/c])},Um=new WeakSet,Hv=function(t){const s=(a,l)=>{this.color=a,this.opacity=l,this.onUpdatedColor()},i=this.color,r=this.opacity;this.addCommands({cmd:s.bind(this,t,Me._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},qm=new WeakSet,Uv=function(t){const s=o(this,ki),i=r=>{b(this,ki,r),A(this,$m,qv).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},$m=new WeakSet,qv=function(t){o(this,ts)&&(A(this,Oh,H1).call(this,{highlightOutlines:o(this,ti).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},bf=new WeakSet,D2=function(){o(this,si)===null||!this.parent||(this.parent.drawLayer.remove(o(this,si)),b(this,si,null),this.parent.drawLayer.remove(o(this,ds)),b(this,ds,null))},xn=new WeakSet,Xa=function(t=this.parent){o(this,si)===null&&({id:Lt(this,si)._,clipPathId:Lt(this,ul)._}=t.drawLayer.draw({bbox:o(this,ti).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:o(this,ts)},path:{d:o(this,ti).toSVGPath()}},!1,!0),b(this,ds,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:o(this,ts)},bbox:o(this,Rs).box,path:{d:o(this,Rs).toSVGPath()}},o(this,ts))),o(this,dl)&&(o(this,dl).style.clipPath=o(this,ul)))},Ta=new WeakSet,Xl=function([t,s,i,r],a){switch(a){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},Gm=new WeakSet,$v=function(t){Me._keyboardManager.exec(this,t)},zh=new WeakSet,U1=function(t){if(!o(this,Ih))return;const s=window.getSelection();t?s.setPosition(o(this,Ih),o(this,uf)):s.setPosition(o(this,ff),o(this,pf))},Hh=new WeakSet,q1=function(){return o(this,ts)?this.rotation:0},Vm=new WeakSet,Gv=function(){if(o(this,ts))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,a=o(this,An),l=new Float32Array(a.length*8);let h=0;for(const{x:c,y:u,width:d,height:f}of a){const p=c*t+i,w=(1-u)*s+r;l[h]=l[h+4]=p,l[h+1]=l[h+3]=w,l[h+2]=l[h+6]=p+d*t,l[h+5]=l[h+7]=w-f*s,h+=8}return l},jm=new WeakSet,Vv=function(t){return o(this,ti).serialize(t,A(this,Hh,q1).call(this))},Wm=new WeakSet,jv=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},Xm=new WeakSet,Wv=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Ym=new WeakSet,Xv=function(t){const{color:s}=this._initialData;return this.hasEditedComment||t.color.some((i,r)=>i!==s[r])},g(Me,Ta),g(Me,Wm),g(Me,Xm),O(Me,"_defaultColor",null),O(Me,"_defaultOpacity",1),O(Me,"_defaultThickness",12),O(Me,"_type","highlight"),O(Me,"_editorType",be.HIGHLIGHT),O(Me,"_freeHighlightId",-1),O(Me,"_freeHighlight",null),O(Me,"_freeHighlightClipId","");let bp=Me;var fl;class Yv{constructor(){g(this,fl,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){o(this,fl)[e]=t}toSVGProperties(){const e=o(this,fl);return b(this,fl,Object.create(null)),{root:e}}reset(){b(this,fl,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Xe("Not implemented")}}fl=new WeakMap;var ii,Uh,qt,pl,ml,vf,R2,yf,P2,wf,L2,gl,Nc,Km,Kv,qh,$1,bl,Fc,Ca,Yl;const Se=class Se extends et{constructor(t){super(t);g(this,vf);g(this,yf);g(this,wf);g(this,gl);g(this,Km);g(this,qh);g(this,bl);g(this,Ca);g(this,ii,null);g(this,Uh,void 0);O(this,"_colorPicker",null);O(this,"_drawId",null);b(this,Uh,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(A(this,vf,R2).call(this,t),A(this,gl,Nc).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(s))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){Xe("Not implemented")}static get typesMap(){Xe("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(o(Se,qt).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,a=r[s],l=h=>{var u;r.updateProperty(s,h);const c=o(this,ii).updateProperty(s,h);c&&A(this,bl,Fc).call(this,c),(u=this.parent)==null||u.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,i),undo:l.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties(o(this,ii).getPathResizingSVGProperties(A(this,qh,$1).call(this)),{bbox:A(this,Ca,Yl).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties(o(this,ii).getPathResizedSVGProperties(A(this,qh,$1).call(this)),{bbox:A(this,Ca,Yl).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:A(this,Ca,Yl).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties(o(this,ii).getPathTranslatedSVGProperties(A(this,qh,$1).call(this),this.parentDimensions),{bbox:A(this,Ca,Yl).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,o(this,Uh)&&(b(this,Uh,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){A(this,wf,L2).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,gl,Nc).call(this),A(this,bl,Fc).call(this,o(this,ii).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),A(this,wf,L2).call(this)):t&&(this._uiManager.addShouldRescale(this),A(this,gl,Nc).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties({bbox:A(this,Ca,Yl).call(this)},o(this,ii).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&A(this,bl,Fc).call(this,o(this,ii).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");return i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),i}static createDrawerInstance(t,s,i,r,a){Xe("Not implemented")}static startDrawing(t,s,i,r){var x;const{target:a,offsetX:l,offsetY:h,pointerId:c,pointerType:u}=r;if(os.isInitializedAndDifferentPointerType(u))return;const{viewport:{rotation:d}}=t,{width:f,height:p}=a.getBoundingClientRect(),w=b(Se,pl,new AbortController),y=t.combinedSignal(w);if(os.setPointer(u,c),window.addEventListener("pointerup",S=>{os.isSamePointerIdOrRemove(S.pointerId)&&this._endDraw(S)},{signal:y}),window.addEventListener("pointercancel",S=>{os.isSamePointerIdOrRemove(S.pointerId)&&this._currentParent.endDrawingSession()},{signal:y}),window.addEventListener("pointerdown",S=>{os.isSamePointerType(S.pointerType)&&(os.initializeAndAddPointerId(S.pointerId),o(Se,qt).isCancellable()&&(o(Se,qt).removeLastElement(),o(Se,qt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",Di,{signal:y}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),a.addEventListener("touchmove",S=>{os.isSameTimeStamp(S.timeStamp)&&St(S)},{signal:y}),t.toggleDrawing(),(x=s._editorUndoBar)==null||x.hide(),o(Se,qt)){t.drawLayer.updateProperties(this._currentDrawId,o(Se,qt).startNew(l,h,f,p,d));return}s.updateUIForDefaultProperties(this),b(Se,qt,this.createDrawerInstance(l,h,f,p,d)),b(Se,ml,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(o(Se,ml).toSVGProperties(),o(Se,qt).defaultSVGProperties),!0,!1)}static _drawMove(t){if(os.isSameTimeStamp(t.timeStamp),!o(Se,qt))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(os.isSamePointerId(r)){if(os.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,o(Se,qt).add(s,i)),os.setTimeStamp(t.timeStamp),St(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,b(Se,qt,null),b(Se,ml,null),os.clearPointerType(),os.clearTimeStamp()),o(Se,pl)&&(o(Se,pl).abort(),b(Se,pl,null),os.clearPointerIds())}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,o(Se,qt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=o(Se,qt),r=this._currentDrawId,a=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:Te.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(Te.DRAW_STEP),!o(Se,qt).isEmpty()){const{pageDimensions:[i,r],scale:a}=s,l=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:o(Se,qt).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:o(Se,ml),mustBeCommitted:!t});return this._cleanup(!0),l}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,a,l){Xe("Not implemented")}static async deserialize(t,s,i){var d,f;const{rawDims:{pageWidth:r,pageHeight:a,pageX:l,pageY:h}}=s.viewport,c=this.deserializeDraw(l,h,r,a,this._INNER_MARGIN,t),u=await super.deserialize(t,s,i);return u.createDrawingOptions(t),A(d=u,vf,R2).call(d,{drawOutlines:c}),A(f=u,gl,Nc).call(f),u.onScaleChanging(),u.rotate(),u}serializeDraw(t){const[s,i]=this.pageTranslation,[r,a]=this.pageDimensions;return o(this,ii).serialize([s,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};ii=new WeakMap,Uh=new WeakMap,qt=new WeakMap,pl=new WeakMap,ml=new WeakMap,vf=new WeakSet,R2=function({drawOutlines:t,drawId:s,drawingOptions:i}){b(this,ii,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=A(this,yf,P2).call(this,t,this.parent),A(this,bl,Fc).call(this,t.box)},yf=new WeakSet,P2=function(t,s){const{id:i}=s.drawLayer.draw(Se._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},wf=new WeakSet,L2=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},gl=new WeakSet,Nc=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=A(this,yf,P2).call(this,o(this,ii),t)}},Km=new WeakSet,Kv=function([t,s,i,r]){const{parentDimensions:[a,l],rotation:h}=this;switch(h){case 90:return[s,1-t,i*(l/a),r*(a/l)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(l/a),r*(a/l)];default:return[t,s,i,r]}},qh=new WeakSet,$1=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[a,l],rotation:h}=this;switch(h){case 90:return[1-s,t,i*(a/l),r*(l/a)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(a/l),r*(l/a)];default:return[t,s,i,r]}},bl=new WeakSet,Fc=function(t){[this.x,this.y,this.width,this.height]=A(this,Km,Kv).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Ca=new WeakSet,Yl=function(){const{x:t,y:s,width:i,height:r,rotation:a,parentRotation:l,parentDimensions:[h,c]}=this;switch((a*4+l)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(h/c),r*(c/h),i*(h/c)];case 5:return[1-s,t,i*(h/c),r*(c/h)];case 6:return[1-t-r*(c/h),1-s,r*(c/h),i*(h/c)];case 7:return[s-i*(h/c),1-t-r*(c/h),i*(h/c),r*(c/h)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(c/h),s,r*(c/h),i*(h/c)];case 13:return[1-s-i*(h/c),t-r*(c/h),i*(h/c),r*(c/h)];case 14:return[1-t,1-s-i*(h/c),r*(c/h),i*(h/c)];case 15:return[s,1-t,i*(h/c),r*(c/h)];default:return[t,s,i,r]}},O(Se,"_currentDrawId",-1),O(Se,"_currentParent",null),g(Se,qt,null),g(Se,pl,null),g(Se,ml,null),O(Se,"_INNER_MARGIN",3);let vp=Se;var Ar,$t,Gt,vl,$h,gs,ss,Ti,yl,wl,Al,Gh,G1;class Ax{constructor(e,t,s,i,r,a){g(this,Gh);g(this,Ar,new Float64Array(6));g(this,$t,void 0);g(this,Gt,void 0);g(this,vl,void 0);g(this,$h,void 0);g(this,gs,void 0);g(this,ss,"");g(this,Ti,0);g(this,yl,new Gf);g(this,wl,void 0);g(this,Al,void 0);b(this,wl,s),b(this,Al,i),b(this,vl,r),b(this,$h,a),[e,t]=A(this,Gh,G1).call(this,e,t);const l=b(this,$t,[NaN,NaN,NaN,NaN,e,t]);b(this,gs,[e,t]),b(this,Gt,[{line:l,points:o(this,gs)}]),o(this,Ar).set(l,0)}updateProperty(e,t){e==="stroke-width"&&b(this,$h,t)}isEmpty(){return!o(this,Gt)||o(this,Gt).length===0}isCancellable(){return o(this,gs).length<=10}add(e,t){[e,t]=A(this,Gh,G1).call(this,e,t);const[s,i,r,a]=o(this,Ar).subarray(2,6),l=e-r,h=t-a;return Math.hypot(o(this,wl)*l,o(this,Al)*h)<=2?null:(o(this,gs).push(e,t),isNaN(s)?(o(this,Ar).set([r,a,e,t],2),o(this,$t).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(o(this,Ar)[0])&&o(this,$t).splice(6,6),o(this,Ar).set([s,i,r,a,e,t],0),o(this,$t).push(...ne.createBezierPoints(s,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(o(this,gs).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){b(this,wl,s),b(this,Al,i),b(this,vl,r),[e,t]=A(this,Gh,G1).call(this,e,t);const a=b(this,$t,[NaN,NaN,NaN,NaN,e,t]);b(this,gs,[e,t]);const l=o(this,Gt).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),o(this,Gt).push({line:a,points:o(this,gs)}),o(this,Ar).set(a,0),b(this,Ti,0),this.toSVGPath(),null}getLastElement(){return o(this,Gt).at(-1)}setLastElement(e){return o(this,Gt)?(o(this,Gt).push(e),b(this,$t,e.line),b(this,gs,e.points),b(this,Ti,0),{path:{d:this.toSVGPath()}}):o(this,yl).setLastElement(e)}removeLastElement(){if(!o(this,Gt))return o(this,yl).removeLastElement();o(this,Gt).pop(),b(this,ss,"");for(let e=0,t=o(this,Gt).length;e<t;e++){const{line:s,points:i}=o(this,Gt)[e];b(this,$t,s),b(this,gs,i),b(this,Ti,0),this.toSVGPath()}return{path:{d:o(this,ss)}}}toSVGPath(){const e=ne.svgRound(o(this,$t)[4]),t=ne.svgRound(o(this,$t)[5]);if(o(this,gs).length===2)return b(this,ss,`${o(this,ss)} M ${e} ${t} Z`),o(this,ss);if(o(this,gs).length<=6){const i=o(this,ss).lastIndexOf("M");b(this,ss,`${o(this,ss).slice(0,i)} M ${e} ${t}`),b(this,Ti,6)}if(o(this,gs).length===4){const i=ne.svgRound(o(this,$t)[10]),r=ne.svgRound(o(this,$t)[11]);return b(this,ss,`${o(this,ss)} L ${i} ${r}`),b(this,Ti,12),o(this,ss)}const s=[];o(this,Ti)===0&&(s.push(`M ${e} ${t}`),b(this,Ti,6));for(let i=o(this,Ti),r=o(this,$t).length;i<r;i+=6){const[a,l,h,c,u,d]=o(this,$t).slice(i,i+6).map(ne.svgRound);s.push(`C${a} ${l} ${h} ${c} ${u} ${d}`)}return b(this,ss,o(this,ss)+s.join(" ")),b(this,Ti,o(this,$t).length),o(this,ss)}getOutlines(e,t,s,i){const r=o(this,Gt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),o(this,yl).build(o(this,Gt),e,t,s,o(this,vl),o(this,$h),i),b(this,Ar,null),b(this,$t,null),b(this,Gt,null),b(this,ss,null),o(this,yl)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Ar=new WeakMap,$t=new WeakMap,Gt=new WeakMap,vl=new WeakMap,$h=new WeakMap,gs=new WeakMap,ss=new WeakMap,Ti=new WeakMap,yl=new WeakMap,wl=new WeakMap,Al=new WeakMap,Gh=new WeakSet,G1=function(e,t){return ne._normalizePoint(e,t,o(this,wl),o(this,Al),o(this,vl))};var bs,Af,xf,ri,xr,Sr,Vh,jh,xl,Vi,Hr,Zm,Zv,Qm,Qv,Jm,Jv;class Gf extends ne{constructor(){super(...arguments);g(this,Vi);g(this,Zm);g(this,Qm);g(this,Jm);g(this,bs,void 0);g(this,Af,0);g(this,xf,void 0);g(this,ri,void 0);g(this,xr,void 0);g(this,Sr,void 0);g(this,Vh,void 0);g(this,jh,void 0);g(this,xl,void 0)}build(t,s,i,r,a,l,h){b(this,xr,s),b(this,Sr,i),b(this,Vh,r),b(this,jh,a),b(this,xl,l),b(this,xf,h??0),b(this,ri,t),A(this,Qm,Qv).call(this)}get thickness(){return o(this,xl)}setLastElement(t){return o(this,ri).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return o(this,ri).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of o(this,ri)){if(t.push(`M${ne.svgRound(s[4])} ${ne.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${ne.svgRound(s[10])} ${ne.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[a,l,h,c,u,d]=s.subarray(i,i+6).map(ne.svgRound);t.push(`C${a} ${l} ${h} ${c} ${u} ${d}`)}}return t.join("")}serialize([t,s,i,r],a){const l=[],h=[],[c,u,d,f]=A(this,Zm,Zv).call(this);let p,w,y,x,S,E,T,_,M;switch(o(this,jh)){case 0:M=ne._rescale,p=t,w=s+r,y=i,x=-r,S=t+c*i,E=s+(1-u-f)*r,T=t+(c+d)*i,_=s+(1-u)*r;break;case 90:M=ne._rescaleAndSwap,p=t,w=s,y=i,x=r,S=t+u*i,E=s+c*r,T=t+(u+f)*i,_=s+(c+d)*r;break;case 180:M=ne._rescale,p=t+i,w=s,y=-i,x=r,S=t+(1-c-d)*i,E=s+u*r,T=t+(1-c)*i,_=s+(u+f)*r;break;case 270:M=ne._rescaleAndSwap,p=t+i,w=s+r,y=-i,x=-r,S=t+(1-u-f)*i,E=s+(1-c-d)*r,T=t+(1-u)*i,_=s+(1-c)*r;break}for(const{line:D,points:L}of o(this,ri))l.push(M(D,p,w,y,x,a?new Array(D.length):null)),h.push(M(L,p,w,y,x,a?new Array(L.length):null));return{lines:l,points:h,rect:[S,E,T,_]}}static deserialize(t,s,i,r,a,{paths:{lines:l,points:h},rotation:c,thickness:u}){const d=[];let f,p,w,y,x;switch(c){case 0:x=ne._rescale,f=-t/i,p=s/r+1,w=1/i,y=-1/r;break;case 90:x=ne._rescaleAndSwap,f=-s/r,p=-t/i,w=1/r,y=1/i;break;case 180:x=ne._rescale,f=t/i+1,p=-s/r,w=-1/i,y=1/r;break;case 270:x=ne._rescaleAndSwap,f=s/r+1,p=t/i+1,w=-1/r,y=-1/i;break}if(!l){l=[];for(const E of h){const T=E.length;if(T===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(T===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const _=new Float32Array(3*(T-2));l.push(_);let[M,D,L,F]=E.subarray(0,4);_.set([NaN,NaN,NaN,NaN,M,D],0);for(let N=4;N<T;N+=2){const W=E[N],$=E[N+1];_.set(ne.createBezierPoints(M,D,L,F,W,$),(N-2)*3),[M,D,L,F]=[L,F,W,$]}}}for(let E=0,T=l.length;E<T;E++)d.push({line:x(l[E].map(_=>_??NaN),f,p,w,y),points:x(h[E].map(_=>_??NaN),f,p,w,y)});const S=new this.prototype.constructor;return S.build(d,i,r,1,c,u,a),S}get box(){return o(this,bs)}updateProperty(t,s){return t==="stroke-width"?A(this,Jm,Jv).call(this,s):null}updateParentDimensions([t,s],i){const[r,a]=A(this,Vi,Hr).call(this);b(this,xr,t),b(this,Sr,s),b(this,Vh,i);const[l,h]=A(this,Vi,Hr).call(this),c=l-r,u=h-a,d=o(this,bs);return d[0]-=c,d[1]-=u,d[2]+=2*c,d[3]+=2*u,d}updateRotation(t){return b(this,Af,t),{path:{transform:this.rotationTransform}}}get viewBox(){return o(this,bs).map(ne.svgRound).join(" ")}get defaultProperties(){const[t,s]=o(this,bs);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ne.svgRound(t)} ${ne.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=o(this,bs);let i=0,r=0,a=0,l=0,h=0,c=0;switch(o(this,Af)){case 90:r=s/t,a=-t/s,h=t;break;case 180:i=-1,l=-1,h=t,c=s;break;case 270:r=-s/t,a=t/s,c=s;break;default:return""}return`matrix(${i} ${r} ${a} ${l} ${ne.svgRound(h)} ${ne.svgRound(c)})`}getPathResizingSVGProperties([t,s,i,r]){const[a,l]=A(this,Vi,Hr).call(this),[h,c,u,d]=o(this,bs);if(Math.abs(u-a)<=ne.PRECISION||Math.abs(d-l)<=ne.PRECISION){const x=t+i/2-(h+u/2),S=s+r/2-(c+d/2);return{path:{"transform-origin":`${ne.svgRound(t)} ${ne.svgRound(s)}`,transform:`${this.rotationTransform} translate(${x} ${S})`}}}const f=(i-2*a)/(u-2*a),p=(r-2*l)/(d-2*l),w=u/i,y=d/r;return{path:{"transform-origin":`${ne.svgRound(h)} ${ne.svgRound(c)}`,transform:`${this.rotationTransform} scale(${w} ${y}) translate(${ne.svgRound(a)} ${ne.svgRound(l)}) scale(${f} ${p}) translate(${ne.svgRound(-a)} ${ne.svgRound(-l)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[a,l]=A(this,Vi,Hr).call(this),h=o(this,bs),[c,u,d,f]=h;if(h[0]=t,h[1]=s,h[2]=i,h[3]=r,Math.abs(d-a)<=ne.PRECISION||Math.abs(f-l)<=ne.PRECISION){const S=t+i/2-(c+d/2),E=s+r/2-(u+f/2);for(const{line:T,points:_}of o(this,ri))ne._translate(T,S,E,T),ne._translate(_,S,E,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ne.svgRound(t)} ${ne.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(i-2*a)/(d-2*a),w=(r-2*l)/(f-2*l),y=-p*(c+a)+t+a,x=-w*(u+l)+s+l;if(p!==1||w!==1||y!==0||x!==0)for(const{line:S,points:E}of o(this,ri))ne._rescale(S,y,x,p,w,S),ne._rescale(E,y,x,p,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ne.svgRound(t)} ${ne.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,a]=i,l=o(this,bs),h=t-l[0],c=s-l[1];if(o(this,xr)===r&&o(this,Sr)===a)for(const{line:u,points:d}of o(this,ri))ne._translate(u,h,c,u),ne._translate(d,h,c,d);else{const u=o(this,xr)/r,d=o(this,Sr)/a;b(this,xr,r),b(this,Sr,a);for(const{line:f,points:p}of o(this,ri))ne._rescale(f,h,c,u,d,f),ne._rescale(p,h,c,u,d,p);l[2]*=u,l[3]*=d}return l[0]=t,l[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ne.svgRound(t)} ${ne.svgRound(s)}`}}}get defaultSVGProperties(){const t=o(this,bs);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ne.svgRound(t[0])} ${ne.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}bs=new WeakMap,Af=new WeakMap,xf=new WeakMap,ri=new WeakMap,xr=new WeakMap,Sr=new WeakMap,Vh=new WeakMap,jh=new WeakMap,xl=new WeakMap,Vi=new WeakSet,Hr=function(t=o(this,xl)){const s=o(this,xf)+t/2*o(this,Vh);return o(this,jh)%180===0?[s/o(this,xr),s/o(this,Sr)]:[s/o(this,Sr),s/o(this,xr)]},Zm=new WeakSet,Zv=function(){const[t,s,i,r]=o(this,bs),[a,l]=A(this,Vi,Hr).call(this,0);return[t+a,s+l,i-2*a,r-2*l]},Qm=new WeakSet,Qv=function(){const t=b(this,bs,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of o(this,ri)){if(r.length<=12){for(let h=4,c=r.length;h<c;h+=6)ae.pointBoundingBox(r[h],r[h+1],t);continue}let a=r[4],l=r[5];for(let h=6,c=r.length;h<c;h+=6){const[u,d,f,p,w,y]=r.subarray(h,h+6);ae.bezierBoundingBox(a,l,u,d,f,p,w,y,t),a=w,l=y}}const[s,i]=A(this,Vi,Hr).call(this);t[0]=ws(t[0]-s,0,1),t[1]=ws(t[1]-i,0,1),t[2]=ws(t[2]+s,0,1),t[3]=ws(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},Jm=new WeakSet,Jv=function(t){const[s,i]=A(this,Vi,Hr).call(this);b(this,xl,t);const[r,a]=A(this,Vi,Hr).call(this),[l,h]=[r-s,a-i],c=o(this,bs);return c[0]-=l,c[1]-=h,c[2]+=2*l,c[3]+=2*h,c};class _g extends Yv{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:et._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new _g(this._viewParameters);return e.updateAll(this),e}}var eg,e8;const t0=class t0 extends vp{constructor(t){super({...t,name:"inkEditor"});g(this,eg);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){et.initialize(t,s),this._defaultDrawingOptions=new _g(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return me(this,"typesMap",new Map([[Te.INK_THICKNESS,"stroke-width"],[Te.INK_COLOR,"stroke"],[Te.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,a){return new Ax(t,s,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,a,l){return Gf.deserialize(t,s,i,r,a,l)}static async deserialize(t,s,i){let r=null;if(t instanceof I3){const{data:{inkLists:l,rect:h,rotation:c,id:u,color:d,opacity:f,borderStyle:{rawWidth:p},popupRef:w,richText:y,contentsObj:x,creationDate:S,modificationDate:E},parent:{page:{pageNumber:T}}}=t;r=t={annotationType:be.INK,color:Array.from(d),thickness:p,opacity:f,paths:{points:l},boxes:null,pageIndex:T-1,rect:h.slice(0),rotation:c,annotationElementId:u,id:u,deleted:!1,popupRef:w,richText:y,comment:(x==null?void 0:x.str)||null,creationDate:S,modificationDate:E}}const a=await super.deserialize(t,s,i);return a._initialData=r,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new pp(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Te.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=t0.getDefaultDrawingOptions({stroke:ae.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":l}}=this,h=Object.assign(super.serialize(t),{color:et._colorManager.convert(r),opacity:a,thickness:l,paths:{lines:s,points:i}});return this.addComment(h),t?(h.isCopy=!0,h):this.annotationElementId&&!A(this,eg,e8).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s,popup:this.comment}),null}};eg=new WeakSet,e8=function(t){const{color:s,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,h)=>l!==s[h])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a},O(t0,"_type","ink"),O(t0,"_editorType",be.INK),O(t0,"_defaultDrawingOptions",null);let I2=t0;class B2 extends Gf{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const c1=8,gc=3;var Sl,Sf,N2,ji,tg,t8,sg,s8,kf,F2,Wh,V1,ig,i8,rg,r8,ng,n8,Tf,O2,Cf,z2,ag,a8;class Ft{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:i},r,a,l,h){let c=new OffscreenCanvas(1,1),u=c.getContext("2d",{alpha:!1});const d=200,f=u.font=`${s} ${i} ${d}px ${t}`,{actualBoundingBoxLeft:p,actualBoundingBoxRight:w,actualBoundingBoxAscent:y,actualBoundingBoxDescent:x,fontBoundingBoxAscent:S,fontBoundingBoxDescent:E,width:T}=u.measureText(e),_=1.5,M=Math.ceil(Math.max(Math.abs(p)+Math.abs(w)||0,T)*_),D=Math.ceil(Math.max(Math.abs(y)+Math.abs(x)||d,Math.abs(S)+Math.abs(E)||d)*_);c=new OffscreenCanvas(M,D),u=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),u.font=f,u.filter="grayscale(1)",u.fillStyle="white",u.fillRect(0,0,M,D),u.fillStyle="black",u.fillText(e,M*(_-1)/2,D*(3-_)/2);const L=A(this,Tf,O2).call(this,u.getImageData(0,0,M,D).data),F=A(this,ng,n8).call(this,L),N=A(this,Cf,z2).call(this,F),W=A(this,kf,F2).call(this,L,M,D,N);return this.processDrawnLines({lines:{curves:W,width:M,height:D},pageWidth:r,pageHeight:a,rotation:l,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,s,i,r){const[a,l,h]=A(this,ag,a8).call(this,e),[c,u]=A(this,rg,r8).call(this,a,l,h,Math.hypot(l,h)*o(this,Sl).sigmaSFactor,o(this,Sl).sigmaR,o(this,Sl).kernelSize),d=A(this,Cf,z2).call(this,u),f=A(this,kf,F2).call(this,c,l,h,d);return this.processDrawnLines({lines:{curves:f,width:l,height:h},pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:a,areContours:l}){i%180!==0&&([t,s]=[s,t]);const{curves:h,width:c,height:u}=e,d=e.thickness??0,f=[],p=Math.min(t/c,s/u),w=p/t,y=p/s,x=[];for(const{points:E}of h){const T=a?A(this,ig,i8).call(this,E):E;if(!T)continue;x.push(T);const _=T.length,M=new Float32Array(_),D=new Float32Array(3*(_===2?2:_-2));if(f.push({line:D,points:M}),_===2){M[0]=T[0]*w,M[1]=T[1]*y,D.set([NaN,NaN,NaN,NaN,M[0],M[1]],0);continue}let[L,F,N,W]=T;L*=w,F*=y,N*=w,W*=y,M.set([L,F,N,W],0),D.set([NaN,NaN,NaN,NaN,L,F],0);for(let $=4;$<_;$+=2){const q=M[$]=T[$]*w,se=M[$+1]=T[$+1]*y;D.set(ne.createBezierPoints(L,F,N,W,q,se),($-2)*3),[L,F,N,W]=[N,W,q,se]}}if(f.length===0)return null;const S=l?new B2:new Gf;return S.build(f,t,s,1,i,l?0:d,r),{outline:S,newCurves:x,areContours:l,thickness:d,width:c,height:u}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:i,height:r}){let a=1/0,l=-1/0,h=0;for(const T of e){h+=T.length;for(let _=2,M=T.length;_<M;_++){const D=T[_]-T[_-2];a=Math.min(a,D),l=Math.max(l,D)}}let c;a>=-128&&l<=127?c=Int8Array:a>=-32768&&l<=32767?c=Int16Array:c=Int32Array;const u=e.length,d=c1+gc*u,f=new Uint32Array(d);let p=0;f[p++]=d*Uint32Array.BYTES_PER_ELEMENT+(h-2*u)*c.BYTES_PER_ELEMENT,f[p++]=0,f[p++]=i,f[p++]=r,f[p++]=t?0:1,f[p++]=Math.max(0,Math.floor(s??0)),f[p++]=u,f[p++]=c.BYTES_PER_ELEMENT;for(const T of e)f[p++]=T.length-2,f[p++]=T[0],f[p++]=T[1];const w=new CompressionStream("deflate-raw"),y=w.writable.getWriter();await y.ready,y.write(f);const x=c.prototype.constructor;for(const T of e){const _=new x(T.length-2);for(let M=2,D=T.length;M<D;M++)_[M-2]=T[M]-T[M-2];y.write(_)}y.close();const S=await new Response(w.readable).arrayBuffer(),E=new Uint8Array(S);return r7(E)}static async decompressSignature(e){try{const t=F9(e),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),r=i.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,l=0;for await(const T of s)a||(a=new Uint8Array(new Uint32Array(T.buffer,0,4)[0])),a.set(T,l),l+=T.length;const h=new Uint32Array(a.buffer,0,a.length>>2),c=h[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const u=h[2],d=h[3],f=h[4]===0,p=h[5],w=h[6],y=h[7],x=[],S=(c1+gc*w)*Uint32Array.BYTES_PER_ELEMENT;let E;switch(y){case Int8Array.BYTES_PER_ELEMENT:E=new Int8Array(a.buffer,S);break;case Int16Array.BYTES_PER_ELEMENT:E=new Int16Array(a.buffer,S);break;case Int32Array.BYTES_PER_ELEMENT:E=new Int32Array(a.buffer,S);break}l=0;for(let T=0;T<w;T++){const _=h[gc*T+c1],M=new Float32Array(_+2);x.push(M);for(let D=0;D<gc-1;D++)M[D]=h[gc*T+c1+D+1];for(let D=0;D<_;D++)M[D+2]=M[D]+E[l++]}return{areContours:f,thickness:p,outlines:x,width:u,height:d}}catch(t){return pe(`decompressSignature: ${t}`),null}}}Sl=new WeakMap,Sf=new WeakSet,N2=function(e,t,s,i){return s-=e,i-=t,s===0?i>0?0:4:s===1?i+6:2-i},ji=new WeakMap,tg=new WeakSet,t8=function(e,t,s,i,r,a,l){const h=A(this,Sf,N2).call(this,s,i,r,a);for(let c=0;c<8;c++){const u=(-c+h-l+16)%8,d=o(this,ji)[2*u],f=o(this,ji)[2*u+1];if(e[(s+d)*t+(i+f)]!==0)return u}return-1},sg=new WeakSet,s8=function(e,t,s,i,r,a,l){const h=A(this,Sf,N2).call(this,s,i,r,a);for(let c=0;c<8;c++){const u=(c+h+l+16)%8,d=o(this,ji)[2*u],f=o(this,ji)[2*u+1];if(e[(s+d)*t+(i+f)]!==0)return u}return-1},kf=new WeakSet,F2=function(e,t,s,i){const r=e.length,a=new Int32Array(r);for(let u=0;u<r;u++)a[u]=e[u]<=i?1:0;for(let u=1;u<s-1;u++)a[u*t]=a[u*t+t-1]=0;for(let u=0;u<t;u++)a[u]=a[t*s-1-u]=0;let l=1,h;const c=[];for(let u=1;u<s-1;u++){h=1;for(let d=1;d<t-1;d++){const f=u*t+d,p=a[f];if(p===0)continue;let w=u,y=d;if(p===1&&a[f-1]===0)l+=1,y-=1;else if(p>=1&&a[f+1]===0)l+=1,y+=1,p>1&&(h=p);else{p!==1&&(h=Math.abs(p));continue}const x=[d,u],S=y===d+1,E={isHole:S,points:x,id:l,parent:0};c.push(E);let T;for(const $ of c)if($.id===h){T=$;break}T?T.isHole?E.parent=S?T.parent:h:E.parent=S?h:T.parent:E.parent=S?h:0;const _=A(this,tg,t8).call(this,a,t,u,d,w,y,0);if(_===-1){a[f]=-l,a[f]!==1&&(h=Math.abs(a[f]));continue}let M=o(this,ji)[2*_],D=o(this,ji)[2*_+1];const L=u+M,F=d+D;w=L,y=F;let N=u,W=d;for(;;){const $=A(this,sg,s8).call(this,a,t,N,W,w,y,1);M=o(this,ji)[2*$],D=o(this,ji)[2*$+1];const q=N+M,se=W+D;x.push(se,q);const z=N*t+W;if(a[z+1]===0?a[z]=-l:a[z]===1&&(a[z]=l),q===u&&se===d&&N===L&&W===F){a[f]!==1&&(h=Math.abs(a[f]));break}else w=N,y=W,N=q,W=se}}}return c},Wh=new WeakSet,V1=function(e,t,s,i){if(s-t<=4){for(let L=t;L<s-2;L+=2)i.push(e[L],e[L+1]);return}const r=e[t],a=e[t+1],l=e[s-4]-r,h=e[s-3]-a,c=Math.hypot(l,h),u=l/c,d=h/c,f=u*a-d*r,p=h/l,w=1/c,y=Math.atan(p),x=Math.cos(y),S=Math.sin(y),E=w*(Math.abs(x)+Math.abs(S)),T=w*(1-E+E**2),_=Math.max(Math.atan(Math.abs(S+x)*T),Math.atan(Math.abs(S-x)*T));let M=0,D=t;for(let L=t+2;L<s-2;L+=2){const F=Math.abs(f-u*e[L+1]+d*e[L]);F>M&&(D=L,M=F)}M>(c*_)**2?(A(this,Wh,V1).call(this,e,t,D+2,i),A(this,Wh,V1).call(this,e,D,s,i)):i.push(r,a)},ig=new WeakSet,i8=function(e){const t=[],s=e.length;return A(this,Wh,V1).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},rg=new WeakSet,r8=function(e,t,s,i,r,a){const l=new Float32Array(a**2),h=-2*i**2,c=a>>1;for(let y=0;y<a;y++){const x=(y-c)**2;for(let S=0;S<a;S++)l[y*a+S]=Math.exp((x+(S-c)**2)/h)}const u=new Float32Array(256),d=-2*r**2;for(let y=0;y<256;y++)u[y]=Math.exp(y**2/d);const f=e.length,p=new Uint8Array(f),w=new Uint32Array(256);for(let y=0;y<s;y++)for(let x=0;x<t;x++){const S=y*t+x,E=e[S];let T=0,_=0;for(let D=0;D<a;D++){const L=y+D-c;if(!(L<0||L>=s))for(let F=0;F<a;F++){const N=x+F-c;if(N<0||N>=t)continue;const W=e[L*t+N],$=l[D*a+F]*u[Math.abs(W-E)];T+=W*$,_+=$}}const M=p[S]=Math.round(T/_);w[M]++}return[p,w]},ng=new WeakSet,n8=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},Tf=new WeakSet,O2=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let i=-1/0,r=1/0;for(let l=0,h=s.length;l<h;l++){const c=s[l]=e[l<<2];i=Math.max(i,c),r=Math.min(r,c)}const a=255/(i-r);for(let l=0,h=s.length;l<h;l++)s[l]=(s[l]-r)*a;return s},Cf=new WeakSet,z2=function(e){let t,s=-1/0,i=-1/0;const r=e.findIndex(h=>h!==0);let a=r,l=r;for(t=r;t<256;t++){const h=e[t];h>s&&(t-a>i&&(i=t-a,l=t-1),s=h,a=t)}for(t=l-1;t>=0&&!(e[t]>e[t+1]);t--);return t},ag=new WeakSet,a8=function(e){const t=e,{width:s,height:i}=e,{maxDim:r}=o(this,Sl);let a=s,l=i;if(s>r||i>r){let f=s,p=i,w=Math.log2(Math.max(s,i)/r);const y=Math.floor(w);w=w===y?y-1:y;for(let S=0;S<w;S++){a=Math.ceil(f/2),l=Math.ceil(p/2);const E=new OffscreenCanvas(a,l);E.getContext("2d").drawImage(e,0,0,f,p,0,0,a,l),f=a,p=l,e!==t&&e.close(),e=E.transferToImageBitmap()}const x=Math.min(r/a,r/l);a=Math.round(a*x),l=Math.round(l*x)}const c=new OffscreenCanvas(a,l).getContext("2d",{willReadFrequently:!0});c.fillStyle="white",c.fillRect(0,0,a,l),c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,a,l);const u=c.getImageData(0,0,a,l).data;return[A(this,Tf,O2).call(this,u),a,l]},g(Ft,Sf),g(Ft,tg),g(Ft,sg),g(Ft,kf),g(Ft,Wh),g(Ft,ig),g(Ft,rg),g(Ft,ng),g(Ft,Tf),g(Ft,Cf),g(Ft,ag),g(Ft,Sl,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),g(Ft,ji,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class B3 extends Yv{constructor(){super(),super.updateProperties({fill:et._defaultLineColor,"stroke-width":0})}clone(){const e=new B3;return e.updateAll(this),e}}class N3 extends _g{constructor(e){super(e),super.updateProperties({stroke:et._defaultLineColor,"stroke-width":1})}clone(){const e=new N3(this._viewParameters);return e.updateAll(this),e}}var Ea,kr,_a,kl;const Hs=class Hs extends vp{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});g(this,Ea,!1);g(this,kr,null);g(this,_a,null);g(this,kl,null);this._willKeepAspectRatio=!0,b(this,_a,t.signatureData||null),b(this,kr,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){et.initialize(t,s),this._defaultDrawingOptions=new B3,this._defaultDrawnSignatureOptions=new N3(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return me(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!o(this,kr)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(o(this,_a)){const{lines:r,mustSmooth:a,areContours:l,description:h,uuid:c,heightInPage:u}=o(this,_a),{rawDims:{pageWidth:d,pageHeight:f},rotation:p}=this.parent.viewport,w=Ft.processDrawnLines({lines:r,pageWidth:d,pageHeight:f,rotation:p,innerMargin:Hs._INNER_MARGIN,mustSmooth:a,areContours:l});this.addSignature(w,u,h,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:o(this,kr)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){b(this,kl,t),this.addEditToolbar()}getUuid(){return o(this,kl)}get description(){return o(this,kr)}set description(t){b(this,kr,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:i,width:r,height:a}=o(this,_a),l=Math.max(r,a),h=Ft.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:i,width:r,height:a},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:h.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,s,i,r){const{x:a,y:l}=this,{outline:h}=b(this,_a,t);b(this,Ea,h instanceof B2),this.description=i;let c;o(this,Ea)?c=Hs.getDefaultDrawingOptions():(c=Hs._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":h.thickness})),this._addOutlines({drawOutlines:h,drawingOptions:c});const[,u]=this.pageDimensions;let d=s/u;d=d>=1?.5:d,this.width*=d/this.height,this.width>=1&&(d*=.9/this.width,this.width=.9),this.height=d,this.setDims(),this.x=a,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Ft.process(t,s,i,r,Hs._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:i,pageHeight:r},rotation:a}=this.parent.viewport;return Ft.extractContoursFromText(t,s,i,r,a,Hs._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Ft.processDrawnLines({lines:t,pageWidth:s,pageHeight:i,rotation:r,innerMargin:Hs._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=Hs.getDefaultDrawingOptions():(this._drawingOptions=Hs._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:o(this,Ea),color:[0,0,0],thickness:o(this,Ea)?0:r});return this.addComment(a),t?(a.paths={lines:s,points:i},a.uuid=o(this,kl),a.isCopy=!0):a.lines=s,o(this,kr)&&(a.accessibilityData={type:"Figure",alt:o(this,kr)}),a}static deserializeDraw(t,s,i,r,a,l){return l.areContours?B2.deserialize(t,s,i,r,a,l):Gf.deserialize(t,s,i,r,a,l)}static async deserialize(t,s,i){var a;const r=await super.deserialize(t,s,i);return b(r,Ea,t.areContours),r.description=((a=t.accessibilityData)==null?void 0:a.alt)||"",b(r,kl,t.uuid),r}};Ea=new WeakMap,kr=new WeakMap,_a=new WeakMap,kl=new WeakMap,O(Hs,"_type","signature"),O(Hs,"_editorType",be.SIGNATURE),O(Hs,"_defaultDrawingOptions",null);let H2=Hs;var ot,Vt,Ma,Sn,Da,Xh,kn,Tl,Tr,ni,Yh,Cl,Oc,El,zc,Kh,j1,Zh,W1,Qh,X1,Ef,q2,Jh,Y1,og,o8;class U2 extends et{constructor(t){super({...t,name:"stampEditor"});g(this,Cl);g(this,El);g(this,Kh);g(this,Zh);g(this,Qh);g(this,Ef);g(this,Jh);g(this,og);g(this,ot,null);g(this,Vt,null);g(this,Ma,null);g(this,Sn,null);g(this,Da,null);g(this,Xh,"");g(this,kn,null);g(this,Tl,!1);g(this,Tr,null);g(this,ni,!1);g(this,Yh,!1);b(this,Sn,t.bitmapUrl),b(this,Da,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){et.initialize(t,s)}static isHandlingMimeForPasting(t){return C4.includes(t)}static paste(t,s){s.pasteEditor({mode:be.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:l}=t||this.copyCanvas(null,null,!0).imageData,h=await i.guess({name:"altText",request:{data:r,width:a,height:l,channels:r.length/(a*l)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const c=h.output;return await this.setGuessedAltText(c),s&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;o(this,Vt)&&(b(this,ot,null),this._uiManager.imageManager.deleteId(o(this,Vt)),(t=o(this,kn))==null||t.remove(),b(this,kn,null),o(this,Tr)&&(clearTimeout(o(this,Tr)),b(this,Tr,null))),super.remove()}rebuild(){if(!this.parent){o(this,Vt)&&A(this,Kh,j1).call(this);return}super.rebuild(),this.div!==null&&(o(this,Vt)&&o(this,kn)===null&&A(this,Kh,j1).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(o(this,Ma)||o(this,ot)||o(this,Sn)||o(this,Da)||o(this,Vt)||o(this,Tl))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.createAltText(),o(this,Tl)||(o(this,ot)?A(this,Zh,W1).call(this):A(this,Kh,j1).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(b(this,Vt,i),r&&b(this,ot,r),b(this,Tl,!1),A(this,Zh,W1).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;o(this,Tr)!==null&&clearTimeout(o(this,Tr)),b(this,Tr,setTimeout(()=>{b(this,Tr,null),A(this,Ef,q2).call(this)},200))}copyCanvas(t,s,i=!1){t||(t=224);const{width:r,height:a}=o(this,ot),l=new Dr;let h=o(this,ot),c=r,u=a,d=null;if(s){if(r>s||a>s){const L=Math.min(s/r,s/a);c=Math.floor(r*L),u=Math.floor(a*L)}d=document.createElement("canvas");const p=d.width=Math.ceil(c*l.sx),w=d.height=Math.ceil(u*l.sy);o(this,ni)||(h=A(this,Qh,X1).call(this,p,w));const y=d.getContext("2d");y.filter=this._uiManager.hcmFilter;let x="white",S="#cfcfd8";this._uiManager.hcmFilter!=="none"?S="black":$9.isDarkMode&&(x="#8f8f9d",S="#42414d");const E=15,T=E*l.sx,_=E*l.sy,M=new OffscreenCanvas(T*2,_*2),D=M.getContext("2d");D.fillStyle=x,D.fillRect(0,0,T*2,_*2),D.fillStyle=S,D.fillRect(0,0,T,_),D.fillRect(T,_,T,_),y.fillStyle=y.createPattern(M,"repeat"),y.fillRect(0,0,p,w),y.drawImage(h,0,0,h.width,h.height,0,0,p,w)}let f=null;if(i){let p,w;if(l.symmetric&&h.width<t&&h.height<t)p=h.width,w=h.height;else if(h=o(this,ot),r>t||a>t){const S=Math.min(t/r,t/a);p=Math.floor(r*S),w=Math.floor(a*S),o(this,ni)||(h=A(this,Qh,X1).call(this,p,w))}const x=new OffscreenCanvas(p,w).getContext("2d",{willReadFrequently:!0});x.drawImage(h,0,0,h.width,h.height,0,0,p,w),f={width:p,height:w,data:x.getImageData(0,0,p,w).data}}return{canvas:d,width:c,height:u,imageData:f}}static async deserialize(t,s,i){var x;let r=null,a=!1;if(t instanceof Sv){const{data:{rect:S,rotation:E,id:T,structParent:_,popupRef:M,richText:D,contentsObj:L,creationDate:F,modificationDate:N},container:W,parent:{page:{pageNumber:$}},canvas:q}=t;let se,z;q?(delete t.canvas,{id:se,bitmap:z}=i.imageManager.getFromCanvas(W.id,q),q.remove()):(a=!0,t._hasNoCanvas=!0);const ee=((x=await s._structTree.getAriaAttributes(`${Kl}${T}`))==null?void 0:x.get("aria-label"))||"";r=t={annotationType:be.STAMP,bitmapId:se,bitmap:z,pageIndex:$-1,rect:S.slice(0),rotation:E,annotationElementId:T,id:T,deleted:!1,accessibilityData:{decorative:!1,altText:ee},isSvg:!1,structParent:_,popupRef:M,richText:D,comment:(L==null?void 0:L.str)||null,creationDate:F,modificationDate:N}}const l=await super.deserialize(t,s,i),{rect:h,bitmap:c,bitmapUrl:u,bitmapId:d,isSvg:f,accessibilityData:p}=t;a?(i.addMissingCanvas(t.id,l),b(l,Tl,!0)):d&&i.imageManager.isValidId(d)?(b(l,Vt,d),c&&b(l,ot,c)):b(l,Sn,u),b(l,ni,f);const[w,y]=l.pageDimensions;return l.width=(h[2]-h[0])/w,l.height=(h[3]-h[1])/y,p&&(l.altTextData=p),l._initialData=r,t.comment&&l.setCommentData(t),b(l,Yh,!!r),l}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:o(this,Vt),isSvg:o(this,ni)});if(this.addComment(i),t)return i.bitmapUrl=A(this,Jh,Y1).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const h=A(this,og,o8).call(this,i);return h.isSame?null:(h.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(s===null)return i;s.stamps||(s.stamps=new Map);const l=o(this,ni)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(o(this,Vt)))s.stamps.set(o(this,Vt),{area:l,serialized:i}),i.bitmap=A(this,Jh,Y1).call(this,!1);else if(o(this,ni)){const h=s.stamps.get(o(this,Vt));l>h.area&&(h.area=l,h.serialized.bitmap.close(),h.serialized.bitmap=A(this,Jh,Y1).call(this,!1))}return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}ot=new WeakMap,Vt=new WeakMap,Ma=new WeakMap,Sn=new WeakMap,Da=new WeakMap,Xh=new WeakMap,kn=new WeakMap,Tl=new WeakMap,Tr=new WeakMap,ni=new WeakMap,Yh=new WeakMap,Cl=new WeakSet,Oc=function(t,s=!1){if(!t){this.remove();return}b(this,ot,t.bitmap),s||(b(this,Vt,t.id),b(this,ni,t.isSvg)),t.file&&b(this,Xh,t.file.name),A(this,Zh,W1).call(this)},El=new WeakSet,zc=function(){if(b(this,Ma,null),this._uiManager.enableWaiting(!1),!!o(this,kn)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,ot)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,ot)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Kh=new WeakSet,j1=function(){if(o(this,Vt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(o(this,Vt)).then(i=>A(this,Cl,Oc).call(this,i,!0)).finally(()=>A(this,El,zc).call(this));return}if(o(this,Sn)){const i=o(this,Sn);b(this,Sn,null),this._uiManager.enableWaiting(!0),b(this,Ma,this._uiManager.imageManager.getFromUrl(i).then(r=>A(this,Cl,Oc).call(this,r)).finally(()=>A(this,El,zc).call(this)));return}if(o(this,Da)){const i=o(this,Da);b(this,Da,null),this._uiManager.enableWaiting(!0),b(this,Ma,this._uiManager.imageManager.getFromFile(i).then(r=>A(this,Cl,Oc).call(this,r)).finally(()=>A(this,El,zc).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=C4.join(",");const s=this._uiManager._signal;b(this,Ma,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),A(this,Cl,Oc).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>A(this,El,zc).call(this))),t.click()},Zh=new WeakSet,W1=function(){var c;const{div:t}=this;let{width:s,height:i}=o(this,ot);const[r,a]=this.pageDimensions,l=.75;if(this.width)s=this.width*r,i=this.height*a;else if(s>l*r||i>l*a){const u=Math.min(l*r/s,l*a/i);s*=u,i*=u}this._uiManager.enableWaiting(!1);const h=b(this,kn,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=s/r,this.height=i/a,this.setDims(),(c=this._initialOptions)!=null&&c.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),A(this,Ef,q2).call(this),o(this,Yh)||(this.parent.addUndoableEditor(this),b(this,Yh,!0)),this._reportTelemetry({action:"inserted_image"}),o(this,Xh)&&this.div.setAttribute("aria-description",o(this,Xh)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Qh=new WeakSet,X1=function(t,s){const{width:i,height:r}=o(this,ot);let a=i,l=r,h=o(this,ot);for(;a>2*t||l>2*s;){const c=a,u=l;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),l>2*s&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const d=new OffscreenCanvas(a,l);d.getContext("2d").drawImage(h,0,0,c,u,0,0,a,l),h=d.transferToImageBitmap()}return h},Ef=new WeakSet,q2=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,a=new Dr,l=Math.ceil(i*t*a.sx),h=Math.ceil(r*s*a.sy),c=o(this,kn);if(!c||c.width===l&&c.height===h)return;c.width=l,c.height=h;const u=o(this,ni)?o(this,ot):A(this,Qh,X1).call(this,l,h),d=c.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(u,0,0,u.width,u.height,0,0,l,h)},Jh=new WeakSet,Y1=function(t){if(t){if(o(this,ni)){const r=this._uiManager.imageManager.getSvgUrl(o(this,Vt));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=o(this,ot),s.getContext("2d").drawImage(o(this,ot),0,0),s.toDataURL()}if(o(this,ni)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*qa.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*qa.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(r,a);return l.getContext("2d").drawImage(o(this,ot),0,0,o(this,ot).width,o(this,ot).height,0,0,r,a),l.transferToImageBitmap()}return structuredClone(o(this,ot))},og=new WeakSet,o8=function(t){var l;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,a=(((l=t.accessibilityData)==null?void 0:l.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},O(U2,"_type","stamp"),O(U2,"_editorType",be.STAMP);var _l,ec,Ra,Pa,Tn,Ps,La,tc,sc,Wi,Cn,jt,En,Ia,ic,le,Ba,_f,G2,lg,l8,Ci,sr,Mf,V2,Df,j2,rc,K1;const Li=class Li{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:l,textLayer:h,viewport:c,l10n:u}){g(this,_f);g(this,lg);g(this,Ci);g(this,Mf);g(this,Df);g(this,rc);g(this,_l,void 0);g(this,ec,!1);g(this,Ra,null);g(this,Pa,null);g(this,Tn,null);g(this,Ps,new Map);g(this,La,!1);g(this,tc,!1);g(this,sc,!1);g(this,Wi,null);g(this,Cn,null);g(this,jt,null);g(this,En,null);g(this,Ia,null);g(this,ic,-1);g(this,le,void 0);const d=[...o(Li,Ba).values()];if(!Li._initialized){Li._initialized=!0;for(const f of d)f.initialize(u,e)}e.registerEditorTypes(d),b(this,le,e),this.pageIndex=t,this.div=s,b(this,_l,r),b(this,Ra,a),this.viewport=c,b(this,jt,h),this.drawLayer=l,this._structTree=i,o(this,le).addLayer(this)}get isEmpty(){return o(this,Ps).size===0}get isInvisible(){return this.isEmpty&&o(this,le).getMode()===be.NONE}updateToolbar(e){o(this,le).updateToolbar(e)}updateMode(e=o(this,le).getMode()){switch(A(this,rc,K1).call(this),e){case be.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case be.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case be.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===be.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const s of o(Li,Ba).values())t.toggle(`${s._type}Editing`,e===s._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=o(this,jt))==null?void 0:t.div)}setEditingState(e){o(this,le).setEditingState(e)}addCommands(e){o(this,le).addCommands(e)}cleanUndoStack(e){o(this,le).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=o(this,Ra))==null||t.togglePointerEvents(e)}async enable(){var s;b(this,sc,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(s=o(this,Ia))==null||s.abort(),b(this,Ia,null);const e=new Set;for(const i of o(this,_f,G2))i.enableEditing(),i.show(!0),i.annotationElementId&&(o(this,le).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=o(this,Ra);if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),o(this,le).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}b(this,sc,!1),o(this,le)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var i;if(b(this,tc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),o(this,jt)&&!o(this,Ia)){b(this,Ia,new AbortController);const r=o(this,le).combinedSignal(o(this,Ia));o(this,jt).div.addEventListener("pointerdown",a=>{const{clientX:h,clientY:c,timeStamp:u}=a,d=o(this,ic);if(u-d>500){b(this,ic,u);return}b(this,ic,-1);const{classList:f}=this.div;f.toggle("getElements",!0);const p=document.elementsFromPoint(h,c);if(f.toggle("getElements",!1),!this.div.contains(p[0]))return;let w;const y=new RegExp(`^${Wc}[0-9]+$`);for(const S of p)if(y.test(S.id)){w=S.id;break}if(!w)return;const x=o(this,Ps).get(w);(x==null?void 0:x.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),x.dblclick(a))},{signal:r,capture:!0})}const e=o(this,Ra),t=[];if(e){const r=new Map,a=new Map;for(const h of o(this,_f,G2)){if(h.disableEditing(),!h.annotationElementId){t.push(h);continue}if(h.serialize()!==null){r.set(h.annotationElementId,h);continue}else a.set(h.annotationElementId,h);(i=this.getEditableAnnotation(h.annotationElementId))==null||i.show(),h.remove()}const l=e.getEditableAnnotations();for(const h of l){const{id:c}=h.data;if(o(this,le).isDeletedAnnotationElement(c)){h.updateEdited({deleted:!0});continue}let u=a.get(c);if(u){u.resetAnnotationElement(h),u.show(!1),h.show();continue}u=r.get(c),u&&(o(this,le).addChangedExistingAnnotation(u),u.renderAnnotationElement(h)&&u.show(!1)),h.show()}}A(this,rc,K1).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of o(Li,Ba).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),b(this,tc,!1)}getEditableAnnotation(e){var t;return((t=o(this,Ra))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){o(this,le).getActive()!==e&&o(this,le).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=o(this,jt))!=null&&e.div&&!o(this,En)){b(this,En,new AbortController);const t=o(this,le).combinedSignal(o(this,En));o(this,jt).div.addEventListener("pointerdown",A(this,lg,l8).bind(this),{signal:t}),o(this,jt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=o(this,jt))!=null&&e.div&&o(this,En)&&(o(this,En).abort(),b(this,En,null),o(this,jt).div.classList.remove("highlighting"))}enableClick(){if(o(this,Pa))return;b(this,Pa,new AbortController);const e=o(this,le).combinedSignal(o(this,Pa));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=o(this,Pa))==null||e.abort(),b(this,Pa,null)}attach(e){o(this,Ps).set(e.id,e);const{annotationElementId:t}=e;t&&o(this,le).isDeletedAnnotationElement(t)&&o(this,le).removeDeletedAnnotationElement(e)}detach(e){var t;o(this,Ps).delete(e.id),(t=o(this,_l))==null||t.removePointerInTextLayer(e.contentDiv),!o(this,tc)&&e.annotationElementId&&o(this,le).addDeletedAnnotationElement(e)}remove(e){this.detach(e),o(this,le).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(o(this,le).addDeletedAnnotationElement(e),et.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),o(this,le).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!o(this,sc)),o(this,le).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!o(this,Tn)&&(e._focusEventsAllowed=!1,b(this,Tn,setTimeout(()=>{b(this,Tn,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:o(this,le)._signal}),t.focus())},0))),e._structTreeParentId=(s=o(this,_l))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getEditorByUID(e){for(const t of o(this,Ps).values())if(t.uid===e)return t;return null}getNextId(){return o(this,le).getId()}combinedSignal(e){return o(this,le).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=o(this,Ci,sr))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await o(this,le).updateMode(e.mode);const{offsetX:s,offsetY:i}=A(this,Df,j2).call(this),r=this.getNextId(),a=A(this,Mf,V2).call(this,{parent:this,id:r,x:s,y:i,uiManager:o(this,le),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=o(Li,Ba).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,o(this,le)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=A(this,Mf,V2).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:o(this,le),isCentered:t,...s});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(A(this,Df,j2).call(this),!0,e)}setSelected(e){o(this,le).setSelected(e)}toggleSelected(e){o(this,le).toggleSelected(e)}unselect(e){o(this,le).unselect(e)}pointerup(e){var i;const{isMac:t}=rs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!o(this,La)||(b(this,La,!1),(i=o(this,Ci,sr))!=null&&i.isDrawer&&o(this,Ci,sr).supportMultipleDrawings))return;if(!o(this,ec)){b(this,ec,!0);return}const s=o(this,le).getMode();if(s===be.STAMP||s===be.SIGNATURE){o(this,le).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(o(this,le).getMode()===be.HIGHLIGHT&&this.enableTextSelection(),o(this,La)){b(this,La,!1);return}const{isMac:t}=rs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(b(this,La,!0),(i=o(this,Ci,sr))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=o(this,le).getActive();b(this,ec,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),o(this,Wi)){o(this,Ci,sr).startDrawing(this,o(this,le),!1,e);return}o(this,le).setCurrentDrawingSession(this),b(this,Wi,new AbortController);const t=o(this,le).combinedSignal(o(this,Wi));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(b(this,Cn,null),this.commitOrRemove())},{signal:t}),o(this,Ci,sr).startDrawing(this,o(this,le),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&b(this,Cn,t);return}o(this,Cn)&&setTimeout(()=>{var t;(t=o(this,Cn))==null||t.focus(),b(this,Cn,null)},0)}endDrawingSession(e=!1){return o(this,Wi)?(o(this,le).setCurrentDrawingSession(null),o(this,Wi).abort(),b(this,Wi,null),b(this,Cn,null),o(this,Ci,sr).endDrawing(e)):null}findNewParent(e,t,s){const i=o(this,le).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return o(this,Wi)?(this.endDrawingSession(),!0):!1}onScaleChanging(){o(this,Wi)&&o(this,Ci,sr).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=o(this,le).getActive())==null?void 0:e.parent)===this&&(o(this,le).commitOrRemove(),o(this,le).setActiveEditor(null)),o(this,Tn)&&(clearTimeout(o(this,Tn)),b(this,Tn,null));for(const s of o(this,Ps).values())(t=o(this,_l))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,o(this,Ps).clear(),o(this,le).removeLayer(this)}render({viewport:e}){this.viewport=e,Rl(this.div,e);for(const t of o(this,le).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){o(this,le).commitOrRemove(),A(this,rc,K1).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Rl(this.div,{rotation:s}),t!==s)for(const i of o(this,Ps).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return o(this,le).viewParameters.realScale}};_l=new WeakMap,ec=new WeakMap,Ra=new WeakMap,Pa=new WeakMap,Tn=new WeakMap,Ps=new WeakMap,La=new WeakMap,tc=new WeakMap,sc=new WeakMap,Wi=new WeakMap,Cn=new WeakMap,jt=new WeakMap,En=new WeakMap,Ia=new WeakMap,ic=new WeakMap,le=new WeakMap,Ba=new WeakMap,_f=new WeakSet,G2=function(){return o(this,Ps).size!==0?o(this,Ps).values():o(this,le).getEditors(this.pageIndex)},lg=new WeakSet,l8=function(e){o(this,le).unselectAll();const{target:t}=e;if(t===o(this,jt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&o(this,jt).div.contains(t)){const{isMac:s}=rs.platform;if(e.button!==0||e.ctrlKey&&s)return;o(this,le).showAllEditors("highlight",!0,!0),o(this,jt).div.classList.add("free"),this.toggleDrawing(),bp.startHighlighting(this,o(this,le).direction==="ltr",{target:o(this,jt).div,x:e.x,y:e.y}),o(this,jt).div.addEventListener("pointerup",()=>{o(this,jt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:o(this,le)._signal}),e.preventDefault()}},Ci=new WeakSet,sr=function(){return o(Li,Ba).get(o(this,le).getMode())},Mf=new WeakSet,V2=function(e){const t=o(this,Ci,sr);return t?new t.prototype.constructor(e):null},Df=new WeakSet,j2=function(){const{x:e,y:t,width:s,height:i}=this.boundingClientRect,r=Math.max(0,e),a=Math.max(0,t),l=Math.min(window.innerWidth,e+s),h=Math.min(window.innerHeight,t+i),c=(r+l)/2-e,u=(a+h)/2-t,[d,f]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:d,offsetY:f}},rc=new WeakSet,K1=function(){for(const e of o(this,Ps).values())e.isEmpty()&&e.remove()},O(Li,"_initialized",!1),g(Li,Ba,new Map([k2,I2,U2,bp,H2].map(e=>[e._editorType,e])));let $2=Li;var Xi,vs,Ml,Rf,hg,h8,Pf,X2,cg,c8,Lf,Y2;const It=class It{constructor({pageIndex:e}){g(this,Pf);g(this,cg);g(this,Lf);g(this,Xi,null);g(this,vs,new Map);g(this,Ml,new Map);this.pageIndex=e}setParent(e){if(!o(this,Xi)){b(this,Xi,e);return}if(o(this,Xi)!==e){if(o(this,vs).size>0)for(const t of o(this,vs).values())t.remove(),e.append(t);b(this,Xi,e)}}static get _svgFactory(){return me(this,"_svgFactory",new mp)}draw(e,t=!1,s=!1){const i=Lt(It,Rf)._++,r=A(this,Pf,X2).call(this),a=It._svgFactory.createElement("defs");r.append(a);const l=It._svgFactory.createElement("path");a.append(l);const h=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",h),l.setAttribute("vector-effect","non-scaling-stroke"),t&&o(this,Ml).set(i,l);const c=s?A(this,cg,c8).call(this,a,h):null,u=It._svgFactory.createElement("use");return r.append(u),u.setAttribute("href",`#${h}`),this.updateProperties(r,e),o(this,vs).set(i,r),{id:i,clipPathId:`url(#${c})`}}drawOutline(e,t){const s=Lt(It,Rf)._++,i=A(this,Pf,X2).call(this),r=It._svgFactory.createElement("defs");i.append(r);const a=It._svgFactory.createElement("path");r.append(a);const l=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const d=It._svgFactory.createElement("mask");r.append(d),h=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",h),d.setAttribute("maskUnits","objectBoundingBox");const f=It._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=It._svgFactory.createElement("use");d.append(p),p.setAttribute("href",`#${l}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const c=It._svgFactory.createElement("use");i.append(c),c.setAttribute("href",`#${l}`),h&&c.setAttribute("mask",`url(#${h})`);const u=c.cloneNode();return i.append(u),c.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(i,e),o(this,vs).set(s,i),s}finalizeDraw(e,t){o(this,Ml).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var h;if(!t)return;const{root:s,bbox:i,rootClass:r,path:a}=t,l=typeof e=="number"?o(this,vs).get(e):e;if(l){if(s&&A(this,Lf,Y2).call(this,l,s),i&&A(h=It,hg,h8).call(h,l,i),r){const{classList:c}=l;for(const[u,d]of Object.entries(r))c.toggle(u,d)}if(a){const u=l.firstElementChild.firstElementChild;A(this,Lf,Y2).call(this,u,a)}}}updateParent(e,t){if(t===this)return;const s=o(this,vs).get(e);s&&(o(t,Xi).append(s),o(this,vs).delete(e),o(t,vs).set(e,s))}remove(e){o(this,Ml).delete(e),o(this,Xi)!==null&&(o(this,vs).get(e).remove(),o(this,vs).delete(e))}destroy(){b(this,Xi,null);for(const e of o(this,vs).values())e.remove();o(this,vs).clear(),o(this,Ml).clear()}};Xi=new WeakMap,vs=new WeakMap,Ml=new WeakMap,Rf=new WeakMap,hg=new WeakSet,h8=function(e,[t,s,i,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*r}%`},Pf=new WeakSet,X2=function(){const e=It._svgFactory.create(1,1,!0);return o(this,Xi).append(e),e.setAttribute("aria-hidden",!0),e},cg=new WeakSet,c8=function(e,t){const s=It._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=It._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},Lf=new WeakSet,Y2=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},g(It,hg),g(It,Rf,0);let W2=It;globalThis._pdfjsTestingUtils={HighlightOutliner:C2};globalThis.pdfjsLib={AbortException:Ua,AnnotationEditorLayer:$2,AnnotationEditorParamsType:Te,AnnotationEditorType:be,AnnotationEditorUIManager:Pl,AnnotationLayer:x2,AnnotationMode:On,AnnotationType:Mt,applyOpacity:V9,build:QA,ColorPicker:fp,createValidAbsoluteUrl:e7,CSSConstants:G9,DOMSVGFactory:mp,DrawLayer:W2,FeatureTest:rs,fetchData:zf,findContrastColor:j9,getDocument:lv,getFilenameFromUrl:O9,getPdfFilenameFromUrl:z9,getRGB:Uf,getUuid:i7,getXfaPageViewport:U9,GlobalWorkerOptions:Qi,ImageKind:b1,InvalidPDFException:k4,isDataScheme:Cg,isPdfFile:M3,isValidExplicitDest:sA,MathClamp:ws,noContextMenu:Di,normalizeUnicode:B9,OPS:Xc,OutputScale:Dr,PasswordResponses:C9,PDFDataRangeTransport:hv,PDFDateString:op,PDFWorker:Zc,PermissionFlag:T9,PixelsPerInch:qa,RenderingCancelledException:_3,renderRichText:a7,ResponseException:ap,setLayerDimensions:Rl,shadow:me,SignatureExtractor:Ft,stopEvent:St,SupportedImageMimeTypes:C4,TextLayer:Kc,TouchManager:hp,updateUrlHash:t7,Util:ae,VerbosityLevel:Sg,version:ZA,XfaLayer:n7};const xx="/assets/pdf.worker-8cc47385.mjs";Qi&&(Qi.workerSrc=xx);const Sx=["text/plain",".txt",".md",".log",".csv",".json",".tsv",".text","application/pdf",".pdf"].join(","),kx=2*1024*1024,K2=2e4,Tx=[".txt",".md",".log",".csv",".json",".tsv"];function Cx(n){var e;return n.type==="application/pdf"||((e=n.name)==null?void 0:e.toLowerCase().endsWith(".pdf"))}function Ex(n){var t;if(n.type&&n.type.startsWith&&n.type.startsWith("text/")||n.type==="application/json")return!0;const e=((t=n.name)==null?void 0:t.toLowerCase())||"";return Tx.some(s=>e.endsWith(s))}function u8(n){if(!n)return"";let e=n.replace(/\r\n/g,`
`).replace(/\u0000/g,"").trim();return e.length>K2&&(e=e.slice(0,K2)+`
...[truncated]`),e}async function _x(n){const e=new Uint8Array(await n.arrayBuffer()),s=await lv({data:e}).promise;let i="";for(let r=1;r<=s.numPages;r++){const h=(await(await s.getPage(r)).getTextContent()).items.map(c=>typeof c.str=="string"?c.str:"").join(" ");if(i+=h+`
`,i.length>=K2)break}return await s.destroy(),u8(i)}async function Mx(n){const e=await n.text();return u8(e)}async function Dx(n){if(!n)throw new Error("No file provided.");if(n.size>kx)throw new Error(`${n.name} is larger than 2MB.`);if(Cx(n))return{type:"pdf",text:await _x(n)};if(Ex(n))return{type:"text",text:await Mx(n)};throw new Error(`${n.name} is not a supported file type.`)}function Rx(n){return Number.isFinite(n)?n<1024?`${n} B`:n<1024*1024?`${(n/1024).toFixed(1)} KB`:`${(n/(1024*1024)).toFixed(1)} MB`:""}function T6(n,e,t){const s=n.slice();return s[31]=e[t],s}function C6(n){let e;return{c(){e=oe("div"),e.textContent="Drop files to attach",U(e,"class","drag-overlay svelte-5nb93l"),U(e,"aria-hidden","true")},m(t,s){Le(t,e,s)},d(t){t&&De(e)}}}function E6(n){let e;return{c(){e=oe("span"),e.textContent="✓",U(e,"class","tool-check svelte-5nb93l")},m(t,s){Le(t,e,s)},d(t){t&&De(e)}}}function Px(n){let e=n[6].length+"",t,s,i;return{c(){t=Xt(e),s=Xt("/"),i=Xt(n[7])},m(r,a){Le(r,t,a),Le(r,s,a),Le(r,i,a)},p(r,a){a[0]&64&&e!==(e=r[6].length+"")&&Mr(t,e),a[0]&128&&Mr(i,r[7])},d(r){r&&(De(t),De(s),De(i))}}}function Lx(n){let e;return{c(){e=Xt("…")},m(t,s){Le(t,e,s)},p:Ns,d(t){t&&De(e)}}}function _6(n){let e,t,s,i,r,a,l,h;return{c(){e=oe("div"),t=oe("span"),t.textContent="🌐",s=ke(),i=oe("span"),i.textContent="Search",r=ke(),a=oe("button"),a.textContent="✕",U(t,"class","pill-icon svelte-5nb93l"),U(a,"type","button"),U(a,"class","pill-remove svelte-5nb93l"),U(a,"aria-label","Disable web search"),U(e,"class","tool-pill svelte-5nb93l"),U(e,"title","Web search enabled")},m(c,u){Le(c,e,u),K(e,t),K(e,s),K(e,i),K(e,r),K(e,a),l||(h=rt(a,"click",n[25]),l=!0)},p:Ns,d(c){c&&De(e),l=!1,h()}}}function M6(n){let e,t=[],s=new Map,i=Fa(n[6]);const r=a=>a[31].id;for(let a=0;a<i.length;a+=1){let l=T6(n,i,a),h=r(l);s.set(h,t[a]=R6(h,l))}return{c(){e=oe("div");for(let a=0;a<t.length;a+=1)t[a].c();U(e,"class","attachment-preview svelte-5nb93l")},m(a,l){Le(a,e,l);for(let h=0;h<t.length;h+=1)t[h]&&t[h].m(e,null)},p(a,l){l[0]&65600&&(i=Fa(a[6]),t=Q2(t,l,r,1,a,i,s,e,Z2,R6,null,T6))},d(a){a&&De(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function D6(n){let e,t=n[31].sizeLabel+"",s;return{c(){e=oe("span"),s=Xt(t),U(e,"class","chip-size svelte-5nb93l")},m(i,r){Le(i,e,r),K(e,s)},p(i,r){r[0]&64&&t!==(t=i[31].sizeLabel+"")&&Mr(s,t)},d(i){i&&De(e)}}}function R6(n,e){let t,s,i,r=e[31].name+"",a,l,h,c,u,d,f,p,w,y=e[31].sizeLabel&&D6(e);function x(){return e[26](e[31])}return{key:n,first:null,c(){t=oe("div"),s=oe("div"),i=oe("span"),a=Xt(r),l=ke(),y&&y.c(),h=ke(),c=oe("button"),u=Xt("✕"),f=ke(),U(i,"class","chip-name svelte-5nb93l"),U(s,"class","chip-text svelte-5nb93l"),U(c,"type","button"),U(c,"class","chip-remove svelte-5nb93l"),U(c,"aria-label",d=`Remove ${e[31].name}`),U(t,"class","attachment-chip svelte-5nb93l"),this.first=t},m(S,E){Le(S,t,E),K(t,s),K(s,i),K(i,a),K(s,l),y&&y.m(s,null),K(t,h),K(t,c),K(c,u),K(t,f),p||(w=rt(c,"click",x),p=!0)},p(S,E){e=S,E[0]&64&&r!==(r=e[31].name+"")&&Mr(a,r),e[31].sizeLabel?y?y.p(e,E):(y=D6(e),y.c(),y.m(s,null)):y&&(y.d(1),y=null),E[0]&64&&d!==(d=`Remove ${e[31].name}`)&&U(c,"aria-label",d)},d(S){S&&De(t),y&&y.d(),p=!1,w()}}}function P6(n){let e,t;return{c(){e=oe("div"),t=Xt(n[8]),U(e,"class","attachment-error svelte-5nb93l"),U(e,"aria-live","polite")},m(s,i){Le(s,e,i),K(e,t)},p(s,i){i[0]&256&&Mr(t,s[8])},d(s){s&&De(e)}}}function Ix(n){let e;return{c(){e=Xt("➤")},m(t,s){Le(t,e,s)},d(t){t&&De(e)}}}function Bx(n){let e;return{c(){e=Xt("...")},m(t,s){Le(t,e,s)},d(t){t&&De(e)}}}function Nx(n){let e,t,s,i,r,a,l,h,c,u,d,f,p,w,y,x,S,E,T,_,M,D,L,F,N,W,$,q,se,z,ee,Y,Z,V,we,Fe,st,ue,Ae,Be=n[11]&&C6(),Ee=n[2]&&E6();function Yt(fe,ct){return fe[9]?Lx:Px}let _e=Yt(n),ht=_e(n),it=n[2]&&_6(n),Ve=n[6].length&&M6(n),Ke=n[8]&&P6(n);function Ji(fe,ct){return fe[1]?Bx:Ix}let Ri=Ji(n),ns=Ri(n);return{c(){e=oe("form"),Be&&Be.c(),t=ke(),s=oe("div"),i=oe("div"),r=oe("button"),a=Xt("+"),h=ke(),c=oe("div"),u=oe("button"),d=oe("span"),d.textContent="Web search",f=ke(),Ee&&Ee.c(),w=ke(),y=oe("button"),x=oe("span"),x.textContent="Add files",S=ke(),E=oe("span"),ht.c(),M=ke(),D=oe("div"),D.innerHTML="<span>Add images</span>",F=ke(),N=oe("input"),W=ke(),it&&it.c(),$=ke(),Ve&&Ve.c(),q=ke(),Ke&&Ke.c(),se=ke(),z=oe("textarea"),ee=ke(),Y=oe("button"),ns.c(),V=ke(),we=oe("div"),U(r,"type","button"),U(r,"class",l=Wt(`tool-trigger ${n[3]?"open":""}`)+" svelte-5nb93l"),U(r,"aria-haspopup","true"),U(r,"aria-expanded",n[3]),U(u,"type","button"),U(u,"class",p=Wt(`tool-item ${n[2]?"selected":""}`)+" svelte-5nb93l"),U(E,"class","tool-check svelte-5nb93l"),U(y,"type","button"),U(y,"class",T=Wt(`tool-item ${n[6].length>=n[7]?"disabled":""}`)+" svelte-5nb93l"),y.disabled=_=n[6].length>=n[7]||n[9],U(D,"class","tool-item disabled svelte-5nb93l"),U(D,"aria-disabled","true"),U(c,"class",L=Wt(`tool-dropdown ${n[3]?"open":""}`)+" svelte-5nb93l"),U(N,"type","file"),U(N,"accept",Sx),N.multiple=!0,U(N,"class","file-input svelte-5nb93l"),U(i,"class","tool-menu svelte-5nb93l"),U(z,"rows","1"),U(z,"placeholder","Send a message..."),U(z,"class","svelte-5nb93l"),U(Y,"class","send-button svelte-5nb93l"),U(Y,"type","submit"),Y.disabled=Z=n[1]||!n[0].trim()&&n[6].length===0,U(s,"class","input-inner svelte-5nb93l"),U(we,"class","input-hints svelte-5nb93l"),U(e,"class",Fe=Wt(`input-bar ${n[4]?"with-inset":""} ${n[11]?"drag-active":""}`)+" svelte-5nb93l"),U(e,"style",st=`--bottom-inset: ${Math.min(Math.max(n[5],0),200)}px;`)},m(fe,ct){Le(fe,e,ct),Be&&Be.m(e,null),K(e,t),K(e,s),K(s,i),K(i,r),K(r,a),K(i,h),K(i,c),K(c,u),K(u,d),K(u,f),Ee&&Ee.m(u,null),K(c,w),K(c,y),K(y,x),K(y,S),K(y,E),ht.m(E,null),K(c,M),K(c,D),K(i,F),K(i,N),n[24](N),K(s,W),it&&it.m(s,null),K(s,$),Ve&&Ve.m(s,null),K(s,q),Ke&&Ke.m(s,null),K(s,se),K(s,z),K3(z,n[0]),K(s,ee),K(s,Y),ns.m(Y,null),K(e,V),K(e,we),ue||(Ae=[rt(r,"click",n[21]),rt(u,"click",n[22]),rt(y,"click",n[23]),rt(N,"change",n[15]),rt(z,"input",n[27]),rt(z,"input",n[13]),rt(z,"keydown",n[28]),rt(e,"submit",hc(n[29])),rt(e,"dragenter",hc(n[17])),rt(e,"dragover",hc(n[20])),rt(e,"dragleave",hc(n[18])),rt(e,"drop",hc(n[19]))],ue=!0)},p(fe,ct){fe[11]?Be||(Be=C6(),Be.c(),Be.m(e,t)):Be&&(Be.d(1),Be=null),ct[0]&8&&l!==(l=Wt(`tool-trigger ${fe[3]?"open":""}`)+" svelte-5nb93l")&&U(r,"class",l),ct[0]&8&&U(r,"aria-expanded",fe[3]),fe[2]?Ee||(Ee=E6(),Ee.c(),Ee.m(u,null)):Ee&&(Ee.d(1),Ee=null),ct[0]&4&&p!==(p=Wt(`tool-item ${fe[2]?"selected":""}`)+" svelte-5nb93l")&&U(u,"class",p),_e===(_e=Yt(fe))&&ht?ht.p(fe,ct):(ht.d(1),ht=_e(fe),ht&&(ht.c(),ht.m(E,null))),ct[0]&192&&T!==(T=Wt(`tool-item ${fe[6].length>=fe[7]?"disabled":""}`)+" svelte-5nb93l")&&U(y,"class",T),ct[0]&704&&_!==(_=fe[6].length>=fe[7]||fe[9])&&(y.disabled=_),ct[0]&8&&L!==(L=Wt(`tool-dropdown ${fe[3]?"open":""}`)+" svelte-5nb93l")&&U(c,"class",L),fe[2]?it?it.p(fe,ct):(it=_6(fe),it.c(),it.m(s,$)):it&&(it.d(1),it=null),fe[6].length?Ve?Ve.p(fe,ct):(Ve=M6(fe),Ve.c(),Ve.m(s,q)):Ve&&(Ve.d(1),Ve=null),fe[8]?Ke?Ke.p(fe,ct):(Ke=P6(fe),Ke.c(),Ke.m(s,se)):Ke&&(Ke.d(1),Ke=null),ct[0]&1&&K3(z,fe[0]),Ri!==(Ri=Ji(fe))&&(ns.d(1),ns=Ri(fe),ns&&(ns.c(),ns.m(Y,null))),ct[0]&67&&Z!==(Z=fe[1]||!fe[0].trim()&&fe[6].length===0)&&(Y.disabled=Z),ct[0]&2064&&Fe!==(Fe=Wt(`input-bar ${fe[4]?"with-inset":""} ${fe[11]?"drag-active":""}`)+" svelte-5nb93l")&&U(e,"class",Fe),ct[0]&32&&st!==(st=`--bottom-inset: ${Math.min(Math.max(fe[5],0),200)}px;`)&&U(e,"style",st)},i:Ns,o:Ns,d(fe){fe&&De(e),Be&&Be.d(),Ee&&Ee.d(),ht.d(),n[24](null),it&&it.d(),Ve&&Ve.d(),Ke&&Ke.d(),ns.d(),ue=!1,Rr(Ae)}}}function Fx(n,e,t){let{inputValue:s=""}=e,{loading:i=!1}=e,{currentUseSearch:r=!0}=e,{toolMenuOpen:a=!1}=e,{hasBottomInset:l=!1}=e,{bottomInset:h=0}=e,{attachments:c=[]}=e,{maxAttachments:u=3}=e,{attachmentError:d=""}=e,{attachmentsLoading:f=!1}=e;const p=G6();let w,y=0,x=!1;function S(V){p("input",V.target.value)}function E(){f||w&&w.click()}function T(V){const we=Array.from(V.target.files??[]);we.length&&p("addFiles",we),V.target.value=""}function _(V){p("removeAttachment",V)}function M(V){var we;V.dataTransfer&&(y+=1,(we=V.dataTransfer.types)!=null&&we.includes("Files")&&t(11,x=!0))}function D(V){V.dataTransfer&&(y=Math.max(y-1,0),y===0&&t(11,x=!1))}function L(V){if(!V.dataTransfer)return;const we=Array.from(V.dataTransfer.files??[]);t(11,x=!1),y=0,we.length&&p("addFiles",we)}function F(V){k8.call(this,n,V)}const N=()=>p("toggleMenu",!a),W=()=>{p("toggleSearch",!r),p("toggleMenu",!1)},$=()=>{E(),p("toggleMenu",!1)};function q(V){o4[V?"unshift":"push"](()=>{w=V,t(10,w)})}const se=()=>p("toggleSearch",!1),z=V=>_(V.id);function ee(){s=this.value,t(0,s)}const Y=V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),p("send"))},Z=()=>p("send");return n.$$set=V=>{"inputValue"in V&&t(0,s=V.inputValue),"loading"in V&&t(1,i=V.loading),"currentUseSearch"in V&&t(2,r=V.currentUseSearch),"toolMenuOpen"in V&&t(3,a=V.toolMenuOpen),"hasBottomInset"in V&&t(4,l=V.hasBottomInset),"bottomInset"in V&&t(5,h=V.bottomInset),"attachments"in V&&t(6,c=V.attachments),"maxAttachments"in V&&t(7,u=V.maxAttachments),"attachmentError"in V&&t(8,d=V.attachmentError),"attachmentsLoading"in V&&t(9,f=V.attachmentsLoading)},[s,i,r,a,l,h,c,u,d,f,w,x,p,S,E,T,_,M,D,L,F,N,W,$,q,se,z,ee,Y,Z]}class Ox extends fg{constructor(e){super(),dg(this,e,Fx,Nx,ug,{inputValue:0,loading:1,currentUseSearch:2,toolMenuOpen:3,hasBottomInset:4,bottomInset:5,attachments:6,maxAttachments:7,attachmentError:8,attachmentsLoading:9},null,[-1,-1])}}const{window:zx}=w8;function L6(n){let e,t,s;return{c(){e=oe("button"),e.textContent="Stop",U(e,"class","stop-btn svelte-9uf8jm"),U(e,"type","button")},m(i,r){Le(i,e,r),t||(s=rt(e,"click",n[25]),t=!0)},p:Ns,d(i){i&&De(e),t=!1,s()}}}function I6(n){let e,t,s;return{c(){e=oe("div"),U(e,"class","sidebar-backdrop svelte-9uf8jm"),U(e,"role","button"),U(e,"tabindex","0"),U(e,"aria-label","Close chat list")},m(i,r){Le(i,e,r),t||(s=[rt(e,"click",n[39]),rt(e,"keydown",n[40])],t=!0)},p:Ns,d(i){i&&De(e),t=!1,Rr(s)}}}function Hx(n){let e,t,s,i,r,a,l=n[8]?"Show chats":"Hide chats",h,c,u,d,f,p,w,y,x,S,E,T,_,M,D,L,F,N,W,$,q=n[4]&&L6(n);x=new b9({props:{conversations:n[0],currentId:n[1],sidebarOpen:n[6],sidebarCollapsed:n[8]}}),x.$on("create",n[30]),x.$on("select",n[31]),x.$on("delete",n[32]),x.$on("close",n[33]),_=new A9({props:{currentConversation:n[2],currentMessages:n[16],renderMarkdown:n[14],loading:n[4]&&n[5]}}),D=new Ox({props:{inputValue:n[3],loading:n[4],currentUseSearch:n[15],toolMenuOpen:n[7],hasBottomInset:n[9],bottomInset:n[10],attachments:n[11],maxAttachments:Z1,attachmentError:n[12],attachmentsLoading:n[13]}}),D.$on("input",n[34]),D.$on("send",n[24]),D.$on("toggleSearch",n[35]),D.$on("toggleMenu",n[36]),D.$on("addFiles",n[37]),D.$on("removeAttachment",n[38]);let se=n[6]&&I6(n);return{c(){e=oe("main"),t=oe("header"),s=oe("div"),i=oe("button"),i.textContent="☰",r=ke(),a=oe("button"),h=Xt(l),u=ke(),d=oe("div"),d.textContent="Llama Chat",f=ke(),p=oe("div"),q&&q.c(),w=ke(),y=oe("div"),Bg(x.$$.fragment),S=ke(),E=oe("section"),T=oe("div"),Bg(_.$$.fragment),M=ke(),Bg(D.$$.fragment),L=ke(),se&&se.c(),U(i,"class","sidebar-toggle svelte-9uf8jm"),U(i,"type","button"),U(i,"aria-label","Open chat list"),U(a,"class","sidebar-collapse-trigger svelte-9uf8jm"),U(a,"type","button"),U(a,"aria-label",c=n[8]?"Show chat list":"Hide chat list"),U(d,"class","logo svelte-9uf8jm"),U(s,"class","top-left svelte-9uf8jm"),U(p,"class","top-controls svelte-9uf8jm"),U(t,"class","top-bar svelte-9uf8jm"),U(T,"class","chat-wrapper svelte-9uf8jm"),U(E,"class","chat-area svelte-9uf8jm"),U(y,"class","app-body svelte-9uf8jm"),U(e,"class",F=Wt(`app ${n[6]?"sidebar-open":""}`)+" svelte-9uf8jm")},m(z,ee){Le(z,e,ee),K(e,t),K(t,s),K(s,i),K(s,r),K(s,a),K(a,h),K(s,u),K(s,d),K(t,f),K(t,p),q&&q.m(p,null),K(e,w),K(e,y),f1(x,y,null),K(y,S),K(y,E),K(E,T),f1(_,T,null),K(T,M),f1(D,T,null),K(e,L),se&&se.m(e,null),N=!0,W||($=[rt(zx,"click",n[26]),rt(i,"click",n[28]),rt(a,"click",n[29])],W=!0)},p(z,ee){(!N||ee[0]&256)&&l!==(l=z[8]?"Show chats":"Hide chats")&&Mr(h,l),(!N||ee[0]&256&&c!==(c=z[8]?"Show chat list":"Hide chat list"))&&U(a,"aria-label",c),z[4]?q?q.p(z,ee):(q=L6(z),q.c(),q.m(p,null)):q&&(q.d(1),q=null);const Y={};ee[0]&1&&(Y.conversations=z[0]),ee[0]&2&&(Y.currentId=z[1]),ee[0]&64&&(Y.sidebarOpen=z[6]),ee[0]&256&&(Y.sidebarCollapsed=z[8]),x.$set(Y);const Z={};ee[0]&4&&(Z.currentConversation=z[2]),ee[0]&65536&&(Z.currentMessages=z[16]),ee[0]&16384&&(Z.renderMarkdown=z[14]),ee[0]&48&&(Z.loading=z[4]&&z[5]),_.$set(Z);const V={};ee[0]&8&&(V.inputValue=z[3]),ee[0]&16&&(V.loading=z[4]),ee[0]&32768&&(V.currentUseSearch=z[15]),ee[0]&128&&(V.toolMenuOpen=z[7]),ee[0]&512&&(V.hasBottomInset=z[9]),ee[0]&1024&&(V.bottomInset=z[10]),ee[0]&2048&&(V.attachments=z[11]),ee[0]&4096&&(V.attachmentError=z[12]),ee[0]&8192&&(V.attachmentsLoading=z[13]),D.$set(V),z[6]?se?se.p(z,ee):(se=I6(z),se.c(),se.m(e,null)):se&&(se.d(1),se=null),(!N||ee[0]&64&&F!==(F=Wt(`app ${z[6]?"sidebar-open":""}`)+" svelte-9uf8jm"))&&U(e,"class",F)},i(z){N||(Uc(x.$$.fragment,z),Uc(_.$$.fragment,z),Uc(D.$$.fragment,z),N=!0)},o(z){Ig(x.$$.fragment,z),Ig(_.$$.fragment,z),Ig(D.$$.fragment,z),N=!1},d(z){z&&De(e),q&&q.d(),p1(x),p1(_),p1(D),se&&se.d(),W=!1,Rr($)}}}const B6="llama-chat-conversations",N6=!0,F6=900,Z1=3,Ux=60;function Ii(n){return n==null?"":String(n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Qc(n){if(!n)return"#";try{const e=new URL(n,typeof window<"u"?window.location.origin:"http://localhost"),t=e.protocol.toLowerCase();return t==="javascript:"||t==="data:"?"#":e.href}catch{return"#"}}function O6(){if(typeof window>"u")return 0;const n=window.visualViewport;if(!n)return 0;const e=window.innerHeight-(n.height+n.offsetTop);return Math.max(e,0)}function qx(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`}function $x(n){return!n||n.length===0?"":n.map((e,t)=>{const s=e.sizeLabel?` (${e.sizeLabel})`:"";return`[File ${t+1}: ${e.name}${s}]
${e.content}`}).join(`

`)}function z6(n){var i;const e=Qc((n==null?void 0:n.href)||(n==null?void 0:n.src)),t=Ii((n==null?void 0:n.text)??((i=n==null?void 0:n.tokens)==null?void 0:i.map(r=>r.raw??"").join(""))??""),s=n!=null&&n.title?` title="${Ii(n.title)}"`:"";return`<img src="${e}" alt="${t}"${s} loading="lazy" />`}function Gx(n,e){if(!n||!Array.isArray(e)||e.length===0)return n;const t=(i,r)=>{const a=parseInt(r,10)-1;if(Number.isNaN(a)||a<0||a>=e.length)return i;const l=e[a];if(!(l!=null&&l.url))return i;const h=Qc(l.url);return`[${`link &#91;${r}&#93;`}](${h})`};let s=n.replace(/\[link\s*\[(\d+)\]\]/gi,t);return s=s.replace(/link\s*\[(\d+)\]/gi,(i,r)=>t(i,r)),s}function Vx(n){return n&&n.replace(/\[!\[([^\]]*?)\]\(([^)]+?)\)\]\(([^)]+?)\)/g,(e,t,s,i)=>{const r=Qc(i),a=Qc(s),l=Ii(t??"");return`<a href="${r}" target="_blank" rel="noreferrer"><img src="${a}" alt="${l}" loading="lazy" /></a>`})}function jx(n,e,t){let s,i,r,a,l,h=[],c=null,u="",d=!1,f=!1,p,w=!1,y=!1,x=!1,S=!1,E=0,T=null,_=!0,M=[],D="",L=!1;function F(){typeof window>"u"||window.innerWidth<F6&&t(6,w=!1)}function N(H){const te=Math.max(H||0,0),J=te>8?Math.min(te+6,220):0;t(10,E=J),t(9,S=J>0)}async function W(H){const te=Array.isArray(H)?H:Array.from(H??[]);if(te.length===0)return;const J=Z1-M.length;if(J<=0){t(12,D=`You can attach up to ${Z1} files.`);return}t(13,L=!0);let ut=J;const kt=[];let Pt="";try{for(const In of te){if(ut<=0){Pt||(Pt=`You can attach up to ${Z1} files.`);break}try{const ui=await Dx(In);if(!(ui!=null&&ui.text)){Pt||(Pt=`${In.name} does not contain readable text.`);continue}kt.push({id:qx(),name:In.name,size:In.size,sizeLabel:Rx(In.size),kind:ui.type,content:ui.text}),ut-=1}catch(ui){console.error("Failed to read attachment",ui),Pt||(Pt=(ui==null?void 0:ui.message)||`Failed to read ${In.name}.`)}}}finally{t(13,L=!1)}kt.length&&t(11,M=[...M,...kt]),t(12,D=Pt)}function $(H){t(11,M=M.filter(te=>te.id!==H)),M.length===0&&t(12,D="")}const q=new Ne.Renderer;q.code=function({text:H="",lang:te=""}){const J=typeof te=="string"?te.trim():"",ut=J?`language-${J}`:"",kt=typeof H=="string"?H:H!=null?String(H):"",Pt=Ii(kt.trimEnd());return`<div class="code-block"><button class="copy-btn" type="button">Copy</button><pre><code class="${ut}">${Pt}</code></pre></div>`},q.codespan=function({text:H=""}){const te=typeof H=="string"?H:H!=null?String(H):"";return`<code class="inline-code">${Ii(te)}</code>`},q.link=function({href:H,title:te,tokens:J}){const ut=Qc(H),kt=te?` title="${Ii(te)}"`:"";let Pt="";return J&&J.length===1&&J[0].type==="image"?Pt=z6(J[0]):Pt=this.parser&&this.parser.parseInline(J??[])||Ii(typeof H=="string"?H:String(H??"")),`<a href="${ut}" target="_blank" rel="noreferrer"${kt}>${Pt}</a>`},q.image=function({href:H,title:te,text:J}){return z6({href:H,title:te,text:J})},q.html=function({text:H=""}){const te=typeof H=="string"?H:H!=null?String(H):"",J=te.trim(),ut=/^<a\s+href="[^"]+"\s+target="_blank"\s+rel="noreferrer">\s*<img\s+src="[^"]+"\s+alt="[^"]*"\s+loading="lazy"\s*\/>\s*<\/a>$/i;return/^<br\s*\/?>$/i.test(J)?"<br />":ut.test(J)?J:Ii(te)};function se(H,te=!1){const J=typeof H=="string"?H:String(H??"");try{return d9.renderToString(J,{displayMode:te,throwOnError:!1,output:"html",strict:"ignore"})}catch(ut){console.error("Failed to render math",ut,H);const kt=te?"div":"span";return`<${kt} class="${te?"math math-block":"math"}">${Ii(J)}</${kt}>`}}const z=[{name:"mathBlock",level:"block",start(H){const te=H.indexOf("$$"),J=H.indexOf("\\[");return te===-1?J===-1?void 0:J:J===-1?te:Math.min(te,J)},tokenizer(H){const te=H.match(/^\$\$([^]*?)\$\$/);if(te)return{type:"mathBlock",raw:te[0],text:te[1]};const J=H.match(/^\\\[([^]*?)\\\]/);if(J)return{type:"mathBlock",raw:J[0],text:J[1]}},renderer(H){return se(H.text.trim(),!0)}},{name:"mathInline",level:"inline",start(H){const te=H.indexOf("$"),J=H.indexOf("\\(");return te===-1?J===-1?void 0:J:J===-1?te:Math.min(te,J)},tokenizer(H){const te=H.match(/^\$([^\n$]+?)\$/);if(te)return{type:"mathInline",raw:te[0],text:te[1]};const J=H.match(/^\\\((.+?)\\\)/);if(J)return{type:"mathInline",raw:J[0],text:J[1]}},renderer(H){return se(H.text,!1)}}];Ne.use({renderer:q,gfm:!0,breaks:!0,headerIds:!1,mangle:!1,extensions:z,async:!1});function ee(H,te=[]){if(!H)return"";const J=Gx(H,te),ut=Vx(J);try{const kt=Ne.parse(ut);return typeof kt=="string"?kt:(console.warn("Unexpected non-string markdown render; falling back to plain text."),Ii(ut).replace(/\n/g,"<br>"))}catch(kt){return console.error("Failed to render markdown",kt,ut),Ii(ut).replace(/\n/g,"<br>")}}function Y(){try{typeof localStorage<"u"&&localStorage.setItem(B6,JSON.stringify(h))}catch(H){console.error("Failed to save conversations",H)}}function Z(){const H=Date.now().toString(),te={id:H,title:"New chat",messages:[],sources:[],useSearch:N6,createdAt:Date.now(),updatedAt:Date.now()};return t(0,h=[te,...h]),t(1,c=H),F(),Y(),te}function V(H){t(1,c=H),F()}function we(H){const te=h.findIndex(J=>J.id===H);if(te!==-1){if(t(0,h=h.filter(J=>J.id!==H)),c===H)if(h.length===0)Z();else{const J=te<h.length?te:h.length-1;t(1,c=h[J].id)}Y()}}function Fe(H){s&&(t(2,s.useSearch=H,s),t(2,s.updatedAt=Date.now(),s),t(0,h=[...h]),Y())}Z3(()=>{const H=()=>{if(!(typeof window>"u")&&(window.innerWidth>=F6?t(6,w=!1):t(8,x=!1),typeof window<"u")){const J=window.visualViewport;N(J?O6():0)}};let te;if(typeof window<"u"&&(H(),window.addEventListener("resize",H),window.visualViewport)){const J=()=>{N(O6())};window.visualViewport.addEventListener("resize",J),window.visualViewport.addEventListener("scroll",J),te=()=>{window.visualViewport.removeEventListener("resize",J),window.visualViewport.removeEventListener("scroll",J)}}try{if(typeof localStorage>"u")return Z(),()=>{typeof window<"u"&&window.removeEventListener("resize",H)};const J=localStorage.getItem(B6);if(J){const ut=JSON.parse(J);if(Array.isArray(ut)&&ut.length>0)return t(0,h=ut),t(1,c=ut[0].id),()=>{typeof window<"u"&&(window.removeEventListener("resize",H),te&&te())}}}catch(J){console.error("Failed to load conversations",J)}return Z(),()=>{typeof window<"u"&&(window.removeEventListener("resize",H),te&&te())}});async function st(){var $3,G3,V3;if(d)return;const H=u.trim(),te=$x(M);if(!H&&!te)return;t(7,y=!1);let J=s;J||(J=Z());const ut=M.map(Os=>({id:Os.id,name:Os.name,sizeLabel:Os.sizeLabel,kind:Os.kind})),Pt={role:"user",content:te?H?`${H}

${te}`:te:H,displayContent:H,attachmentsMeta:ut};J.messages=[...J.messages,Pt],J.updatedAt=Date.now(),(!J.title||J.title==="New chat")&&(J.title=Pt.content.slice(0,40));const In=J.messages.map(Os=>({role:Os.role,content:Os.content}));t(3,u=""),t(11,M=[]),t(12,D="");const ui={role:"assistant",content:""};J.messages=[...J.messages,ui];const Mg=J.messages.length-1;t(0,h=[...h]),Y(),t(4,d=!0),t(5,f=!0),J.sources=[],t(0,h=[...h]),Y(),p&&p.abort(),p=new AbortController;try{const Os=await fetch("/api/chat/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:Pt.content,use_search:J.useSearch,history:In}),signal:p.signal});if(!Os.ok)throw new Error(`HTTP ${Os.status}`);const d8=Os.body.getReader(),f8=new TextDecoder("utf-8");let Dg="";for(;;){const{done:p8,value:m8}=await d8.read();if(p8)break;Dg+=f8.decode(m8,{stream:!0});const j3=Dg.split(`

`);Dg=j3.pop()??"";for(const W3 of j3){if(!W3.trim())continue;const g8=W3.split(`
`).map(zs=>zs.trim()).filter(Boolean);let X3="message",Br="";for(const zs of g8)if(zs.startsWith("event:"))X3=zs.slice(6).trim();else if(zs.startsWith("data:")){const Vf=zs.slice(5).trim();Br&&(Br+=`
`),Br+=Vf}if(Br&&Br!=="[DONE]"){if(X3==="sources"){try{const zs=JSON.parse(Br);s&&s.id===J.id&&(t(2,s.sources=zs,s),t(0,h=[...h]),Y())}catch(zs){console.error("Failed to parse sources JSON",zs,Br)}continue}try{const Vf=((V3=(G3=($3=JSON.parse(Br).choices)==null?void 0:$3[0])==null?void 0:G3.delta)==null?void 0:V3.content)??"";Vf&&s&&s.id===J.id&&(t(2,s.messages[Mg].content+=Vf,s),f&&t(5,f=!1),t(2,s.updatedAt=Date.now(),s),t(0,h=[...h]),Y(),await Pg(),ue())}catch(zs){console.error("Failed to parse stream JSON",zs,Br)}}}}}catch(Os){console.error(Os),s&&s.id===J.id&&(t(2,s.messages[Mg].content=s.messages[Mg].content||"Sorry, something went wrong while streaming from the model.",s),t(0,h=[...h]),Y())}finally{t(4,d=!1),t(5,f=!1),await Pg(),ue()}}function ue(H=!1){T||(T=document.getElementById("messages")),T&&(H||_)&&(T.scrollTop=T.scrollHeight)}function Ae(){p&&p.abort()}Z3(()=>{let H=null,te=null,J=!1;return(async()=>{if(await Pg(),J||(T=document.getElementById("messages"),!T))return;const kt=()=>{_=T.scrollHeight-T.scrollTop-T.clientHeight<=Ux};T.addEventListener("scroll",kt),H=()=>T&&T.removeEventListener("scroll",kt),typeof ResizeObserver<"u"&&(te=new ResizeObserver(()=>{_&&ue(!0)}),te.observe(T)),kt()})(),()=>{J=!0,H&&H(),te&&te.disconnect()}});function Be(H){if(!y)return;const te=H.target;te&&typeof te.closest=="function"&&te.closest(".tool-menu")||t(7,y=!1)}const Ee=()=>t(6,w=!0),Yt=()=>{t(8,x=!x),t(6,w=!1)},_e=()=>{Z(),F()},ht=H=>V(H.detail.id),it=H=>we(H.detail.id),Ve=()=>t(6,w=!1),Ke=H=>t(3,u=H.detail),Ji=H=>Fe(H.detail),Ri=H=>t(7,y=H.detail),ns=H=>W(H.detail),fe=H=>$(H.detail),ct=()=>t(6,w=!1),lc=H=>{(H.key==="Enter"||H.key===" ")&&(H.preventDefault(),t(6,w=!1))};return n.$$.update=()=>{n.$$.dirty[0]&3&&t(2,s=h.find(H=>H.id===c)||null),n.$$.dirty[0]&4&&t(16,i=s!=null&&s.messages?[...s.messages]:[]),n.$$.dirty[0]&4&&t(27,r=s!=null&&s.sources?[...s.sources]:[]),n.$$.dirty[0]&4&&t(15,a=(s==null?void 0:s.useSearch)??N6),n.$$.dirty[0]&134217728&&t(14,l=H=>ee(H,r))},[h,c,s,u,d,f,w,y,x,S,E,M,D,L,l,a,i,F,W,$,Z,V,we,Fe,st,Ae,Be,r,Ee,Yt,_e,ht,it,Ve,Ke,Ji,Ri,ns,fe,ct,lc]}class Wx extends fg{constructor(e){super(),dg(this,e,jx,Hx,ug,{},null,[-1,-1])}}new Wx({target:document.getElementById("app")});
